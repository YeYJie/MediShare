!function(K,D,w){"use strict";var H="ht";if(!K[H]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),K.performance&&K.performance.now||function(){var G=Date.now();K.performance||(K.performance={}),K.performance.now=function(){return Date.now()-G}}();for(var R=Date.now(),z=16,V=["ms","moz","webkit","o"],N=0;N<V.length&&!K.requestAnimationFrame;++N)K.requestAnimationFrame=K[V[N]+"RequestAnimationFrame"],K.cancelAnimationFrame=K[V[N]+"CancelAnimationFrame"]||K[V[N]+"CancelRequestAnimationFrame"];K.requestAnimationFrame||(K.requestAnimationFrame=function(u){var b=Date.now(),G=z+R-b;return 0>G&&(G=0),R=b,K.setTimeout(function(){R=Date.now(),u(performance.now())},G)}),K.cancelAnimationFrame||(K.cancelAnimationFrame=function(A){return K.clearTimeout(A)}),D.assign===w&&(D.assign=function(n){if(n===w||null===n)throw new TypeError("Cannot convert undefined or null to object");for(var J=D(n),G=1;G<arguments.length;G++){var I=arguments[G];if(I!==w&&null!==I)for(var f in I)D.prototype.hasOwnProperty.call(I,f)&&(J[f]=I[f])}return J})}();var h,S,$,u,G=K.document,s=null,c=K[H]={},b=K[H+"config"],Z=c.Default=b&&b.Default||{},k=c.Style=b&&b.Style||{},E=c.Attr=b&&b.Attr||{},n=c.Color=b&&b.Color||{},V=c.IsGetter=b&&b.IsGetter||{},C=Math,T=C.round,p=C.floor,Q=C.ceil,O=C.sqrt,M=C.max,d=C.min,A=C.abs,P=C.cos,r=C.acos,t=C.sin,U=C.pow,L=C.asin,_=C.PI,v=2*_,q=_/2,l=C.tan,o=C.atan2,X=C.random,J=C.log,Y=function(d,j,r){return Math.max(j,Math.min(r,d))},i=!1,x=!1,g=K.parseInt||global.parseInt,y="2018-07-15",N=K.navigator?K.navigator.platform.indexOf("Win")>-1:!1,e=function(e){return e*e},F=K.setTimeout,W=K.clearTimeout,I=K.location,z=K.navigator?K.navigator.userAgent.toLowerCase():"",j=function(y){return y.test(z)},m=j(/msie/),a=j(/msie/)||j(/trident/),B=j(/msie 10/),f=j(/edge/),R=j(/firefox/),Xg=j(/mac/),nb=Z.isTouchable===w?N?!1:G?"ontouchend"in G:!1:Z.isTouchable,Ph="default",Yl="single",wb="multiple",ad="front",Ed="back",Zq="left",Oi="right",Tp="top",Rk="bottom",Vp="center",is="eye",Th="middle",wl="east",Wl="west",Fi="north",Um="none",Wo="px",Zc="absolute",lf="border",ys="triangle",Sh="rect",Xq="circle",es="cylinder",Ri="shape",En="items",$g="normal",Dq="remove",zo="clear",Lm="width",me="height",Oj="ingroup",Bq="check",Rl="uncheck",Nb="radio",Gl="radioOn",Sd="radioOff",qg="points",xp="values",bn="series",Hr="body",Xo="label",um="label2",ip="note",mp="note2",to="icons",po="labelFont",hl="labelColor",Vr="labelSelectColor",fc="note.expanded",Li="note2.expanded",rh="edge.expanded",Ce="edge.points",Rj="edge.type",ki="rotation",ug="getRotation",ss="setRotation",Fc="hidden",Lj="visible",gg="tuv",rs="no",Pj="draw",Gh="select",vp="currentSubGraph",bf="selectBackground",$j="autoMakeVisible",Ol="autoHideScrollBar",cp="scrollBarColor",hk="scrollBarSize",De="indent",ap="rowHeight",Xb="columnLineColor",Ke="rowLineColor",Ir="columnLineVisible",gj="rowLineVisible",dn="visibleFunc",Mq="expandIcon",vg="collapseIcon",ql="checkMode",Ar="sortFunc",Wk="editable",Ue="batchEditable",Uk="tristate",Gk="asc",Ki="desc",dj="position",bq="elevation",oj="children",qj="translateX",xi="translateY",Qm="dataModel",Mj="maxSize",mn="shape3d",re="shape3d.resolution",Yp="shape3d.visible",rn="shape3d.from.visible",kp="shape3d.to.visible",Cq="shape3d.top.visible",Yb="shape3d.bottom.visible",$q="repeat.uv.length",Pq="serializeValue",Qn="deserializeValue",hm="centerUniform",Tk="uniform",jn="rgba(255,255,255,0)",Ho="style",sd="attr",Ve="field",Ti="string",Af="boolean",Cd="color",$p="int",Te="number",Se="ew-resize",Xp="ns-resize",wg="pointer",Pp="auto",Wb="mousedown",fr="mousemove",Yc="mouseup",fd="mouseout",xq="touchstart",rb="touchmove",dh="touchend",Gi="keydown",qs="keyup",Ne=["DOMMouseScroll","mousewheel"],Sj=R?Ne[0]:Ne[1],no=nb?[xq,rb,dh,Gi,qs,"keypress","input","contextmenu"]:[Gi,qs,"keypress","input",Wb,fr,Yc,fd,Sj,"wheel","contextmenu","mouseenter","mouseleave","mouseover"],ag=s,Qq=s,_g=s,rc=Yc.length,_r=function(){_g&&(W(_g.timeout),_g=s)},Bg=function(){_g&&Zk(_g.e,_g.info)};K.addEventListener&&(nb||(K.addEventListener(fd,function(){_r()},!1),K.addEventListener(Sj,function(){Oc()},!1)),K.addEventListener(qs,function(T){91===T.keyCode?sq={}:delete sq[T.keyCode]},!0),K.addEventListener(Gi,function(F){sq[F.keyCode]=!0},!0));var km,$k,bk,cr=0,qf=s,Km=function(z,c){var D=F(function(){delete qf[D],Lr(qf)&&(qf=s),z()},c);return D},Ug=s,qp=s,oc={},Vg={},jh={},Mo={},ho={},sq={},vl={},nr={},mk={},zl={},Jn=/.json$/,co=/^data:image\/svg\+xml/,Pr={},kf=[],Cc={},Sn=s,Jq=s,sn=function(){},xn=function(){throw"Oops!"},Nl=[0,0,0],Jo=[0,0,0,0],Kd={x:0,y:0,width:0,height:0},Sq=s,qm=s,Zo=s,sc=function(w){qm&&!w._72O&&(Zo||(Zo={}),Zo[w._72O=Xi()]=w),km!=s?pb()<.05&&u&&!$k&&(ol=_r):ol=vs},Hh=function(q,T,x,h){qm||(qm={});var u=qm[q];if(u){if(u.url===T)return;u.image?(u.image.onload=sn,u.image.onerror=sn):u.request&&(u.request.onload=sn,u.request.onerror=sn)}if(Jn.test(T)){var M=new XMLHttpRequest;if(qm[q]={request:M,url:T},M.overrideMimeType&&M.overrideMimeType("text/plain"),T=Z.beforeLoadURL(T),T.data){var N=Z.parse(T.data);Jj(q,N),Z.handleImageLoaded(q,N)}else M.open("GET",encodeURI(T),!0),M.onload=function(X){if(200===this.status||0===this.status){var U=Z.parse(X.target.response||X.target.responseText);Jj(q,U),Z.handleImageLoaded(q,U)}else Jj(q,Z.handleUnfoundImage(q,T)||s)},M.onerror=function(){Jj(q,Z.handleUnfoundImage(q,T)||s)},M.send(null)}else{var N=new Image;qm[q]={image:N,url:T},a&&(T.toLowerCase().indexOf(".svg")>0||co.test(T))?(G.body.appendChild(N),N.style.visibility="hidden",N.onload=function(){F(function(){if(x&&(N.width=x),h&&(N.height=h),!N.width||!N.height){var d=N.width||N.clientWidth,P=N.height||N.clientHeight;N.width=d,N.height=P}Z.handleImageLoaded(q,N),Jj(q,N),G.body.removeChild(N),N.style.visibility=""},180)},N.onerror=function(){Jj(q,Z.handleUnfoundImage(q,T)||s),G.body.removeChild(N),N.style.visibility=""}):(N.onload=function(){x&&(N.width=x),h&&(N.height=h),Z.handleImageLoaded(q,N),Jj(q,N)},N.onerror=function(){Jj(q,Z.handleUnfoundImage(q,T)||s)}),/^data:image/.test(T)||(T=Z.beforeLoadURL(T),/^data:image/.test(T)||(T=Z.appendTimeStamp(T),T=encodeURI(T))),N.src=T}},Jj=function(n,Z){if(Vg[n]=Z,delete qm[n],Lr(qm)&&(qm=s,Zo)){for(var $ in Zo){var U=Zo[$];U._2O&&(U._2O={}),U.invalidateAll&&U.invalidateAll(w,"imageLoaded",n),U.redraw&&U.redraw(),U.iv(),delete U._72O}Zo=s}if(Z&&Zo)for(var $ in Zo){var U=Zo[$];U.invalidateAll&&U.invalidateAll(w,"imageLoading",n),U.redraw&&U.redraw(),U.iv()}},qo=function(){return J=C&&Date,function(){return K.performance&&K.performance.now?K.performance.now():Date.now()}}(),mh=function(T,P){P?W(T):K.cancelAnimationFrame(T)},Qf=function(W,N,o){return{width:W,height:N,comps:Dc(o)?o:[o]}},ac=function(i,W){return{type:Xq,rect:[i,W,1.6,1.6],borderWidth:1,borderColor:dl,gradient:Fq,gradientColor:fj,background:dl}},jm=function(n,r){return Qf(16,16,{type:ys,rect:[4,4,10,8],background:n,rotation:r?1.57:3.14})},ge=function(I,P){return Qf(16,16,{type:ys,rect:[4,4,8,7],background:I,rotation:P?3.14:0})},nn=function(H){var Q=H._orientation;return"horizontal"===Q||"h"===Q},Ei=function(q){var A=s||4,Z=s||1,b=s||1;0>A?A=0:A>.25&&(A=.25);var u,z,e,G,B,E,N,V=.5,T=[],X=[],I=[],p=v/b,L=v/Z,J=V-A;for(z=0;Z>=z;z++)for(G=-_+z*L,E=P(G),B=t(G),u=0;b>=u;u++)e=u*p,N=J+A*E,T.push(P(e)*N,B*A,-t(e)*N),(S=q)&&X.push(u/b,1-z/Z);for(z=0;Z>z;z++){var m=z*(b+1),w=(z+1)*(b+1);for(u=0;b>u;u++)I.push(m+u,w+u+1,w+u,m+u,m+u+1,w+u+1),Vn.z=fp.z=q}},pd=function(U){var s=2,A=0;for(var N in U)N.length===s&&g(N,32)===Kc&&(Sn=Jq=U[N]),A++;return A},dg=function(Q,I,y,W){return y||(y=nb?5:3,y/=W||1),{x:Q-y,y:I-y,width:2*y,height:2*y}},mf=function(W,l,G,k){var J=this;l||(l=nb?5:3,G=20,k=20);var r={x:W,y:l,width:G,height:k};if(G)for(var R=0;G>R;R++)if(3===G)k=20;else for(var F=0;k>F;F++)J=K?K:G;var U={x:_,y:2*_};if(Mr(r,U)){var S=me[0]+Tp[0]+zo[1]+(Gk.length-1);ig[is]=J[S],J[S]=Ng[is]}},Ig=function(L){return(/ble$/.test(L)||/ed$/.test(L)||V[L]?"is":"get")+L.charAt(0).toUpperCase()+L.slice(1)},Ng=function(Y){return"set"+Y.charAt(0).toUpperCase()+Y.slice(1)},Fm=function(j){return typeof j===Ti||j instanceof String},Rb=function(L){return typeof L===Te},vs=function(x){return typeof x===Af},Sg=function(N){return N&&"object"==typeof N},dc=function(k){return"function"==typeof k},Dc=function(b){return b instanceof Array},Qr=function(x){return x instanceof Yd},Fn=function($){return Dc($)?new Yd($):$},Cl=function(F){return F instanceof Zm},$f=function(j){return j instanceof Wg},Ur=function(j){return j instanceof nj},Yj=function(p,L){if(!(p instanceof c.Group))return!1;if(!L)return p.isExpanded();var r=L.getDataUI(p);return r&&r._88I?!0:!1},Di=function(m){return m instanceof xc},Zd=function(p){return p&&"IFRAME"===p.tagName},vc=function(t){return t==s||Z.numberDigits==s?t:parseFloat(t.toFixed(Z.numberDigits))},wm=function(Y,P,R){var t,n=P.length;if(R)for(var F=0;R>F;F++)if(3===n)Y.push(P[0]),Y.push(P[1]),Y.push(P[2]);else for(t=0;n>t;t++)Y.push(P[t]);else if(3===n)Y.push(P[0]),Y.push(P[1]),Y.push(P[2]);else for(t=0;n>t;t++)Y.push(P[t])},tq=function(v){return v?Sg(v)?v:{}:!1},se=function(R,C,v){var M,$=Sg(R)?R:R.prototype;for(M in C)v&&$[M]!==w||($[M]=C[M]);return R},$b=function(K){return String.fromCharCode(K)},Dm=function(H){for(var e,K=0,n="";K<H.length;K++)e=H[H.length-1-K],"%"===e?e="'":"a"===e?e='"':"]"===e&&(e="\\"),n+=$b(e.charCodeAt(0)-1);return n},fm=function(x,o,e){x.superClass.constructor.apply(o,e)},Lr=function(N){for(var k in N)return!1;return!0},Rf=function(G){return G?0===G.length:!0},vk=function(){var q="";return[Rl[0],Ke[0],Xo[0]].forEach(function(A){q+=Ng(A).slice(3)}),Tk=G&&G[q]||hm,function(E,f){return E===f?!0:E.x===f.x&&E.y===f.y&&E.width===f.width&&E.height===f.height}}(),Mk=function(X,z,Z){return z>X?z:X>Z?Z:X},Fr=function(R){return 0>R?-1:R>0?1:0},pb=function(){var c=1e4*t(rc++);return c-p(c)},Fo=function(h,U,J){return Qd(h.x,h.y,U.x,U.y,J.x,J.y,J.x+J.width,J.y,!0)||Qd(h.x,h.y,U.x,U.y,J.x+J.width,J.y,J.x+J.width,J.y+J.height,!0)||Qd(h.x,h.y,U.x,U.y,J.x+J.width,J.y+J.height,J.x,J.y+J.height,!0)||Qd(h.x,h.y,U.x,U.y,J.x,J.y+J.height,J.x,J.y,!0)},Qd=function(C,K,B,X,h,E,D,q,y){var e=(D-h)*(K-E)-(q-E)*(C-h),R=(q-E)*(B-C)-(D-h)*(X-K);if(0!==R){var Y=e/R,_=C+Y*(B-C),Q=K+Y*(X-K);return y&&(_+sg<d(C,B)||_-sg>M(C,B)||_+sg<d(h,D)||_-sg>M(h,D)||Q+sg<d(K,X)||Q-sg>M(K,X)||Q+sg<d(E,q)||Q-sg>M(E,q))?s:[_,Q]}return s},Pe=function(K,c,u){if(K&&u)if(c){if(c===Ho)return K.getStyle(u);if(c===sd)return K.getAttr(u);if(c===Ve)return K[u]}else if(u=Ig(u),K[u])return K[u]();return w},We=function(O,V,B,R){if(O&&B)if(V){if(V===Ho)O.s(B,R);else if(V===sd)O.a(B,R);else if(V===Ve){var J=O[B];O[B]=R,O.fp("f:"+B,J,R)}}else B=Ng(B),O[B]&&O[B](R)},gl=function(S,m,l){return m&&"top"!==m?"bottom"===m?{x:S.x,y:S.y,width:S.width,height:S.height*l}:"right"===m?{x:S.x,y:S.y,width:S.width*l,height:S.height}:"left"===m?{x:S.x+S.width*(1-l),y:S.y,width:S.width*l,height:S.height}:void 0:{x:S.x,y:S.y+S.height*(1-l),width:S.width,height:S.height*l}},np=function(h,x,A,V,g){x&&Yg(h,A,V,1,g,x)},$c=function(k,V,_,h){var R=1-k;return R*R*V+2*k*R*_+k*k*h},Vn=function(T,C,r,d,X){var f=1-T;return f*f*f*C+3*f*f*T*r+3*f*T*T*d+T*T*T*X},je=function(q){var k,m,K,C,A=0;return q.forEach(function(i){if(k=i.length,k>0)for(m=i[0],C=1;k>C;C++)K=i[C],A+=dq(m,K),m=K}),A},ke=function(t,k,Q){var C="__"+t,K=function(v){Q.disabled||Q["handle_"+t](v)};Q[C]||(Q[C]=K,k.addEventListener(t,K,!1))},Bi=function(Q,F,J){var c="__"+Q,S=J[c];S&&(F.removeEventListener(Q,S,!1),delete J[c])},tp=function(h,W){var R="_"+W;h[Ig(W)]=function(){return this[R]},h[Ng(W)]=function(b){var I=this[R];this[R]=b,this.fp(W,I,b)}},Ep=function(x){return D.create(x)},Ll=function(b){if(!b.element){var e,_;(e=b.textField)?_=vq(Cn.TextField,e):(e=b.textArea)?_=vq(Cn.TextArea,e):(e=b.button)?_=vq(Cn.Button,e):(e=b.comboBox)?_=vq(Cn.ComboBox,e):(e=b.checkBox)?_=vq(Cn.CheckBox,e):(e=b.radioButton)?_=vq(Cn.RadioButton,e):(e=b.slider)?_=vq(Cn.Slider,e):(e=b.colorPicker)?_=vq(Cn.ColorPicker,e):(e=b.image)&&(_=vq(Cn.Image,e)),_&&(b.element=_)}},Op=function(P,g){var o=mc(P);return o._ht=g,o},mc=function(w,U){var J=G.createElement("div"),O=J.style;return J.tabIndex=-1,J.onkeydown=Jr,O.msTouchAction=Um,Rm(J,s,0),nb&&O.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",s),w&&(O.overflow=Fc),U&&zd(U,J),J},qb=function(R,T){var $=G.createElement("canvas"),S=$.style;return S.msTouchAction=Um,T||(S.pointerEvents=Um),Rm($,s,0),R&&zd(R,$),$},Rm=function(G,W,j){var m=G.style;m.border=W?W+" solid 1px":0,m.outline=0,m.padding=j?"0 "+j+Wo:0,Tr(G)},Tr=function(h){var o=h.style;o.position=Zc,o.margin=0,o.setProperty("box-sizing","border-box",s),o.setProperty("-moz-box-sizing","border-box",s)},Dg=function(b,C,$,L){L||(L=fk),C!=s&&(b.width=C*L,b.style.width=C+Wo),$!=s&&(b.height=$*L,b.style.height=$+Wo)},zd=function(t,H,d){t.appendChild(H),d&&(H.style.position=Zc)},nq=function(b,z){z.split||(z+="");for(var g,Z=z.split("\n"),T=0,A=Z.length,B=0;A>B;B++){var W=Bm(b.font,Z[B]);W.width>T&&(T=W.width),g||(g=W.height)}return b.ss=Z,{width:T,height:g*A}},Xl=function(D,y,q,r,v,G){var n=y.length;if(1===n)pl(D,y[0],q,r,v);else for(var E=q.height/n,h={x:q.x,y:q.y,width:q.width,height:E},w=0;w<y.length;w++)G?Kn(D,y[w],r,v,h.x,h.y,h.width,h.height,G):pl(D,y[w],h,r,v),h.y+=E},pl=function(e,C,b,n,D){e.font=n?n:dr,e.fillStyle=D?D:yc,e.textAlign=Vp,e.textBaseline=Th;var u,X;b?b.width===w?(u=b.x,X=b.y):(u=b.x+b.width/2,X=b.y+b.height/2):(u=0,X=0),e.fillText(C,T(u),T(X))},Ag=function(a){a.getView&&(a=a.getView());var Y=a.offsetWidth||a.scrollWidth;return!Y&&a.style.width&&(Y=g(a.style.width)),Y},Mi=function(V){V.getView&&(V=V.getView());var O=V.offsetHeight||V.scrollHeight;return!O&&V.style.height&&(O=g(V.style.height)),O},Er=function(){var P=function(z){Jr(z),z.stopPropagation()},U=nb?[xq]:[Gi,Wb];return function(E){var V=mc(),j=V.style;return j.backgroundColor=Z.disabledBackground,E&&(j.backgroundImage="url("+E+")",j.backgroundPosition="50% 50%",j.backgroundRepeat="no-repeat no-repeat"),U.forEach(function(h){V.addEventListener(h,P)}),V}}(),Ml=function(Z){var H=Z.getContext("2d");return H.save(),H.lineCap=Tj,H.lineJoin=Pl,H},ol=function(S,p,h,R){Xr(S,p*fk,h*fk),R*=fk,1!==R&&S.scale(R,R)},Xr=function(O,U,z){O.translate(U,z)},Wf=function(a,g){g&&a.rotate(g)},Ak=function(M,F,U){F===w&&(F=1),U===w&&(U=1),(1!==F||1!==U)&&M.scale(F,U)},Br=!1,Zp=function(Z){var V=G.activeElement;if(G.activeElement!==Z){V&&V.forceOnblur&&V.forceOnblur();for(var n=[],z=Z.parentNode;z;)n.push([z,z.scrollLeft,z.scrollTop]),z=z.parentNode;if(!Br){var a=[];try{for(var m=K.parent,p=K;m!==p;)a.push([m,m.scrollX,m.scrollY]),p=m,m=K.parent}catch(l){Br=!0}}if(nb)Z.focus();else{var N=Vj(),r=N.target;Z.focus(),r.scrollLeft=N.left,r.scrollTop=N.top}n.forEach(function(Z){Z[0].scrollLeft=Z[1],Z[0].scrollTop=Z[2]}),Br||a.forEach(function(M){M[0].scrollTo(M[1],M[2])})}},kk=function(E){return E&&E.getView?E.getView():E},_p=function(F,e,r,k,E){if(2===arguments.length&&(r=e.y,k=e.width,E=e.height,e=e.x),F.isSelfViewEvent)F.setX(e),F.setY(r),F.setWidth(k),F.setHeight(E);else{var z=kk(F),i=z.style;if((G.fullscreenElement||G.mozFullScreenElement||G.webkitFullscreenElement||G.msFullscreenElement)!==z)e!==w&&(i.left=e+Wo),r!==w&&(i.top=r+Wo),k!==w&&(i.width=k+Wo),E!==w&&(i.height=E+Wo);else{var p=Z.getWindowInfo();i.left=(e=p.left)+Wo,i.top=(r=p.top)+Wo,i.width=(k=p.width)+Wo,i.height=(E=p.height)+Wo}F.endEditing&&!nb&&F.endEditing(),F.redraw&&F.redraw(),F.invalidate&&F.invalidate(),F.onLayouted&&F.onLayouted(e,r,k,E),F.fireViewEvent&&F.fireViewEvent("layout")}},Ui=function(C){if(!C.touches)return C;var W=C.touches[0];return W?W:C.changedTouches[0]},xr=function(t){return nb?Ui(t).target:t.target},ur=function(O){Z.popup&&Z.popup.close(),Z.popup=O},wk=s,xo=function(N){wk.handleWindowTouchMove(N)},Re=function($){wk.handleWindowTouchEnd($),K.removeEventListener(rb,xo,!1),K.removeEventListener(dh,Re,!1),wk=s},Ef=function(E){wk.handleWindowMouseMove(E)},Jk=function(M){wk.handleWindowMouseUp(M),K.removeEventListener(fr,Ef,!1),K.removeEventListener(Yc,Jk,!1),wk=s},Uo=function(T){return 1===qe(T)},Bc=function(e,I){return I?I.keyCode===e:sq[e]},Un=function(v){return sf(v)&&Bc(65,v)},sl=function(f){return Bc(46,f)||Bc(8,f)},El=function(p){return function(t){return t?t.keyCode===p:sq[p]}},Kc=573,Jp=[65,83,68,87,37,38,39,40,32,13,27],Vd=El(Jp[0]),Dr=El(Jp[1]),Tc=El(Jp[2]),ij=El(Jp[3]),Ee=El(Jp[4]),oo=El(Jp[5]),Ck=El(Jp[6]),Ni=El(Jp[7]),mm=El(Jp[8]),Rg=El(Jp[9]),af=El(Jp[10]),Em={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},us=[2,2,2,2,2,2,2,2,2,2,3,3,3,3,5,5,5,5,5,19,311],Co=s,Jf=s,zm=function(F,X){Co||(Co=qb()),Dg(Co,F,X,1);var v=Ml(Co);return v.clearRect(0,0,F,X),v},Ai=function(){var v,B={};for(var _ in K){var g=wb.length;if(_.length==g&&_[0]===wb[2]&&_[1]===Um[1]&&_[4]===wb[3]&&_[5]===wb[4]&&_.substr(g-2)===Um[1]+Um[2]){var Z=K[_];for(var f in Z)f.length===g&&f.substr(0,3)===Oi[3]+Dq[3]+Gh[0]&&f.substr(g-2)===wb[0]+ip[3]&&(Ne=Z[f])}}return function(O){var K,i=B[O];return i||(v||(v=qb(),Dg(v,1,1,1)),K=v.getContext("2d"),K.clearRect(0,0,1,1),Yg(K,0,0,1,1,O),i=K.getImageData(0,0,1,1).data,i=B[O]=[i[0],i[1],i[2],i[3]]),i}}(),Xe=function(x){if(!Fm(x))return x;var m=Ai(x);return m.CA||(m.CA=[m[0]/255,m[1]/255,m[2]/255,m[3]/255]),m.CA},qn=function(F,Z,T,E,V){var t=qb();t.width=T,t.height=E;var x=t.getContext("2d");x.drawImage(F,0,0,T,E);try{for(var W=x.getImageData(0,0,T,E),U=W.data,h=0,D=U.length;D>h;h+=4){var v=U[h+0],o=U[h+1],A=U[h+2],_=U[h+3];"override_a"===V?U[h+3]=255*Z[3]:"override_rgb"===V?(U[h+0]=255*Z[0],U[h+1]=255*Z[1],U[h+2]=255*Z[2]):"override"===V?(U[h+0]=255*Z[0],U[h+1]=255*Z[1],U[h+2]=255*Z[2],U[h+3]=255*Z[3]):(U[h+0]=Z[0]*v,U[h+1]=Z[1]*o,U[h+2]=Z[2]*A,U[h+3]=Z[3]*_)}x.putImageData(W,0,0)}catch(X){return F}return t},ig=function(n,h,$){return h&&(h="miter"===$?8*h+20:h+1,n&&$o(n,h)),h},Zb=function(Z,V){if(V){var l=new Qi(V),n=Z.width/2,x=Z.height/2,U=Ge([l.tf(-n,-x),l.tf(n,-x),l.tf(n,x),l.tf(-n,x)]);return U.x+=Z.x+n,U.y+=Z.y+x,U}return Z},ul=function(G,n,q,T,A,b,l,y){T*=Math.PI/180;var K={x:Math.cos(T)*(G.x-l.x)/2+Math.sin(T)*(G.y-l.y)/2,y:-Math.sin(T)*(G.x-l.x)/2+Math.cos(T)*(G.y-l.y)/2},E=Math.pow(K.x,2)/Math.pow(n,2)+Math.pow(K.y,2)/Math.pow(q,2);E>1&&(n*=Math.sqrt(E),q*=Math.sqrt(E));var W=(A==b?-1:1)*Math.sqrt((Math.pow(n,2)*Math.pow(q,2)-Math.pow(n,2)*Math.pow(K.y,2)-Math.pow(q,2)*Math.pow(K.x,2))/(Math.pow(n,2)*Math.pow(K.y,2)+Math.pow(q,2)*Math.pow(K.x,2)));isNaN(W)&&(W=0);var I={x:W*n*K.y/q,y:W*-q*K.x/n},X={x:(G.x+l.x)/2+Math.cos(T)*I.x-Math.sin(T)*I.y,y:(G.y+l.y)/2+Math.sin(T)*I.x+Math.cos(T)*I.y},v=function(u){return Math.sqrt(Math.pow(u[0],2)+Math.pow(u[1],2))},m=function(O,f){return(O[0]*f[0]+O[1]*f[1])/(v(O)*v(f))},R=function(x,b){return(x[0]*b[1]<x[1]*b[0]?-1:1)*Math.acos(m(x,b))},D=R([1,0],[(K.x-I.x)/n,(K.y-I.y)/q]),a=[(K.x-I.x)/n,(K.y-I.y)/q],U=[(-K.x-I.x)/n,(-K.y-I.y)/q],p=R(a,U);m(a,U)<=-1&&(p=Math.PI),m(a,U)>=1&&(p=0);var m=n>q?n:q,u=n>q?1:n/q,d=n>q?q/n:1;if(null==y){var M={x:0,y:0,width:0,height:0};$o(M,m),M.x*=u,M.width*=u,M.y*=d,M.height*=d;var t=new Qi(T);return M=Ge([t.tf(M.x,M.y),t.tf(M.x+M.width,M.y),t.tf(M.x+M.width,M.y+M.height),t.tf(M.x,M.y+M.height)]),M.x+=X.x,M.y+=X.y,[{x:M.x,y:M.y},{x:M.x+M.width,y:M.y},{x:M.x+M.width,y:M.y+M.height},{x:M.x,y:M.y+M.height}]}y.translate(X.x,X.y),y.rotate(T),y.scale(u,d),y.arc(0,0,m,D,D+p,1-b),y.scale(1/u,1/d),y.rotate(-T),y.translate(-X.x,-X.y)},lo=function(E,s){E&&E.beginPath();for(var b,W,Y,K=[],c=function(r){for(var j,M=/(\-{0,1}[\d\.]+)/gi,R=[];j=M.exec(r);)R.push(parseFloat(j[0]));return R},q=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,z={x:0,y:0};b=q.exec(s);){var H=b[0],x=H.substr(0,1);if("M"===x||"m"===x){for(var M=c(H),Q=0;Q<M.length;Q+=2){var V=M[Q],o=M[Q+1];"m"===x&&(V+=z.x,o+=z.y),E&&E.moveTo(V,o),K.push({x:V,y:o}),z.x=V,z.y=o}W=Y=null}else if("H"===x||"h"===x){for(var M=c(H),Q=0;Q<M.length;Q+=1){var V=M[Q];"h"===x&&(V+=z.x),E&&E.lineTo(V,z.y),K.push({x:V,y:z.y}),z.x=V}W=Y=null}else if("C"===x||"c"===x){for(var M=c(H),Q=0;Q<M.length;Q+=6){var f=M[Q],k=M[Q+1],i=M[Q+2],Z=M[Q+3],V=M[Q+4],o=M[Q+5];"c"===x&&(f+=z.x,k+=z.y,i+=z.x,Z+=z.y,V+=z.x,o+=z.y),E&&E.bezierCurveTo(f,k,i,Z,V,o),K.push({x:f,y:k}),K.push({x:i,y:Z}),K.push({x:V,y:o}),z.x=V,z.y=o}W=[f,k,i,Z,V,o],Y=null}else if("S"===x||"s"===x){for(var M=c(H),Q=0;Q<M.length;Q+=4){var f,k;W?(f=2*W[4]-W[2],k=2*W[5]-W[3]):(f=z.x,k=z.y);var i=M[Q],Z=M[Q+1],V=M[Q+2],o=M[Q+3];"s"===x&&(i+=z.x,Z+=z.y,V+=z.x,o+=z.y),E&&E.bezierCurveTo(f,k,i,Z,V,o),K.push({x:f,y:k}),K.push({x:i,y:Z}),K.push({x:V,y:o}),z.x=V,z.y=o}W=[f,k,i,Z,V,o],Y=null}else if("Q"===x||"q"===x){for(var M=c(H),Q=0;Q<M.length;Q+=4){var f=M[Q],k=M[Q+1],V=M[Q+2],o=M[Q+3];"q"===x&&(f+=z.x,k+=z.y,V+=z.x,o+=z.y),E&&E.quadraticCurveTo(f,k,V,o),K.push({x:f,y:k}),K.push({x:V,y:o}),z.x=V,z.y=o}W=null,Y=[f,k,V,o]}else if("T"===x||"t"===x){for(var M=c(H),Q=0;Q<M.length;Q+=2){var f,k;Y?(f=2*Y[2]-Y[0],k=2*Y[3]-Y[1]):(f=z.x,k=z.y);var V=M[Q],o=M[Q+1];"t"===x&&(V+=z.x,o+=z.y),E&&E.quadraticCurveTo(f,k,V,o),K.push({x:f,y:k}),K.push({x:V,y:o}),z.x=V,z.y=o}W=null,Y=[f,k,V,o]}else if("V"===x||"v"===x){for(var M=c(H),Q=0;Q<M.length;Q+=1){var o=M[Q];"v"===x&&(o+=z.y),E&&E.lineTo(z.x,o),K.push({x:z.x,y:o}),z.y=o}W=Y=null}else if("L"===x||"l"===x){for(var M=c(H),Q=0;Q<M.length;Q+=2){var V=M[Q],o=M[Q+1];"l"===x&&(V+=z.x,o+=z.y),E&&E.lineTo(V,o),K.push({x:V,y:o}),z.x=V,z.y=o}W=Y=null}else if("A"===x||"a"===x){for(var M=c(H),Q=0;Q<M.length;Q+=7){var d=M[Q],$=M[Q+1],n=M[Q+2],v=M[Q+3],T=M[Q+4],V=M[Q+5],o=M[Q+6];"a"===x&&(V+=z.x,o+=z.y);var m=ul(z,d,$,n,v,T,{x:V,y:o},E);m&&(K=K.concat(m)),z.x=V,z.y=o}W=Y=null}var g=H.substr(H.length-1);("z"===g||"Z"===g)&&E&&E.closePath()}return K},lj=function(r,P){var G,i,n="L"===P[0],F=P.length;for(r.save(),n?(r.transform(P[5],P[6],P[7],P[8],P[9],P[10]),G=r.createLinearGradient(P[1],P[2],P[3],P[4]),i=11):(r.transform(P[7],P[8],P[9],P[10],P[11],P[12]),G=r.createRadialGradient(P[1],P[2],P[3],P[4],P[5],P[6]),i=13);F>i;)G.addColorStop(P[i],P[i+1]),i+=2;r.fillStyle=G},fp=function(s,G){var g=s.s("shape.gradient.pack");if(g){for(var v=g.length,q=new Array(v),X=0;v>X;X++)q[X]=g[X];var B,H,u,$,Y,o,n,L,A,e,E,V,N,P="L"===q[0];B=P?5:7,H=q[B],u=q[B+1],$=q[B+2],Y=q[B+3],o=q[B+4],n=q[B+5],L=G[0],A=G[1],e=G[2],E=G[3],V=G[4],N=G[5],q[B]=L*H+e*u,q[B+1]=A*H+E*u,q[B+2]=L*$+e*Y,q[B+3]=A*$+E*Y,q[B+4]=L*o+e*n+V,q[B+5]=A*o+E*n+N,s.s("shape.gradient.pack",q)}},hr=function(U,S,a,w){var l=!1;if(U.beginPath?U.beginPath():l=!0,Qr(S)&&(S=S._as),Qr(a)&&(a=a._as),a&&a.length){for(var O,D,Q,d,N=0,q=0,u=a.length;u>q;q++)O=a[q],1===O?(D=S[N++],U.moveTo(D.x,l?-D.y:D.y)):2===O?(D=S[N++],U.lineTo(D.x,l?-D.y:D.y)):3===O?(D=S[N++],Q=S[N++],U.quadraticCurveTo(D.x,l?-D.y:D.y,Q.x,l?-Q.y:Q.y)):4===O?(D=S[N++],Q=S[N++],d=S[N++],U.bezierCurveTo(D.x,l?-D.y:D.y,Q.x,l?-Q.y:Q.y,d.x,l?-d.y:d.y)):5===O&&U.closePath();w&&5!==O&&U.closePath()}else{var R,i,r,e=S.length;if(e>0){for(R=S[0],U.moveTo(R.x,l?-R.y:R.y),i=1;e>i;i++)r=S[i],U.lineTo(r.x,l?-r.y:r.y);w&&U.closePath()}}},kb=function(X,f,S,O){if(Qr(X)&&(X=X._as),Qr(f)&&(f=f._as),f&&f.length){S=S||we;for(var w,p,Y,c,z,N,v,R,P=[],K=s,H=0,u=0,i=f.length;i>u;u++)if(w=f[u],1===w)P.push(K=[]),K.push(X[H++]);else if(2===w)K.push(X[H++]);else if(3===w){for(p=K[K.length-1],Y=X[H++],c=X[H++],N=1;S>N;N++)v=$c(N/S,p.x,Y.x,c.x),R=$c(N/S,p.y,Y.y,c.y),K.push({x:v,y:R,b:!0});K.push(c)}else if(4===w){for(p=K[K.length-1],Y=X[H++],c=X[H++],z=X[H++],N=1;S>N;N++)v=Vn(N/S,p.x,Y.x,c.x,z.x),R=Vn(N/S,p.y,Y.y,c.y,z.y),K.push({x:v,y:R,b:!0});K.push(z)}else 5===w&&K.push(K[0]);return O&&5!==w&&K&&K.length>2&&K.push(K[0]),P}return O&&X.length>2&&(X=X.slice(),X.push(X[0])),X?[X]:[]},zj=function(V,P,i,Y,N,w){var s,t,f,Z=Ai(P),O=Y,I=Z[0],J=Z[1],x=Z[2];if(i){var e=Ai(i);s=e[0]-I,t=e[1]-J,f=e[2]-x}else s=255-I,t=255-J,f=255-x;for(w||(w=Y>10?1:.5,w=1>N?d(w/N,2):w);(Y-=w)>0;){var k=1-Y/O,H=I+s*k,S=J+t*k,v=x+f*k;H=d(Q(H),255),S=d(Q(S),255),v=d(Q(v),255),V.strokeStyle="rgb("+H+","+S+","+v+")",V.lineWidth=Y,V.stroke()}},Gb=function(){var h={};return function(C,q){var e=C+"-"+q,m=h[e];if(m)return m;var r,c,_,G=Ai(C);return 0>q?(q=(100+q)/100,r=Q(G[0]*q),c=Q(G[1]*q),_=Q(G[2]*q)):(q/=100,r=G[0],c=G[1],_=G[2],r+=(255-r)*q,c+=(255-c)*q,_+=(255-_)*q,r=d(Q(r),255),c=d(Q(c),255),_=d(Q(_),255)),h[e]="rgb("+r+","+c+","+_+")"}}(),Yg=function($,E,x,k,s,g){g&&($.fillStyle=g),$.beginPath(),$.rect(E,x,k,s),$.fill()},om=function(u,e,V,$,n,U,g){u.beginPath(),pm[e](u,V.x,V.y,V.width,V.height,$,n,U,g)},Sp=function(R,P,U,L,F){var I=pm[U];R.fillStyle=I?I(R,P,L?L:fj,F.x,F.y,F.width,F.height):P},Sk=function(J,L,z,T,m,x){try{if(!L.tagName&&L.comps){L._cacheImage_||(L._cacheImage_={});var i;i="override"===T?"colors_override":"override_rgb"===T?"colors_override_rgb":"override_a"===T?"colors_override_a":"colors",L._cacheImage_[i]||(L._cacheImage_[i]={__count__:0});var t=L._cacheImage_[i][z];t||(L._cacheImage_[i].__count__>Z.imageCacheThreshold&&(L._cacheImage_[i]={__count__:0}),t=c.Default.toCanvas(L,Db(L),Vc(L),null,m,x,z,null,T),L._cacheImage_[i][z]=t,L._cacheImage_[i].__count__++),L=t}J.fillStyle=J.createPattern(L,"repeat")}catch(n){J.fillStyle="black"}},ml=function(E,f,Q,T,z,t,W){E.save(),E.translate(f,Q),E.scale(1,W/t),E.arc(0,0,t,T,z),E.restore()},cb=function(J,y,z,d,B,e,R,Z){var h,n,E,v,C,Y,V,r,W,c,X;if(A(B)>2*_&&(B=2*_),C=Q(A(B)/(_/4)),h=B/C,n=-h,E=-d,C>0){Y=y+P(d)*e,V=z+t(-d)*R,Z?J.lineTo(Y,V):J.moveTo(Y,V);for(var w=0;C>w;w++)E+=n,v=E-n/2,r=y+P(E)*e,W=z+t(E)*R,c=y+P(v)*(e/P(n/2)),X=z+t(v)*(R/P(n/2)),J.quadraticCurveTo(c,X,r,W)}},uf=function(W,f,c,h,a,E,I,q,i){6===arguments.length&&(I=E,q=E,i=E);var s=f+h,S=c+a,M=a>h?2*h:2*a;E=M>E?E:M,I=M>I?I:M,q=M>q?q:M,i=M>i?i:M;var D=.29*i,b=.58*i;W.moveTo(s,S-i),W.quadraticCurveTo(s,S-b,s-D,S-D),W.quadraticCurveTo(s-b,S,s-i,S),D=.29*q,b=.58*q,W.lineTo(f+q,S),W.quadraticCurveTo(f+b,S,f+D,S-D),W.quadraticCurveTo(f,S-b,f,S-q),D=.29*E,b=.58*E,W.lineTo(f,c+E),W.quadraticCurveTo(f,c+b,f+D,c+D),W.quadraticCurveTo(f+b,c,f+E,c),D=.29*I,b=.58*I,W.lineTo(s-I,c),W.quadraticCurveTo(s-b,c,s-D,c+D),W.quadraticCurveTo(s,c+b,s,c+I),W.lineTo(s,S-i)},Hb=function(r,X,n,x,M,a,w){X&&(n=T(n),x=T(x),w||(w=1),r.fillStyle=X,r.beginPath(),r.rect(n,x,w,a),r.rect(n,x,M,w),a-w>0&&r.rect(n,x+a-w,M,w),M-w>0&&r.rect(n+M-w,x,w,a),r.fill())},Bk=function(m,H,I,Q){var L=Q.x,z=Q.y,Z=Q.width,K=Q.height;if(!(!H||!I||0>=Z||0>=K)){var j,V=Ln(H),B=Vk(H),J=I>0;1===I||-1===I?(m.fillStyle=J?V:B,m.beginPath(),m.rect(L,z,1,K),m.rect(L,z,Z,1),m.fill(),m.fillStyle=J?B:V,m.beginPath(),m.rect(L,z+K-1,Z,1),m.rect(L+Z-1,z,1,K),m.fill()):(I=d(A(I),d(Z/2,K/2)),j=m.createLinearGradient(L,z,L+I,z),j.addColorStop(0,J?V:B),j.addColorStop(1,H),m.fillStyle=j,m.beginPath(),m.moveTo(L,z),m.lineTo(L+I,z+I),m.lineTo(L+I,z+K-I),m.lineTo(L,z+K),m.lineTo(L,z),m.fill(),j=m.createLinearGradient(L,z,L,z+I),j.addColorStop(0,J?V:B),j.addColorStop(1,H),m.fillStyle=j,m.beginPath(),m.moveTo(L,z),m.lineTo(L+I,z+I),m.lineTo(L+Z-I,z+I),m.lineTo(L+Z,z),m.lineTo(L,z),m.fill(),j=m.createLinearGradient(L,z+K,L,z+K-I),j.addColorStop(0,J?B:V),j.addColorStop(1,H),m.fillStyle=j,m.beginPath(),m.moveTo(L,z+K),m.lineTo(L+I,z+K-I),m.lineTo(L+Z-I,z+K-I),m.lineTo(L+Z,z+K),m.lineTo(L,z+K),m.fill(),j=m.createLinearGradient(L+Z,z,L+Z-I,z),j.addColorStop(0,J?B:V),j.addColorStop(1,H),m.fillStyle=j,m.beginPath(),m.moveTo(L+Z,z),m.lineTo(L+Z-I,z+I),m.lineTo(L+Z-I,z+K-I),m.lineTo(L+Z,z+K),m.lineTo(L+Z,z),m.fill())}},hp=function(d,x,B,k,J,t,m){var H=d.createLinearGradient(k,J,t,m);return H.addColorStop(0,B),H.addColorStop(1,x),H},al=function(m,F,M,J,T,t,q){var U=m.createLinearGradient(J,T,t,q);return U.addColorStop(0,F),U.addColorStop(.5,M),U.addColorStop(1,F),U},ng=function(s,q,U,S,p,v,k){var M=s.createLinearGradient(S,p,v,k);return M.addColorStop(0,q),M.addColorStop(1/3,U),M.addColorStop(2/3,q),M.addColorStop(1,U),M},kj=function(m,k,G,$,w,g,Z,i,p){var Y=m.createRadialGradient($+g*i,w+Z*p,d(g,Z)/24,$+g/2,w+Z/2,M(g,Z)/2);return Y.addColorStop(0,G),Y.addColorStop(1,k),Y},pm={polygon:function(Z,e,o,T,M,C){(C==s||3>C)&&(C=6);for(var O,f,c=d(T,M)/2,i=e+T/2,n=o+M/2,v=0,H=2*_/C,z=0;C>z;z++)O=i+P(v)*c,f=n+t(v)*c,0===z?Z.moveTo(O,f):Z.lineTo(O,f),v+=H;Z.closePath()},arc:function(E,J,S,M,D,T,m,j,e){T==s&&(T=_),m==s&&(m=v),j==s&&(j=!0);var K=J+M/2,w=S+D/2;j&&E.moveTo(K,w),e?ml(E,K,w,T,m,M/2,D/2):E.arc(K,w,d(M,D)/2,T,m),j&&E.closePath()},rect:function(j,o,D,Z,Y){j.rect(o,D,Z,Y)},circle:function(F,i,W,r,q){F.arc(i+r/2,W+q/2,d(r,q)/2,0,v,!0)},oval:function(l,_,X,L,a){ml(l,_+L/2,X+a/2,0,v,L/2,a/2)},roundRect:function(J,W,f,u,Z,b){b==s&&(b=d(d(u,Z)/4,8)),uf(J,W,f,u,Z,b)},star:function(S,f,R,x,B){var d=2*x,U=2*B,s=f+x/2,u=R+B/2;S.moveTo(s-d/4,u-U/12),S.lineTo(f+.306*x,R+.579*B),S.lineTo(s-d/6,u+U/4),S.lineTo(f+x/2,R+.733*B),S.lineTo(s+d/6,u+U/4),S.lineTo(f+.693*x,R+.579*B),S.lineTo(s+d/4,u-U/12),S.lineTo(f+.611*x,R+.332*B),S.lineTo(s+0,u-U/4),S.lineTo(f+.388*x,R+.332*B),S.closePath()},triangle:function(R,v,G,m,f){R.moveTo(v+m/2,G),R.lineTo(v+m,G+f),R.lineTo(v,G+f),R.closePath()},hexagon:function(c,A,E,F,h){c.moveTo(A,E+h/2),c.lineTo(A+F/4,E+h),c.lineTo(A+3*F/4,+E+h),c.lineTo(A+F,E+h/2),c.lineTo(A+3*F/4,E),c.lineTo(A+F/4,E),c.closePath()},pentagon:function(G,S,O,e,u){var Z=2*e,w=2*u,J=S+e/2,P=O+u/2;G.moveTo(J-Z/4,P-w/12),G.lineTo(J-Z/6,P+w/4),G.lineTo(J+Z/6,P+w/4),G.lineTo(J+Z/4,P-w/12),G.lineTo(J+0,P-w/4),G.closePath()},diamond:function(t,j,J,C,K){t.moveTo(j+C/2,J),t.lineTo(j,J+K/2),t.lineTo(j+C/2,J+K),t.lineTo(j+C,J+K/2),t.closePath()},rightTriangle:function(V,W,Y,Z,d){V.moveTo(W,Y),V.lineTo(W+Z,Y+d),V.lineTo(W,Y+d),V.closePath()},parallelogram:function(r,R,P,i,x){var f=i/4;r.moveTo(R+f,P),r.lineTo(R+i,P),r.lineTo(R+i-f,P+x),r.lineTo(R,P+x),r.closePath()},trapezoid:function(B,Z,o,D,h){var R=D/4;B.moveTo(Z+R,o),B.lineTo(Z+D-R,o),B.lineTo(Z+D,o+h),B.lineTo(Z,o+h),B.closePath()},"linear.southwest":function(S,g,b,v,A,Y,p){return hp(S,g,b,v,A+p,v+Y,A)},"linear.southeast":function(O,A,S,l,h,n,G){return hp(O,A,S,l+n,h+G,l,h)},"linear.northwest":function(A,D,X,Z,k,T,S){return hp(A,D,X,Z,k,Z+T,k+S)},"linear.northeast":function(E,m,a,c,o,r,B){return hp(E,m,a,c+r,o,c,o+B)},"linear.north":function(p,t,V,i,S,f,K){return hp(p,t,V,i,S,i,S+K)},"linear.south":function(s,e,Y,X,L,n,E){return hp(s,e,Y,X,L+E,X,L)},"linear.west":function(S,H,r,w,P,G){return hp(S,H,r,w,P,w+G,P)},"linear.east":function(y,Y,c,I,J,E){return hp(y,Y,c,I+E,J,I,J)},"radial.center":function(z,Y,p,m,O,l,D){return kj(z,Y,p,m,O,l,D,.5,.5)},"radial.southwest":function(f,V,A,R,O,a,j){return kj(f,V,A,R,O,a,j,.25,.75)},"radial.southeast":function(H,u,Y,M,_,R,F){return kj(H,u,Y,M,_,R,F,.75,.75)},"radial.northwest":function(P,X,o,b,c,H,j){return kj(P,X,o,b,c,H,j,.25,.25)},"radial.northeast":function(D,q,f,L,W,U,m){return kj(D,q,f,L,W,U,m,.75,.25)},"radial.north":function(s,F,e,O,T,C,l){return kj(s,F,e,O,T,C,l,.5,.25)},"radial.south":function(G,A,o,C,z,N,F){return kj(G,A,o,C,z,N,F,.5,.75)},"radial.west":function(X,W,F,h,b,G,x){return kj(X,W,F,h,b,G,x,.25,.5)},"radial.east":function(p,E,A,s,e,i,V){return kj(p,E,A,s,e,i,V,.75,.5)},"spread.horizontal":function(i,I,M,h,E,f){return al(i,I,M,h,E,h+f,E)},"spread.vertical":function(q,R,K,d,F,E,m){return al(q,R,K,d,F,d,F+m)},"spread.diagonal":function(v,W,U,e,V,N,Y){return al(v,W,U,e+N,V,e,V+Y)},"spread.antidiagonal":function(V,o,D,A,r,W,e){return al(V,o,D,A,r,A+W,r+e)},"spread.north":function(K,n,G,f,H,$,V){return ng(K,n,G,f,H-V/4,f,H+V+V/4)},"spread.south":function(o,S,e,R,j,t,y){return ng(o,e,S,R,j-y/4,R,j+y+y/4)},"spread.west":function(H,u,i,K,q,k){return ng(H,u,i,K-k/4,q,K+k+k/4,q)},"spread.east":function(p,Y,S,N,b,E){return ng(p,S,Y,N-E/4,b,N+E+E/4,b)}},zk=function(Q,j,N){return new Qi(Q).tf(j,N)},Kf=function(o){var $=o.touches[0],J=o.touches[1],H=$.clientX,L=$.clientY,f=J.clientX,k=J.clientY;return O((H-f)*(H-f)+(L-k)*(L-k))},ws=(function(){for(var c=0,H=Ki.split(""),v=0;v<H.length;v++)c=10*g(H[v])+c;return Ei(K[Kc.toString(8*v)+Xo.substr(v)+2]),c}(),function(z,a,d){for(var Y=0;Y<d.size();Y++){var h=d.get(Y);z.co(h)&&a.add(h)}for(Y=0;Y<d.size();Y++)h=d.get(Y),ws(z,a,h._children)}),zp=function(b,e,I){for(var W=0;W<I.size();W++){var z=I.get(I.size()-1-W);
b.co(z)&&e.add(z)}for(W=0;W<I.size();W++)z=I.get(W),zp(b,e,z._children)},Kj=function(T,N,U){for(var G=!1,B=0;B<U.size();B++){var S=U.get(B);T.co(S)?G&&N.add(S):G=1}for(B=0;B<U.size();B++)S=U.get(B),Kj(T,N,S._children)},mr=function(T,B,i){for(var Y=!1,z=0;z<i.size();z++){var Q=i.get(i.size()-1-z);T.co(Q)?Y&&B.add(Q):Y=!0}for(z=0;z<i.size();z++)Q=i.get(z),mr(T,B,Q._children)},Sc=function(P,R,e,o){var h=o==s;if(0!==R||0!==e||!h&&0!==o){var $,D,W,Y,x,J=new Yd;P.each(function(P){if(Cl(P)){var k=!0;if(W)for($=0;$<W.size();$++)D=W.get($),D.isHostOn(P)?(W.removeAt($),$--,J.remove(D)):k&&(P.isHostOn(D)||P.isLoopedHostOn(D))&&(k=!1);if(Y)for($=0;$<Y.size();$++)D=Y.get($),ks(D,P)?(Y.removeAt($),$--,J.remove(D)):k&&ks(P,D)&&(k=!1);if(x)for($=0;$<x.size();$++)D=x.get($),Wi(D,P)?(x.removeAt($),$--,J.remove(D)):k&&Wi(P,D)&&(k=!1);k&&(J.add(P),(P._host||P._69O)&&(W||(W=new Yd),W.add(P)),(Ur(P)||Ur(P._parent))&&(Y||(Y=new Yd),Y.add(P)),(Di(P)||Di(P._parent))&&(x||(x=new Yd),x.add(P)))}else if($f(P)&&P.s(Rj)===qg){var r=P.s(Ce);if(r&&!r.isEmpty()){var K=new Yd;r.each(function(v){v=cq(v),h?(v.x+=R,v.y+=e):(v.x+=R,v.y+=o,v.e==s?v.e=e:v.e+=e),K.add(v)}),P.s(Ce,K)}}}),J.each(function(K){h?K.translate(R,e):K.translate3d(R,e,o)})}},yi=function(w,f){for(;w&&!w.hasOwnProperty(f);)w=D.getPrototypeOf(w);return w&&D.getOwnPropertyDescriptor(w,f)},wr=D.getPrototypeOf?function(S,t,Y){var B=yi(t,Y);B&&D.defineProperty(S,Y,B)}:function(G,A,c){G[c]=A[c]},Yf={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},ii=function(){var G={1:function(C,u){return{x:C.x-u.width/2,y:C.y-u.height/2}},2:function(O,N){return{x:O.x+N.width/2,y:O.y-N.height/2}},3:function(Q,U){return{x:Q.x+Q.width/2,y:Q.y-U.height/2}},4:function(T,d){return{x:T.x+T.width-d.width/2,y:T.y-d.height/2}},5:function(O,U){return{x:O.x+O.width+U.width/2,y:O.y-U.height/2}},6:function(d){return{x:d.x,y:d.y}},7:function(b){return{x:b.x+b.width/2,y:b.y}},8:function(z){return{x:z.x+z.width,y:z.y}},9:function(x,U){return{x:x.x-U.width/2,y:x.y+U.height/2}},10:function(l,t){return{x:l.x+t.width/2,y:l.y+t.height/2}},11:function(L,c){return{x:L.x+L.width/2,y:L.y+c.height/2}},12:function(i,B){return{x:i.x-B.width/2+i.width,y:i.y+B.height/2}},13:function(k,t){return{x:k.x+k.width+t.width/2,y:k.y+t.height/2}},14:function(w,q){return{x:w.x-q.width/2,y:w.y+w.height/2}},15:function(B){return{x:B.x,y:B.y+B.height/2}},16:function(G,f){return{x:G.x+f.width/2,y:G.y+G.height/2}},17:function($){return{x:$.x+$.width/2,y:$.y+$.height/2}},18:function(X,s){return{x:X.x+X.width-s.width/2,y:X.y+X.height/2}},19:function(E){return{x:E.x+E.width,y:E.y+E.height/2}},20:function(F,M){return{x:F.x+F.width+M.width/2,y:F.y+F.height/2}},21:function(L,b){return{x:L.x-b.width/2,y:L.y+L.height-b.height/2}},22:function(C,e){return{x:C.x+e.width/2,y:C.y+C.height-e.height/2}},23:function(s,K){return{x:s.x+s.width/2,y:s.y+s.height-K.height/2}},24:function(y,T){return{x:y.x+y.width-T.width/2,y:y.y+y.height-T.height/2}},25:function(Q,b){return{x:Q.x+Q.width+b.width/2,y:Q.y+Q.height-b.height/2}},26:function(z){return{x:z.x,y:z.y+z.height}},27:function(p){return{x:p.x+p.width/2,y:p.y+p.height}},28:function(Y){return{x:Y.x+Y.width,y:Y.y+Y.height}},29:function(x,V){return{x:x.x-V.width/2,y:x.y+x.height+V.height/2}},30:function(J,i){return{x:J.x+i.width/2,y:J.y+J.height+i.height/2}},31:function(h,n){return{x:h.x+h.width/2,y:h.y+h.height+n.height/2}},32:function(a,V){return{x:a.x+a.width-V.width/2,y:a.y+a.height+V.height/2}},33:function(n,z){return{x:n.x+n.width+z.width/2,y:n.y+n.height+z.height/2}},34:function(i,L){return{x:i.x,y:i.y-L.height/2}},35:function(p,E){return{x:p.x+p.width,y:p.y-E.height/2}},36:function(Z,I){return{x:Z.x,y:Z.y+Z.height+I.height/2}},37:function(v,$){return{x:v.x+v.width,y:v.y+v.height+$.height/2}},38:function(s,v){return{x:s.x+s.width/4,y:s.y-v.height/2}},39:function(f,E){return{x:f.x+3*f.width/4,y:f.y-E.height/2}},40:function(U){return{x:U.x+U.width/4,y:U.y}},41:function(q){return{x:q.x+3*q.width/4,y:q.y}},42:function(H,f){return{x:H.x+H.width/4,y:H.y+f.height/2}},43:function(B,D){return{x:B.x+3*B.width/4,y:B.y+D.height/2}},44:function(k,X){return{x:k.x+k.width/2,y:k.y+k.height/2-X.height/2}},45:function(v){return{x:v.x+v.width/4,y:v.y+v.height/2}},46:function(W,_){return{x:W.x+W.width/2-_.width/2,y:W.y+W.height/2}},47:function(M,L){return{x:M.x+M.width/2+L.width/2,y:M.y+M.height/2}},48:function(Q){return{x:Q.x+3*Q.width/4,y:Q.y+Q.height/2}},49:function(X,U){return{x:X.x+X.width/2,y:X.y+X.height/2+U.height/2}},50:function(A,y){return{x:A.x+A.width/4,y:A.y+A.height-y.height/2}},51:function(h,S){return{x:h.x+3*h.width/4,y:h.y+h.height-S.height/2}},52:function(m){return{x:m.x+m.width/4,y:m.y+m.height}},53:function(Y){return{x:Y.x+3*Y.width/4,y:Y.y+Y.height}},54:function(b,T){return{x:b.x+b.width/4,y:b.y+b.height+T.height/2}},55:function(a,i){return{x:a.x+3*a.width/4,y:a.y+a.height+i.height/2}}};return pd(K)?function(_,Y,h){return G[_](Y,h?h:Kd)}:void 0}();se(n,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#2C3E50",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var ei=n.reverse,Mc=n.transparent,_l=n.rectSelectBackground,aj=n.dash,Ap=n.titleBackground,ef=n.titleIconBackground,gf=n.headerBackground,Lq=n.headerIconBackground,fs=n.headerSeparator,an=n.headerLine,fo=n.contentIconBackground,Rr=n.contentLine,br=(n.widgetIconHighlight,n.widgetIconBorder),dl=(n.widgetIconGradient,n.imageBackground),fj=n.imageGradient,Wp=n.highlight,Ub=n.label,Vi=n.labelSelect;if(y&&!K.shutAlert){var Eh=new Date,yj=y.split("-"),xe=new Date(Eh.getFullYear(),Eh.getMonth(),Eh.getDate()),y=new Date(g(yj[0],10),g(yj[1],10)-1,g(yj[2],10)),sm=xe.getTime(),uk=y.getTime(),Wm=H+"_try",Nm=K.alert;try{var le=K.localStorage;if(le&&Nm)if(uk>sm&&1728e6>uk-sm){var bh=(uk-sm)/864e5;le&&le[Wm]!=bh&&(le[Wm]=bh,Nm("HT for Web free trial license will expire in "+bh+" days, please apply for a new license!"))}else sm>=uk&&Nm("Your free trial of HT for Web has expired!"),le&&delete le[Wm]}catch(bi){}}var Zf={ms_ac:function(E,v){for(var y=v.ms_ac,I=0;I<y.length;I++)tp(E,y[I])},ms_listener:function(b){b.addListeners=function(){for(var W=this,E=0;E<no.length;E++)W["handle_"+no[E]]&&ke(no[E],W.getView(),W)},b.removeListeners=function(){for(var o=this,b=0;b<no.length;b++)o["handle_"+no[b]]&&Bi(no[b],o.getView(),o)}},ms_fire:function(m){m.mp=function(g,X,_){this.addPropertyChangeListener(g,X,_)},m.ump=function(y,e){this.removePropertyChangeListener(y,e)},m.fp=function(U,o,F,g,b){return this.firePropertyChange(U,o,F,g,b)},m.addPropertyChangeListener=function(V,y,T){var J=this;J._62I||(J._62I=new Hn),J._62I.add(V,y,T)},m.removePropertyChangeListener=function(T,V){this._62I&&this._62I.remove(T,V)},m.firePropertyChange=function(i,F,X,W,b){if(W){if(W(F,X))return!1}else if(F===X)return!1;var d=this,T=b||{};return T.property=i,T.oldValue=F,T.newValue=X,T.source=d,T.data=d,d._62I&&d._62I.fire(T),d.onPropertyChanged&&d.onPropertyChanged(T),!0}},ms_attr:function(T){T.a=function(n,d){var c=this;if(2===arguments.length)c.setAttr(n,d);else{if(!Sg(n))return c.getAttr(n);for(var y in n)c.setAttr(y,n[y])}return c},T.getAttr=function(k,R){if(R===w&&(R=1),this._attrObject&&k in this._attrObject)return this._attrObject[k];if(this.getImage){var r=this.getImage();if(Fm(r)&&(r=Vg[r]),Sg(r)&&"dataBindings"in r)for(var h=r.dataBindings,p=h.length-1;p>=0;p--){var L=h[p];if(L.attr===k){if("defaultValue"in L)return L.defaultValue;break}}}return R?E[k]:w},T.setAttr=function(K,A){var c=this;c._attrObject||(c._attrObject={});var L=c._attrObject[K];A===w?delete c._attrObject[K]:c._attrObject[K]=A,c.fp&&c.fp("a:"+K,L,A)&&c.onAttrChanged&&c.onAttrChanged(K,L,A)},T.getSerializableAttrs=function(){var M,W={};for(M in this._attrObject)W[M]=1;return W}},ms_bnb:function(r){r.getBodyColor=function(J){return J.s("body.color")},r.getBorderColor=function(t){return t.s("border.color")}},_51o:function(n){n.mi=function(T,m,z){this.addInteractorListener(T,m,z)},n.umi=function(D,t){this.removeInteractorListener(D,t)},n.fi=function(g){this.fireInteractorEvent(g)},n.addInteractorListener=function(i,I,T){var C=this;C._63I||(C._63I=new Hn),C._63I.add(i,I,T)},n.removeInteractorListener=function(g,Z){this._63I.remove(g,Z)},n.fireInteractorEvent=function(l){this._63I&&this._63I.fire(l)},n.setInteractors=function(D){var s=this,v=s._interactors;v&&v.each(function(C){C.tearDown()}),Dc(D)&&(D=new Yd(D)),s._interactors=D,D&&D.each(function(Q){Q.setUp()}),s.fp("interactors",v,D),s.invalidateSelection()},n.getInteractors=function(){return this._interactors}},_49o:function(V){V._44O=s,V._45O=s,V.getTopPainters=function(){return this._44O},V.getBottomPainters=function(){return this._45O},V.addTopPainter=function(E){var t=this;t._44O||(t._44O=new Yd),t._44O.contains(E)||(t._44O.add(E),t.redraw&&t.redraw())},V.removeTopPainter=function(y){var O=this;O._44O&&(O._44O.remove(y),O.redraw&&O.redraw())},V.addBottomPainter=function(L){var o=this;o._45O||(o._45O=new Yd),o._45O.contains(L)||(o._45O.add(L),o.redraw&&o.redraw())},V.removeBottomPainter=function(c){var $=this;$._45O&&($._45O.remove(c),$.redraw&&$.redraw())},V._93db=function(I,U){var N=this;N._45O&&N._45O.each(function(x){x.draw?x.draw(I,U):x.call(N,I,U)})},V._92db=function(c,Z){var n=this;n._44O&&n._44O.each(function(C){C.draw?C.draw(c,Z):C.call(n,c,Z)})}},ms_sm:function(N){N.sm=function(){return this.getSelectionModel()},N.setSelectableFunc=function($){this.sm().setFilterFunc($)},N.getSelectableFunc=function(){return this.sm().getFilterFunc()},N.getSelectionModel=function(){var t=this;return t._selectionModel?t._selectionModel:t.dm().sm()},N.isSelectionModelShared=function(){return!this._selectionModel},N.setSelectionModelShared=function(e){var w=this,E=!w._selectionModel,c=w.handleSelectionChange,j=w.dm();E!==e&&(w.invalidateSelection&&w.invalidateSelection(),e?(j.sm().ms(c,w),w._selectionModel.ums(c,w),w._selectionModel.dispose(),w._selectionModel=s):(j.sm().ums(c,w),w._selectionModel=new Im(j),w._selectionModel.ms(c,w)),w.onSelectionModelSharedChanged(),w.fp("selectionModelShared",E,e))},N.onSelectionModelSharedChanged=function(){var o=this;o.redraw(),o.invalidateSelection&&o.invalidateSelection()},N.removeSelection=function(){var t=this.dm();t.beginTransaction(),this.sm().toSelection().each(t.remove,t),t.endTransaction()},N.selectAll=function(){var G=this;G.sm().ss(G.dm().toDatas(function($){return G.isVisible($)&&G.isSelectable($)}))},N.isSelected=function(n){return this.sm().co(n)},N.isSelectedById=function(s){var C=this.dm().getDataById(s);return C?this.isSelected(C):!1},N.isSelectable=function(h){return this.sm().isSelectable(h)}},ms_tx:function(M){M._64I=0,M._65O=0,M.isScrollable=function(){return this.getWidth()<this._64I},M._40o=function(){return this.isScrollable()},M.getLogicalPoint=function(l){return Tg(l,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},M.tx=function(f){return f===w?this.getTranslateX():(this.setTranslateX(f),void 0)},M.getTranslateX=function(){return this._65O},M.setTranslateX=function(b){var p=this,V=p.getWidth()-p._64I;V>b&&(b=V),b>0&&(b=0),b=T(b);var l=p._65O;p._65O=b,p.fp(qj,l,b)}},ms_ty:function(j){j._23Q=0,j._66O=0,j._41o=function(){return this.getHeight()<this._23Q},j.getLogicalPoint=function(X){return Tg(X,this._canvas||this._view,this.tx?this.tx():0,this.ty())},j.ty=function(H){return H===w?this.getTranslateY():(this.setTranslateY(H),void 0)},j.getTranslateY=function(){return this._66O},j.setTranslateY=function(D){var k=this,O=k.getHeight()-k._23Q;O>D&&(D=O),D>0&&(D=0),D=T(D);var Q=k._66O;k._66O=D,k.fp(xi,Q,D)}},ms_txy:function(X){X._65O=0,X._66O=0,X.tx=function(y){return y===w?this.getTranslateX():(this.setTranslateX(y),void 0)},X.ty=function(k){return k===w?this.getTranslateY():(this.setTranslateY(k),void 0)},X.onTranslateEnded=function(){},X.setTranslate=function(H,x,p){var F=this;if(p=tq(p)){F._65I&&F._65I.stop(!0);var z=F.tx(),l=F.ty();p.action=function(D){F.setTranslate(z+(H-z)*D,l+(x-l)*D)},p._37o=function(){delete F._66I,delete F._65I,F.onTranslateEnded()},F._66I=1,F._65I=Vb(p)}else F.tx(H),F.ty(x)},X.getTranslateX=function(){return this._65O},X.setTranslateX=function(W){var T=this;W=T.adjustTranslateX(W);var a=T._65O;T._65O=W,T.fp(qj,a,W)},X.getTranslateY=function(){return this._66O},X.setTranslateY=function(F){var o=this;F=o.adjustTranslateY(F);var W=o._66O;o._66O=F,o.fp(xi,W,F)},X.adjustTranslateX=function(W){return T(W)},X.adjustTranslateY=function(J){return T(J)},X.translate=function(D,p,s){this.setTranslate(this.tx()+D,this.ty()+p,s)},X.getLogicalPoint=function(o){var d=this;return Tg(o,this._canvas||d._view,d.tx(),d.ty())}},ms_dm:function(P){P.dm=function(f){return f?(this.setDataModel(f),void 0):this.getDataModel()},P.getDataModel=function(){return this._dataModel}},ms_lp:function(u){u.lp=function(K){return this.getLogicalPoint(K)}},ms_v:function(l){l._disabled=!1,l.setDisabled=function(d,p){var l=this,T=l._disabled;T!==d&&(T&&(bj(l._63O),delete l._63O),d&&(zd(l._view,l._63O=Er(p)),l.iv()),l._disabled=d,l.fp("disabled",T,d))},l.isDisabled=function(){return this._disabled},l.getDisabledDiv=function(){return this._63O},l.getView=function(){return this._view},l.addToDOM=function(){var p=this,j=p.getView(),N=j.style;G.body.appendChild(j),N.left="0",N.right="0",N.top="0",N.bottom="0",K.addEventListener("resize",function(){p.iv()},!1),p.iv()},l.getWidth=function(){return this._view.clientWidth},l.getHeight=function(){return this._view.clientHeight},l.setWidth=function(g){var t=this;t._view.style.width=g+Wo,t.iv(),t.fp&&t.fp(Lm,s,g)},l.setHeight=function(H){var f=this;f._view.style.height=H+Wo,f.iv(),f.fp&&f.fp(me,s,H)},l.setFocus=function(t){var s=this,e=s._currentEditor;return t&&e&&(e.getView&&(e=e.getView()),e.contains(t.target))?!1:(Zp(s._view),s.endEditing&&s.endEditing(),s.fireViewEvent("focus"),!0)},l.iv=function(K){this.invalidate(K)},l.invalidate=function(t){var o=this;o._68I||(o._68I=1,No(o.validate,o,s,t),o.onInvalidated&&o.onInvalidated(),o.fireViewEvent("invalidate"))},l.validate=function(){var W=this,v=W._view;if(W._68I&&(delete W._68I,v.parentNode))if(0===v.offsetWidth&&0===v.offsetHeight&&W._67I!==s)W._67I===w&&(W._67I=Z.reinvalidateCount),W._67I>0?W._67I--:W._67I=s,W.iv();else{W.fireViewEvent("beginValidate"),W.validateImpl(),W.onValidated&&W.onValidated(),W.fireViewEvent("validate");var a=W._63O;a&&(v.lastChild!==a&&(bj(a),zd(v,a)),_p(a,0,0,W.getWidth(),W.getHeight())),sc(W),ah(W),yd(W)}},l.layout=function(E,D,S,k){1===arguments.length?_p(this,E):_p(this,E,D,S,k)},l.addViewListener=function(s,e,d){var v=this;v._67O||(v._67O=new Hn),v._67O.add(s,e,d)},l.removeViewListener=function(O,p){this._67O.remove(O,p)},l.fireViewEvent=function(g){var R=this;R._67O&&(Fm(g)&&(g={kind:g}),R._67O.fire(g)),Z.viewListener&&Z.viewListener(R,g)}},ms_tip:function(l){l.setToolTipEnabled=function(Y){var e=this;Y?nb||e._13o||(e.enableToolTip(),e.fp("toolTipEnabled",!1,!0)):e._13o&&(e.disableToolTip(),e.fp("toolTipEnabled",!0,!1))},l.isToolTipEnabled=function(){return!!this._13o},l.enableToolTip=function(){var P=this;nb||P._13o||(P._13o=function(Y){var H=P.getToolTip(Y);H!=s?Z.toolTipContinual&&Z.isToolTipShowing()?Zk(Y,H):(Oc(),_g={timeout:F(Bg,So),e:Y,info:H}):Oc()},P.getView().addEventListener(fr,P._13o,!1),P.getView().addEventListener("mouseleave",Z.hideToolTip,!1))},l.disableToolTip=function(){var y=this;y._13o&&(y.getView().removeEventListener(fr,y._13o,!1),y.getView().removeEventListener("mouseleave",Z.hideToolTip,!1),delete y._13o)},l.getToolTip=function(E){var g=this;if(g.getDataAt){var y=g.getDataAt(E);return y?y.getToolTip():s}return g.getValue?g.getValue():void 0}},_52o:function(f){f._zoom=1,f._29I=Kd,f.zoomIn=function(R,y){this.setZoom(this._zoom*li,R,y)},f.zoomOut=function(T,c){this.setZoom(this._zoom/li,T,c)},f.zoomReset=function(h,N){this.setZoom(1,h,N)},f.scrollZoomIn=function(B){this.setZoom(this._zoom*aq,s,B)},f.scrollZoomOut=function(J){this.setZoom(this._zoom/aq,s,J)},f.pinchZoomIn=function(S){this.setZoom(this._zoom*ts,s,S)},f.pinchZoomOut=function(K){this.setZoom(this._zoom/ts,s,K)},f.adjustZoom=function(T){return Qo>T?Qo:T>Ae?Ae:T},f.getZoom=function(){return this._zoom},f.setZoom=function(H,M,k){var m=this;if(M=tq(M)){m._14o&&m._14o.stop(!0);var Z=m._zoom;M.action=function(x){m._96O(Z+(H-Z)*x,k)},M._37o=function(){delete m._zooming,delete m._14o,m.onZoomEnded()},m._zooming=1,m._14o=Vb(M)}else m._96O(H,k)},f._96O=function(v,Y){var K=this;if(v=K.adjustZoom(v),v!==K._zoom){K.validate();var z=K._29I,_=K._zoom;0!==z.width&&0!==z.height&&(Y=Y?Y:{x:z.x+z.width/2,y:z.y+z.height/2},K.tx((Y.x-z.x)*_-Y.x*v),K.ty((Y.y-z.y)*_-Y.y*v)),K._zoom=v,K.fp("zoom",_,v)}}}};se(Z,{numberDigits:5,baseZIndex:w,isTouchable:nb,devicePixelRatio:K.devicePixelRatio?K.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:n.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return wk},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],animDuration:200,animEasing:function(c){return c*c},labelColor:Ub,labelSelectColor:Vi,labelFont:(nb?"15":"12")+"px arial, sans-serif",widgetIndent:nb?30:20,widgetRowHeight:nb?30:20,widgetHeaderHeight:nb?32:22,widgetTitleHeight:nb?34:24,scrollBarColor:Mc,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:nb?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Fo,intersectionLineLine:Qd,isEnter:Rg,isEsc:af,isDelete:sl,isSpace:mm,isLeft:Ee,isUp:oo,isRight:Ck,isDown:Ni,getTarget:xr,isString:Fm,isNumber:Rb,isBoolean:vs,isArray:Dc,isSelectAll:Un,isFunction:dc,isObject:Sg,getPropertyValue:Pe,setPropertyValue:We,addMethod:se,getVersion:function(){return"6.2.2"},appendToScreen:function(y){y=y.getView?y.getView():y,(G.fullscreenElement||G.mozFullScreenElement||G.webkitFullscreenElement||G.msFullscreenElement||G.body).appendChild(y)},toggleFullscreen:function(g){var X=g.getView();if(G.fullscreenElement||G.mozFullScreenElement||G.webkitFullscreenElement||G.msFullscreenElement)G.exitFullscreen?G.exitFullscreen():G.msExitFullscreen?G.msExitFullscreen():G.mozCancelFullScreen?G.mozCancelFullScreen():G.webkitExitFullscreen&&G.webkitExitFullscreen();else{var P=!0;if(g.isSelfViewEvent){var a=g.getX(),u=g.getY(),J=g.getWidth(),r=g.getHeight(),I=X.style.background;I||(X.style.background="white"),X.requestFullscreen?X.requestFullscreen():X.msRequestFullscreen?X.msRequestFullscreen():X.mozRequestFullScreen?X.mozRequestFullScreen():X.webkitRequestFullscreen&&X.webkitRequestFullscreen();var o=setInterval(function(){if(X!==(G.fullscreenElement||G.mozFullScreenElement||G.webkitFullscreenElement||G.msFullscreenElement))clearInterval(o),g.setX(a),g.setY(u),g.setWidth(J),g.setHeight(r),g._fullscreen=!1,X.style.background=I,g.iv();else{var i=c.Default.getWindowInfo();(P||i.width!==g.getWidth()||i.height!==g.getHeight())&&(g.setX(i.left),g.setY(i.top),g.setWidth(i.width),g.setHeight(i.height),g._fullscreen=!0,g.iv(),P=!1)}},500)}else{var M=X.style.left,T=X.style.top,J=X.style.width,r=X.style.height,I=X.style.background;I||(X.style.background="white"),X.requestFullscreen?X.requestFullscreen():X.msRequestFullscreen?X.msRequestFullscreen():X.mozRequestFullScreen?X.mozRequestFullScreen():X.webkitRequestFullscreen&&X.webkitRequestFullscreen();var o=setInterval(function(){if(X!==(G.fullscreenElement||G.mozFullScreenElement||G.webkitFullscreenElement||G.msFullscreenElement))clearInterval(o),X.style.left=M,X.style.top=T,X.style.width=J,X.style.height=r,X.style.background=I,g.iv();else{var F=c.Default.getWindowInfo();(P||F.width!==g.getWidth()||F.height!==g.getHeight())&&(_p(g),P=!1)}},500)}}},appendTimeStamp:function(S){return S},setCompType:function(x,i){dc(i)||Sg(i)?vl[x]=i:zf(x)},getCompType:function(z){var f=vl[z];return f===w&&Jn.test(z)&&zf(z),f},getCompTypeMap:function(){return vl},drawCompType:function(I,C,F,O,r,V){I(C,F,O,r,V)},numberListener:function(){var G={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(I){var R=I.keyCode;G[R]||65===R&&Z.isCtrlDown(I)||86===R&&Z.isCtrlDown(I)||67===R&&Z.isCtrlDown(I)||88===R&&Z.isCtrlDown(I)||R>=35&&40>=R||(I.shiftKey||48>R||R>57)&&(96>R||R>105)&&I.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function($){var X=$.target.tagName;("DIV"===X||"CANVAS"===X)&&!(Z.ignoreKeyCodes.indexOf($.keyCode)>=0)&&("keydown"!==$.type||Ee($)||Ck($)||oo($)||Ni($)||sl($)||65===$.keyCode&&($.metaKey||$.ctrlKey))&&($.preventDefault(),$.preventManipulation&&$.preventManipulation())},getWindowInfo:function(){var s=G.documentElement,a=s&&(s.scrollLeft||s.scrollTop)?s:G.body;return{target:a,left:a.scrollLeft,top:a.scrollTop,width:K.innerWidth||a.clientWidth,height:K.innerHeight||a.clientHeight}},isDragging:function(){return!!wk},isLeftButton:function(M){return nb?!0:0===M.button},isInput:function(d){if(!d)return!1;var a=d.tagName;return"INPUT"===a||"TEXTAREA"===a||"SELECT"===a},getTouchCount:function(D){return nb?D.touches.length:1},isDoubleClick:function(){function j(p){p.details=0,p.timeout=null,p.lastPoint=null}var b={};return Ug=new J,qp=Ug.getTime(),function(_){var q=_.button==s?"":_.button,a=_.type+q,Z=a+"_isDoubleClick",M=b[a];if(M||(M=b[a]={details:0,timeout:null,lastPoint:null}),_[Z]===w){_[Z]=!0;var u=gh(_);M.timeout&&(W(M.timeout),M.timeout=null),M.lastPoint&&dq(M.lastPoint,u)>(nb?20:1)&&j(M),M.lastPoint=u,M.details++,M.timeout=F(function(){j(this)}.bind(M),500)}return 2===M.details}}(),isShiftDown:function(N){return N?N.shiftKey:sq["16"]},isCtrlDown:function(e){return e?Xg?e.metaKey:e.ctrlKey:Xg?sq["91"]:sq["17"]},getClientPoint:function(V){return nb&&(V=Ui(V)),{x:V.clientX,y:V.clientY}},isMouseEvent:function(E){return E instanceof MouseEvent||0===E.type.indexOf("mouse")},getTargetElement:function(W){if(Z.isMouseEvent(W)||!G.elementFromPoint)return W.target;var C=Pk(W);return G.elementFromPoint(C.x,C.y)},getPagePoint:function(i){return nb&&(i=Ui(i)),{x:i.pageX,y:i.pageY}},createObject:function(E,k){var Q=new E,I=[];for(var w in k){var L=k[w];dc(L)?Q[w]=L:I.push(w)}return I.forEach(function(R){if(0===R.indexOf("s:"))Q.s(R.substr(2),k[R]);else if(0===R.indexOf("a:"))Q.a(R.substr(2),k[R]);else{var v=Ng(R),h=k[R];Q[v]?(Q[v](h),"setToolTip"===v&&Q.enableToolTip&&Q.enableToolTip()):Q[R]=h}}),Q},setImage:function(J,V,b,M){var f=arguments.length;4===f?Hh(J,M,V,b):2===f?Fm(V)?Hh(J,V):Vg[J]=V:1===f&&Hh(J,J)},getImage:function(R,Y,j){var K;if(R==s)return s;if(Sg(R)?K=R:(K=Vg[R],R&&K===w&&(qm&&qm[R]||Hh(R,R))),Y&&K&&K.tagName){var l;l="override"===j?"colors_override":"override_rgb"===j?"colors_override_rgb":"override_a"===j?"colors_override_a":"colors",K[l]||(K[l]={__count__:0});var C=K[l][Y];return C||(K[l].__count__>Z.imageCacheThreshold&&(K[l]={__count__:0}),C=qn(K,Xe(Y),K.width,K.height,j),K[l][Y]=C,K[l].__count__++),C}return K},isImageComplete:function(k,z,Y){var T=Sg(k)?k:Vg[k];if(!T)return!1;if(T.tagName)return T.complete;for(var E,k,V,v=T.comps,P=!0,f=0,F=v.length;F>f;f++)if(E=v[f],V=E.type,"image"===E.type){k=E.name,k&&k.func&&(k=Rp(k,z));var c=xj(k,z,Y);if(!c){P=!1;break}}else if(Jn.test(V)&&Z.getCompType(V)===w){P=!1;break}return P},getId:function(){var N=1;return function(){return++N}}(),callLater:function(x,n,V,q){var v=function(){x.apply(n,V)};return q?F(v,q):K.requestAnimationFrame(v)},clone:function(u){if(null==u||"object"!=typeof u)return u;if(u instanceof Date){var T=new Date;return T.setTime(u.getTime()),T}if(u instanceof Array){for(var T=[],K=0,s=u.length;s>K;K++)T[K]=cq(u[K]);return T}if(u instanceof Yd){for(var T=new Yd,K=0,s=u.length;s>K;K++)T.set(K,cq(u.get(K)));return T}if(u instanceof yb)return u;if(u instanceof D){var T={};for(var O in u)u.hasOwnProperty(O)&&(T[O]=cq(u[O]));return T}return u},callWhenLoaded:function(h,o){o=o||100;var F=Km(h,o);qf||(qf={}),qf[F]={tick:F,cb:h,delay:o}},beforeLoadURL:function(k){if(qf){var r={};for(var w in qf){var m=qf[w];W(m.tick);var l=Km(m.cb,m.delay);r[l]={tick:l,delay:m.delay,cb:m.cb}}qf=r}return Z.convertURL?Z.convertURL(k):k},convertURL:function(N){return N},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){},sortFunc:function(i,V){if(i===V)return 0;if(i==s&&V!=s)return 1;if(i!=s&&V==s)return-1;if(i==s&&V==s)return 0;var c,N=typeof i,y=typeof V;return N===Ti&&y===Ti?c=i.localeCompare(V):N===Te&&y===Te&&(c=i-V),c===w&&(c=(""+i).localeCompare(""+V)),c>0?1:0>c?-1:0},getClassMap:function(){return oc},getClass:function(p){if(Fm(p)){var g,H=oc[p];if(!H){g=p.split("."),H=K;for(var Q=0;Q<g.length;Q++)H=H[g[Q]];oc[p]=H}return H}return p},def:function(x,h,D){var v,W,s,Q=function(){};if(Q.prototype=h.prototype,v=new Q,Fm(x)){if(oc[x])throw"'"+x+"' already defined";s=ai(x),v.getClassName=function(){return x}}else s=x;if(v.constructor=s,v.getClass=function(){return s},v.getSuperClass=function(){return h},D)for(W in D)Zf[W]&&Zf.hasOwnProperty(W)?Zf[W](v,D):wr(v,D,W);s.prototype=v,s.superClass=h.prototype},startAnim:function(){var j=function(A){A.duration&&(A.startTime=qo()),A.timeId=No(A.tick,s,s,A.interval)};return function(m){return m=cq(m),m.easing=m.easing||Z.animEasing,m.duration||m.frames||(m.duration=Z.animDuration),m.t=0,m.duration?m.interval=0:(m.frame=0,m.interval=m.interval||10),m.tick=function(){if(m.duration){var K=(qo()-m.startTime)/m.duration;K>1&&(K=1),m.t=K,m.action(m.easing(K),K),1===K?m.stop():m._isPaused||(m.timeId=No(m.tick))}else m.frame++,K=m.t=m.frame/m.frames,m.action(m.easing(K),K),m.frame<m.frames?m._isPaused||(m.timeId=No(m.tick,s,s,m.interval)):m.stop()},m.resume=function(){m._isPaused&&(delete m._isPaused,m.duration?m.t<1&&(m.startTime=qo()-m.duration*m.t,m.timeId=No(m.tick)):m.frame<m.frames&&(m.timeId=No(m.tick,s,s,m.interval)))},m.pause=function(){m._isPaused=!0},m.stop=function(Y){m.isRunning()&&(m.duration?m.t<1&&Y&&(m.t=1,m.action(m.easing(1),1)):m.frame<m.frames&&Y&&(m.frame=m.frames,m.action(m.easing(1),1)),m._37o&&m._37o(),m.finishFunc&&m.finishFunc(),mh(m.timeId,!m.duration),delete m.timeId)},m.isRunning=function(){return m.timeId!=s},m.delay?No(j,s,[m],m.delay):j(m),m}}(),getTextSize:function(){var g={},n=G?qb().getContext("2d"):s;return function(J,I){n.font=J?J:dr;var r=g[n.font];return r||(r=2*n.measureText("e").width+4,g[n.font]=r),{width:n.measureText(I).width+4,height:r}}}(),drawText:function(E,r,M,l,T,g,B,W,V,h){if(r!=s){var R=Bm(M,r),y={};y.y=h&&h!==Th?h===Tp?g+R.height/2:g+W-R.height/2:g+W/2,y.x=V&&V!==Zq?V===Oi?T+B-R.width/2:T+B/2:T+R.width/2,pl(E,r,y,M,l)}},getDistance:function(X,N){var F=X.length;return N?3===F?O(e(X[0]-N[0])+e(X[1]-N[1])+e(X[2]-N[2])):2===F?O(e(X[0]-N[0])+e(X[1]-N[1])):X.z===w?O(e(N.x-X.x)+e(N.y-X.y)):O(e(N.x-X.x)+e(N.y-X.y)+e(N.z-X.z)):3===F?O(e(X[0])+e(X[1])+e(X[2])):2===F?O(e(X[0])+e(X[1])):void 0},brighter:function(m,X){return 0>X&&(X=-X),Gb(m,X?X:40)},darker:function(F,d){return d>0&&(d=-d),Gb(F,d?d:-40)},unionPoint:function(h,o){if(!h)return s;if(2===arguments.length)return h&&o?{x:d(h.x,o.x),y:d(h.y,o.y),width:A(h.x-o.x),height:A(h.y-o.y)}:s;var e=h;if(e._as&&(e=e._as),e.length===w)return s;var Y=e.length;if(0>=Y)return s;for(var i=1,y=e[0],t={x:y.x,y:y.y,width:0,height:0};Y>i;i++){y=e[i];var J=d(t.x,y.x),b=M(t.x+t.width,y.x),a=d(t.y,y.y),F=M(t.y+t.height,y.y);t.x=J,t.y=a,t.width=b-J,t.height=F-a}return t},unionRect:function(Q,h){if(Q&&!h)return cq(Q);if(!Q&&h)return cq(h);if(Q&&h){var W={x:d(Q.x,h.x),y:d(Q.y,h.y)};return W.width=M(Q.x+Q.width,h.x+h.width)-W.x,W.height=M(Q.y+Q.height,h.y+h.height)-W.y,W}return s},containsPoint:function(O,e,N,f){if(f!=s&&1!==f){var x=O.x+O.width/2,q=O.y+O.height/2;O={x:x-O.width/2*f,y:q-O.height/2*f,width:O.width*f,height:O.height*f}}if(N){var V=O.width/2,C=O.height/2,S=t(-N),A=P(-N),o=e.x-O.x-V,I=e.y-O.y-C;return e={x:A*o-S*I,y:S*o+A*I},Mr({x:-V,y:-C,width:O.width,height:O.height},e)}return!(!O||e.x<O.x||e.y<O.y||e.x>O.x+O.width||e.y>O.y+O.height)},containsRect:function(d,$){if(!d||!$)return!1;var v=$.x,I=$.y,T=$.width,S=$.height,L=d.width,p=d.height;if(0>(L|p|T|S))return!1;var b=d.x,z=d.y;if(b>v||z>I)return!1;if(L+=b,T+=v,v>=T){if(L>=b||T>L)return!1}else if(L>=b&&T>L)return!1;if(p+=z,S+=I,I>=S){if(p>=z||S>p)return!1}else if(p>=z&&S>p)return!1;return!0},intersectsRect:function(w,R){if(!w||!R)return!1;var T=R.width,l=R.height,G=w.width,Q=w.height;if(0>=G||0>=Q||0>=T||0>=l)return!1;var x=R.x,f=R.y,j=w.x,n=w.y;return G+=j,Q+=n,T+=x,l+=f,G>x&&Q>f&&T>j&&l>n},intersection:function(D,j){if(!D||!j)return s;var M=j.x,H=j.y,x=D.x,L=D.y,g=M,E=H,T=x,t=L;return g+=j.width,E+=j.height,T+=D.width,t+=D.height,x>M&&(M=x),L>H&&(H=L),g>T&&(g=T),E>t&&(E=t),g-=M,E-=H,0>=g||0>=E?s:{x:M,y:H,width:g,height:E}},grow:function(W,F,M){M===w&&(M=F),W.x-=F,W.y-=M,W.width=W.width+2*F,W.height=W.height+2*M},getLogicalPoint:function(K,c,s,_,l,P){var B,m,Q=c.getBoundingClientRect();return K.target?(sf(K)?Xg?sq["91"]=!0:sq["17"]=!0:Xg?sq["91"]=!1:sq["17"]=!1,sq["16"]=sb(K)?!0:!1,K=nb?Ui(K):K,B=K.clientX,m=K.clientY):(B=K.x,m=K.y),{x:(B-Q.left+c.scrollLeft-(s||0))/(l||1),y:(m-Q.top+c.scrollTop-(_||0))/(P||1)}},removeHTML:function(){var X;return function(b){return b&&b.parentNode?X===b?!0:(X=b,b.parentNode.removeChild(b),X=s,!0):!1}}(),getToolTipDiv:function(){if(!ag){ag=mc(),Qq=mc();var V=ag.style;Z.baseZIndex!=s&&(V.zIndex=g(Z.baseZIndex)+3+""),V.whiteSpace="nowrap",V.color=Z.toolTipLabelColor,V.background=Z.toolTipBackground,V.font=Z.toolTipLabelFont,V.padding="5px",V.boxShadow="0px 0px 3px "+Z.toolTipShadowColor}return ag},isToolTipShowing:function(){return ag&&ag.parentNode?!0:Qq&&Qq.parentNode?!0:!1},hideToolTip:function(){bj(ag),bj(Qq),_r()},showToolTip:function(m,k){if(!m||k==s)return Oc(),void 0;Z.getToolTipDiv();var K,D;if(k.html?(k=k.html,K=Qq,bj(ag)):(K=ag,bj(Qq)),D=K.style,K.innerHTML=k,K.parentNode||c.Default.appendToScreen(K),m.target){m=Pk(m);var A=Vj(),W=m.x,l=m.y,V=nb?60:12;if(nb){var P=K.getBoundingClientRect();D.left=W-P.width/2+Wo,D.top=l-P.height-V<A.top?l+V+Wo:l-P.height-V+Wo}else{D.left=W+V+Wo,D.top=l+V+Wo;var P=K.getBoundingClientRect();P.left+P.width>A.width&&(D.left=W-V-P.width+Wo),P.top+P.height>A.height&&(D.top=l-V-P.height+Wo),P.left<0&&(D.left=W+V+Wo),P.top<0&&(D.top=l+V+Wo)}}else D.left=m.x+Wo,D.top=m.y+Wo;_r()},startDragging:function(c,t){c!==wk&&(wk?nb?wk.handleWindowTouchEnd(t):wk.handleWindowMouseUp(t):nb?(K.addEventListener(rb,xo,!1),K.addEventListener(dh,Re,!1)):(K.addEventListener(fr,Ef,!1),K.addEventListener(Yc,Jk,!1)),wk=c)},getImageMap:function(){return Vg},toBoundaries:function(x,v,D,o){var e=[];return kb(x,v,D,o).forEach(function(B){var N=[];B.forEach(function(X){N.push(X.x,X.y)}),e.push(N)}),e},getCurrentKeyCodeMap:function(){return sq},drawCenterImage:function(f,i,I,l,A,C,O,M){var u=Db(i,A,C),E=Vc(i,A,C);ff(f,i,T(I-u/2),T(l-E/2),u,E,A,C,O,M)},drawStretchImage:function(A,$,J,W,f,o,u,N,H,E,F,q){var z,j=Db($,N,H,o),K=Vc($,N,H,u);
"uniform"===J?(z=d(o/j,u/K),j*=z,K*=z,W+=T((o-j)/2),f+=T((u-K)/2),o=j,u=K):"centerUniform"===J&&((j>o||K>u)&&(z=d(o/j,u/K),j*=z,K*=z),W+=T((o-j)/2),f+=T((u-K)/2),o=j,u=K);var Q=A.interactiveInfo;if(Q){var n;if(n="center"===J?{x:W+o/2-j/2,y:f+u/2-K/2,width:j,height:K}:{x:W,y:f,width:o,height:u},Q.rect){var G=Q.compInfos,w=G.length;w&&(G[w-1].rect.image=$)}else Q.rect=n}if("center"===J){var I=F!==!1&&(j>o||K>u);I&&(A.save(),A.beginPath(),A.rect(W,f,o,u),A.clip()),ff(A,$,W+o/2-j/2,f+u/2-K/2,j,K,N,H,E,q),I&&A.restore()}else ff(A,$,W,f,o,u,N,H,E,q)},toCanvas:function(i,p,c,X,N,O,C,w,g){i=sr(i,C),p=p||Db(i,N),c=c||Vc(i,N);var a=qb(),S=Ml(a);return w?(Dg(a,p,c,w),S.scale(w,w)):Dg(a,p,c,1),pc(S,i,X,0,0,p,c,N,O,C,g),i&&i.clampToEdge&&(a.clampToEdge=i.clampToEdge),S.restore(),a},createGradientImage:function(C,P,V,G){for(var K=["L",0,0,C,0,1,0,0,1,0,0],q=0,H=Math.min(P.length,V.length);H>q;q++)K.push(V[q],P[q]);var U=c.Default.toCanvas({width:C,height:C,clampToEdge:!0,comps:[{type:"shape",rotation:G||0,points:[0,0,C,0,C,C,0,C],background:"#ffffff",gradientPack:K}]});return U},createElement:function(e,h,v,p){var f=G.createElement(e);return Rm(f,h||n.widgetBorder,2),f.style.font=v?v:dr,p!=s&&(f.value=p),Z.onElementCreated&&Z.onElementCreated(f),f},containedInView:function(W,$){var Z=kk($).getBoundingClientRect();return Mr({x:Z.left,y:Z.top,width:Z.width,height:Z.height},gh(W))},isIsolating:function(){return cr>0},setIsolating:function(q){q?cr++:cr--},getMSMap:function(){return Zf},stringify:function(I,W){var D=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var t=JSON.stringify(I,function(h,K){return"function"==typeof K?"__ht__"+(K.__ht__||K.toString()):Rb(K)?vc(K):K},W==s?2:W);return Date.prototype.toJSON=D,t},parse:function(O){return Fm(O)?JSON.parse(O,function(i,v){if(Fm(v)){if("__ht__function"==v.substr(0,14)){var r=v.indexOf("{")+1,D=v.lastIndexOf("}"),u=v.indexOf("(")+1,h=v.indexOf(")");if(r&&D&&u&&h){var A=new Function(v.substring(u,h),v.substring(r,D));return A.__ht__=v.substr(6),A}}if("__ht__date"==v.substr(0,10))return new Date(g(v.substr(10)))}return v}):O},loadJS:function(d,_){_&&d.push(_);var L=d.shift();if(Dc(L))d=L.contact(d),Z.loadJS(d);else if(dc(L))L(),Z.loadJS(d);else if(Fm(L)){var x=G.createElement("script");x.onload=function(){Z.loadJS(d)},x.setAttribute("src",L),G.getElementsByTagName("head")[0].appendChild(x)}else d.length&&Z.loadJS(d)},toRoundedCorner:function(b,m){var Y=b.size();if(0>=m)return{points:b};var J,q=new Yd,Q=new Yd,M=b.get(0);q.add(M),Q.add(1);for(var E=1;Y>E;E++)if(Y>E+1){var y=b.get(E),z=b.get(E+1),F=M.x,N=M.y,p=y.x,l=y.y,i=l-N,K=p-F,X=o(i,K);J=d(.99*dq(M,y),m),q.add({x:p-J*P(X),y:l-J*t(X)}),q.add(y),F=y.x,N=y.y,p=z.x,l=z.y,i=l-N,K=p-F,X=o(i,K),J=d(.99*dq(y,z),m),M={x:F+J*P(X),y:N+J*t(X)},q.add(M),Q.addAll([2,3])}else q.add(b.get(E)),Q.add(2);return{points:q,segments:Q}},toColorData:Ai,setCanvas:Dg,createDiv:mc,createDisabledDiv:Er,createView:Op,createCanvas:qb,appendChild:zd,initContext:Ml,checkLoadingImage:sc,translateAndScale:ol,layout:_p,getPosition:ii,drawPoints:hr,drawRoundRect:uf,drawBorder:Hb,setFocus:Zp,getter:Ig,setter:Ng,isEmptyObject:Lr},!0),se(V,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var de=Z.disabledOpacity,So=Z.toolTipDelay,fk=Z.devicePixelRatio,Ud=Z.autoMakeVisible,io=Z.autoHideScrollBar,Fq=Z.imageGradient,Zk=Z.showToolTip,Oc=Z.hideToolTip,kg=Z.dashPattern,Tj=Z.lineCap,Pl=Z.lineJoin,yc=Z.labelColor,Jl=Z.labelSelectColor,dr=Z.labelFont,Fd=Z.widgetIndent,Pi=Z.widgetRowHeight,Zr=Z.widgetHeaderHeight,si=Z.widgetTitleHeight,zr=Z.scrollBarColor,oq=Z.scrollBarSize,Je=Z.scrollBarTimeout,$e=Z.scrollBarMinLength,pi=Z.scrollBarInteractiveSize,li=Z.zoomIncrement,aq=Z.scrollZoomIncrement,ts=Z.pinchZoomIncrement,Ae=Z.zoomMax,Qo=Z.zoomMin,vq=Z.createObject,Jr=Z.preventDefault,jb=Z.setImage,sr=Z.getImage,xj=Z.isImageComplete,ds=Z.drawCenterImage,pc=Z.drawStretchImage,Xi=Z.getId,No=Z.callLater,Od=Z.sortFunc,cq=Z.clone,ai=Z.getClass,Vb=Z.startAnim,Ln=Z.brighter,Vk=Z.darker,Kn=Z.drawText,Bm=Z.getTextSize,db=Z.isLeftButton,qe=Z.getTouchCount,yk=Z.isDoubleClick,sb=Z.isShiftDown,sf=Z.isCtrlDown,gh=Z.getClientPoint,Pk=Z.getPagePoint,dq=Z.getDistance,Ge=Z.unionPoint,hq=Z.unionRect,Mr=Z.containsPoint,qi=Z.containsRect,Yk=Z.intersectsRect,xs=Z.intersection,Vj=Z.getWindowInfo,$o=Z.grow,Tg=Z.getLogicalPoint,ym=Z.startDragging,bj=Z.removeHTML,_f=Z.createElement,we=Z.segmentResolution,Al=Z.shapeResolution,Cm=Z.shapeSide,xl=Z.def,If=function(b,E,d){xl(H+"."+b,E,d)},ye=function(i,k){i.childNodes.forEach(function(L){k(L),ye(L,k)})};se(Z,{toolTipLabelColor:yc,toolTipLabelFont:dr,toolTipBackground:n.toolTipBackground,toolTipShadowColor:Mc,drawBreakableText:Xl,setDevicePixelRatio:function(n){fk=Z.devicePixelRatio="number"==typeof n?n:K.devicePixelRatio,ye(G.body,function(b){var I=b._ht;I&&I._canvas&&(Dg(I._canvas,I.getWidth(),I.getHeight()),I.redraw?I.redraw():I.iv())})}},!0);var sg=1e-6,js="undefined"!=typeof Uint16Array?Uint16Array:Array,Jm="undefined"!=typeof Float32Array?Float32Array:Array,Wj=function(c,v,d){var Y=[c[0]-v[0],c[1]-v[1],c[2]-v[2]];if(d){var Z=dq(Y);Z>0&&(Y[0]/=Z,Y[1]/=Z,Y[2]/=Z)}return Y},rp=function(){var M="charCodeAt",X=2*(2*Zc.length+1);for(var u in K)if(u===H+Zq[0]+Wo.length){var W=K[u];if(!W)break;for(var d=W.length,o=0;d>o;o++)if(W[o][M](0)===X&&W[o+1]!=s&&W[o+1]===Wo[0]&&W[o+2]!=s&&W[o+2][M](0)===X){for(var C=o+3;d>C;C++)if(W[C][M](0)===X){if(0==W[C+1])for(var J,D=C+2;d>D;D++){if(W[D][M](0)===X){0==W[D-1]&&J&&(m=J.substr(0,J.length-1));break}J==s?J=W[D]:J+=W[D]}break}break}break}return function(f){return[-f[0],-f[1],-f[2]]}}(),Eq=function(A,u){return 3===A.length?A[0]*u[0]+A[1]*u[1]+A[2]*u[2]:A[0]*u[0]+A[1]*u[1]},kr=function(){var W=new Jm(16);return W[0]=1,W[1]=0,W[2]=0,W[3]=0,W[4]=0,W[5]=1,W[6]=0,W[7]=0,W[8]=0,W[9]=0,W[10]=1,W[11]=0,W[12]=0,W[13]=0,W[14]=0,W[15]=1,W},rl=kr(),Do=function(S){var b=new Jm(16);return b[0]=S[0],b[1]=S[1],b[2]=S[2],b[3]=S[3],b[4]=S[4],b[5]=S[5],b[6]=S[6],b[7]=S[7],b[8]=S[8],b[9]=S[9],b[10]=S[10],b[11]=S[11],b[12]=S[12],b[13]=S[13],b[14]=S[14],b[15]=S[15],b},Nd=function(q,o){return q[0]=o[0],q[1]=o[1],q[2]=o[2],q[3]=o[3],q[4]=o[4],q[5]=o[5],q[6]=o[6],q[7]=o[7],q[8]=o[8],q[9]=o[9],q[10]=o[10],q[11]=o[11],q[12]=o[12],q[13]=o[13],q[14]=o[14],q[15]=o[15],q},mg=function(R){return R[0]=1,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=1,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=1,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R},kh=function(U,w){var z=U[0],K=U[1],l=U[2];return U[0]=w[0]*z+w[4]*K+w[8]*l+w[12],U[1]=w[1]*z+w[5]*K+w[9]*l+w[13],U[2]=w[2]*z+w[6]*K+w[10]*l+w[14],U},zi=function(V,p){var n=V[0],T=V[1],t=V[2],D=V[3];return V[0]=p[0]*n+p[4]*T+p[8]*t+p[12]*D,V[1]=p[1]*n+p[5]*T+p[9]*t+p[13]*D,V[2]=p[2]*n+p[6]*T+p[10]*t+p[14]*D,V[3]=p[3]*n+p[7]*T+p[11]*t+p[15]*D,V},kc=function(){var f,s,U,q,h=$b(Jp[1]+Jp[7]),X=$b(Jp[0]+Jp[3]-Jp[10]),C=$b(Jp[8]+2),M=function(){return s=U.charAt(f),f+=1,s},n=function(){var P="";if(s===C)for(;M();){if(s===C)return M(),P;P+=s}else M()},z=function(){for(;s&&" ">=s;)M()},E=function(){var v,y={};if(s===h){if(M(),z(),s===X)return M(),y;for(;s;){if(v=n(),z(),M(),y[v]=q(),z(),s===X)return M(),y;M(),z()}}};return q=function(){switch(z(),s){case h:return E();default:return n()}},function(H){if(u={},H){var x;if(U=H,f=0,s=" ",x=q(),z(),!s)return x}}}(),_o=function(Y,Q){if(Q){var s=t(Q),J=P(Q),N=Y[4],d=Y[5],C=Y[6],z=Y[7],H=Y[8],S=Y[9],u=Y[10],E=Y[11];Y[4]=N*J+H*s,Y[5]=d*J+S*s,Y[6]=C*J+u*s,Y[7]=z*J+E*s,Y[8]=H*J-N*s,Y[9]=S*J-d*s,Y[10]=u*J-C*s,Y[11]=E*J-z*s}},zq=function(l,C){if(C){var z=t(C),H=P(C),S=l[0],p=l[1],O=l[2],j=l[3],X=l[8],Q=l[9],r=l[10],F=l[11];l[0]=S*H-X*z,l[1]=p*H-Q*z,l[2]=O*H-r*z,l[3]=j*H-F*z,l[8]=S*z+X*H,l[9]=p*z+Q*H,l[10]=O*z+r*H,l[11]=j*z+F*H}},Bf=function(K,e){if(e){var X=t(e),u=P(e),c=K[0],s=K[1],b=K[2],J=K[3],L=K[4],B=K[5],A=K[6],C=K[7];K[0]=c*u+L*X,K[1]=s*u+B*X,K[2]=b*u+A*X,K[3]=J*u+C*X,K[4]=L*u-c*X,K[5]=B*u-s*X,K[6]=A*u-b*X,K[7]=C*u-J*X}},vj=function(v,c,i){return Fb(s,i===!1?s:v.getFinalScale3d(),v.getFinalRotation3d(),v.getRotationMode(),v.p3(),s,c)},Fb=function(A,q,N,L,O,b,p){return b||(b=kr()),O&&Ih(b,O),Mn(b,N,L),p&&nc(b,b,p),q&&Ld(b,q),A&&nc(b,b,A),b},ie=function(r,U,u){U=g(U),u=g(u);var m=this;m.g=r,m._84O=U,m._85O=u,m._70I=!0,m.F=0,m._83O=U+u,m.pen={x:0,y:0}},On="lineDashOffset",ji="setLineDash",rq=function(Z){for(var _ in Z)1===_.length&&(On=Z[_]);return _?1:0},Jd=function(X,M,i){return Rf(M)?X:X[ji]?(X[ji](M),i&&(X.lineDashOffset=i),X):new ie(X,M[0],M.length>1?M[1]:M[0])},vb=function(Y,R){!Rf(R)&&Y[ji]&&(Y[ji](kf),Y.lineDashOffset=0)};if(xl(ie,D,{_69I:6,moveTo:function(y,e){var i=this,c=i.pen;c.x=y,c.y=e,i.g.moveTo(y,e),i.start||(i.start={x:y,y:e})},lineTo:function(w,M){var g=this,F=g.pen,B=w-F.x,x=M-F.y,u=o(x,B),Z=P(u),A=t(u),E=g._23O(F.x,F.y,w,M),T=g._85O,s=g._84O,d=g._83O;if(g.F){if(g.F>E)return g._70I?g._72I(w,M):g.moveTo(w,M),g.F-=E,void 0;if(g._70I?g._72I(F.x+Z*g.F,F.y+A*g.F):g.moveTo(F.x+Z*g.F,F.y+A*g.F),E-=g.F,g.F=0,g._70I=!g._70I,!E)return}var f=p(E/d);if(f){for(var X=Z*s,H=A*s,$=Z*T,j=A*T,Q=0;f>Q;Q++)g._70I?(g._72I(F.x+X,F.y+H),g.moveTo(F.x+$,F.y+j)):(g.moveTo(F.x+$,F.y+j),g._72I(F.x+X,F.y+H));E-=d*f}g._70I?E>s?(g._72I(F.x+Z*s,F.y+A*s),g.moveTo(w,M),g.F=T-(E-s),g._70I=!1):(g._72I(w,M),E===s?(g.F=0,g._70I=!g._70I):(g.F=s-E,g.moveTo(w,M))):E>T?(g.moveTo(F.x+Z*T,F.y+A*T),g._72I(w,M),g.F=s-(E-T),g._70I=!0):(g.moveTo(w,M),E===T?(g.F=0,g._70I=!g._70I):g.F=T-E)},quadraticCurveTo:function(j,H,D,X){var z,v=this,r=v.pen,u=r.x,E=r.y,O=v._22O(u,E,j,H,D,X),l=0,F=0,I=v._85O,Z=v._84O;if(v.F){if(v.F>O)return v._70I?v._71I(j,H,D,X):v.moveTo(D,X),v.F-=O,void 0;if(l=v.F/O,z=v._20O(u,E,j,H,D,X,l),v._70I?v._71I(z[2],z[3],z[4],z[5]):v.moveTo(z[4],z[5]),v.F=0,v._70I=!v._70I,!O)return}var J=O-O*l,m=p(J/v._83O),_=Z/O,A=I/O;if(m)for(var k=0;m>k;k++)v._70I?(F=l+_,z=v._21O(u,E,j,H,D,X,l,F),v._71I(z[2],z[3],z[4],z[5]),l=F,F=l+A,z=v._21O(u,E,j,H,D,X,l,F),v.moveTo(z[4],z[5])):(F=l+A,z=v._21O(u,E,j,H,D,X,l,F),v.moveTo(z[4],z[5]),l=F,F=l+_,z=v._21O(u,E,j,H,D,X,l,F),v._71I(z[2],z[3],z[4],z[5])),l=F;J=O-O*l,v._70I?J>Z?(F=l+_,z=v._21O(u,E,j,H,D,X,l,F),v._71I(z[2],z[3],z[4],z[5]),v.moveTo(D,X),v.F=I-(J-Z),v._70I=!1):(z=v._19O(u,E,j,H,D,X,l),v._71I(z[2],z[3],z[4],z[5]),O===Z?(v.F=0,v._70I=!v._70I):(v.F=Z-J,v.moveTo(D,X))):J>I?(F=l+A,z=v._21O(u,E,j,H,D,X,l,F),v.moveTo(z[4],z[5]),z=v._19O(u,E,j,H,D,X,F),v._71I(z[2],z[3],z[4],z[5]),v.F=Z-(J-I),v._70I=!0):(v.moveTo(D,X),J===I?(v.F=0,v._70I=!v._70I):v.F=I-J)},bezierCurveTo:function(){var $=arguments;this.pen={x:$[4],y:$[5]},this.g.bezierCurveTo($[0],$[1],$[2],$[3],$[4],$[5])},arc:function(m,c,b,x,o,$){$||(x=-x,o=-o),cb(this,m,c,x,o-x,b,b,!1)},rect:function(o,G,$,W){var U=this;U.pen={x:o,y:G},U.moveTo(o,G),U.lineTo(o,G+W),U.lineTo(o+$,G+W),U.lineTo(o+$,G),U.lineTo(o,G)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(a,E,W,R){var g=W-a,n=R-E;return O(g*g+n*n)},_22O:function($,l,i,H,y,p,J){for(var B,M,w,C,G,N,W,I=0,j=$,K=l,Y=J>0?J:this._69I,d=1;Y>=d;d++)w=d/Y,C=1-w,G=C*C,N=2*w*C,W=w*w,B=G*$+N*i+W*y,M=G*l+N*H+W*p,I+=this._23O(j,K,B,M),j=B,K=M;return I},_21O:function(k,y,q,w,F,t,m,p){var N=this;if(0===m)return N._20O(k,y,q,w,F,t,p);if(1===p)return N._19O(k,y,q,w,F,t,m);var b=N._20O(k,y,q,w,F,t,p);return b.push(m/p),N._19O.apply(N,b)},_20O:function(z,O,V,P,h,l,b){if(1!==b){var y=V+(h-V)*b,i=P+(l-P)*b;V=z+(V-z)*b,P=O+(P-O)*b,h=V+(y-V)*b,l=P+(i-P)*b}return[z,O,V,P,h,l]},_19O:function(T,Y,u,S,v,K,D){if(1!==D){var e=T+(u-T)*D,O=Y+(S-Y)*D;u+=(v-u)*D,S+=(K-S)*D,T=e+(u-e)*D,Y=O+(S-O)*D}return[T,Y,u,S,v,K]},_72I:function(U,i){var Z=this.pen;(U!==Z.x||i!==Z.y)&&(Z.x=U,Z.y=i,this.g.lineTo(U,i))},_71I:function(S,v,Q,P){var s=this.pen;(S!==Q||v!==P||Q!==s.x||P!==s.y)&&(s.x=Q,s.y=P,this.g.quadraticCurveTo(S,v,Q,P))}}),i&&I){var zs=I.toString();x=zs.indexOf(Fc.substr(0,2))>0&&zs.indexOf(Tp+Tp.substr(1,1))>1||zs.indexOf(Gh[0]+Ve.substr(0,2)+Fc.substr(2,2)+Zq[0]+Fc[4])>1?!0:!1}var bm=s,Uj=s,ah=function(O){bm&&!O._72O&&(Uj||(Uj={}),Uj[O._72O=Xi()]=O)},zf=function(b,H){if(H||(H=b),H&&(bm||(bm={}),!bm[b])){var L=new XMLHttpRequest;if(bm[H]={request:L,url:H},L.overrideMimeType&&L.overrideMimeType("text/plain"),H=Z.beforeLoadURL(H),H.data){var $=Z.parse(H.data);Ic(b,$),Z.handleCompTypeLoaded(b,$)}else L.open("GET",encodeURI(H),!0),L.onload=function(L){if(200===this.status||0===this.status){var m=Z.parse(L.target.response||L.target.responseText);Ic(b,m),Z.handleCompTypeLoaded(b,m)}else Ic(b,s)},L.onerror=function(){Ic(b,s)},L.send(null)}},Ic=function(A,O){if(vl[A]=O,delete bm[A],Lr(bm)&&(bm=s,Uj)){for(var P in Uj){var x=Uj[P];x.invalidateAll&&x.invalidateAll(w,"compTypeLoaded",A),x.redraw&&x.redraw(),x.iv(),delete x._72O}Uj=s}if(O&&Uj)for(var P in Uj){var x=Uj[P];x.invalidateAll&&x.invalidateAll(w,"compTypeLoading",A),x.redraw&&x.redraw(),x.iv()}},ep=n.chart,Nh=Z.compStack=[],fl=/^style@/,bd=/^attr@/,Bs=/^field@/,Vl={x:.5,y:.5},Db=function(t,c,Q,G){if(!t)return 0;if(Rp(t.fitSize,c,Q)&&G)return G;var I=Rp(t.width,c,Q);return null==I?20:I},Vc=function(Q,R,j,P){if(!Q)return 0;if(Rp(Q.fitSize,R,j)&&P)return P;var _=Rp(Q.height,R,j);return null==_?20:_},Rp=function(k,c,L){if(!k||!k.func)return k;var V,l=k.func,K=k.value;return V=dc(l)?L&&L.vectorDataBindingDisabled&&!k.isSafeFunc?K:l(c,L):c instanceof yb?bd.test(l)?c.a(l.slice(5)):fl.test(l)?c.s(l.slice(6)):Bs.test(l)?c[l.slice(6)]:c[l]?c[l](L):K:K,K!==w&&V==s?K:V},ff=Z.drawImage=function(){var u,Y,A,G,f,l,b=function(j,t){j.getValue&&j.getValue.compType===t||(j.getValue=function(q){var m=H(j,q);if(m===w&&t.properties){var K=t.properties[q];K&&(m=K.defaultValue)}return m},j.getValue.compType=t)},H=function(a,s,o){var u=a[s];return u&&u.func?(u=Rp(u,Y,A),o&&(u=o(u))):o&&(u=a[s]=o(u)),u},x=function(q,Z){var r;if(r=Z?H(q,Z):q,f&&r){if("override"===l)return f;if("override_rgb"===l){var x=Xe(f);return r=Ai(r),"rgba("+p(255*x[0])+","+p(255*x[1])+","+p(255*x[2])+","+r[3]/255+")"}if("override_a"===l){var x=Xe(f);return r=Ai(r),"rgba("+r[0]+","+r[1]+","+r[2]+","+x[3]+")"}var x=Xe(f);return r=Ai(r),"rgba("+p(r[0]*x[0])+","+p(r[1]*x[1])+","+p(r[2]*x[2])+","+r[3]/255*x[3]+")"}return r},q=function(w){if(Dc(w)){for(var N=new Yd,F=w.length,_=0;F>_;_+=2)N.add({x:w[_],y:w[_+1]});w=N}return w},V=function(q){var t=H(q,"anchorX"),Q=H(q,"anchorY");if(t!==w||Q!==w)return{x:t===w?Vl.x:t,y:Q===w?Vl.y:Q};var l=H(q,"type"),L=H(q,"name");if("image"!==l||!L)return Vl;var p=sr(L);return p&&p.anchorX!==w&&p.anchorY!==w?{x:p.anchorX,y:p.anchorY}:Vl},z=function(v,t){var s=H(v,Sh),n=V(v);if(Dc(s)){var h=s.length,E=H(v,"relative"),r=t.width,$=t.height;if(4===h)s={x:s[0],y:s[1],width:s[2],height:s[3]},E?(s.x*=r,s.y*=$,s.width*=r,s.height*=$):t.fitSize&&(s.x*=t.widthScale,s.width*=t.widthScale,s.y*=t.heightScale,s.height*=t.heightScale);else if(3===h){var j=s[0];s={width:s[1],height:s[2]},E?(s.width*=r,s.height*=$):t.fitSize&&(s.width*=t.widthScale,s.height*=t.heightScale),"object"==typeof j?j.length&&(j={x:j[0],y:j[1]}):j=ii(j,t,s),s.x=j.x-s.width*n.x,s.y=j.y-s.height*n.y}var w=H(v,"offsetX");w&&(t.fitSize&&(w*=t.widthScale),s.x+=w),w=H(v,"offsetY"),w&&(t.fitSize&&(w*=t.heightScale),s.y+=w)}return s},_=function(d){return Dc(d)?new Yd(d):d},y=function(U,M,Y,B,v,p,R){var z=u.interactiveInfo,F=U.transform;if(F)return u.save(),u.setTransform(F.a,F.b,F.c,F.d,F.tx,F.ty),z&&z.compInfos.push({comp:U,rect:M,matrix:F.clone()}),!0;v===w&&(v=1),p===w&&(p=1);var y=H(U,"clipPercentage"),S=vk(Y,M);if(S&&!B&&1===v&&1===p&&!(1>y))return z&&z.compInfos.push({comp:U,rect:M,matrix:z.matrix.clone()}),!1;R=R||Vl;var Z=M.x+M.width*R.x,o=M.y+M.height*R.y,l=Y.x+Y.width*R.x,T=Y.y+Y.height*R.y,J=Y.width?v*(M.width/Y.width):1,X=Y.height?p*(M.height/Y.height):1;if(u.save(),z&&(z.matrix.appendTranslate(Z,o).appendRotate(B).appendScale(J,X).appendTranslate(-l,-T),z.compInfos.push({comp:U,rect:M,matrix:z.matrix.clone()})),Xr(u,Z,o),Wf(u,B||0),Ak(u,J,X),Xr(u,-l,-T),1>y){0>y&&(y=0);var a=gl(Y,H(U,"clipDirection"),y);u.beginPath(),u.rect(a.x,a.y,a.width,a.height),u.clip()}return!0},c=function(){u.restore()},J=function(W,F,D){var w=H(W,"path"),M=H(W,ki),Z=H(W,"scaleX"),f=H(W,"scaleY"),B=V(W),h=s,e=lo(null,w);if(D||(D=W.unionRect,D||(D=Ge(e),W.path.func||(W.unionRect=D)),h=D),D){h||(h=W.unionRect,h||(h=Ge(e),W.path.func||(W.unionRect=h)));var a=y(W,D,h,M,Z,f,B),d=H(W,"borderPattern"),N=Jd(u,d),n=x(W,"background"),C=x(W,"borderColor"),T=H(W,"borderWidth"),P=H(W,"gradient"),k=x(W,"gradientColor"),v=H(W,"border3d"),i=H(W,"border3dColor"),S=H(W,"border3dAccuracy"),r=u.lineJoin,$=u.lineCap;if(u.lineJoin=H(W,"borderJoin")||Pl,u.lineCap=H(W,"borderCap")||Tj,n?(Sp(u,n,P,k,h),lo(u,w),u.fill(),N!==u&&lo(u,w)):lo(u,w),T&&C){var L=H(W,"borderWidthAbsolute");L&&(u.save(),u.setTransform(1,0,0,1,0,0)),u.lineWidth=T,u.strokeStyle=C,u.stroke(),L&&u.restore(),v&&zj(u,C,i,T,G,S)}if(vb(u,d),H(W,"dash")){var K=H(W,"dashWidth")||T;if(K>0){d=H(W,"dashPattern")||kg;var N=Jd(u,d,H(W,"dashOffset")),p=x(W,"dashColor")||x(aj);N!==u&&lo(u,w),u.strokeStyle=p,u.lineWidth=K,u.stroke(),H(W,"dash3d")&&zj(u,p,x(W,"dash3dColor"),K,G,H(W,"dash3dAccuracy")),vb(u,d)}}F===Sh&&Bk(u,n,H(W,"depth"),h),u.lineJoin=r,u.lineCap=$,a&&c()}},o=function(b,v,Z,p){var O=H(b,qg,q),n=H(b,ki),K=V(b);if(O&&p.fitSize){var W=Math.abs(Math.cos(n))<.001,L=new Yd,U=Ge(O),$=p.widthScale,m=p.heightScale,F=U.x+K.x*U.width,B=U.y+K.y*U.height,D=F*$,P=B*m;O.each(function(w){var Q=w.x-F,O=w.y-B;L.add({x:D+Q*(W?m:$),y:P+O*(W?$:m)})}),O=L,b.unionRect=null}var r=H(b,"scaleX"),N=H(b,"scaleY"),M=v===Ri,g=s;if(!Z&&M&&(Z=b.unionRect,Z||(Z=Ge(O),b.points.func||(b.unionRect=Z)),g=Z),Z){M?g||(g=b.unionRect,g||(g=Ge(O),b.points.func||(b.unionRect=g))):g=Z;var a,k,R,w,E=y(b,Z,g,n,r,N,K),X=H(b,"borderPattern"),T=Jd(u,X),d=x(b,"background"),I=sr(H(b,"repeatImage"),f,l),J=H(b,"gradientPack"),Q=x(b,"borderColor"),C=H(b,"borderWidth"),z=H(b,"segments",_),o=H(b,"gradient"),i=x(b,"gradientColor"),h=H(b,"border3d"),t=H(b,"border3dColor"),e=H(b,"border3dAccuracy"),S=H(b,"closePath"),j=H(b,"fillRule")||"nonzero",Ho=u.lineJoin,Gd=u.lineCap;if(u.lineJoin=H(b,"borderJoin")||Pl,u.lineCap=H(b,"borderCap")||Tj,M)if(d||I||J){var Fr=H(b,"fillClipPercentage");if(1>Fr){0>Fr&&(Fr=0);var zc=gl(g,H(b,"fillClipDirection"),Fr);u.save(),u.beginPath(),u.rect(zc.x,zc.y,zc.width,zc.height),u.clip()}if(hr(u,O,z,S),J)lj(u,J);else if(I){var Wb=u,Sc=f,Hf=l;Sk(u,I,f,l,Y,A),u=Wb,f=Sc,l=Hf}else{var Wb=u;Sp(u,d,o,i,g),u=Wb}u.fill(j),1>Fr&&u.restore(),J&&u.restore(),T!==u&&hr(T,O,z,S)}else hr(T,O,z,S);else if("roundRect"===v?a=H(b,"cornerRadius"):"polygon"===v?a=H(b,"polygonSide"):"arc"===v&&(a=H(b,"arcFrom"),k=H(b,"arcTo"),R=H(b,"arcClose"),w=H(b,"arcOval")),d||I||J){var Fr=H(b,"fillClipPercentage");if(1>Fr){0>Fr&&(Fr=0);var zc=gl(g,H(b,"fillClipDirection"),Fr);u.save(),u.beginPath(),u.rect(zc.x,zc.y,zc.width,zc.height),u.clip()}if(om(u,v,g,a,k,R,w),J)lj(u,J);else if(I){var Wb=u,Sc=f,Hf=l;Sk(u,I,f,l,Y,A),u=Wb,f=Sc,l=Hf}else Sp(u,d,o,i,g);u.fill(j),1>Fr&&u.restore(),J&&u.restore(),u!==T&&om(T,v,g,a,k,R,w)}else om(T,v,g,a,k,R,w);if(C&&Q){var Rl=H(b,"borderWidthAbsolute");Rl&&(u.save(),u.setTransform(1,0,0,1,0,0)),u.lineWidth=C,u.strokeStyle=Q,u.stroke(),Rl&&u.restore(),h&&zj(u,Q,t,C,G,e)}if(vb(u,X),H(b,"dash")){var Dq=H(b,"dashWidth")||C;if(Dq>0){X=H(b,"dashPattern")||kg;var T=Jd(u,X,H(b,"dashOffset")),wo=x(b,"dashColor")||x(aj);T!==u&&(M?hr(T,O,z,S):om(T,v,g,a,k,R,w)),u.strokeStyle=wo,u.lineWidth=Dq,u.stroke(),H(b,"dash3d")&&zj(u,wo,x(b,"dash3dColor"),Dq,G,H(b,"dash3dAccuracy")),vb(u,X)}}v===Sh&&Bk(u,d,H(b,"depth"),g),u.lineJoin=Ho,u.lineCap=Gd,E&&c()}},X=function(L,x){var J=f,C=l,U=f||H(L,Cd),i=l||H(L,"blendMode"),z=sr(H(L,"name"),U,i);z&&(pc(u,z,H(L,"stretch"),x.x,x.y,x.width,x.height,Y,A,U,null,i),f=J,l=C)},E=function(B,d){var E=H(B,"text");E!=s&&Kn(u,E,H(B,"font"),x(B,Cd),d.x,d.y,d.width,d.height,H(B,"align"),H(B,"vAlign"))},D=function(r,C){Hb(u,x(r,Cd),C.x,C.y,C.width,C.height,H(r,"width"))},j=function(b,O){var z=H(b,xp),W=0;if(z&&(z.forEach(function(F){W+=F}),W>0)){for(var I=H(b,"colors")||ep,c=H(b,"startAngle")||0,Q=H(b,"hollow"),e=H(b,Xo),K=H(b,po),j=H(b,hl),J=e?new Yd:s,F=O.x,T=O.y,n=O.width,y=O.height,m=F+n/2,B=T+y/2,_=d(n,y)/2,U=0,f=0;f<z.length;f++){var i=z[f],X=v*i/W,g=c+X;if(u.fillStyle=I[U++],U===I.length&&(U=0),u.beginPath(),Q){var N=m+P(c)*_/2,l=B+t(c)*_/2,o=m+P(g)*_,p=B+t(g)*_;u.moveTo(N,l),u.arc(m,B,_/2,c,g,!1),u.lineTo(o,p),u.arc(m,B,_,g,c,!0)}else u.moveTo(m,B),u.arc(m,B,_,g,c,!0);J&&(X=(c+g)/2,J.add({text:dc(e)?e(i,f,W,Y):i,x:m+.75*P(X)*_,y:B+.75*t(X)*_})),u.closePath(),u.fill(),c=g}J&&J.each(function(H){Kn(u,H.text,K,j,H.x,H.y,0,0,Vp)})}},S=function(K,t){var E=H(K,bn);if(E&&E.length>0){var a=E.length,R=H(K,Xo),C=H(K,po),w=H(K,hl),X=R?new Yd:s,l=H(K,"minValue")||0,V=H(K,"maxValue");if(V==s&&(V=0,E.forEach(function(B){H(B,xp).forEach(function(v){V=M(V,v)})})),l===V)return;for(var k=t.height/(V-l),I=t.y+V*k,P=H(E[0],xp).length,O=t.width/(3*P+1),$=2*O/a,D=0,A=0;a>A;A++)for(var U=E[A],F=H(U,Cd),i=H(U,"colors"),m=H(U,xp),n=0;P>n;n++){i?u.fillStyle=i[n]:F?u.fillStyle=F:(u.fillStyle=ep[D++],D===ep.length&&(D=0));var p=m[n],r=p*k,N=t.x+(1+3*n)*O+A*$;if(Yg(u,N,I-r,$,r),X){var o=dc(R)?R(p,n,U,Y):p,G=Bm(C,o).height;X.add({x:N,y:I-r-G,width:$,height:G,text:o})}}X&&X.each(function(p){Kn(u,p.text,C,w,p.x,p.y,p.width,p.height,Vp)})}},O=function(i,S){var $=H(i,bn);if($&&$.length>0){var J=$.length,E=H($[0],xp).length,P=S.width/(3*E+1),Z=0,q=H(i,"maxValue"),g=H(i,Xo),k=H(i,po),r=H(i,hl),U=g?new Yd:s;if(q==s){q=0;for(var v=0;E>v;v++){for(var x=0,e=0;J>e;e++)x+=H($[e],xp)[v];q=M(q,x)}}if(q>0){for(var v=0;E>v;v++)for(var f=S.y+S.height,e=0;J>e;e++){var K=$[e],V=H(K,Cd),I=H(K,xp)[v],B=I/q*S.height;V?u.fillStyle=V:(u.fillStyle=ep[Z++],Z===ep.length&&(Z=0)),f-=B;var G={x:S.x+(1+3*v)*P,y:f,width:2*P,height:B};Yg(u,G.x,G.y,G.width,G.height),U&&(G.text=dc(g)?g(I,v,K,Y):I,U.add(G))}U&&U.each(function(K){Kn(u,K.text,k,r,K.x,K.y,K.width,K.height,Vp)})}}},F=function(Q,G){var f=H(Q,bn);if(f&&f.length>0){for(var C=f.length,B=H(f[0],xp).length,A=G.width/(3*B+1),T=0,K=H(Q,Xo),e=H(Q,po),r=H(Q,hl),y=K?new Yd:s,N=0;B>N;N++){for(var w=0,i=0;C>i;i++)w+=H(f[i],xp)[N];if(w>0){var X=G.y+G.height;for(i=0;C>i;i++){var D=f[i],g=H(D,Cd),l=H(D,xp)[N],p=l/w*G.height;g?u.fillStyle=g:(u.fillStyle=ep[T++],T===ep.length&&(T=0)),X-=p;var O={x:G.x+(1+3*N)*A,y:X,width:2*A,height:p};Yg(u,O.x,O.y,O.width,O.height),y&&(O.text=dc(K)?K(l,N,D,Y):l,y.add(O))}}}y&&y.each(function($){Kn(u,$.text,e,r,$.x,$.y,$.width,$.height,Vp)})}},W=function(j,z){var y=H(j,bn);if(y&&y.length>0){var I=y.length,r=H(j,"minValue")||0,d=H(j,"maxValue");if(d==s&&(d=0,y.forEach(function(G){H(G,xp).forEach(function(u){d=M(d,u)})})),r===d)return;for(var D=z.height/(d-r),F=z.y+d*D,$=H(y[0],xp).length,t=z.width/(3*$+1),g=0,x=H(j,"lineWidth")||2,O=H(j,"line3d"),C=H(j,"linePoint"),B=H(j,Xo),f=H(j,po),_=H(j,hl),A=0;I>A;A++){var c=y[A],k=H(c,Cd),e=H(c,xp);k?u.strokeStyle=k:(k=u.strokeStyle=ep[g++],g===ep.length&&(g=0)),u.beginPath();for(var J=0;$>J;J++){var W=z.x+(2+3*J)*t,q=F-e[J]*D;0===J?u.moveTo(W,q):u.lineTo(W,q)}if(u.lineWidth=x,u.stroke(),O&&zj(u,k,s,x,G),C||B){var L,a=x/2+2;for(J=0;$>J;J++){var l=e[J];if(W=z.x+(2+3*J)*t,q=F-l*D,dc(C)?C(u,W,q,k,J,c,Y):C&&(u.fillStyle=k,u.beginPath(),u.arc(W,q,a,0,v,!0),u.fill()),dc(B)?L=B(l,J,c,Y):B&&(L=l),L){var h=Bm(f,L).height,V=u.shadowBlur;if(V){var R=u.shadowOffsetX,T=u.shadowOffsetY,i=u.shadowColor;u.shadowOffsetX=0,u.shadowOffsetY=0,u.shadowBlur=0,u.shadowColor=s}Kn(u,L,f,_,W,q-h-a+2,0,h,Vp),V&&(u.shadowOffsetX=R,u.shadowOffsetY=T,u.shadowBlur=V,u.shadowColor=i)}}}}}},L={border:D,image:X,text:E,pieChart:j,columnChart:S,stackedColumnChart:O,percentageColumnChart:F,lineChart:W};return function(I,h,C,a,Q,P,D,d,k,T){if(h&&Q&&P){u=I,Y=D,A=d,G=A?A._zoom?A._zoom:1:1,f=k,l=T;var F=Q,e=P;if(Lb()){var i,N,r;0===u[Mj]?Lb[0]&&(i=!0):i=!0,u.texureImage2D?Lb[1]&&(N=!0):N=!0,u.texureImage3D?Lb[2]&&(r=!0):r=!0,i&&N&&r&&(F=C,e=a)}if(h.tagName)return Fm(m)&&!K[m]||u.drawImage(h,F,e,Q,P),void 0;if(H(h,"visible")!==!1){f||(f=Rp(h.color,Y,A)),T||(l=Rp(h.blendMode,Y,A)),Fm(m)&&!K[m]&&(Q=F,P=e);var X=Db(h,Y,A,Q),B=Vc(h,Y,A,P),U={x:0,y:0,width:X,height:B,fitSize:H(h,"fitSize")},g=H(h,"clip"),t=H(h,"opacity");if(U.fitSize&&(U.widthScale=X/Rp(h.width,Y,A),U.heightScale=B/Rp(h.height,Y,A)),u.save(),u.interactiveInfo){var O=u.interactiveInfo.matrix,W=O.clone();O.appendTranslate(F,e).appendScale(Q/X,P/B)}Xr(u,F,e),(X!==Q||B!==P)&&u.scale(Q/X,P/B),g&&(dc(g)?g(u,X,B,Y,A,h):(u.beginPath(),u.rect(0,0,X,B),u.clip())),t!=s&&(u.globalAlpha*=t),H(h,"comps").forEach(function(f){if(H(f,Lj)!==!1){if(Nh.splice(0,0,f),u.interactiveInfo)var j=u.interactiveInfo.matrix.clone();var E=H(f,"opacity"),X=H(f,"shadow"),Q=H(f,"type"),h=z(f,U);if(E!=s){var I=u.globalAlpha;u.globalAlpha*=E}if(X){var g=u.shadowOffsetX,W=u.shadowOffsetY,m=u.shadowBlur,T=u.shadowColor,a=H(f,"shadowOffsetX"),k=H(f,"shadowOffsetY"),S=H(f,"shadowBlur"),F=x(f,"shadowColor");u.shadowOffsetX=(a==s?3:a)*G,u.shadowOffsetY=(k==s?3:k)*G,u.shadowBlur=(S==s?6:S)*G,u.shadowColor=F||x(Wp)}if("save"===Q)u.save();else if("endClip"===Q||"restore"===Q)u.restore();else if("clip"===Q)u.save(),hr(u,H(f,"points",q),H(f,"segments",_),!0),u.clip();else if(pm[Q])h=h||{x:0,y:0,width:U.width,height:U.height},o(f,Q,h,U);else if(Q===Ri)o(f,Q,h,U);else if("SVGPath"===Q)J(f,Q,h);else{h=h||{x:0,y:0,width:U.width,height:U.height};var e=H(f,ki),p=H(f,"scaleX"),B=H(f,"scaleY"),i=V(f),n=y(f,h,h,e,p,B,i);if(dc(Q))b(f,Q),Z.drawCompType(Q,u,h,f,Y,A);else if(Z.getCompType(Q)){var C=Z.getCompType(Q),t=C.func||C;b(f,C),Z.drawCompType(t,u,h,f,Y,A)}else L[Q]?L[Q](f,h):Z.getCompType(Q)===w&&Jn.test(Q)&&zf(Q);n&&c()}X&&(u.shadowOffsetX=g,u.shadowOffsetY=W,u.shadowBlur=m,u.shadowColor=T),E!=s&&(u.globalAlpha=I),u.interactiveInfo&&(u.interactiveInfo.matrix=j),Nh.splice(0,1)}}),u.interactiveInfo&&(u.interactiveInfo.matrix=W),u.restore()}}}}();Z.getCurrentComp=function(){return Nh[0]},Z.getParentComp=function(){return Nh[1]},Z.getInternal=function(){return{isEnter:Rg,isEsc:af,isSpace:mm,isLeft:Ee,isUp:oo,isRight:Ck,isDown:Ni,addMethod:se,superCall:fm,toPointsArray:kb,translateAndScale:ol,appendArray:wm,createWorldMatrix:Fb,vec3TransformMat4:kh,setCanvas:Dg,createDiv:mc,createView:Op,createCanvas:qb,createImage:Qf,initContext:Ml,layout:_p,fillRect:Yg,Mat:Qi,drawBorder:Hb,isString:Fm,setBorder:Rm,getPropertyValue:Pe,setPropertyValue:We,drawVerticalLine:np,draw3DRect:Bk,getPinchDist:Kf,isSameRect:vk,getPosition:ii,intersectionLineRect:Fo,getNodeRect:mi,getEdgeAgentPosition:hd,getImageWidth:Db,getImageHeight:Vc,initItemElement:Ll,drawPoints:hr,createG2:Jd,closePopup:ur,isH:nn,createAnim:tq,createNormalMatrix:am,createNormals:gs,toFloatArray:vm,glMV:gk,batchShape:bs,createNodeMatrix:vj,getFaceInfo:Tf,transformAppend:wn,drawFaceInfo:cd,to3dPointsArray:lh,setGLDebugMode:function(o){bl=o},cube:function(){return{vs:ll,is:$r,uv:ih}},ui:function(){return{DataUI:iq,NodeUI:Yh,EdgeUI:Fh,GroupUI:Gn,ShapeUI:yg,GridUI:qc,Data3dUI:un,Node3dUI:Ik,Shape3dUI:dm}},getInternalVersion:function(){return"U2FsdGVkX184COat+EJg1hNVDPg1UmK3c62AMLV/Lqc="},getDragger:function(){return wk},addMSMap:function(Y){se(Zf,Y)},k:h}},function(Z){function q(B,T){B!=s&&(T==s&&Ti!=typeof B?this._54O(B,256):this._54O(B,T))}function e(){return new q(s)}function W(W,m,r,l,g,s){for(;--s>=0;){var U=m*this[W++]+r[l]+g;g=p(U/67108864),r[l++]=67108863&U}return g}function R(x,n,v,t,o,z){for(var r=32767&n,B=n>>15;--z>=0;){var p=32767&this[x],b=this[x++]>>15,I=B*p+b*r;p=r*p+((32767&I)<<15)+v[t]+(1073741823&o),o=(p>>>30)+(I>>>15)+B*b+(o>>>30),v[t++]=1073741823&p}return o}function V(k,x,e,_,V,L){for(var M=16383&x,K=x>>14;--L>=0;){var O=16383&this[k],X=this[k++]>>14,p=K*O+X*M;O=M*O+((16383&p)<<14)+e[_]+V,V=(O>>28)+(p>>14)+K*X,e[_++]=268435455&O}return V}function T(o){return ir.charAt(o)}function o(T,W){var m=$c[T.charCodeAt(W)];return m==s?-1:m}function C(R){for(var j=this.t-1;j>=0;--j)R[j]=this[j];R.t=this.t,R.s=this.s}function K(F){this.t=1,this.s=0>F?-1:0,F>0?this[0]=F:-1>F?this[0]=F+this.DV:this.t=0}function y(X){var M=e();return M._58O(X),M}function u(u,c){var T,y=this;if(16==c)T=4;else if(8==c)T=3;else if(256==c)T=8;else if(2==c)T=1;else if(32==c)T=5;else{if(4!=c)return y.fromRadix(u,c),void 0;T=2}y.t=0,y.s=0;for(var m=u.length,b=!1,S=0;--m>=0;){var V=8==T?255&u[m]:o(u,m);0>V?"-"==u.charAt(m)&&(b=!0):(b=!1,0==S?y[y.t++]=V:S+T>y.DB?(y[y.t-1]|=(V&(1<<y.DB-S)-1)<<S,y[y.t++]=V>>y.DB-S):y[y.t-1]|=V<<S,S+=T,S>=y.DB&&(S-=y.DB))}8==T&&0!=(128&u[0])&&(y.s=-1,S>0&&(y[y.t-1]|=(1<<y.DB-S)-1<<S)),y._57O(),b&&q.ZERO._78O(y,y)}function L(){for(var C=this,y=C.s&C.DM;C.t>0&&C[C.t-1]==y;)--C.t}function n(s){var K=this;if(K.s<0)return"-"+K._85O()[gm](s);var Z;if(16==s)Z=4;else if(8==s)Z=3;else if(2==s)Z=1;else if(32==s)Z=5;else{if(4!=s)return K.toRadix(s);Z=2}var g,H=(1<<Z)-1,R=!1,u="",n=K.t,S=K.DB-n*K.DB%Z;if(n-->0)for(S<K.DB&&(g=K[n]>>S)>0&&(R=!0,u=T(g));n>=0;)Z>S?(g=(K[n]&(1<<S)-1)<<Z-S,g|=K[--n]>>(S+=K.DB-Z)):(g=K[n]>>(S-=Z)&H,0>=S&&(S+=K.DB,--n)),g>0&&(R=!0),R&&(u+=T(g));return R?u:"0"}function i(){var G=e();return q.ZERO._78O(this,G),G}function x(){return this.s<0?this._85O():this}function a(v){var S=this,b=S.s-v.s;if(0!=b)return b;var W=S.t;if(b=W-v.t,0!=b)return S.s<0?-b:b;for(;--W>=0;)if(0!=(b=S[W]-v[W]))return b;return 0}function N(s){var z,K=1;return 0!=(z=s>>>16)&&(s=z,K+=16),0!=(z=s>>8)&&(s=z,K+=8),0!=(z=s>>4)&&(s=z,K+=4),0!=(z=s>>2)&&(s=z,K+=2),0!=(z=s>>1)&&(s=z,K+=1),K}function w(){var H=this;return H.t<=0?0:H.DB*(H.t-1)+N(H[H.t-1]^H.s&H.DM)}function j(H,x){var f;for(f=this.t-1;f>=0;--f)x[f+H]=this[f];for(f=H-1;f>=0;--f)x[f]=0;x.t=this.t+H,x.s=this.s}function S(D,Q){for(var l=D;l<this.t;++l)Q[l-D]=this[l];Q.t=M(this.t-D,0),Q.s=this.s}function r(h,x){var r,f=this,Y=h%f.DB,l=f.DB-Y,A=(1<<l)-1,u=p(h/f.DB),M=f.s<<Y&f.DM;for(r=f.t-1;r>=0;--r)x[r+u+1]=f[r]>>l|M,M=(f[r]&A)<<Y;for(r=u-1;r>=0;--r)x[r]=0;x[u]=M,x.t=f.t+u+1,x.s=f.s,x._57O()}function E(a,n){var v=this;n.s=v.s;var R=p(a/v.DB);if(R>=v.t)return n.t=0,void 0;var e=a%v.DB,G=v.DB-e,D=(1<<e)-1;n[0]=v[R]>>e;for(var k=R+1;k<v.t;++k)n[k-R-1]|=(v[k]&D)<<G,n[k-R]=v[k]>>e;e>0&&(n[v.t-R-1]|=(v.s&D)<<G),n.t=v.t-R,n._57O()}function l(u,a){for(var Z=this,W=0,H=0,c=d(u.t,Z.t);c>W;)H+=Z[W]-u[W],a[W++]=H&Z.DM,H>>=Z.DB;if(u.t<Z.t){for(H-=u.s;W<Z.t;)H+=Z[W],a[W++]=H&Z.DM,H>>=Z.DB;H+=Z.s}else{for(H+=Z.s;W<u.t;)H-=u[W],a[W++]=H&Z.DM,H>>=Z.DB;H-=u.s}a.s=0>H?-1:0,-1>H?a[W++]=Z.DV+H:H>0&&(a[W++]=H),a.t=W,a._57O()}function I(u,x){var W=this.abs(),b=u.abs(),X=W.t;for(x.t=X+b.t;--X>=0;)x[X]=0;for(X=0;X<b.t;++X)x[X+W.t]=W.am(0,b[X],x,X,0,W.t);x.s=0,x._57O(),this.s!=u.s&&q.ZERO._78O(x,x)}function J(W){for(var m=this.abs(),L=W.t=2*m.t;--L>=0;)W[L]=0;for(L=0;L<m.t-1;++L){var Y=m.am(L,m[L],W,2*L,0,1);(W[L+m.t]+=m.am(L+1,2*m[L],W,2*L+1,Y,m.t-L-1))>=m.DV&&(W[L+m.t]-=m.DV,W[L+m.t+1]=1)}W.t>0&&(W[W.t-1]+=m.am(L,m[L],W,2*L,0,1)),W.s=0,W._57O()}function D(B,H,n){var v=B.abs(),J=this;if(!(v.t<=0)){var X=J.abs();if(X.t<v.t)return H!=s&&H._58O(0),n!=s&&J._77O(n),void 0;n==s&&(n=e());var W=e(),y=J.s,O=B.s,F=J.DB-N(v[v.t-1]);F>0?(v._44O(F,W),X._44O(F,n)):(v._77O(W),X._77O(n));var c=W.t,L=W[c-1];if(0!=L){var f=L*(1<<J.F1)+(c>1?W[c-2]>>J.F2:0),r=J.FV/f,u=(1<<J.F1)/f,k=1<<J.F2,i=n.t,A=i-c,P=H==s?e():H;for(W._59O(A,P),n._52O(P)>=0&&(n[n.t++]=1,n._78O(P,n)),q.ONE._59O(c,P),P._78O(W,W);W.t<c;)W[W.t++]=0;for(;--A>=0;){var Q=n[--i]==L?J.DM:p(n[i]*r+(n[i-1]+k)*u);if((n[i]+=W.am(0,Q,n,A,0,c))<Q)for(W._59O(A,P),n._78O(P,n);n[i]<--Q;)n._78O(P,n)}H!=s&&(n._45O(c,H),y!=O&&q.ZERO._78O(H,H)),n.t=c,n._57O(),F>0&&n._46O(F,n),0>y&&q.ZERO._78O(n,n)}}}function _(k){var $=e();return this.abs()._49O(k,s,$),this.s<0&&$._52O(q.ZERO)>0&&k._78O($,$),$}function k(C){this.m=C}function G(V){return V.s<0||V._52O(this.m)>=0?V.mod(this.m):V}function f(W){return W}function m(b){b._49O(this.m,s,b)}function B(A,a,l){A._47O(a,l),this._74O(l)}function c(H,w){H._48O(w),this._74O(w)}function F(){if(this.t<1)return 0;var R=this[0];if(0==(1&R))return 0;var u=3&R;return u=15&u*(2-(15&R)*u),u=255&u*(2-(255&R)*u),u=65535&u*(2-(65535&(65535&R)*u)),u=u*(2-R*u%this.DV)%this.DV,u>0?this.DV-u:-u
}function A(K){var s=this;s.m=K,s.mp=K._50O(),s.mpl=32767&s.mp,s.mph=s.mp>>15,s.um=(1<<K.DB-15)-1,s.mt2=2*K.t}function Y(h){var R=e();return h.abs()._59O(this.m.t,R),R._49O(this.m,s,R),h.s<0&&R._52O(q.ZERO)>0&&this.m._78O(R,R),R}function b(H){var Q=e();return H._77O(Q),this._74O(Q),Q}function z(p){for(var U=this;p.t<=U.mt2;)p[p.t++]=0;for(var x=0;x<U.m.t;++x){var y=32767&p[x],e=y*U.mpl+((y*U.mph+(p[x]>>15)*U.mpl&U.um)<<15)&p.DM;for(y=x+U.m.t,p[y]+=U.m.am(0,e,p,x,0,U.m.t);p[y]>=p.DV;)p[y]-=p.DV,p[++y]++}p._57O(),p._45O(U.m.t,p),p._52O(U.m)>=0&&p._78O(U.m,p)}function em(o,z){o._48O(z),this._74O(z)}function mr(t,c,T){t._47O(c,T),this._74O(T)}function Rm(){return 0==(this.t>0?1&this[0]:this.s)}function Ah(F,X){if(F>4294967295||1>F)return q.ONE;var g=e(),y=e(),J=X._73O(this),Y=N(F)-1;for(J._77O(g);--Y>=0;)if(X._76O(g,y),(F&1<<Y)>0)X._75O(y,J,g);else{var W=g;g=y,y=W}return X.revert(g)}function Dc(E,s){var T;return T=256>E||s._51O()?new k(s):new A(s),this.exp(E,T)}function gl(){var $=this;if($.s<0){if(1==$.t)return $[0]-$.DV;if(0==$.t)return-1}else{if(1==$.t)return $[0];if(0==$.t)return 0}return($[1]&(1<<32-$.DB)-1)<<$.DB|$[0]}function Df(W,r){return new q(W,r)}function Vq(){var Q=this;Q.n=s,Q.e=0,Q.d=s,Q.p=s,Q.q=s,Q.dmp1=s,Q.dmq1=s,Q._10A=s}function ps(U){return U._53O(this.e,this.n)}function Ml(K){var X,S,V,$="",C=0;for(X=0;X<K.length&&K.charAt(X)!=jk;++X)V=sr.indexOf(K.charAt(X)),0>V||(0==C?($+=T(V>>2),S=3&V,C=1):1==C?($+=T(S<<2|V>>4),S=15&V,C=2):2==C?($+=T(S),$+=T(V>>2),S=3&V,C=3):($+=T(S<<2|V>>4),$+=T(15&V),C=0));return 1==C&&($+=T(S<<2)),$}function Me(J){var C=J.split(""),N=Ml(J);return C.forEach(function(e){var v=e.length;v>0&&N&&(km+=g(e))}),N}function Xm(a,O){var Q=hh._4O.Util._56O(a,"ss"),w={},W=0;return w.v=Q==O,w.t=1,w.s=0>W?-1:0,$k=w.v,W>0?w[0]=W:-1>W?w[0]=W+w.DV:w.t=0,[Q,w]}function Zk(W){var e=38,Y=W.substring(0,e);if(Y&&30==Y.indexOf("05000420")){var h=["ss",W.substring(e)];return h}return[]}function Ue(R,Q){Q=Q.replace(kl,""),Q=Q.replace(/[ \n]+/g,"");var N=Df(Q,16);if(N._55O()>this.n._55O())return 0;var T=this._37O(N),B=T[gm](16).replace(/^1f+00/,""),O=Zk(B);if(0==O.length)return!1;for(var $,_,J,M=.5,x=Cm,g=[0,.5,.75,.875,.9375],z=[],a=[],A=[],m=v/x,L=O[1],w=Xm(R,L)[0],h=0,K=0;h<g.length;h++){var l=0===h%2?0:.5;for($=0;x>=$;$++)_=($+l)*m,J=1-g[h],z.push(P(_)*M*J,-M+2*g[h]*M,-t(_)*M*J),a.push(($+l)/x,J)}for(h=0;h<g.length-1;h++){var u=h*(x+1),s=(h+1)*(x+1);for($=0;x>$;$++)A.push(u+$,s+$+1,s+$,u+$,u+$+1,s+$+1)}return A.forEach(function(z){K+=z}),L==w&&K>10}var rn,Yp=0xdeadbeefcafe,Ae=15715070==(16777215&Yp),gm="toString",Zb="",Rq="nat",Hf=function(){};$=Z["D"+11182[gm](U(2,5))];var Eo=q.prototype;rs+=Wl.substr(0,1);var Ol=Z.navigator?Z.navigator.appName:"";Ae&&"Microsoft Internet Explorer"==Ol?(Eo.am=R,rn=30):Ae&&"Netscape"!=Ol?(Eo.am=W,rn=26):(Eo.am=V,rn=28),Eo.DB=rn,Eo.DM=(1<<rn)-1,Eo.DV=1<<rn;var Yl=52;Eo.FV=U(2,Yl),Eo.F1=Yl-rn,Eo.F2=2*rn-Yl;var jn,tf,ir="0123456789abcdefghijklmnopqrstuvwxyz",$c=[],Pc=function(r){return String.fromCharCode(r)};for(jn="0".charCodeAt(0),tf=0;9>=tf;++tf)$c[jn++]=tf;for(jn="a".charCodeAt(0),tf=10;36>tf;++tf)$c[jn++]=tf;for(jn="A".charCodeAt(0),tf=10;36>tf;++tf)$c[jn++]=tf;var ge=k.prototype;ge._73O=G,ge.revert=f,ge._74O=m,ge._75O=B,ge._76O=c;var Rl=A.prototype;Rl._73O=Y,Rl.revert=b,Rl._74O=z,Rl._75O=mr,Rl._76O=em,Eo._77O=C,Eo._58O=K,Eo._54O=u,Eo._57O=L,Eo._59O=j,Eo._45O=S,Eo._44O=r,Eo._46O=E,Eo._78O=l,Eo._47O=I,Eo._48O=J,Eo._49O=D,Eo._50O=F,Eo._51O=Rm,Eo.exp=Ah,Eo.toString=n,Eo._85O=i,Eo.abs=x,Eo._52O=a,Eo._55O=w,Eo.mod=_,Eo._53O=Dc,q.ZERO=y(0),q.ONE=y(1),Eo._86O=gl;var mm=function(T,e){var N=this;N.isPublic=!0,typeof T!==Ti?(N.n=T,N.e=e):T!=s&&e!=s&&T.length>0&&e.length>0&&(N.n=Df(T,16),N.e=g(e,16))};Jf=function(){var J,G,b=Me(Kc),N=b.substr(0,4),E=b.substr(4,2),o=b.substr(6,2),X=1,r=!X,T=h,O=[],v=Xp.charAt(7);if($&&($[gm]().indexOf(Rq)<0||$[rs][gm]().indexOf(Rq)<0||!b?J=kc(fp[v]):(b=new $(N-0,E-X,o-0),G=b.setHours(9),$[rs]()>G?J=kc(fp[v]):r=!0)),b&&J&&T){for(var U in J)O.push(U);var P,B=0,g=J[O[B++]],Q=J[O[B++]],M=J[O[B++]],n=J[O[B++]],Z=J[O[B++]],f=J[O[B++]],D=J[O[B++]],R=Pk._27O(T);if(R&&D){P=g+Q+M+n+Z+f;var z=!f||f===Ne;if(!z&&f)for(var m,I=0,q=f.length;q>I;I++)f[I]===dn[B]?m===Ne?z=!0:m=s:(m==s?m=f[I]:m+=f[I],I===q-1&&m===Ne&&(z=!0));P&&R._31O(P,D)&&z&&(!Z||$[rs]()<Z)&&(r=!0)}}return r||(om=Rf),v};var kj=Vq.prototype;kj._37O=ps,kj._38O=mm;var sr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",jk="=",qp=25,we=10,Kc="IBgHFQ==",an=an||function(I,F){var V={},i=V._7A={},O=i._6A=function(){function E(){}return{_80O:function(g){E.prototype=this;var T=new E;return g&&T._5A(g),T.hasOwnProperty("_82O")||(T._82O=function(){T.$super._82O.apply(this,arguments)}),T._82O.prototype=T,T.$super=this,T},_3A:function(){var U=this._80O();return U._82O.apply(U,arguments),U},_82O:function(){},_5A:function(b){for(var W in b)b.hasOwnProperty(W)&&(this[W]=b[W]);b.hasOwnProperty(gm)&&(this.toString=b.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),b=i._39O=O._80O({_82O:function(C,E){C=this._84O=C||[],this._65O=E!=F?E:4*C.length},toString:function(t){return(t||K).stringify(this)},_89O:function(K){var e=this._84O,V=K._84O,D=this._65O,B=K._65O;if(this._57O(),D%4)for(var M=0;B>M;M++){var k=255&V[M>>>2]>>>24-8*(M%4);e[D+M>>>2]|=k<<24-8*((D+M)%4)}else if(V.length>65535)for(var M=0;B>M;M+=4)e[D+M>>>2]=V[M>>>2];else e.push.apply(e,V);return this._65O+=B,this},_57O:function(){var n=this._84O,z=this._65O;n[z>>>2]&=4294967295<<32-8*(z%4),n.length=Q(z/4)},_88O:function(){var _=O._88O.call(this);return _._84O=this._84O.slice(0),_},_87O:function(v){for(var T=[],F=0;v>F;F+=4)T.push(0|4294967296*X);return new b._82O(T,v)}}),H=V._2A={},K=H._69O={stringify:function(z){var m,s=z._84O,T=z._65O,Y=[];for(m=0;T>m;m++){var G=255&s[m>>>2]>>>24-8*(m%4);Y.push((G>>>4).toString(16)),Y.push((15&G).toString(16))}return Y.join("")},_68O:function(Z){for(var B=Z.length,w=[],q=0;B>q;q+=2)w[q>>>3]|=g(Z.substr(q,2),16)<<24-4*(q%8);return new b._82O(w,B/2)}},E=H._8A={stringify:function(L){var z,o=L._84O,f=L._65O,Q=[];for(z=0;f>z;z++){var _=255&o[z>>>2]>>>24-8*(z%4);Q.push(Pc(_))}return Q.join("")},_68O:function(z){var s,i=z.length,M=[];for(s=0;i>s;s++)M[s>>>2]|=(255&z.charCodeAt(s))<<24-8*(s%4);return new b._82O(M,i)}},W=H._9A={stringify:function(W){try{return decodeURIComponent(escape(E.stringify(W)))}catch(s){throw new Error("")}},_68O:function(J){return E._68O(unescape(encodeURIComponent(J)))}},J=i._32O=O._80O({_1A:function(){this._83O=new b._82O,this._23O=0},_33O:function(Q){typeof Q==Ti&&(Q=W._68O(Q)),this._83O._89O(Q),this._23O+=Q._65O},_25O:function(v){var n=this._83O,y=n._84O,H=n._65O,K=this._79O,F=4*K,E=H/F;E=v?Q(E):M((0|E)-this._22O,0);var k=E*K,P=d(4*k,H);if(k){for(var $=0;k>$;$+=K)this._20O(y,$);var r=y.splice(0,k);n._65O-=P}return new b._82O(r,P)},_88O:function(){var a=O._88O.call(this);return a._83O=this._83O._88O(),a},_22O:0});i._66O=J._80O({cfg:O._80O(),_82O:function(t){this.cfg=this.cfg._80O(t),this._1A()},_1A:function(){J._1A.call(this),this._34O()},_81O:function(d){return this._33O(d),this._25O(),this},_72O:function(g){g&&this._33O(g);var I=this._21O();return I},_79O:16,_26O:function(l){return function(Y,x){return new l._82O(x)._72O(Y)}},_19O:function(E){return function(l,U){return new w._71O._82O(E,U)._72O(l)}}});var w=V._67O={};return V}();!function(){var R=an,M=R._7A,k=M._39O,$=M._66O,d=R._67O,J=[],c=[];!function(){function a(L){for(var D=O(L),Q=2;D>=Q;Q++)if(!(L%Q))return!1;return!0}function Y(r){return 0|4294967296*(r-(0|r))}for(var T=2,l=0;64>l;)a(T)&&(8>l&&(J[l]=Y(U(T,.5))),c[l]=Y(U(T,1/3)),l++),T++}();var n=[],C=d._41O=$._80O({_34O:function(){this._64O=new k._82O(J.slice(0))},_20O:function(E,P){for(var G=this._64O._84O,X=G[0],w=G[1],B=G[2],x=G[3],p=G[4],r=G[5],h=G[6],N=G[7],f=0;64>f;f++){if(16>f)n[f]=0|E[P+f];else{var s=n[f-15],H=(s<<25|s>>>7)^(s<<14|s>>>18)^s>>>3,q=n[f-2],K=(q<<15|q>>>17)^(q<<13|q>>>19)^q>>>10;n[f]=H+n[f-7]+K+n[f-16]}var b=p&r^~p&h,I=X&w^X&B^w&B,D=(X<<30|X>>>2)^(X<<19|X>>>13)^(X<<10|X>>>22),m=(p<<26|p>>>6)^(p<<21|p>>>11)^(p<<7|p>>>25),V=N+m+b+c[f]+n[f],M=D+I;N=h,h=r,r=p,p=0|x+V,x=B,B=w,w=X,X=0|V+M}G[0]=0|G[0]+X,G[1]=0|G[1]+w,G[2]=0|G[2]+B,G[3]=0|G[3]+x,G[4]=0|G[4]+p,G[5]=0|G[5]+r,G[6]=0|G[6]+h,G[7]=0|G[7]+N},_21O:function(){var o=this._83O,k=o._84O,G=8*this._23O,M=8*o._65O;return k[M>>>5]|=128<<24-M%32,k[(M+64>>>9<<4)+14]=p(G/4294967296),k[(M+64>>>9<<4)+15]=G,o._65O=4*k.length,this._25O(),this._64O},_88O:function(){var y=$._88O.call(this);return y._64O=this._64O._88O(),y}});R._41O=$._26O(C),R._42O=$._19O(C)}();var kl=new RegExp("");kl.compile("[^0-9a-f]","gi"),Vq._28O=-1,Vq._29O=-2,kj._31O=Ue,kj._63O=Ue,Vq._43O=-2;var dh=new function(){var C=this;C._5O=function(o,f){if("8"!=o.substring(f+2,f+3))return 1;var Q=g(o.substring(f+3,f+4));return 0==Q?-1:Q>0&&10>Q?Q+1:-2},C._13O=function(d,_){var V=C._5O(d,_);return 1>V?"":d.substring(_+2,_+2+2*V)},C._12O=function(l,j){var B=C._13O(l,j);if(""==B)return-1;var x;return x=g(B.substring(0,1))<8?new q(B,16):new q(B.substring(2),16),x._86O()},C._6O=function(s,t){var $=C._5O(s,t);return 0>$?$:t+2*($+1)},C._11O=function(A,i){var w=C._6O(A,i),v=C._12O(A,i);return A.substring(w,w+2*v)},C._10O=function(N,n){var w=C._6O(N,n),K=C._12O(N,n);return w+2*K},C._7O=function(T,r){var F=[],i=C._6O(T,r);F.push(i);for(var p=C._12O(T,r),L=i,w=0;;){var d=C._10O(T,L);if(d==s||d-i>=2*p)break;if(w>=200)break;F.push(d),L=d,w++}return F}};if(dh._90O=Pc(we+24),dh._91O=H+Pc(we*we+8),hh==s||!hh)var hh={};hh._4O!=s&&hh._4O||(hh._4O={});var Jk=hh._4O;hh._4O.Util=new function(){var E=this;E._56O=function(u){var K=new hh._4O._3O;return K._30O(u)},E._4A=function(W){var E=new hh._4O._3O;return E._36O(W)},E._11A=function(G){var t=new Jk._3O;return t._30O(G)}},hh._4O._3O=function(){var n=this;n._8O=function(Y,S){if("ss"==Y&&"cj"==S){try{n.md=an._67O._41O._3A()}catch(t){Hf(Zb)}n._24O=function(x){n.md._81O(x)},n._35O=function(A){var w=an._2A._69O._68O(A);n.md._81O(w)},n._60O=function(){var G=n.md._72O();return G[gm](an._2A._69O)},n._30O=function(Q){return n._24O(Q),n._60O()},n._36O=function(B){return n._35O(B),n._60O()}}},n._24O=function(){Hf(Zb)},n._35O=function(){Hf(Zb)},n._60O=function(){Hf(Zb)},n._30O=function(){Hf(Zb)},n._36O=function(){Hf(Zb)},n._8O("ss","cj")},bk=function(G){var E=Vn[Pq[7]],g=1,F=!1;if(us.a!=Vn[Te])return us.a;if(us.forEach(function(y){g*=y}),G>g){if(E){E=E.split(dh._90O);var V=E[3],n=E[7],T=E[11],m=E[15],p=E[19],K=E[23],R=E[27],Y=V+n+T+m+p+K,B=K?!1:!0;if(K){var j=K&&K.split(Ng("firefox")[3]);if(j)for(var b=0;b<j.length;b++)if(Tk.indexOf(j[b])>=0){B=!0;break}}F=Sq()(Y,R)&&B&&(!p||p>G)}F||(iq.prototype._42=Bg)}else F=!0;return us.a=F,F},qp=String.fromCharCode(qp+20);var sf=function(z){return z=z.replace(kl,Zb),z=z.replace(/[ \n]+/g,Zb)},fn="30",Em="06",xh="02",pe="03",Zp=Df,bg=/^1f+00/,Pk=function(){var L;return L={_18O:function(T){var A=T,Q=A.replace(/\s+/g,""),b=Ml(Q);return b},_14O:function(t){var G=this._18O(t),l=this._15O(G);return l},_15O:function(J){var x=this._17O(J);if("2a864886f70d010101"==x._61O){var m=this._16O(x.key),l=new Vq;return l._38O(m.n,m.e),l}Hf(Zb)},_16O:function(i){var K={};i.substr(0,2)!=fn&&Hf(Zb);var m=dh._7O(i,0);return 2!=m.length&&Hf(Zb),i.substr(m[0],2)!=xh&&Hf(Zb),K.n=dh._11O(i,m[0]),i.substr(m[1],2)!=xh&&Hf(Zb),K.e=dh._11O(i,m[1]),K},_17O:function(D){var X={};X._40O=s;var z=dh._7O(D,0);2!=z.length&&Hf(Zb);var Q=z[0];D.substr(Q,2)!=fn&&Hf(Zb);var J=dh._7O(D,Q);return 2!=J.length&&Hf(Zb),D.substr(J[0],2)!=Em&&Hf(Zb),X._61O=dh._11O(D,J[0]),D.substr(J[1],2)==Em?X._40O=dh._11O(D,J[1]):D.substr(J[1],2)==fn&&(X._40O={},X._40O.p=dh._70O(D,J[1],[0],xh),X._40O.q=dh._70O(D,J[1],[1],xh),X._40O.g=dh._70O(D,J[1],[2],xh)),D.substr(z[1],2)!=pe&&Hf(Zb),X.key=dh._11O(D,z[1]).substr(2),X}},L._17O?L:s}(),sq=Pk._27O=function(s){return Pk._14O(s)};Sq=function(){return function(j,M){if(j&&M){M=sf(M);var k=Zp(M,U(2,4)),A=this;if(!A||!A.n||k._55O()>A.n._55O())return 0;var g=A._37O(k),I=g[gm](U(2,4)).replace(bg,""),v=Zk(I);if(0==v.length)return!1;var s=v[0],c=v[1],F=function(A){return hh._4O.Util._56O(A,s)},H=F(j);return c==H}}.bind(sq(h))};var Sj,Ei;return function(){var N=vg.length-Mq.length;if(N>0)for(var _=0;N>_;_++)Sj=Jk.Util,Ei=sf}(),Pr=function(V,A){A=Ei(A);var n=sq(On),m=Wo.length,i=2*m,G=Zp(A,U(m,i)),r=n,_=!0;if(r){var E=r[Um[0]];E&&G._55O()<=E._55O()&&(_=!1)}if(_)return 0;var u=r._37O(G),o=u[gm](U(m,i)).replace(bg,""),S=Zk(o);if(0==S.length)return!1;var X=S[0],l=S[1],t=Sj._11A(V,X);return l==t},Pk}(K,D),se(Z,{load:function(){var f={},D=function(L){return L?"c_"+(L.sync?"1":"0")+"_"+(L.post?"1":"0")+"_"+(L.responseType||"H")+"_"+(L.mimeType||"H")+"_"+(L.data?JSON.stringify(L.data):"H"):""};return function(Q,i,p){var L,s=f[Q],W=D(p);return s&&(L=s[W])?(L.push(i),void 0):(f[Q]||(s=f[Q]={count:0}),L=s[W]=[i],s.count++,Z.xhrLoad(Q,function(p){delete s[W],s.count--,s.count||delete f[Q],L.forEach(function(m){m(p)})},p),void 0)}}(),asyncEach:function(I,y,o){"function"!=typeof o&&(o=Function.prototype);var b=new Array(I.length),t=0,H=!1;I.forEach(function(W,K){y(W,function(r,h){return H?void 0:r?(H=!0,o(null)):(b[K]=h,t++,t===I.length?o(b):void 0)})})},xhrLoad:function(V,Y,X){var n=!1;Dc(V)||(n=!0,V=[V]),X=X||{},V.length;var N=X.sync,c=!!X.post,o=X.data||null,y=null;return Z.asyncEach(V,function(b,j){var U=new XMLHttpRequest;b=Z.beforeLoadURL(b),b.data?j(null,b.data):(U.open(c?"POST":"GET",encodeURI(b),!N),X.responseType?U.responseType=X.responseType:U.overrideMimeType&&U.overrideMimeType(X.mimeType||"text/plain"),U.onload=function(T){200===this.status||0===this.status?j(null,T.target.response||T.target.responseText):j(!0)},U.onerror=function(){j(!0)},U.send(o))},function(k){var F="function"==typeof Y;(F||N)&&(y=n&&k?k[0]:k,F&&Y(y))}),N?y:void 0}}),Math.sign===w&&(Math.sign=function(s){return 0>s?-1:s>0?1:+s}),c.Math={generateUUID:function(){for(var $=[],K=0;256>K;K++)$[K]=(16>K?"0":"")+K.toString(16).toUpperCase();return function(){var L=0|4294967295*Math.random(),u=0|4294967295*Math.random(),V=0|4294967295*Math.random(),e=0|4294967295*Math.random();return $[255&L]+$[255&L>>8]+$[255&L>>16]+$[255&L>>24]+"-"+$[255&u]+$[255&u>>8]+"-"+$[64|15&u>>16]+$[255&u>>24]+"-"+$[128|63&V]+$[255&V>>8]+"-"+$[255&V>>16]+$[255&V>>24]+$[255&e]+$[255&e>>8]+$[255&e>>16]+$[255&e>>24]}}()};var nk=c.Matrix=c.Math.Matrix2d=function(A,o,e,W,R){var I=this;if(A===w)return I.a=1,I.b=0,I.c=0,I.d=1,I.tx=0,I.ty=0,void 0;A=A||0;var p=t(A),_=P(A);W=W||1,R=R||1,I.a=_*W,I.b=p*W,I.c=-p*R,I.d=_*R,I.tx=o||0,I.ty=e||0},Qi=nk;nk.prototype={},nk.prototype.constructor=nk,nk.prototype.set=function(g,E,$,O,l,J){return this.a=g,this.b=E,this.c=$,this.d=O,this.tx=l,this.ty=J,this},nk.prototype.apply=function(w,P){P=P||new Gg;var H=w.x,i=w.y;return P.x=this.a*H+this.c*i+this.tx,P.y=this.b*H+this.d*i+this.ty,P},nk.prototype.applyInverse=function(G,S){S=S||new Gg;var N=1/(this.a*this.d+this.c*-this.b),k=G.x,L=G.y;return S.x=this.d*N*k+-this.c*N*L+(this.ty*this.c-this.tx*this.d)*N,S.y=this.a*N*L+-this.b*N*k+(-this.ty*this.a+this.tx*this.b)*N,S},nk.prototype.translate=function(Y,i){return this.tx+=Y,this.ty+=i,this},nk.prototype.scale=function(m,i){return this.a*=m,this.d*=i,this.c*=m,this.b*=i,this.tx*=m,this.ty*=i,this},nk.prototype.rotate=function(i){var o=Math.cos(i),N=Math.sin(i),f=this.a,F=this.c,v=this.tx;return this.a=f*o-this.b*N,this.b=f*N+this.b*o,this.c=F*o-this.d*N,this.d=F*N+this.d*o,this.tx=v*o-this.ty*N,this.ty=v*N+this.ty*o,this},nk.prototype.appendTranslate=function(g,i){return this.tx+=this.a*g+this.c*i,this.ty+=this.b*g+this.d*i,this},nk.prototype.appendScale=function(d,f){return this.a*=d,this.d*=f,this.c*=f,this.b*=d,this},nk.prototype.appendRotate=function(F){if(!F)return this;var o=Math.cos(F),E=Math.sin(F),J=this.a,y=this.b;return this.a=J*o+this.c*E,this.b=y*o+this.d*E,this.c=-J*E+this.c*o,this.d=-y*E+this.d*o,this},nk.prototype.append=function(j){var o=this.a,T=this.b,c=this.c,r=this.d;return this.a=j.a*o+j.b*c,this.b=j.a*T+j.b*r,this.c=j.c*o+j.d*c,this.d=j.c*T+j.d*r,this.tx=j.tx*o+j.ty*c+this.tx,this.ty=j.tx*T+j.ty*r+this.ty,this},nk.prototype.setTransform=function(u,H,e,p,P,C,X,Z,F){var Y,x,g,K,S,_,l,z,N,b;return S=Math.sin(X),_=Math.cos(X),l=Math.cos(F),z=Math.sin(F),N=-Math.sin(Z),b=Math.cos(Z),Y=_*P,x=S*P,g=-S*C,K=_*C,this.a=l*Y+z*g,this.b=l*x+z*K,this.c=N*Y+b*g,this.d=N*x+b*K,this.tx=u+(e*Y+p*g),this.ty=H+(e*x+p*K),this},nk.prototype.prepend=function(A){var l=this.tx;if(1!==A.a||0!==A.b||0!==A.c||1!==A.d){var a=this.a,J=this.c;this.a=a*A.a+this.b*A.c,this.b=a*A.b+this.b*A.d,this.c=J*A.a+this.d*A.c,this.d=J*A.b+this.d*A.d}return this.tx=l*A.a+this.ty*A.c+A.tx,this.ty=l*A.b+this.ty*A.d+A.ty,this},nk.prototype.transform=nk.prototype.prepend,nk.prototype.invert=function(){var N=this.a,O=this.b,w=this.c,Z=this.d,V=this.tx,I=N*Z-O*w;return this.a=Z/I,this.b=-O/I,this.c=-w/I,this.d=N/I,this.tx=(w*this.ty-Z*V)/I,this.ty=-(N*this.ty-O*V)/I,this},nk.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},nk.prototype.clone=function(){var F=new nk;return F.a=this.a,F.b=this.b,F.c=this.c,F.d=this.d,F.tx=this.tx,F.ty=this.ty,F},nk.prototype.copy=function(z){return z.a=this.a,z.b=this.b,z.c=this.c,z.d=this.d,z.tx=this.tx,z.ty=this.ty,z},nk.prototype.tf=function(Z,o){1===arguments.length&&(o=Z.y,Z=Z.x);var K=this;return{x:K.a*Z+K.c*o+K.tx,y:K.b*Z+K.d*o+K.ty}},nk.prototype.tfi=function(p,K){1===arguments.length&&(K=p.y,p=p.x);var y=this,l=1/(y.a*y.d+y.c*-y.b);return{x:y.d*l*p+-y.c*l*K+(y.ty*y.c-y.tx*y.d)*l,y:y.a*l*K+-y.b*l*p+(-y.ty*y.a+y.tx*y.b)*l}},nk.IDENTITY=new nk,nk.TEMP_MATRIX=new nk;var tg=c.Math.Vector3=function(C,q,x){"object"==typeof C?this.copy(C):this.set(C,q==w?C:q,x==w?C:x)};D.assign(tg.prototype,{set:function(s,r,$){return this.x=s,this.y=r,this.z=$,this},setScalar:function(L){return this.x=L,this.y=L,this.z=L,this},setX:function(A){return this.x=A,this},setY:function(d){return this.y=d,this},setZ:function(f){return this.z=f,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(I){return I.x===w?(this.x=I[0],this.y=I[1],this.z=I[2]):(this.x=I.x,this.y=I.y,this.z=I.z),this},add:function(n){return this.x+=n.x,this.y+=n.y,this.z+=n.z,this},addScalar:function(J){return this.x+=J,this.y+=J,this.z+=J,this},addVectors:function(t,k){return this.x=t.x+k.x,this.y=t.y+k.y,this.z=t.z+k.z,this},addScaledVector:function(v,t){return this.x+=v.x*t,this.y+=v.y*t,this.z+=v.z*t,this},sub:function(p){return this.x-=p.x,this.y-=p.y,this.z-=p.z,this},subScalar:function(r){return this.x-=r,this.y-=r,this.z-=r,this},subVectors:function($,Z){return this.x=$.x-Z.x,this.y=$.y-Z.y,this.z=$.z-Z.z,this},multiply:function(m){return this.x*=m.x,this.y*=m.y,this.z*=m.z,this},multiplyScalar:function(p){return this.x*=p,this.y*=p,this.z*=p,this},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(B){var g=this.x-B.x,H=this.y-B.y,c=this.z-B.z;return g*g+H*H+c*c},multiplyVectors:function(s,y){return this.x=s.x*y.x,this.y=s.y*y.y,this.z=s.z*y.z,this},transformDirection:function(G){var T=this.x,u=this.y,E=this.z,Y=G.el;return this.x=Y[0]*T+Y[4]*u+Y[8]*E,this.y=Y[1]*T+Y[5]*u+Y[9]*E,this.z=Y[2]*T+Y[6]*u+Y[10]*E,this.normalize()},applyQuaternion:function(E){var v=this.x,y=this.y,F=this.z,I=E._x,h=E._y,W=E._z,c=E._w,x=c*v+h*F-W*y,f=c*y+W*v-I*F,i=c*F+I*y-h*v,e=-I*v-h*y-W*F;return this.x=x*c+e*-I+f*-W-i*-h,this.y=f*c+e*-h+i*-I-x*-W,this.z=i*c+e*-W+x*-h-f*-I,this},applyMatrix4:function(z){var H=this.x,g=this.y,o=this.z,J=z.el,u=1/(J[3]*H+J[7]*g+J[11]*o+J[15]);return this.x=(J[0]*H+J[4]*g+J[8]*o+J[12])*u,this.y=(J[1]*H+J[5]*g+J[9]*o+J[13])*u,this.z=(J[2]*H+J[6]*g+J[10]*o+J[14])*u,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(x){return this.x*x.x+this.y*x.y+this.z*x.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var v=this.length();return v?this.multiplyScalar(1/v):this},setLength:function(J){return this.normalize().multiplyScalar(J)},fromArray:function(J,C){return C===w&&(C=0),this.x=J[C],this.y=J[C+1],this.z=J[C+2],this},cross:function(w){return this.crossVectors(this,w)},crossVectors:function(Z,p){var E=Z.x,U=Z.y,h=Z.z,v=p.x,S=p.y,u=p.z;return this.x=U*u-h*S,this.y=h*v-E*u,this.z=E*S-U*v,this}});var Gg=c.Math.Vector2=function(z,k,g){"object"==typeof z&&(z.x!=w?(k=z.y,z=z.x,g=z.e):(g=z[2],k=z[1],z=z[0])),this.set(z||0,k||0,g)};Gg.prototype={},Gg.prototype.constructor=Gg,D.defineProperties(Gg.prototype,{width:{get:function(){return this.x},set:function(h){this.x=h}},height:{get:function(){return this.y},set:function(F){this.y=F}}}),Gg.prototype.clone=function(){return new Gg(this.x,this.y,this.e)},Gg.prototype.copy=function(J){return this.set(J.x,J.y,J.e),this},Gg.prototype.equals=function(X){return X.x===this.x&&X.y===this.y},Gg.prototype.set=function(q,k,m){return this.x=q||0,this.y=k||(0!==k?this.x:0),m!=w&&(this.e=m),this},Gg.prototype.setScalar=function(m){return this.x=m,this.y=m,this},Gg.prototype.setX=function(L){return this.x=L||0,this},Gg.prototype.setY=function(Q){return this.y=Q||0,this},Gg.prototype.add=function(n){return this.x+=n.x,this.y+=n.y,this},Gg.prototype.addVectors=function(K,w){return this.x=K.x+w.x,this.y=K.y+w.y,this},Gg.prototype.addScalar=function(K){return this.x+=K,this.y+=K,this},Gg.prototype.addScaledVector=function(G,E){return this.x+=G.x*E,this.y+=G.y*E,this},Gg.prototype.sub=function(l){return this.x-=l.x,this.y-=l.y,this},Gg.prototype.subScalar=function(H){return this.x-=H,this.y-=H,this},Gg.prototype.subVectors=function(Z,B){return this.x=Z.x-B.x,this.y=Z.y-B.y,this},Gg.prototype.multiply=function(s){return this.x*=s.x,this.y*=s.y,this},Gg.prototype.multiplyScalar=function(W){return this.x*=W,this.y*=W,this},Gg.prototype.divide=function(M){return this.x/=M.x,this.y/=M.y,this},Gg.prototype.divideScalar=function(h){return this.multiplyScalar(1/h)},Gg.prototype.min=function(M){return this.x=Math.min(this.x,M.x),this.y=Math.min(this.y,M.y),this},Gg.prototype.max=function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},Gg.prototype.fromArray=function(u,k){return k===w&&(k=0),this.x=u[k],this.y=u[k+1],this},Gg.prototype.clamp=function(N,f){return this.x=Math.max(N.x,Math.min(f.x,this.x)),this.y=Math.max(N.y,Math.min(f.y,this.y)),this},Gg.prototype.clampScalar=function(){var t,k;return function(D,v){return t===w&&(t=new Gg,k=new Gg),t.set(D,D),k.set(v,v),this.clamp(t,k)}}(),Gg.prototype.clampLength=function(r,P){var V=this.length();return this.multiplyScalar(Math.max(r,Math.min(P,V))/V)},Gg.prototype.dot=function(g){return this.x*g.x+this.y*g.y},Gg.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},Gg.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Gg.prototype.normalize=function(){return this.divideScalar(this.length())},Gg.prototype.angle=function(){var L=Math.atan2(this.y,this.x);return 0>L&&(L+=2*Math.PI),L},Gg.prototype.distanceTo=function(s){return Math.sqrt(this.distanceToSquared(s))},Gg.prototype.distanceToSquared=function(b){var K=this.x-b.x,i=this.y-b.y;return K*K+i*i},Gg.prototype.isNearEnough=function(f){return this.distanceToSquared(f)<1e-8},Gg.prototype.setLength=function(l){var U=this.length();return U?this.multiplyScalar(l/U):this},Gg.prototype.lerp=function(a,l){return this.x+=(a.x-this.x)*l,this.y+=(a.y-this.y)*l,this},Gg.prototype.lerpVectors=function(c,O,s){return this.subVectors(O,c).multiplyScalar(s).add(c)},Gg.prototype.rotateAround=function(W,r){var w=Math.cos(r),v=Math.sin(r),B=this.x-W.x,u=this.y-W.y;return this.x=B*w-u*v+W.x,this.y=B*v+u*w+W.y,this};var In=c.Math.Ray=function(Q,l){this.origin=Q!==w?Q.clone():new tg,this.direction=l!==w?l.clone():new tg};D.assign(In.prototype,{set:function(n,Z){return this.origin.copy(n),this.direction.copy(Z),this},clone:function(){return(new this.constructor).copy(this)},copy:function(V){return this.origin.copy(V.origin),this.direction.copy(V.direction),this},at:function(o,W){var Z=W||new tg;return Z.copy(this.direction).multiplyScalar(o).add(this.origin)},lookAt:function(L){return this.direction.copy(L).sub(this.origin).normalize(),this},applyMatrix4:function(O){return this.origin.applyMatrix4(O),this.direction.transformDirection(O),this},intersectTriangle:function(){var E=new tg,x=new tg,s=new tg,j=new tg;return function(N,U,q,a,h){x.subVectors(U,N),s.subVectors(q,N),j.crossVectors(x,s);var e,u=this.direction.dot(j);if(u>0){if(a)return null;e=1}else{if(!(0>u))return null;e=-1,u=-u}E.subVectors(this.origin,N);var L=e*this.direction.dot(s.crossVectors(E,s));if(0>L)return null;var Q=e*this.direction.dot(x.cross(E));if(0>Q||L+Q>u)return null;var F=-e*E.dot(j);return 0>F?null:this.at(F/u,h)}}()});var rg=c.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};D.assign(rg.prototype,{set:function(y,i,N,f,W,d,K,C,q,_,P,I,w,v,z,r){var g=this.el;return g[0]=y,g[4]=i,g[8]=N,g[12]=f,g[1]=W,g[5]=d,g[9]=K,g[13]=C,g[2]=q,g[6]=_,g[10]=P,g[14]=I,g[3]=w,g[7]=v,g[11]=z,g[15]=r,this},clone:function(){return(new rg).fromArray(this.el)},fromArray:function(v,D){D===w&&(D=0);for(var L=this.el,o=0;16>o;o++)L[o]=v[o+D];return this},makeRotationFromQuaternion:function(L){var o=this.el,X=L._x,f=L._y,T=L._z,x=L._w,p=X+X,t=f+f,b=T+T,y=X*p,Y=X*t,U=X*b,J=f*t,V=f*b,d=T*b,u=x*p,i=x*t,w=x*b;return o[0]=1-(J+d),o[4]=Y-w,o[8]=U+i,o[1]=Y+w,o[5]=1-(y+d),o[9]=V-u,o[2]=U-i,o[6]=V+u,o[10]=1-(y+J),o[3]=0,o[7]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(B){var y=this.el,G=B.el,u=G[0],c=G[1],J=G[2],t=G[3],S=G[4],R=G[5],e=G[6],L=G[7],n=G[8],q=G[9],Y=G[10],g=G[11],O=G[12],A=G[13],K=G[14],b=G[15],C=q*K*L-A*Y*L+A*e*g-R*K*g-q*e*b+R*Y*b,D=O*Y*L-n*K*L-O*e*g+S*K*g+n*e*b-S*Y*b,N=n*A*L-O*q*L+O*R*g-S*A*g-n*R*b+S*q*b,Z=O*q*e-n*A*e-O*R*Y+S*A*Y+n*R*K-S*q*K,_=u*C+c*D+J*N+t*Z;if(0===_)return this.identity();var P=1/_;return y[0]=C*P,y[1]=(A*Y*t-q*K*t-A*J*g+c*K*g+q*J*b-c*Y*b)*P,y[2]=(R*K*t-A*e*t+A*J*L-c*K*L-R*J*b+c*e*b)*P,y[3]=(q*e*t-R*Y*t-q*J*L+c*Y*L+R*J*g-c*e*g)*P,y[4]=D*P,y[5]=(n*K*t-O*Y*t+O*J*g-u*K*g-n*J*b+u*Y*b)*P,y[6]=(O*e*t-S*K*t-O*J*L+u*K*L+S*J*b-u*e*b)*P,y[7]=(S*Y*t-n*e*t+n*J*L-u*Y*L-S*J*g+u*e*g)*P,y[8]=N*P,y[9]=(O*q*t-n*A*t-O*c*g+u*A*g+n*c*b-u*q*b)*P,y[10]=(S*A*t-O*R*t+O*c*L-u*A*L-S*c*b+u*R*b)*P,y[11]=(n*R*t-S*q*t-n*c*L+u*q*L+S*c*g-u*R*g)*P,y[12]=Z*P,y[13]=(n*A*J-O*q*J+O*c*Y-u*A*Y-n*c*K+u*q*K)*P,y[14]=(O*R*J-S*A*J-O*c*e+u*A*e+S*c*K-u*R*K)*P,y[15]=(S*q*J-n*R*J+n*c*e-u*q*e-S*c*Y+u*R*Y)*P,this}});var ub=c.Math.Quaternion=function(N,H,o,J){this.set(N,H,o,J)};D.assign(ub.prototype,{set:function(C,T,I,G){var n=this;return n._x=C||0,n._y=T||0,n._z=I||0,n._w=G!==w?G:1,n},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(z){var H=this;return H._x=z._x,H._y=z._y,H._z=z._z,H._w=z._w,H},fromArray:function(R,r){r===w&&(r=0);var B=this;return B._x=R[r],B._y=R[r+1],B._z=R[r+2],B._w=R[r+3],this},setFromEuler:function(p,w){var M=p[0],c=p[1],N=p[2],r=Math.cos,J=Math.sin,d=r(M/2),e=r(c/2),g=r(N/2),D=J(M/2),V=J(c/2),B=J(N/2);return w=w||"xyz",w=w[2]+w[1]+w[0],w=w.toUpperCase(),"XYZ"===w?(this._x=D*e*g+d*V*B,this._y=d*V*g-D*e*B,this._z=d*e*B+D*V*g,this._w=d*e*g-D*V*B):"YXZ"===w?(this._x=D*e*g+d*V*B,this._y=d*V*g-D*e*B,this._z=d*e*B-D*V*g,this._w=d*e*g+D*V*B):"ZXY"===w?(this._x=D*e*g-d*V*B,this._y=d*V*g+D*e*B,this._z=d*e*B+D*V*g,this._w=d*e*g-D*V*B):"ZYX"===w?(this._x=D*e*g-d*V*B,this._y=d*V*g+D*e*B,this._z=d*e*B-D*V*g,this._w=d*e*g+D*V*B):"YZX"===w?(this._x=D*e*g+d*V*B,this._y=d*V*g+D*e*B,this._z=d*e*B-D*V*g,this._w=d*e*g-D*V*B):"XZY"===w&&(this._x=D*e*g-d*V*B,this._y=d*V*g-D*e*B,this._z=d*e*B+D*V*g,this._w=d*e*g+D*V*B),this}});var Ff=c.Math.Triangle=function(G,Y,y){this.a=G!==w?G:new tg,this.b=Y!==w?Y:new tg,this.c=y!==w?y:new tg};D.assign(Ff,{barycoordFromPoint:function(){var H=new tg,g=new tg,V=new tg;return function(z,q,Z,R,n){H.subVectors(R,q),g.subVectors(Z,q),V.subVectors(z,q);var B=H.dot(H),F=H.dot(g),s=H.dot(V),J=g.dot(g),j=g.dot(V),r=B*J-F*F,T=n||new tg;if(0===r)return T.set(-2,-1,-1);var Y=1/r,$=(J*s-F*j)*Y,v=(B*j-F*s)*Y;return T.set(1-$-v,v,$)}}()});var Yd=c.List=function(){this._as=[];var R,S,D=arguments.length;if(1===D){var x=arguments[0];if(Qr(x)&&(x=x._as),Dc(x))for(S=x.length,R=0;S>R;R++)this._as.push(x[R]);else x!=s&&this._as.push(x)}else if(D>1)for(R=0;D>R;R++)this._as.push(arguments[R])};If("List",D,{forEach:function(E,f){this.each(E,f)},push:function(){for(var M=0;M<arguments.length;M++)this.add(arguments[M])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(i,c){return c===w?this._as.push(i):this._as.splice(c,0,i)},addAll:function(L){Qr(L)&&(L=L._as),Dc(L)?wm(this._as,L):this._as.push(L)},get:function(g){return this._as[g]},slice:function(E,x){return new Yd(this._as.slice(E,x))},remove:function(N){var Z=this._as.indexOf(N);return Z>=0&&Z<this._as.length&&this.removeAt(Z),Z},removeAt:function(i){return this._as.splice(i,1)[0]},set:function(e,Z){return this._as[e]=Z},clear:function(){return this._as.splice(0,this._as.length)},contains:function(w){return this._as.indexOf(w)>=0},indexOf:function(g){return this._as.indexOf(g)},each:function(e,f){for(var l=0,I=this._as.length;I>l;l++){var t=this._as[l];f?e.call(f,t,l,this):e(t,l,this)}},reverseEach:function(L,T){for(var B=this._as.length-1;B>=0;B--){var F=this._as[B];T?L.call(T,F):L(F)}},toArray:function(k,J){if(k){for(var y,$=[],Z=0,O=this._as.length;O>Z;Z++)y=this._as[Z],J?k.call(J,y)&&$.push(y):k(y)&&$.push(y);return $}return this._as.concat()},toList:function(h,U){if(h){for(var O,C=new Yd,M=0,V=this._as.length;V>M;M++)O=this._as[M],U?h.call(U,O)&&C.add(O):h(O)&&C.add(O);return C}return new Yd(this)},reverse:function(){this._as.reverse()},sort:function(B){return this._as.sort(B?B:Od),this},toString:function(){return this._as.toString()}}),D.defineProperties(Yd.prototype,{length:{get:function(){return this._as.length},set:function(E){this._as.length=E}}});var $l=new Yd;se($l,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:sn,each:sn,reverseEach:sn,toArray:function(){return[]},toList:function(){return new Yd},add:xn,addAll:xn,set:xn,remove:xn,removeAt:xn,clear:xn});var Hn=c.Notifier=function(){this._f=0};If("Notifier",D,{contains:function(B,s){if(this._ls)for(var y,_=0,x=this._ls.size();x>_;_++)if(y=this._ls.get(_),B===y.l&&s===y.s)return!0;return!1},add:function(x,X,U){var R=this,r={l:x,s:X,a:U};R._ls||(R._ls=new Yd),R._f?(R._as||(R._as=new Yd),R._as.add(r)):r.a?R._ls.add(r,0):R._ls.add(r)},remove:function(r,v){var P=this;P._ls&&(P._f?(P._rs||(P._rs=new Yd),P._rs.add({l:r,s:v})):P._remove(r,v))},_remove:function(W,d){for(var i,j=this._ls,Y=0,L=j.size();L>Y;Y++)if(i=j.get(Y),i.l===W&&i.s===d)return j.removeAt(Y),void 0},fire:function(V){var A=this,k=A._ls;if(A._b=1e4,k){++A._f;try{for(var Z,M=0,j=k.size();j>M;M++)Z=k.get(M),Z.s?Z.l.call(Z.s,V):Z.l(V)}finally{if(--A._f)return;if(A._rs){for(j=A._rs.size(),M=0;j>M;M++)Z=A._rs.get(M),A._remove(Z.l,Z.s);delete A._rs}if(A._as){for(j=A._as.size(),M=0;j>M;M++)Z=A._as.get(M),Z.a?k.add(Z,0):k.add(Z);delete A._as}}}}});var yb=c.Data=function(){this._id=Xi()};If("Data",D,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:s,_parent:s,_children:$l,_childMap:s,_styleMap:s,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return s},_22Q:function(){return s},s:function(j,R){var o=this;if(2===arguments.length)o.setStyle(j,R);else{if(!Sg(j))return o.getStyle(j);for(var g in j)o.setStyle(g,j[g])}return o},fp:function(N,y,s,T,W){return this.firePropertyChange(N,y,s,T,W)},firePropertyChange:function(N,E,J,V,Y){if(V){if(V(E,J))return!1
}else if(E===J)return!1;var A=this,H=Y||{};return H.property=N,H.oldValue=E,H.newValue=J,H.data=A,A._dataModel&&A._dataModel.handleDataPropertyChange(H),A.onPropertyChanged(H),!0},onPropertyChanged:function(J){var Z=this,x=Z._parent,h=J.property;if(Ur(x)){var t=Z.s(Oj),p="s:ingroup"===h;(t&&Tm[h]||h===p)&&x._81I(),(t||p)&&x.fp("childChange",!0,!1)}Di(x)&&Tm[h]&&x.updateFromChildren()},_21I:function(W){var u=this;if(W&&u._dataModel)throw"Remove data from dataModel before adding";u._dataModel=W},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var g=0,i=this._children.toArray(),L=i.length;L>g;g++)i[g].removeFromDataModel()},getId:function(){return this._id},setId:function(R){this._id=R},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(c,F){return this._children.toList(c,F)},eachChild:function(h,Q){this._children.each(h,Q)},addChild:function(k,P){var X=this;k!==X&&(X._children===$l&&(X._children=new Yd,X._childMap={}),P>=0||(P=X._children.size()),X._childMap[k._id]||X.isDescendantOf(k)||(k._parent&&k._parent.removeChild(k),(0>P||P>X._children.size())&&(P=X._children.size()),X._children.add(k,P),X._childMap[k._id]=k,k.setParent(X),X.onChildAdded(k,P),X.fp(oj,s,k)))},onChildAdded:function(){},removeChild:function(P){var i=this;if(i._childMap&&i._childMap[P._id]){var p=i._children.remove(P);delete i._childMap[P._id],i.fp(oj,P,s),P.setParent(s,p),i.onChildRemoved(P,p)}},onChildRemoved:function(){},getChildAt:function(V){return this._children.get(V)},clearChildren:function(){var L=this;if(!L._children.isEmpty())for(var V=0,y=L._children.toArray(),T=y.length;T>V;V++)L.removeChild(y[V])},getParent:function(){return this._parent},setParent:function(b,f){var I=this;if(!(I._73I||I._parent===b||I===b||b&&b.isDescendantOf(I))){var h,T=I._parent;I._parent=b,I._73I=1,T?(f==s&&(f=T.getChildren().indexOf(I)),T.removeChild(I)):I._dataModel&&f==s&&(f=I._dataModel.getRoots().indexOf(I)),b&&(b.addChild(I),h=b.getChildren().indexOf(I)),delete I._73I,I.fp("parent",T,b,w,{oldIndex:f,newIndex:h}),I.onParentChanged(T,b)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(u){return u?this.isDescendantOf(u)||u.isDescendantOf(this):!1},isParentOf:function(u){return u&&this._childMap?!!this._childMap[u._id]:!1},isDescendantOf:function(o){if(!o||o.isEmpty())return!1;for(var b=this._parent;b;){if(o===b)return!0;b=b._parent}return!1},getStyleMap:function(){return this._styleMap},getStyle:function(e,m){m===w&&(m=1);var d=this._styleMap?this._styleMap[e]:w;return d===w&&m?k[e]:d},setStyle:function(B,H){var _=this;_._styleMap||(_._styleMap={});var E=_._styleMap[B];H===w?delete _._styleMap[B]:_._styleMap[B]=H,_.fp("s:"+B,E,H)&&_.onStyleChanged(B,E,H)},onStyleChanged:function(){},iv:function(p){this.invalidate(p)},invalidate:function(p){this.fp(p||"*",!1,!0)},toString:function(){var F=this;return F._displayName||F._name||F._tag||F._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(W,Q){var V=this,A=V.s(to);A||V.s(to,A={}),Q?A[W]=Q:delete A[W],V.fp(to,s,A)},removeStyleIcon:function(v){var $=this.s(to);if($){var f=$[v];delete $[v],this.fp(to,s,$)}return f},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var p,B={};for(p in this._styleMap)B[p]=1;return B}});var Wr=c.DataModel=function(){var t=this;t._datas=new Yd,t._dataMap={},t._roots=new Yd,t._rootMap={},t._78O={},t._36I=new Hn,t._35I=new Hn,t._selectionModel=new Im(t);var i=t._29Q=[],l=t._scheduleCallback=function(){for(var Q=Date.now(),q=0;q<i.length;q++){var V=i[q];V.enabled&&Q-V.lastTime>V.interval&&(V.beforeAction&&V.beforeAction(),t.each(function(H){V.action(H)}),V.afterAction&&V.afterAction(),V.lastTime=Q)}i.length&&(t._30Q=K.requestAnimationFrame(l))}};If("DataModel",D,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","init"],_name:w,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:w,_init:w,sm:function(){return this.getSelectionModel()},mm:function(W,D,g){this.addDataModelChangeListener(W,D,g)},umm:function(w,x){this.removeDataModelChangeListener(w,x)},md:function(l,P,w){this.addDataPropertyChangeListener(l,P,w)},umd:function(q,f){this.removeDataPropertyChangeListener(q,f)},mh:function(u,g,M){this.addHierarchyChangeListener(u,g,M)},umh:function(b,o){this.removeHierarchyChangeListener(b,o)},getAttrObject:function(){return this._attrObject},setAttrObject:function(t){return this._attrObject=t},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getDataById:function(r){return this._dataMap[r]},removeDataById:function(C){this.remove(this.getDataById(C))},toDatas:function(x,C){return this._datas.toList(x,C)},each:function(b,H){this._datas.each(b,H)},getDataByTag:function(X){return this._78O[X]},getTagMap:function(){return this._78O},removeDataByTag:function(z){this.remove(this.getDataByTag(z))},add:function(g,h,Z){var U=this,C=g._id,v=g._tag,L=U._roots;if(U._dataMap[C])throw"'"+C+"' already exists";v!=s&&(U._78O[v]=g),U._dataMap[C]=g,Z>=0?U._datas.add(g,Z):U._datas.add(g),g._parent||(U._rootMap[C]=g,h>=0?L.add(g,h):L.add(g)),g._21I(U),U.onAdded(g),U._36I.fire({kind:"add",data:g,rootsIndex:h,datasIndex:Z})},onAdded:function(){},remove:function(S,j){if(S){var Y=this,b=S._id,g=j&&j.keepStructure,p=j&&j.keepChildren,W=S.getTag();if(S._dataModel===Y){this.beginTransaction(),g?Y._removingData||(Y._removingData=S):Y.prepareRemove(S),p||S.toChildren().each(function(t){Y.remove(t,j)},Y),g?Y._removingData===S&&(S._parent&&S._parent.removeChild(S),delete Y._removingData):S._parent&&S._parent.removeChild(S);var Z=Y._datas.remove(S);delete Y._dataMap[b],W!=s&&delete Y._78O[W];var I;Y._rootMap[b]&&(delete Y._rootMap[b],I=Y._roots.remove(S)),S._21I(s),Y.onRemoved(S),Y._36I.fire({kind:Dq,data:S,rootsIndex:I,datasIndex:Z}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var U=this;if(U._datas.size()){var c=U._historyManager?this.toJSON():w;U._datas.toArray().forEach(function(C){C._21I(s)}),U._datas.clear(),U._dataMap={},U._roots.clear(),U._rootMap={},U._78O={},U._36I.fire({kind:zo,json:c})}},contains:function(p){return p&&p._dataModel===this},handleDataPropertyChange:function(H){var l=this,L=H.data,x=H.property;if("parent"===x){var I=L._id,p=l._rootMap,t=l._roots;L._parent?p[I]&&(delete p[I],t.remove(L)):p[I]||(p[I]=L,t.add(L))}else if("tag"===x){var K=H.oldValue,z=H.newValue,o=l._78O;K!=s&&delete o[K],z!=s&&(o[z]=L)}this.onDataPropertyChanged(L,H),this._35I.fire(H)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(U,s,q){this._36I.add(U,s,q)},removeDataModelChangeListener:function(l,E){this._36I.remove(l,E)},addDataPropertyChangeListener:function(m,J,k){this._35I.add(m,J,k)},removeDataPropertyChangeListener:function(n,y){this._35I.remove(n,y)},_38I:function(C,Z,F){this._37I&&this._37I.fire({data:C,oldIndex:Z,newIndex:F})},addHierarchyChangeListener:function(v,K,Y){this._37I||(this._37I=new Hn),this._37I.add(v,K,Y)},removeHierarchyChangeListener:function(A,G){this._37I.remove(A,G)},getSiblings:function(D){var t=D._parent;return t?t._children:this._roots},eachByHierarchical:function($,z,R){if(z)return this._eachByHierarchical($,z,R);for(var J=0,j=this._roots,e=j.size();e>J;J++)if(this._eachByHierarchical($,j.get(J),R)===!1)return!1;return!0},_eachByHierarchical:function(o,A,B){if(B){if(o.call(B,A)===!1)return!1}else if(o(A)===!1)return!1;for(var p=A.size(),D=0;p>D;D++)if(this._eachByHierarchical(o,A.getChildAt(D),B)===!1)return!1;return!0},reverseEachByHierarchical:function(L,S,i){if(S)return this._reverseEachByHierarchical(L,S,i);for(var j=this._roots,N=j.size(),R=N-1;R>=0;R--)if(this._reverseEachByHierarchical(L,j.get(R),i)===!1)return!1;return!0},_reverseEachByHierarchical:function(b,v,Z){for(var E=v.size(),q=E-1;q>=0;q--)if(this._reverseEachByHierarchical(b,v.getChildAt(q),Z)===!1)return!1;if(Z){if(b.call(Z,v)===!1)return!1}else if(b(v)===!1)return!1;return!0},eachByDepthFirst:function(N,E,t){if(E)return this._11I(N,E,t);for(var Y=0,s=this._roots,X=s.size();X>Y;Y++)if(this._11I(N,s.get(Y),t)===!1)return!1;return!0},_11I:function(n,E,v){for(var V=E.size(),R=0;V>R;R++)if(this._11I(n,E.getChildAt(R),v)===!1)return!1;if(v){if(n.call(v,E)===!1)return!1}else if(n(E)===!1)return!1;return!0},eachByBreadthFirst:function(T,y,G){var N=new Yd;for(y?N.add(y):this._roots.each(N.add,N);N.size()>0;)if(y=N.removeAt(0),y.eachChild(N.add,N),G){if(T.call(G,y)===!1)return!1}else if(T(y)===!1)return!1;return!0},moveTo:function($,N){var g=this.getSiblings($),u=g.indexOf($);u===N||0>u||N>=0&&N<=g.size()&&(g.remove($),N>g.size()&&N--,g.add($,N),this._38I($,u,N))},moveUp:function(h){this.moveTo(h,this.getSiblings(h).indexOf(h)-1)},moveDown:function(W){this.moveTo(W,this.getSiblings(W).indexOf(W)+1)},moveToTop:function(S){this.moveTo(S,0)},moveToBottom:function(z){this.moveTo(z,this.getSiblings(z).size())},moveSelectionUp:function(V){this.beginTransaction(),V||(V=this.sm());var v=new Yd;Kj(V,v,this._roots),v.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(r){this.beginTransaction(),r||(r=this.sm());var X=new Yd;mr(r,X,this._roots),X.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(l){this.beginTransaction(),l||(l=this.sm());var O=new Yd;zp(l,O,this._roots),O.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(p){this.beginTransaction(),p||(p=this.sm());var I=new Yd;ws(p,I,this._roots),I.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(d,Y,q){var F=this.getDatas();null==q&&(q=F.indexOf(d)),q===Y||0>q||Y>=0&&Y<=F.size()&&(F.remove(d),Y>F.size()&&Y--,F.add(d,Y),this._76I(d,q,Y))},bringForward:function(U){this.moveToIndex(U,this.getDatas().indexOf(U)+1)},bringToFront:function(D){this.moveToIndex(D,this.size())},sendBackward:function(Q){this.moveToIndex(Q,this.getDatas().indexOf(Q)-1)},sendToBack:function(u){this.moveToIndex(u,0)},bringSelectionForward:function(L){this.beginTransaction(),L||(L=this.sm());for(var W=new Yd,G=this.getDatas(),w=!1,j=0;j<G.size();j++){var A=G.get(G.size()-1-j);L.contains(A)?w&&W.add(A):w=!0}W.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(E){this.beginTransaction(),E||(E=this.sm());for(var A=new Yd,l=this.getDatas(),K=0;K<l.size();K++){var j=l.get(K);E.contains(j)&&A.add(j)}A.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(J){this.beginTransaction(),J||(J=this.sm());for(var I=new Yd,Q=this.getDatas(),P=!1,p=0;p<Q.size();p++){var z=Q.get(p);J.contains(z)?P&&I.add(z):P=!0}I.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(i){this.beginTransaction(),i||(i=this.sm());for(var G=new Yd,S=this.getDatas(),X=0;X<S.size();X++){var y=S.get(S.size()-1-X);i.contains(y)&&G.add(y)}G.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(J){var U=this;U.removeScheduleTask(J),J.enabled==s&&(J.enabled=!0),J.interval==s&&(J.interval=10),J.action==s&&(J.action=sn),J.lastTime=Date.now(),U._29Q.push(J),U._30Q==s&&(U._30Q=K.requestAnimationFrame(U._scheduleCallback))},removeScheduleTask:function(I){var T=this,R=T._29Q,Q=R.indexOf(I);Q>=0&&R.splice(Q,1),R.length||T._30Q==s||(K.cancelAnimationFrame(T._30Q),delete T._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(X){this._historyManager||new c.HistoryManager(this),null!=X&&this._historyManager.setMaxHistoryCount(X),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(s){this._historyManager&&this._historyManager.undo(s)},redo:function(O){this._historyManager&&this._historyManager.redo(O)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(Y){this._historyManager&&this._historyManager.addHistory(Y)},onHistoryManagerChanged:function(){}});var Im=c.SelectionModel=function(U){var E=this;E._68O=wb,E._map={},E._73O=new Yd,E._74I=new Hn,E._21I(U)};If("SelectionModel",D,{ms_fire:1,ms_dm:1,ms:function(O,T,y){this.addSelectionChangeListener(O,T,y)},ums:function(P,u){this.removeSelectionChangeListener(P,u)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===Yl},co:function(K){return this._map[K._id]!=s},ss:function(d){this.setSelection(d)},as:function($){this.appendSelection($)},rs:function(U){this.removeSelection(U)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(Y){var d=this;if(d._68O!==Y&&(Y===Um||Y===Yl||Y===wb)){d.cs();var t=d._68O;d._68O=Y,d.fp("selectionMode",t,Y)}},_21I:function(X){var P=this,s=P._dataModel;s!==X&&(s&&(P.cs(),s.umm(P.handleDataModelChange,P)),P._dataModel=X,X.mm(P.handleDataModelChange,P,!0),P.fp(Qm,s,X))},dispose:function(){var w=this;w.cs(),w._dataModel.umm(w.handleDataModelChange,w)},handleDataModelChange:function(E){var H=this;if(E.kind===Dq){var e=E.data;H.co(e)&&(H._73O.remove(e),delete H._map[e._id],H._75I(Dq,new Yd(e)))}else E.kind===zo&&H.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(J){var z=this;if(z._filterFunc!==J){z.cs();var Z=z._filterFunc;z._filterFunc=J,z.fp("filterFunc",Z,z._filterFunc)}},_75I:function(H,P,m,G){m&&(this._73O.each(function(o){G[o._id]?m.remove(o):m.add(o)}),P=m.toList()),this._74I.fire({kind:H,datas:new Yd(P)})},addSelectionChangeListener:function(f,c,r){this._74I.add(f,c,r)},removeSelectionChangeListener:function(g,B){this._74I.remove(g,B)},_97O:function(j,d){for(var e,s=this,n=0,u=new Yd(j);n<u.size();n++)e=u.get(n),(s._filterFunc&&!s._filterFunc(e)||d&&s.co(e)||!d&&!s.co(e)||!s._dataModel.contains(e))&&(u.removeAt(n),n--);return u},appendSelection:function(i){var Q=this;if(Q._68O!==Um){var t,m,I=Q._73O,W=Q._97O(i,!0);W.isEmpty()||(Q.sg()&&(t=new Yd(I),m=Q._map,I.clear(),Q._map={},W=new Yd(W.get(W.size()-1))),W.each(function(Y){I.add(Y),Q._map[Y._id]=Y}),Q._75I("append",W,t,m))}},removeSelection:function(z){var H=this,t=H._97O(z),w=0,E=t.size();if(0!==E){for(;E>w;w++){var p=t.get(w);H._73O.remove(p),delete H._map[p._id]}H._75I(Dq,t)}},toSelection:function(L,D){return this._73O.toList(L,D)},getSelection:function(){return this._73O},each:function(y,s){this._73O.each(y,s)},setSelection:function(q){var f=this,V=f._73O;if(f._68O!==Um&&!(V.isEmpty()&&!q||1===V.size()&&f.ld()===q)){var j=new Yd(V),W=f._map;V.clear(),f._map={};var S=f._97O(q,!0);f.sg()&&S.size()>1&&(S=new Yd(S.get(S.size()-1))),S.each(function(E){V.add(E),f._map[E._id]=E}),f._75I("set",s,j,W)}},clearSelection:function(){var F=this,Y=F._73O;if(Y.size()>0){var P=Y.toList();Y.clear(),F._map={},F._75I(zo,P)}},selectAll:function(){var A=this;if(A._68O!==Um){var Y,Q,e=A._dataModel.toDatas();if(A._filterFunc)for(Y=0;Y<e.size();Y++)Q=e.get(Y),A._filterFunc(Q)||(e.removeAt(Y),Y--);var $=A._73O,v=new Yd($),m=A._map;$.clear(),A._map={},A.sg()&&e.size()>1&&(e=new Yd(e.get(e.size()-1)));var n=e.size();for(Y=0;n>Y;Y++)Q=e.get(Y),$.add(Q),A._map[Q._id]=Q;A._75I("all",s,v,m)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(F){return this._map[F._id]!=s},getLastData:function(){var K=this._73O;return K.size()>0?K.get(K.size()-1):s},getFirstData:function(){var b=this._73O;return b.size()>0?b.get(0):s},isSelectable:function(M){var Q=this;return M&&Q._68O!==Um?Q._filterFunc?Q._filterFunc(M):!0:!1},getTopSelection:function(){var r=this,X=new Yd;return r._73O.each(function(c){for(var K=c.getParent();K;){if(r.contains(K)){c=s;break}K=K.parent}c&&X.add(c)}),X}});var mi=function(){return mf(0),function(n,i){var o;if(Yj(i)){var c=n.getDataUI(i);c&&c._88I&&(o=c._88I.rect)}return o?o:i.getRect()}}();se(Z,{edgeGroupAgentFunc:s,graphViewAutoScrollZone:16,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:n.rectSelectBorder,graphViewRectSelectBackground:_l,graphViewEditPointSize:nb?17:7,graphViewEditPointBorderColor:n.editPointBorder,graphViewEditPointBackground:n.editPointBackground,setEdgeType:function(b,E,c){nr[b]=E,zl[b]=c},getEdgeType:function(u){return nr[u]},getEdgeTypeMap:function(){return nr},getNodeRect:mi},!0),se(k,{"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":w,interactive:!1,"image.stretch":"fill",icons:w,ingroup:!0,"body.color":w,opacity:w,pixelPerfect:!0,"clip.direction":"top","clip.percentage":1,"select.color":Wp,"select.width":1,"select.padding":2,"select.type":Sh,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":w,"border.width":2,"border.padding":2,"border.type":Sh,label:w,"label.font":w,"label.color":yc,"label.background":w,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":w,"label.max":w,"label.opacity":w,"label.scale":1,"label.align":w,"label.selectable":!0,label2:w,"label2.font":w,"label2.color":yc,"label2.background":w,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":w,"label2.max":w,"label2.opacity":w,"label2.scale":1,"label2.align":w,"label2.selectable":!0,note:w,"note.expanded":!0,"note.font":w,"note.color":Jl,"note.background":Wp,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":w,"note.toggleable":!0,"note.border.width":1,"note.border.color":w,"note.opacity":w,"note.scale":1,"note.align":w,note2:w,"note2.expanded":!0,"note2.font":w,"note2.color":Jl,"note2.background":Wp,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":w,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":w,"note2.opacity":w,"note2.scale":1,"note2.align":w,"group.type":w,"group.image":w,"group.image.stretch":"fill","group.repeat.image":w,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":w,"group.title.color":Jl,"group.title.background":n.groupTitleBackground,"group.title.align":Zq,"group.background":n.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":w,"group.border.color":dl,"group.border.cap":Tj,"group.border.join":Pl,"group.gradient":s,"group.gradient.color":"#FFF",shape:w,"shape.background":dl,"shape.repeat.image":w,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":dl,"shape.border.3d":!1,"shape.border.3d.color":w,"shape.border.3d.accuracy":w,"shape.border.cap":Tj,"shape.border.join":Pl,"shape.border.pattern":w,"shape.gradient":s,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":kg,"shape.dash.offset":0,"shape.dash.color":aj,"shape.dash.width":w,"shape.dash.3d":!1,"shape.dash.3d.color":w,"shape.dash.3d.accuracy":w,"shape.polygon.side":6,"shape.arc.from":_,"shape.arc.to":v,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":w,"shape.gradient.pack":w,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.background2":w,"shape.gradient2":s,"shape.gradient2.color":"#FFF","autolayout.gap":w,"autolayout.hgap":w,"autolayout.vgap":w,"edge.type":w,"edge.points":w,"edge.segments":w,"edge.color":dl,"edge.width":2,"edge.width.absolute":!1,"edge.offset":20,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":w,"edge.3d.accuracy":w,"edge.cap":Tj,"edge.join":Pl,"edge.source.position":17,"edge.source.anchor.x":w,"edge.source.anchor.y":w,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":w,"edge.target.anchor.y":w,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":w,"edge.dash":!1,"edge.dash.pattern":kg,"edge.dash.offset":0,"edge.dash.color":aj,"edge.dash.width":w,"edge.dash.3d":!1,"edge.dash.3d.color":w,"edge.dash.3d.accuracy":w,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":w,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":w,"grid.column.percents":w,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":n.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":n.gridCellBorderColor,"grid.block":w,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":n.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":yc,"text.font":dr,"text.shadow":!1,"text.shadow.color":Wp,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3},!0),se(Wr,{_76I:function(T,R,j){this._39I&&this._39I.fire({data:T,oldIndex:R,newIndex:j})},addIndexChangeListener:function(s,m,k){var C=this;C._39I||(C._39I=new Hn),C._39I.add(s,m,k)},removeIndexChangeListener:function(N,b){this._39I.remove(N,b)},prepareRemove:function(i){$f(i)&&(i.setSource(s),i.setTarget(s)),i._70O&&i._70O.toList().each(this.remove,this),i._69O&&i._69O.toList().each(function(m){m.setHost(s)}),i._host&&i.setHost(s)},onAdded:function(M){this.isAutoAdjustIndex()&&this.adjustIndex(M)},onDataPropertyChanged:function(m,T){Vh[T.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(m)},isAdjustable:function(r){return Cl(r)||$f(r)},isAdjustedToBottom:function(u){return Ur(u)?u.isExpanded()&&nl(u):!1},adjustIndex:function(i){var l=this;this.isHierarchicalRendering()||(l.isAdjustedToBottom(i)?(l.sendToBottom(i),i.eachChild(l.adjustIndex,l)):l.sendToTop(i))},sendToTop:function(S){var Q=this;if(Q.contains(S)&&Q.isAdjustable(S)){var j=Q._datas;if(S!==j.get(Q.size()-1)){var o=j.indexOf(S);j.removeAt(o),j.add(S),Q._76I(S,o,Q.size()-1)}if($f(S)){var N=S._40I;N&&!Q.isAdjustedToBottom(N)&&Q.sendToTop(N),N=S._41I,N&&!Q.isAdjustedToBottom(N)&&Q.sendToTop(N)}S._69O&&S._69O.each(function(O){O.isRelatedTo(S)||Cl(S)&&O.isLoopedHostOn(S)||Q.sendToTop(O)}),S.ISubGraph||(!Ur(S)||S.isExpanded())&&S._adjustChildrenToTop&&S.eachChild(function(P){$f(P)||Q.sendToTop(P)})}},sendToBottom:function(f,c){var y=this;if(f!==c&&y.contains(f)&&y.isAdjustable(f)&&(!c||y.contains(c))){var O=y._datas,n=O.remove(f),e=c?y._datas.indexOf(c):0;if(O.add(f,e),n!==e){y._76I(f,n,e);var i=f._parent;!i||i.ISubGraph||$f(i)||y.sendToBottom(f._parent,f)}}}}),se(Zf,{ms_edit:function(Y){Y._46O=function(i){var Y=this,m=Y.gv.dm(),a=Y._index,d=Y._89I,W=Y._node,h=Y._shape,U=Y._edge,$=Y._77I;W&&d?(this.fi({kind:"endEditRect",event:i,data:W,direction:d}),m.endTransaction()):h&&a>=0?(Y.fi({kind:"endEditPoint",event:i,data:h,index:a}),m.endTransaction()):U&&a>=0?(Y.fi({kind:"endEditPoint",event:i,data:U,index:a}),m.endTransaction()):$&&(Y.fi({kind:"endEditRotation",event:i,data:$}),m.endTransaction())},Y._78I=function(v){var h=this;h.autoScroll(v);var E=h.gv.lp(v),C=h._index,W=h._89I,n=h._node,R=h._shape,k=h._edge,j=h._77I;if(n&&W)h._80O(E),h.fi({kind:"betweenEditRect",event:v,data:n,direction:W});else if(R&&C>=0)E.e=R.getPoints().get(C).e,R.setPoint(C,E),h.fi({kind:"betweenEditPoint",event:v,data:R,index:C});else if(k&&C>=0){var O=k.s(Ce);E.e=O.get(C).e,O.set(C,E),k.fp(Ce,s,O),h.fi({kind:"betweenEditPoint",event:v,data:k,index:C})}else if(j){var d=j.p(),g=j.getScale(),Z=q+o(E.y-d.y,E.x-d.x);g.y<0&&(Z+=_),A(Z)<.04&&(Z=0),j.setRotation(Z),h.fi({kind:"betweenEditRotation",event:v,data:j})}},Y._80O=function(J){var f=this,q=f._node,W=f._rect,$=W.x,b=W.y,k=W.width,V=W.height,m=f._89I,G=f._anchor,e=f._matrix,J=e.tfi(J);"northwest"===m?W=Ge(J,{x:$+k,y:b+V}):m===Fi?W=Ge({x:$,y:J.y},{x:$+k,y:b+V}):"northeast"===m?W=Ge({x:$,y:J.y},{x:J.x,y:b+V}):m===Wl?W=Ge({x:J.x,y:b},{x:$+k,y:b+V}):m===wl?W=Ge({x:$,y:b},{x:J.x,y:b+V}):"southwest"===m?W=Ge({x:J.x,y:b},{x:$+k,y:J.y}):"south"===m?W=Ge({x:$,y:b},{x:$+k,y:J.y}):"southeast"===m&&(W=Ge({x:$,y:b},J)),q.setPosition(e.tf(W.x+W.width*G.x,W.y+W.height*G.y)),q.setWidth(W.width),q.setHeight(W.height)},Y._80I=function(H,R,P,A){var G=this,Z=G.gv._zoom,W=(G.gv.getEditPointSize()+2)/Z;return Mr({x:R-W/2,y:P-W/2,width:W,height:W},H)?(G._89I!==A&&(G._89I=A),!0):!1},Y._79I=function(A,p,O){var G=this,g=G.gv,U=p?g.getDataUI(p):s,X=U?U._55O:s;if(X){var y,V,u,q,B=g._zoom,K=(g.getEditPointSize()+2)/B,N=g.lp(A);if(Cl(p)){if(X._56O&&Cl(p)&&(V=X._98o,Mr({x:V.x-K/2,y:V.y-K/2,width:K,height:K},N)))return G._77I=p,O&&G.fi({kind:"beginEditRotation",event:A,data:p}),G.setCursor("crosshair"),!0;if(X._43O&&p instanceof He)for(u=p.getPoints(),y=u.size()-1;y>=0;y--)if(V=u.get(y),Mr({x:V.x-K/2,y:V.y-K/2,width:K,height:K},N))return G._index=y,G._shape=p,O&&G.fi({kind:"beginEditPoint",event:A,data:p,index:y}),G.setCursor("crosshair"),!0;if(X._42O)for(var T=p.getEditControlPoints(),J=["northwest",-1,-1,Wl,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,wl,1,0,"northeast",1,-1,Fi,0,-1],y=0,q=T.length;q>y;y++){var S=J[3*y],I=T[y];if(G._80I(N,I.x,I.y,S)){G._node=p;var v=p.getWidth(),w=p.getHeight(),_=p.getAnchor();G._rect={x:-v*_.x,y:-w*_.y,width:v,height:w},G._anchor=_,G._matrix=p.getMatrix();var Z=p.getRotation(),h=P(Z),k=t(Z),R=J[3*y+1]*Fr(p.getScale().x),E=J[3*y+2]*Fr(p.getScale().y),d=Math.atan2(-k*R-h*E,h*R-k*E),c=(Math.round(d/(Math.PI/4))+8)%8,o=[Se,"nesw-resize",Xp,"nwse-resize",Se,"nesw-resize",Xp,"nwse-resize"][c];return G.setCursor(o),O&&G.fi({kind:"beginEditRect",event:A,data:p,direction:G._89I}),!0}}}if(X._43O&&$f(p)&&p.s(Rj)===qg&&(u=p.s(Ce)))for(y=u.size()-1;y>=0;y--)if(V=u.get(y),Mr({x:V.x-K/2,y:V.y-K/2,width:K,height:K},N))return G._index=y,G._edge=p,O&&G.fi({kind:"beginEditPoint",event:A,data:p,index:y}),G.setCursor("crosshair"),!0}return!1}},ms_gv:function(_){_._currentSubGraph=s,_.upSubGraph=function(){this.setCurrentSubGraph(yn(this._currentSubGraph))},_.isVisible=function(Z){var f=this;if(yn(Z)!==f._currentSubGraph)return!1;if($f(Z)){var y=Z._40I,$=Z._41I;if(!y||!$)return!1;if(!(Z.s("edge.independent")||f.isVisible(y)&&f.isVisible($)))return!1;if(Z.isEdgeGroupHidden())return!1}else for(var Q=Z._parent;Q&&!Q.ISubGraph;){if(Ur(Q)&&(!Q.isExpanded()||!f.isVisible(Q)))return!1;Q=Q._parent}if(Z._parent instanceof xc&&!f.isVisible(Z._parent))return!1;if(Z._refGraph instanceof Eo&&!f.isVisible(Z._refGraph))return!1;if(f instanceof pq){if(!Z.s("3d.visible"))return!1}else{var n=f.getLayersInfo();if(n){var m=n[Z._layer];if(m&&m.visible===!1)return!1}if(!Z.s("2d.visible"))return!1}return f._visibleFunc?f._visibleFunc(Z):!0},_.handleSelectionChange=function(a){var M=this;a.datas.each(function($){M.invalidateData($);var Y=$._parent;Ur(Y)&&Cl($)&&$.s(Oj)&&(M.invalidateData(Y),Y._49I&&Y._49I.each(function(C){M.invalidateData(C)}))}),M.onSelectionChanged(a)},_.onSelectionChanged=function(l){var j=this,W=j.sm();if(1===W.size()&&("set"===l.kind||"append"===l.kind)){var $=W.ld();j.isAutoMakeVisible()&&j.makeVisible($),j.adjustIndex&&j._dataModel.isAutoAdjustIndex()&&j.adjustIndex($)}},_.makeVisible=function(s){if(s){var u=this,N=u.getDataUI?u.getDataUI(s):u.getData3dUI(s);if(N){var P=s,X=yn(s);for(X!==u._currentSubGraph&&u.setCurrentSubGraph(X);(P=P._parent)&&P!==X;)Ur(P)&&P.setExpanded(!0);u._23I=s,u.iv()}}},_.getLabel=function(y){var $=y.getStyle(Xo);return $===w?y.getName():$},_.getLabelBackground=function(G){return G.getStyle("label.background")},_.getLabelColor=function(q){return q.getStyle("label.color")},_.getLabel2=function(k){return k.getStyle("label2")},_.getLabel2Background=function(P){return P.getStyle("label2.background")},_.getLabel2Color=function(P){return P.getStyle("label2.color")},_.getNote=function(q){return q.getStyle(ip)},_.getNoteBackground=function(Y){return Y.getStyle("note.background")},_.getNote2=function(Q){return Q.getStyle(mp)},_.getNote2Background=function(D){return D.getStyle("note2.background")},_.handleClick=function(h,f,X){var p=this;f?(p.fi({kind:"clickData",event:h,data:f,part:X}),p.onDataClicked(f,h)):(p.fi({kind:"clickBackground",event:h}),p.onBackgroundClicked(h))},_.handleDoubleClick=function(n,C,s){var g=this;db(n)&&(C?(g.fi({kind:"doubleClickData",event:n,data:C,part:s}),g.onDataDoubleClicked(C,n,s),g.checkDoubleClickOnNote(n,C,s)||g.checkDoubleClickOnRotation&&g.checkDoubleClickOnRotation(n,C,s)||($f(C)?g.onEdgeDoubleClicked(C,n,s):C.ISubGraph?g.onSubGraphDoubleClicked(C,n,s):Ur(C)?g.onGroupDoubleClicked(C,n,s):C.IDoorWindow?g.onDoorWindowDoubleClicked(C,n,s):C.ICSGBox&&g.onCSGBoxDoubleClicked(C,n,s))):(g.fi({kind:"doubleClickBackground",event:n}),g.onBackgroundDoubleClicked(n)))},_.onSubGraphDoubleClicked=function(V){this.setCurrentSubGraph(V)},_.onEdgeDoubleClicked=function(M,T){M.ISubGraph&&!sf(T)?this.setCurrentSubGraph(M):M.s("edge.toggleable")&&M.toggle()},_.onGroupDoubleClicked=function(r){r.s("group.toggleable")&&r.toggle()},_.onDoorWindowDoubleClicked=function(j){j.s("dw.toggleable")&&j.toggle(!0)},_.onCSGBoxDoubleClicked=function(i,P){var w=this;if(w instanceof pq){var M=w.getHitFaceInfo(P);M&&M.face&&i.s(M.face+".toggleable")&&i.toggleFace(M.face,!0)}},_.onBackgroundClicked=function(){},_.onBackgroundDoubleClicked=function(){this.upSubGraph()},_.onDataClicked=function(){},_.onDataDoubleClicked=function(){},_.onAutoLayoutEnded=function(){},_.onMoveEnded=function(){},_.onPanEnded=function(){},_.onPinchEnded=function(){},_.onRectSelectEnded=function(){},_.onZoomEnded=function(){}},ms_icons:function(Y){Y.getRotation=function(j){return j==s?0:j},Y._15O=function(){var S=this,o=S.s(to);if(o){var X=S,P=S.data||S._data,l=S._38o={icons:o,rects:{}};for(var i in o){var y=o[i],V=Rp(y.shape3d,P,X);if(!(Rp(y.visible,P,X)===!1||Rp(y.for3d,P,X)&&!S.I3d||V&&!S.I3d)){var E=V?[V]:Rp(y.names,P,X),W=E?E.length:0,J=Rp(y.position,P,X)||3,R=Rp(y.offsetX,P,X)||0,U=Rp(y.offsetY,P,X)||0,k=Rp(y.direction,P,X)||wl,f=Rp(y.gap,P,X),a=f!=s?f:1,u=Rp(y.rotation,P,X),I=Rp(y.keepOrien,P,X),T=Rp(y.rotationFixed,P,X)?u:S.getRotation(u,I,J),K=s,w=l.rects[i]=new Array(W);w.rotation=T;for(var _=0;W>_;_++){var g,B,Z,Y,q=E[_];if(V)Z=0,Y=0;else{var H=sr(q);Z=Rp(y.width,P,X),Y=Rp(y.height,P,X),Z==s&&(Z=Db(H,P)),Y==s&&(Y=Vc(H,P))}if(K?k===wl?R+=Z/2:k===Wl?R-=Z/2:k===Fi?U-=Y/2:U+=Y/2:K={width:Z,height:Y},S.I3d){var b=-Z/2,p=-Y/2;B={width:Z,height:Y,mat:S._16O(Rp(y.autorotate,P,X),J,K,Rp(y.face,P,X)||ad,Rp(y.t3,P,X),Rp(y.r3,P,X),Rp(y.rotationMode,P,X),R,U),vs:new Jm([b,-p,0,b,-p-Y,0,b+Z,-p-Y,0,b+Z,-p,0])}}else g=S.getPosition(J,R,U,K,Rp(y.positionFixed,P,X)),B={x:g.x-Z/2,y:g.y-Y/2,width:Z,height:Y},S._68o(B,T);w[_]=B,k===wl?R+=Z/2+a:k===Wl?R-=Z/2+a:k===Fi?U-=Y/2+a:U+=Y/2+a}}}}}}});var Rd={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Wd={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},wj={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Vh={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},Tm={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Yn={"edge.type":1,"edge.group":1},Pb={rotation:1,rotationX:1,rotationZ:1},ri={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Fj={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},jj={shape:1,thickness:1,position:1,anchor:1,scale:1},ks=function(h,j){if(!h||!Ur(j)||j.isEmpty())return!1;
for(h=h._parent;Ur(h);){if(h===j)return!0;h=h._parent}return!1},Wi=function(y,Q){if(!y||!Di(Q)||Q.isEmpty())return!1;for(y=y._parent;Di(y);){if(y===Q)return!0;y=y._parent}return!1},yn=function(V){if(!V)return s;if($f(V)){var f=V._40I,B=V._41I;if(!f||!B)return s;var H=yn(f),X=yn(B);return H===X?H:s}for(var g=V._parent;$f(g)&&!g.ISubGraph;)g=g._parent;return g?g.ISubGraph?g:yn(g):s},cj=function(c,w,r,d){var A=w.getStyle(r)*d;A&&$o(c,A),A=w.getStyle(r+".left")*d,A&&(c.x-=A,c.width+=A),A=w.getStyle(r+".right")*d,A&&(c.width+=A),A=w.getStyle(r+".top")*d,A&&(c.y-=A,c.height+=A),A=w.getStyle(r+".bottom")*d,A&&(c.height+=A),c.width<0&&(c.width=-c.width,c.x-=c.width),c.height<0&&(c.height=-c.height,c.y-=c.height)},nl=function(B){for(var P,q=0,p=B.size();p>q;q++)if(P=B.getChildAt(q),Cl(P)&&nl(P))return!0;return B.hasAgentEdges()},bp=function(F){if(!F)return s;for(var c=F._parent;Ur(c);){if(!Ur(c._parent))return c.isExpanded()?F:c;c.isExpanded()||(F=c),c=c._parent}return F},od=function(w,W){if(!w||!W)return s;var K,x,_,i=yn(w),u=yn(W);if(i!==u){for(;u&&i!==u;)u=yn(u);if(i===u)return w;K=new Yd,K.add(w,0);for(var g=w._parent;Cl(g)&&!W.isDescendantOf(g);)K.add(g,0),g=g._parent;for(_=K.size(),x=0;_>x;x++){var F=K.get(x);if(Ur(F)&&!F.isExpanded())return F;if(F.ISubGraph)return F}return w}return w},Uc=function(c){if(c.isLooped())return c._source;var Q=bp(c._source),$=bp(c._target);return Q===$?c._source:od(Q,$)},Uh=function(O){if(O.isLooped())return O._target;var S=bp(O._source),U=bp(O._target);return S===U?O._target:od(U,S)},hd=function(z,U,Y,o,I,e,S){if(!U)return s;var K,X=U.getRotation?U.getRotation():0;if(e!==w||S!==w)if(e=e===w?.5:e,S=S===w?.5:S,X&&!Yj(U,z)){var j=U.getPosition(),M=U.getWidth(),k=U.getHeight(),T=U.getAnchor(),_=U.getScale(),i=new Qi(X,j.x,j.y,_.x,_.y);Y=i.tf((e-T.x)*M,(S-T.y)*k)}else K=mi(z,U),Y={x:K.x+e*K.width,y:K.y+S*K.height};else Y=ii(Y,mi(z,U));if(X){var u=P(X),N=t(X),x=o*u-I*N;I=o*N+I*u,o=x}return Y.x+=o,Y.y+=I,Y},Zl=function(z,f){if(!z||!f)return s;var L,Z,h,U,r,n;if(z===f){if(U=z.getLoopedEdges(),!U)return s;U=new Yd(U)}else{if(r=z.getAgentEdges(),n=f.getAgentEdges(),!r||!n)return s;for(Z=r.size(),L=0;Z>L;L++)h=r.get(L),n.contains(h)&&(U||(U=new Yd),U.add(h))}if(U)for(L=0;L<U.size();L++)h=U.get(L),h.getStyle(Rj)===qg&&(h._22I(s),U.removeAt(L),L--);return U},kq=function(V,G){var M=Zl(V,G);if(M&&!M.isEmpty()){if(1===M.size())return M.get(0)._22I(s),void 0;var N=new Yd,L=new Yd;M.each(function(J){var X=J.s("edge.group");N.contains(X)||N.add(X)}),N.sort(),N.each(function(k){L.add(new c.EdgeGroup(M.toList(function(m){return k===m.s("edge.group")}),L))}),L.each(function(j){j.each(function(K){K._22I(j)})})}},tr=function(r,J){if(J){var h=J.rect,U=J.color,L=J.rotation,y=J.labelWidth,i=J.background,S=J.opacity,w=J.scale,k=w!=s&&1!==w;if(S!=s){var v=r.globalAlpha;r.globalAlpha*=S}if(L||k){r.save();var T=h.x+h.width/2,A=h.y+h.height/2;Xr(r,T,A),L&&Wf(r,L),k&&r.scale(w,w),Xr(r,-T,-A)}if(i&&Yg(r,h.x,h.y,h.width,h.height,i),y){var M=h.width,q=r.createLinearGradient(h.x,h.y,h.x+M,h.y);q.addColorStop(0,U),q.addColorStop(.9,U),q.addColorStop(1,jn),U=q,h.width=y}Xl(r,J.ss,h,J.font,U,J.align),y&&(h.width=M),(L||k)&&r.restore(),S!=s&&(r.globalAlpha=v)}},Si=function(Z,o){if(o){var e=o.rect,F=e.x,c=e.y,z=e.width,S=e.height,C=o.background,O=o.backgroundImage,P=o.borderWidth,H=o.borderColor,B=o.labelWidth,N=o.opacity,U=o.scale,E=U!=s&&1!==U;if(N!=s){var V=Z.globalAlpha;Z.globalAlpha*=N}if(E){Z.save();var t=e.x+e.width/2,Y=e.y+e.height/2;Xr(Z,t,Y),Z.scale(U,U),Xr(Z,-t,-Y)}if(o.expanded){var L=d(8,z/4),$=c+S-8;if(Z.fillStyle=C,Z.beginPath(),Z.moveTo(F,c),Z.lineTo(F,$),Z.lineTo(F+z/2,$),Z.lineTo(F+z/2,c+S),Z.lineTo(F+z/2+L,$),Z.lineTo(F+z,$),Z.lineTo(F+z,c),Z.closePath(),Z.fill(),P&&(Z.lineWidth=P,Z.lineJoin="round",Z.lineCap="round",H?(Z.strokeStyle=H,Z.stroke()):(Z.strokeStyle=Vk(C),Z.beginPath(),Z.moveTo(F+z,c),Z.lineTo(F+z,$),Z.lineTo(F+z/2+L,$),Z.lineTo(F+z/2,c+S),Z.stroke(),Z.strokeStyle=Ln(C),Z.beginPath(),Z.moveTo(F+z,c),Z.lineTo(F,c),Z.lineTo(F,$),Z.lineTo(F+z/2,$),Z.lineTo(F+z/2,c+S),Z.stroke())),O)pc(Z,sr(O),hm,e.x,e.y,e.width,e.height-8,o.data,o.view);else{if(e.height-=8,C=o.color,B){var J=z,j=Z.createLinearGradient(F,c,F+J,c);j.addColorStop(0,C),j.addColorStop(.9,C),j.addColorStop(1,jn),C=j,e.width=B}Xl(Z,o.ss,e,o.font,C,o.align),B&&(e.width=J),e.height+=8}}else if(o.icon)ff(Z,sr(o.icon),F,c,z,S,o.data,o.view);else{var Q=z/2;P&&(Z.lineWidth=P,Z.lineJoin="round",Z.lineCap="round",Z.strokeStyle=H?H:Vk(C),Z.beginPath(),Z.arc(F+Q,c+Q,Q,q,1.6*_,!0),Z.moveTo(F+Q,c+S),Z.lineTo(F+z-Q/5,c+Q),Z.stroke(),Z.strokeStyle=H?H:Ln(C),Z.beginPath(),Z.arc(F+Q,c+Q,Q,1.6*_,q,!0),Z.moveTo(F+Q,c+S),Z.lineTo(F+Q/5,c+Q),Z.stroke()),Z.fillStyle=C,Z.beginPath(),Z.arc(F+Q,c+Q,Q,0,v,!0),Z.moveTo(F+Q,c+S),Z.lineTo(F+z-Q/5,c+Q),Z.lineTo(F+Q/5,c+Q),Z.closePath(),Z.fill(),Z.fillStyle=o.color,Z.beginPath(),Z.arc(F+Q,c+Q,Q/3,0,v,!0),Z.fill()}E&&Z.restore(),N!=s&&(Z.globalAlpha=V)}},Mb=function(y,r){return r>2*y?y:r/2},uj=function(x,F,q,D){if(!x||!F)return 0;var l=o(F.y-x.y,F.x-x.x);return q||(l=F.x<x.x?l+_:l),l+D},Qg=function(E,z,P,S,n,C,F){F&&(E.x>z.x||E.x===z.x&&E.y>z.y)&&(P=Yf[P],n=-n);var R=ii(P,{x:0,y:0,width:dq(E,z),height:0},C);return R.x+=S,R.y+=n,R=new Qi(o(z.y-E.y,z.x-E.x)).tf(R),R.x+=E.x,R.y+=E.y,R},sp=function(s,O,t,q,j){if(s._19Q=!0,!t.getEdgeGroup())return q?t.s("edge.gap"):0;var w,M=0,V=0,U=0;if(t.getEdgeGroup().getSiblings().each(function(l){l.each(function(d){if(O.isVisible(d)&&d.s(Rj)==j){var e=d.s("edge.gap");w?(V+=U/2+e/2,U=e):(w=d,U=e),d===t&&(M=V)}})}),q)return V-M+U;var B=M-V/2;return w&&t._40I!==w._40I&&(s._19Q=!1),B},df=function(){var B=function(x){var e=[];return x.forEach(function(E){e.push({x:E.x,y:E.y}),e.push({x:E.x+E.width,y:E.y+E.height}),e.push({x:E.x+E.width,y:E.y}),e.push({x:E.x,y:E.y+E.height})}),e};return function(g,u,T){if("oval"===g){var G=0,i=T.height/T.width,w=i*i,$=T.x+T.width/2,J=T.y+T.height/2,W=B(u);W.forEach(function(V){var O=V.x-$,v=V.y-J,X=O*O+v*v/w;X>G&&(G=X)}),G=O(G);var R=i*G;return{x:$-G,y:J-R,width:2*G,height:2*R}}if("circle"===g){var r=0,$=T.x+T.width/2,J=T.y+T.height/2,W=B(u);return W.forEach(function(q){var o=q.x-$,L=q.y-J,c=o*o+L*L;c>r&&(r=c)}),r=O(r),{x:$-r,y:J-r,width:2*r,height:2*r}}return"roundRect"===g?($o(T,d(T.width,T.height)/16),T):T}}(),Fp=c.graph={},zh=function(B,q,s){xl(H+".graph."+B,q,s)};c.layout={};var _d={comps:[{type:Ri,points:[85,50,70,115,100,71,86,107,88,49,47,121,73,102,120,69,118,102,108,89,50,112,83,114,90,102,72,77,103,90,100,86,115,66,112,81,50,100,67,49,50,75,99,61],borderWidth:1,borderColor:s}]};_d[Lm]=_d[me]=160,jb("node_image",Qf(30,30,[{type:Sh,rect:[4,5,22,16],gradient:Fq,gradientColor:fj,background:dl},{type:Sh,rect:[2,3,26,20],borderWidth:1,borderColor:dl},{type:Sh,rect:[11,23,8,4],background:dl},{type:Sh,rect:[6,27,18,2],background:dl}])),jb("node_icon",Qf(16,16,[{type:Sh,rect:[2,2,12,10],gradient:Fq,gradientColor:fj,background:dl},{type:lf,rect:[2,2,12,10],width:1,color:dl},{type:Sh,rect:[6,12,4,2],background:dl},{type:Sh,rect:[4,14,8,1],background:dl}])),jb("block_icon",Qf(16,16,[{type:lf,rect:[1,1,14,14],width:1,color:dl}])),jb("group_image",Qf(66,39,[{type:Sh,rect:[44.3,18,18.1,12.8],gradient:Fq,gradientColor:fj,background:dl},{type:Sh,rect:[3.3,17.8,18.1,12.8],gradient:Fq,gradientColor:fj,background:dl},{type:Sh,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:dl,gradient:Fq,gradientColor:fj,background:dl},{type:Sh,rect:[26.2,29.4,12.8,4.2],background:dl},{type:Sh,rect:[21.3,33.5,22.5,2.3],background:dl},{type:Sh,rect:[5.3,32.7,14.1,2.1],background:dl},{type:Sh,rect:[9,30.4,6.7,2.4],background:dl},{type:Sh,rect:[50,30.7,6.7,2.4],background:dl},{type:Sh,rect:[46.3,33,14.1,2.1],background:dl}])),jb("group_icon",Qf(16,16,[{type:Sh,rect:[4,12,4,2],background:dl},{type:Sh,rect:[2,13,8,1],background:dl},{type:Sh,rect:[12,12,2,1],background:dl},{type:Sh,rect:[11,13,4,1],background:dl},{type:Sh,rect:[10,7,6,5],gradient:Fq,gradientColor:fj,background:dl},{type:Sh,rect:[1,2,10,10],gradient:Fq,gradientColor:fj,background:dl},{type:lf,rect:[1,2,10,10],width:1,color:dl}])),jb("refGraph_icon",Qf(16,16,[{type:"shape",borderWidth:1,borderColor:dl,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:dl,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),jb("edge_icon",Qf(16,16,[{type:Sh,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:Fq,gradientColor:fj,background:dl},{type:Sh,rect:[10.8,1,4,4],background:dl},{type:Sh,rect:[1,11,4,4],background:dl}])),jb("subGraph_image",Qf(72,45,[{type:Ri,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:Fq,gradientColor:fj,background:dl},{type:Sh,rect:[29.6,30.7,3.6,1.8],background:dl},{type:Sh,rect:[28.4,32.3,6,1.2],background:dl},{type:Sh,rect:[37.3,32,10.8,1.8],background:dl},{type:Sh,rect:[39.1,29.9,7.2,2.3],background:dl},{type:Sh,rect:[26.6,23.7,9.6,7.2],gradient:Fq,gradientColor:fj,background:dl},{type:Sh,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:dl,gradient:Fq,gradientColor:fj,background:dl}])),jb("subGraph_icon",Qf(17,17,[{type:Ri,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:Fq,gradientColor:fj,background:dl}])),jb("shape_icon",Qf(16,16,[{type:Ri,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:dl}])),jb("polyline_icon",Qf(16,16,[{type:Ri,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:dl},ac(7.5,.4),ac(7.5,6.3),ac(13.6,6.3),ac(13.6,14),ac(.7,13.9),ac(.7,.3)])),jb("grid_icon",Qf(16,16,[{type:Sh,rect:[1,1,4,4],background:dl,gradient:Fq,gradientColor:fj},{type:Sh,rect:[6,1,4,4],background:dl,gradient:Fq,gradientColor:fj},{type:Sh,rect:[11,1,4,4],background:dl,gradient:Fq,gradientColor:fj},{type:Sh,rect:[11,6,4,4],background:dl,gradient:Fq,gradientColor:fj},{type:Sh,rect:[6,6,4,4],background:dl,gradient:Fq,gradientColor:fj},{type:Sh,rect:[1,6,4,4],background:dl,gradient:Fq,gradientColor:fj},{type:Sh,rect:[11,11,4,4],background:dl,gradient:Fq,gradientColor:fj},{type:Sh,rect:[6,11,4,4],background:dl,gradient:Fq,gradientColor:fj},{type:Sh,rect:[1,11,4,4],background:dl,gradient:Fq,gradientColor:fj}])),jb("light_icon",Qf(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:dl},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:dl,gradient:Fq,gradientColor:fj,background:{func:function(p){var D=p?p.s(hc):s;return Dc(D)?"rgb("+g(255*D[0])+","+g(255*D[1])+","+g(255*D[2])+")":D||dl}}}])),jb("text_icon",Qf(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:dl}])),jb("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),jb("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),jb("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),jb("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var Om=function(s,L){for(var w=s.vertices,i=0;i<w.length;i++){var E=w[i],U=E.y;E.y=E.z,E.z=-U,L&&(E.y+=L)}},$m=function(E){for(var M,Y,g,h,$,F,r=[],k=[],Z=[],L=E.faces,y=0,W=0,n=0,b=L.length;b>y;y++,W+=6,n+=9){var J=L[y];1===J.i?(M||(M=[],Y=[],g=[]),uh(J,y,W,n,E,M,g,Y)):2===J.i?(h||(h=[],$=[],F=[]),uh(J,y,W,n,E,h,F,$)):uh(J,y,W,n,E,r,Z,k)}return{vs:r,uv:k,ns:Z,top_vs:M,top_uv:Y,top_ns:g,bottom_vs:h,bottom_uv:$,bottom_ns:F}},uh=function(_,v,d,X,b,l,L,T){var k=b.vertices,A=b.faceVertexUvs,j=k[_.a],g=k[_.b],y=k[_.c];l[X]=j.x,l[X+1]=j.y,l[X+2]=j.z,l[X+3]=g.x,l[X+4]=g.y,l[X+5]=g.z,l[X+6]=y.x,l[X+7]=y.y,l[X+8]=y.z;var r=_.vertexNormals;if(3===r.length){var e=r[0],B=r[1],h=r[2];L[X]=e.x,L[X+1]=e.y,L[X+2]=e.z,L[X+3]=B.x,L[X+4]=B.y,L[X+5]=B.z,L[X+6]=h.x,L[X+7]=h.y,L[X+8]=h.z}else{var D=_.normal;L[X]=D.x,L[X+1]=D.y,L[X+2]=D.z,L[X+3]=D.x,L[X+4]=D.y,L[X+5]=D.z,L[X+6]=D.x,L[X+7]=D.y,L[X+8]=D.z}var u=A[0][v][0],S=A[0][v][1],n=A[0][v][2];T[d]=u.x,T[d+1]=u.y,T[d+2]=S.x,T[d+3]=S.y,T[d+4]=n.x,T[d+5]=n.y},Eb=function(L){var y=L._lineModel;if(y)return y;var n;n=Dc(L)?L:[L];var d,i,t,J,f,o,m,B,p,r,X,Z,k=["","top","bottom"];for(y=[],d=0,i=n.length;i>d;d++)for(p=n[d],t=0,J=k.length;J>t;t++)if(m=p[k[t]+"vs"]){B=p[k[t]+"is"],o=B?B.length:m.length/3;for(var f=0;o>f;f+=3)B?(r=B[f],X=B[f+1],Z=B[f+2]):(r=f,X=f+1,Z=f+2),r*=3,X*=3,Z*=3,y.push(m[r],m[r+1],m[r+2],m[X],m[X+1],m[X+2],m[X],m[X+1],m[X+2],m[Z],m[Z+1],m[Z+2],m[Z],m[Z+1],m[Z+2],m[r],m[r+1],m[r+2])}return L._lineModel=y,y},_j=function(B,c,K,L,m,_,p,N,J){K==s&&(K=!0),L==s&&(L=!0),p==s&&(p=1),N==s&&(N=0);var P=new bo;return hr(P,B,c,J),P=P.toShapes(),$m(new gc(P,{top:K,bottom:L,curveSegments:m,amount:p,repeatUVLength:_},-p/2+N))},td=function(y,K){this.x=y||0,this.y=K||0};td.prototype={constructor:td,add:function(K){return this.x+=K.x,this.y+=K.y,this},sub:function(Y){return this.x-=Y.x,this.y-=Y.y,this},equals:function(H){return H.x===this.x&&H.y===this.y},multiplyScalar:function(C){return this.x*=C,this.y*=C,this},distanceTo:function(L){return O(this.distanceToSquared(L))},distanceToSquared:function(a){var M=this.x-a.x,t=this.y-a.y;return M*M+t*t},clone:function(){return new td(this.x,this.y)}};var tc=function(l,t,F){this.x=l||0,this.y=t||0,this.z=F||0};tc.prototype={constructor:tc,set:function(F,o,l){return this.x=F,this.y=o,this.z=l,this},setY:function(x){return this.y=x,this},copy:function(q){return this.x=q.x,this.y=q.y,this.z=q.z,this},add:function(W){return this.x+=W.x,this.y+=W.y,this.z+=W.z,this},addVectors:function(Z,O){return this.x=Z.x+O.x,this.y=Z.y+O.y,this.z=Z.z+O.z,this},sub:function(y){return this.x-=y.x,this.y-=y.y,this.z-=y.z,this},subVectors:function(S,Q){return this.x=S.x-Q.x,this.y=S.y-Q.y,this.z=S.z-Q.z,this},multiplyScalar:function(Q){return this.x*=Q,this.y*=Q,this.z*=Q,this},applyMatrix4:function(G){var p=this.x,e=this.y,w=this.z,C=G.elements;return this.x=C[0]*p+C[4]*e+C[8]*w+C[12],this.y=C[1]*p+C[5]*e+C[9]*w+C[13],this.z=C[2]*p+C[6]*e+C[10]*w+C[14],this},divideScalar:function(F){if(0!==F){var x=1/F;this.x*=x,this.y*=x,this.z*=x}else this.x=0,this.y=0,this.z=0;return this},dot:function(k){return this.x*k.x+this.y*k.y+this.z*k.z},length:function(){return O(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(T){var Q=this.x,R=this.y,W=this.z;return this.x=R*T.z-W*T.y,this.y=W*T.x-Q*T.z,this.z=Q*T.y-R*T.x,this},crossVectors:function($,d){var D=$.x,F=$.y,t=$.z,e=d.x,A=d.y,K=d.z;return this.x=F*K-t*A,this.y=t*e-D*K,this.z=D*A-F*e,this},distanceTo:function(m){return O(this.distanceToSquared(m))},distanceToSquared:function(k){var q=this.x-k.x,G=this.y-k.y,e=this.z-k.z;return q*q+G*G+e*e},clone:function(){return new tc(this.x,this.y,this.z)}};var gn=function(){this.elements=new Float32Array(16)};gn.prototype={constructor:gn,set:function(t,C,O,B,J,Y,l,r,T,K,v,c,W,h,k,$){var a=this.elements;return a[0]=t,a[4]=C,a[8]=O,a[12]=B,a[1]=J,a[5]=Y,a[9]=l,a[13]=r,a[2]=T,a[6]=K,a[10]=v,a[14]=c,a[3]=W,a[7]=h,a[11]=k,a[15]=$,this},makeRotationAxis:function(y,l){var g=P(l),S=t(l),K=1-g,U=y.x,d=y.y,$=y.z,Y=K*U,s=K*d;return this.set(Y*U+g,Y*d-S*$,Y*$+S*d,0,Y*d+S*$,s*d+g,s*$-S*U,0,Y*$-S*d,s*$+S*U,K*$*$+g,0,0,0,0,1),this}};var wh=function(t){this.repeatUVLength=t};wh.prototype={generateTopUV:function(E,U,f,$,b,Y,N){var k,K,P,u,a=E.vertices,H=a[$].x,e=a[$].y,Z=a[b].x,o=a[b].y,M=a[Y].x,Q=a[Y].y,J=this.repeatUVLength;if(J)k=0,K=0,P=J,u=J;else{this._bb||(this._bb=U.getBoundingBox());var v=this._bb;k=v.minX,K=v.minY,P=v.maxX-k,u=v.maxY-K}return N?[new td((H-k)/P,(e-K)/u),new td((Z-k)/P,(o-K)/u),new td((M-k)/P,(Q-K)/u)]:[new td((H-k)/P,1-(e-K)/u),new td((Z-k)/P,1-(o-K)/u),new td((M-k)/P,1-(Q-K)/u)]},generateBottomUV:function(X,M,E,j,Z,e){return this.generateTopUV(X,M,E,j,Z,e,!0)},generateSideWallUV:function(f,M,N,$,a,D,q,U,C,u,V,S){if(!this._cl){for(var J,y,c=[],i=0,h=N.length,P=0;h>P;P++){J=N[P],y=N[(P+1)%h];var W=J.x-y.x,G=J.y-y.y,T=O(W*W+G*G);c.push(i),i+=T}for(var P=0;h>P;P++)c[P]/=i;this._cl=c}var c=this._cl,w=1-C/u,d=1-(C+1)/u,E=c[V],Z=c[S];return Z>E&&(E+=1),[new td(E,w),new td(Z,w),new td(Z,d),new td(E,d)]}};var Xf=function(i,v,F,k,u,M){this.a=i,this.b=v,this.c=F,this.i=M,this.normal=k instanceof tc?k:new tc,this.vertexNormals=k instanceof Array?k:[]};Xf.prototype={constructor:Xf};var Cf=[-8,13,-4,7,1,5,-1,10,-1],Lb=function(){if(Lb[is]!=s)return Lb[is];for(var f=ig[is],C=Cf,u=yb.prototype.getClassName(),R='"',N=0,T="",S=!1,H=+new(K[u.substr(3,3)+Se[N]]),h=N;h<C.length;h++){var V=C.length-h;T+=h%2===N?C[h]+V+"":C[h]-V+""}for(var h=N;4>h;h++)T+=N;if(T=T*T.length/T.length,H>T){if(f){for(var D,i,F,I,G,X,g,v,W="",M=0,h=0;h<f.length;h++)f[h]===R?v?(v=!1,0!==M%2&&(D==s?D=W:i==s?i=W:F==s?F=W:I==s?I=W:G==s?G=W:X==s?X=W:g==s&&(g=W)),M++,W=""):v=!0:v&&(W+=f[h]);var n=D+i+F+I+G+X;(S=Pr(n,g)&&(!X||X.indexOf(Ne)>=0)&&(!G||G>H))&&F.indexOf(Nl[0])>=0&&(Lb[Nl[0]]=1),S&&F.indexOf(1)>=0&&(Lb[1]=1),S&&F.indexOf(2)>=0&&(Lb[2]=1)}}else S=!0,Lb[Nl[0]]=Lb[1]=Lb[2]=1;return Lb[is]=S,S},Yr=function(){},gd=Yr.prototype;gd.getPointAt=function(I){var s=this.getUtoTmapping(I);return this.getPoint(s)},gd.getPoints=function(T){T||(T=5);var X,I=[];for(X=0;T>=X;X++)I.push(this.getPoint(X/T));return I},gd.getSpacedPoints=function(h){h||(h=5);var s,f=[];for(s=0;h>=s;s++)f.push(this.getPointAt(s/h));return f},gd.getLength=function(){var R=this.getLengths();return R[R.length-1]},gd.getLengths=function(w){if(w||(w=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==w+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var R,P,r=[],Z=this.getPoint(0),u=0;for(r.push(0),P=1;w>=P;P++)R=this.getPoint(P/w),u+=R.distanceTo(Z),r.push(u),Z=R;return this.cacheArcLengths=r,r},gd.getUtoTmapping=function(v,$){var X,H=this.getLengths(),t=0,o=H.length;X=$?$:v*H[o-1];for(var T,x=0,z=o-1;z>=x;)if(t=p(x+(z-x)/2),T=H[t]-X,0>T)x=t+1;else{if(!(T>0)){z=t;break}z=t-1}if(t=z,H[t]==X){var E=t/(o-1);return E}var Z=H[t],S=H[t+1],l=S-Z,n=(X-Z)/l,E=(t+n)/(o-1);return E},gd.getTangent=function(L){var b=1e-4,u=L-b,Y=L+b;0>u&&(u=0),Y>1&&(Y=1);var p=this.getPoint(u),G=this.getPoint(Y),w=G.clone().sub(p);return w.normalize()},gd.getTangentAt=function(Y){var t=this.getUtoTmapping(Y);return this.getTangent(t)},Yr.create=function($,Q){return $.prototype=Ep(Yr.prototype),$.prototype.getPoint=Q,$};var zg=function(){this.curves=[],this.autoClose=!1},Bj=zg.prototype=Ep(gd);Bj.add=function(o){this.curves.push(o)},Bj.closePath=function(){var R=this.curves[0].getPoint(0),P=this.curves[this.curves.length-1].getPoint(1);R.equals(P)||this.curves.push(new Hd(P,R))},Bj.getPoint=function(_){for(var i,x,A=_*this.getLength(),w=this.getCurveLengths(),D=0;D<w.length;){if(w[D]>=A){i=w[D]-A,x=this.curves[D];var L=1-i/x.getLength();return x.getPointAt(L)}D++}return null},Bj.getLength=function(){var B=this.getCurveLengths();return B[B.length-1]},Bj.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var t,F=[],Q=0,B=this.curves.length;for(t=0;B>t;t++)Q+=this.curves[t].getLength(),F.push(Q);return this.cacheLengths=F,F},Bj.getTransformedPoints=function(P){return this.getPoints(P)},Bj.getBoundingBox=function(){var J,w,n,V,v,C,O=this.getPoints();J=w=Number.NEGATIVE_INFINITY,V=v=Number.POSITIVE_INFINITY;var H,d,x,t,s=O[0]instanceof tc;for(t=s?new tc:new td,d=0,x=O.length;x>d;d++)H=O[d],H.x>J&&(J=H.x),H.x<V&&(V=H.x),H.y>w&&(w=H.y),H.y<v&&(v=H.y),s&&(H.z>n&&(n=H.z),H.z<C&&(C=H.z)),t.add(H);var q={minX:V,minY:v,maxX:J,maxY:w};return s&&(q.maxZ=n,q.minZ=C),q};var Hp=function(M){zg.call(this),this.actions=[],M&&this.fromPoints(M)},yf=Hp.prototype=Ep(zg.prototype),wq="moveTo",Ab="lineTo",Hj="quadraticCurveTo",Lh="bezierCurveTo",oh="arc",Zg="ellipse";yf.fromPoints=function(H){this.moveTo(H[0].x,H[0].y);for(var a=1,G=H.length;G>a;a++)this.lineTo(H[a].x,H[a].y)},yf.moveTo=function(){var l=Array.prototype.slice.call(arguments);this.actions.push({action:wq,args:l})},yf.lineTo=function(m,l){var u=Array.prototype.slice.call(arguments),X=this.actions[this.actions.length-1].args,h=X[X.length-2],V=X[X.length-1],d=new Hd(new td(h,V),new td(m,l));this.curves.push(d),this.actions.push({action:Ab,args:u})},yf.quadraticCurveTo=function(e,z,f,H){var V=Array.prototype.slice.call(arguments),W=this.actions[this.actions.length-1].args,y=W[W.length-2],S=W[W.length-1],r=new Po(new td(y,S),new td(e,z),new td(f,H));this.curves.push(r),this.actions.push({action:Hj,args:V})},yf.bezierCurveTo=function(O,$,p,P,D,Z){var x=Array.prototype.slice.call(arguments),B=this.actions[this.actions.length-1].args,e=B[B.length-2],w=B[B.length-1],N=new Mm(new td(e,w),new td(O,$),new td(p,P),new td(D,Z));this.curves.push(N),this.actions.push({action:Lh,args:x})},yf.arc=function(P,j,Z,k,U,X){var z=this.actions[this.actions.length-1].args,W=z[z.length-2],D=z[z.length-1];this.absarc(P+W,j+D,Z,k,U,X)},yf.absarc=function(Z,W,s,b,t,C){this.absellipse(Z,W,s,s,b,t,C)},yf.ellipse=function(g,S,_,M,q,x,H){var F=this.actions[this.actions.length-1].args,u=F[F.length-2],k=F[F.length-1];this.absellipse(g+u,S+k,_,M,q,x,H)},yf.absellipse=function(M,W,J,F,y,s,C){var l=Array.prototype.slice.call(arguments),_=new Nf(M,W,J,F,y,s,C);this.curves.push(_);var K=_.getPoint(1);l.push(K.x),l.push(K.y),this.actions.push({action:Zg,args:l})},yf.getSpacedPoints=function(Y){Y||(Y=40);for(var W=[],b=0;Y>b;b++)W.push(this.getPoint(b/Y));return W},yf.getPoints=function(K,e){K=K||12;var s,X,T,l,b,F,n,S,_,i,f,U,v,u,I,m,L,k,C=[];for(s=0,X=this.actions.length;X>s;s++)switch(T=this.actions[s],l=T.action,b=T.args,l){case wq:C.push(new td(b[0],b[1]));break;case Ab:C.push(new td(b[0],b[1]));break;case Hj:for(F=b[2],n=b[3],i=b[0],f=b[1],C.length>0?(u=C[C.length-1],U=u.x,v=u.y):(u=this.actions[s-1].args,U=u[u.length-2],v=u[u.length-1]),I=1;K>=I;I++)m=I/K,L=lc.b2(m,U,i,F),k=lc.b2(m,v,f,n),C.push(new td(L,k));break;case Lh:for(F=b[4],n=b[5],i=b[0],f=b[1],S=b[2],_=b[3],C.length>0?(u=C[C.length-1],U=u.x,v=u.y):(u=this.actions[s-1].args,U=u[u.length-2],v=u[u.length-1]),I=1;K>=I;I++)m=I/K,L=lc.b3(m,U,i,S,F),k=lc.b3(m,v,f,_,n),C.push(new td(L,k));break;case oh:var Y,h=b[0],j=b[1],x=b[2],c=b[3],G=b[4],R=!!b[5],Q=G-c,E=2*K;for(I=1;E>=I;I++)m=I/E,R||(m=1-m),Y=c+m*Q,L=h+x*P(Y),k=j+x*t(Y),C.push(new td(L,k));break;case Zg:var Y,h=b[0],j=b[1],W=b[2],o=b[3],c=b[4],G=b[5],R=!!b[6],Q=G-c,E=2*K;for(I=1;E>=I;I++)m=I/E,R||(m=1-m),Y=c+m*Q,L=h+W*P(Y),k=j+o*t(Y),C.push(new td(L,k))}var H=C[C.length-1],a=1e-10;return A(H.x-C[0].x)<a&&A(H.y-C[0].y)<a&&C.splice(C.length-1,1),e&&C.push(C[0]),C},yf.toShapes=function(x,q){function l(f){var v,F,w,P,K,A=[],m=new Hp;for(v=0,F=f.length;F>v;v++)w=f[v],K=w.args,P=w.action,P==wq&&0!=m.actions.length&&(A.push(m),m=new Hp),m[P].apply(m,K);return 0!=m.actions.length&&A.push(m),A}function W(H){for(var U=[],N=0,f=H.length;f>N;N++){var E=H[N],t=new bo;t.actions=E.actions,t.curves=E.curves,U.push(t)}return U}function K(b,P){for(var h=1e-10,i=P.length,y=!1,L=i-1,Q=0;i>Q;L=Q++){var x=P[L],c=P[Q],E=c.x-x.x,$=c.y-x.y;if(A($)>h){if(0>$&&(x=P[Q],E=-E,c=P[L],$=-$),b.y<x.y||b.y>c.y)continue;if(b.y==x.y){if(b.x==x.x)return!0}else{var z=$*(b.x-x.x)-E*(b.y-x.y);if(0==z)return!0;if(0>z)continue;y=!y}}else{if(b.y!=x.y)continue;if(c.x<=b.x&&b.x<=x.x||x.x<=b.x&&b.x<=c.x)return!0}}return y}var v=l(this.actions);if(0==v.length)return[];if(q===!0)return W(v);var F,$,y,e=[];if(1==v.length)return $=v[0],y=new bo,y.actions=$.actions,y.curves=$.curves,e.push(y),e;var V=!lc.isClockWise(v[0].getPoints());V=x?!V:V;var k,U=[],T=[],L=[],J=0;T[J]=w,L[J]=[];var D,h;for(D=0,h=v.length;h>D;D++)$=v[D],k=$.getPoints(),F=lc.isClockWise(k),F=x?!F:F,F?(!V&&T[J]&&J++,T[J]={s:new bo,p:k},T[J].s.actions=$.actions,T[J].s.curves=$.curves,V&&J++,L[J]=[]):L[J].push({h:$,p:k[0]});if(!T[0])return W(v);if(T.length>1){for(var Z=!1,H=[],B=0,I=T.length;I>B;B++)U[B]=[];for(var B=0,I=T.length;I>B;B++){T[B];for(var Y=L[B],X=0;X<Y.length;X++){for(var t=Y[X],d=!0,a=0;a<T.length;a++)K(t.p,T[a].p)&&(B!=a&&H.push({froms:B,tos:a,hole:X}),d?(d=!1,U[a].push(t)):Z=!0);d&&U[B].push(t)}}H.length>0&&(Z||(L=U))}var j,Q,E;for(D=0,h=T.length;h>D;D++)for(y=T[D].s,e.push(y),j=L[D],Q=0,E=j.length;E>Q;Q++)y.holes.push(j[Q].h);return e};var bo=function(){Hp.apply(this,arguments),this.holes=[]},zc=bo.prototype=Ep(yf);zc.getPointsHoles=function(M){var D,e=this.holes.length,W=[];for(D=0;e>D;D++)W[D]=this.holes[D].getTransformedPoints(M);return W},zc.extractAllPoints=function(T){return{shape:this.getTransformedPoints(T),holes:this.getPointsHoles(T)}},zc.extractPoints=function(Q){return this.extractAllPoints(Q)};var lc={triangulateShape:function(E,c){function C(_,P,b){return _.x!=P.x?_.x<P.x?_.x<=b.x&&b.x<=P.x:P.x<=b.x&&b.x<=_.x:_.y<P.y?_.y<=b.y&&b.y<=P.y:P.y<=b.y&&b.y<=_.y}function b(c,l,F,Z,D){var h=1e-10,t=l.x-c.x,O=l.y-c.y,o=Z.x-F.x,K=Z.y-F.y,u=c.x-F.x,G=c.y-F.y,X=O*o-t*K,$=O*u-t*G;if(A(X)>h){var q;if(X>0){if(0>$||$>X)return[];if(q=K*u-o*G,0>q||q>X)return[]}else{if($>0||X>$)return[];if(q=K*u-o*G,q>0||X>q)return[]}if(0==q)return!D||0!=$&&$!=X?[c]:[];if(q==X)return!D||0!=$&&$!=X?[l]:[];if(0==$)return[F];if($==X)return[Z];var E=q/X;return[{x:c.x+E*t,y:c.y+E*O}]}if(0!=$||K*u!=o*G)return[];var d=0==t&&0==O,w=0==o&&0==K;if(d&&w)return c.x!=F.x||c.y!=F.y?[]:[c];if(d)return C(F,Z,c)?[c]:[];if(w)return C(c,l,F)?[F]:[];var e,N,i,M,Y,n,g,T;return 0!=t?(c.x<l.x?(e=c,i=c.x,N=l,M=l.x):(e=l,i=l.x,N=c,M=c.x),F.x<Z.x?(Y=F,g=F.x,n=Z,T=Z.x):(Y=Z,g=Z.x,n=F,T=F.x)):(c.y<l.y?(e=c,i=c.y,N=l,M=l.y):(e=l,i=l.y,N=c,M=c.y),F.y<Z.y?(Y=F,g=F.y,n=Z,T=Z.y):(Y=Z,g=Z.y,n=F,T=F.y)),g>=i?g>M?[]:M==g?D?[]:[Y]:T>=M?[Y,N]:[Y,n]:i>T?[]:i==T?D?[]:[e]:T>=M?[e,N]:[e,n]}function q(I,v,d,s){var M=1e-10,h=v.x-I.x,R=v.y-I.y,Y=d.x-I.x,m=d.y-I.y,$=s.x-I.x,N=s.y-I.y,S=h*m-R*Y,Z=h*N-R*$;if(A(S)>M){var P=$*m-N*Y;return S>0?Z>=0&&P>=0:Z>=0||P>=0}return Z>0}function p(B,j){function N(x,m){var Y=n.length-1,j=x-1;0>j&&(j=Y);var I=x+1;I>Y&&(I=0);var p=q(n[x],n[j],n[I],F[m]);if(!p)return!1;var T=F.length-1,H=m-1;0>H&&(H=T);var C=m+1;return C>T&&(C=0),p=q(F[m],F[H],F[C],n[x]),p?!0:!1}function p(u,l){var U,R,$;for(U=0;U<n.length;U++)if(R=U+1,R%=n.length,$=b(u,l,n[U],n[R],!0),$.length>0)return!0;return!1}function x(o,y){var L,d,J,B,q;for(L=0;L<z.length;L++)for(d=j[z[L]],J=0;J<d.length;J++)if(B=J+1,B%=d.length,q=b(o,y,d[J],d[B],!0),q.length>0)return!0;return!1}for(var F,L,V,u,c,h,D,G,X,J,T,n=B.concat(),z=[],y=[],K=0,g=j.length;g>K;K++)z.push(K);for(var P=0,l=2*z.length;z.length>0&&(l--,!(0>l));)for(V=P;V<n.length;V++){u=n[V],L=-1;for(var K=0;K<z.length;K++)if(h=z[K],D=u.x+":"+u.y+":"+h,y[D]===w){F=j[h];for(var i=0;i<F.length;i++)if(c=F[i],N(V,i)&&!p(u,c)&&!x(u,c)){L=i,z.splice(K,1),G=n.slice(0,V+1),X=n.slice(V),J=F.slice(L),T=F.slice(0,L+1),n=G.concat(J).concat(T).concat(X),P=V;break}if(L>=0)break;y[D]=!0}if(L>=0)break}return n}for(var j,P,a,T,I,Y,z={},d=E.concat(),r=0,B=c.length;B>r;r++)Array.prototype.push.apply(d,c[r]);for(j=0,P=d.length;P>j;j++)I=d[j].x+":"+d[j].y,z[I]!==w,z[I]=j;var S=p(E,c),J=Hk.Triangulate(S,!1);for(j=0,P=J.length;P>j;j++)for(T=J[j],a=0;3>a;a++)I=T[a].x+":"+T[a].y,Y=z[I],Y!==w&&(T[a]=Y);return J.concat()},isClockWise:function(D){return Hk.Triangulate.area(D)<0},b2p0:function(T,N){var b=1-T;return b*b*N},b2p1:function(I,v){return 2*(1-I)*I*v},b2p2:function(g,a){return g*g*a},b2:function(g,d,m,b){return this.b2p0(g,d)+this.b2p1(g,m)+this.b2p2(g,b)},b3p0:function(M,j){var p=1-M;return p*p*p*j},b3p1:function(K,b){var U=1-K;return 3*U*U*K*b},b3p2:function(C,y){var F=1-C;return 3*F*C*C*y},b3p3:function(t,C){return t*t*t*C},b3:function(R,T,m,k,y){return this.b3p0(R,T)+this.b3p1(R,m)+this.b3p2(R,k)+this.b3p3(R,y)}},Hk={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var p=D.keys(this.faces);return p.length?p[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(C){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(R){var S=R.familyName.toLowerCase(),n=this;return n.faces[S]=n.faces[S]||{},n.faces[S][R.cssFontWeight]=n.faces[S][R.cssFontWeight]||{},n.faces[S][R.cssFontWeight][R.cssFontStyle]=R,R},drawText:function(t){var Z,Q=this.getFace(),i=this.size/Q.resolution,G=0,l=String(t).split(""),J=l.length,H=[];for(Z=0;J>Z;Z++){var F=new Hp,j=this.extractGlyphPoints(l[Z],Q,i,G,F);j&&(G+=j.offset*this.spacing,H.push(j.path))}var h=G/2;return{paths:H,offset:h}},extractGlyphPoints:function(Y,N,o,D,d){var g,w,G,C,b,z,m,i,f,M,Z,A,x,j,Q,L,V,y,H,s=[],E=N.glyphs[Y]||N.glyphs["?"];if(E){if(E.o)for(C=E._cachedOutline||(E._cachedOutline=E.o.split(" ")),z=C.length,m=o,i=o,g=0;z>g;)switch(b=C[g++]){case"m":f=C[g++]*m+D,M=C[g++]*i,d.moveTo(f,M);break;case"l":f=C[g++]*m+D,M=C[g++]*i,d.lineTo(f,M);break;case"q":if(Z=C[g++]*m+D,A=C[g++]*i,Q=C[g++]*m+D,L=C[g++]*i,d.quadraticCurveTo(Q,L,Z,A),H=s[s.length-1])for(x=H.x,j=H.y,w=1,G=this.divisions;G>=w;w++){var k=w/G;lc.b2(k,x,Q,Z),lc.b2(k,j,L,A)}break;case"b":if(Z=C[g++]*m+D,A=C[g++]*i,Q=C[g++]*m+D,L=C[g++]*i,V=C[g++]*m+D,y=C[g++]*i,d.bezierCurveTo(Q,L,V,y,Z,A),H=s[s.length-1])for(x=H.x,j=H.y,w=1,G=this.divisions;G>=w;w++){var k=w/G;lc.b3(k,x,Q,V,Z),lc.b3(k,j,L,y,A)}}return{offset:E.ha*o,path:d}}}};Hk.generateShapes=function(u,c){c=c||{};var f=c.font;if(f===w&&(f=Hk.getDefaultFont(),!f))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var n=c.size!==w?c.size:1,e=c.curveSegments!==w?c.curveSegments:4,i=c.spacing!==w?c.spacing:1,W=c.weight!==w?c.weight:"normal",g=c.style!==w?c.style:"normal";Hk.size=n,Hk.divisions=e,Hk.face=f,Hk.weight=W,Hk.style=g,Hk.spacing=i;for(var G=Hk.drawText(u),A=G.paths,K=[],_=0,U=A.length;U>_;_++)Array.prototype.push.apply(K,A[_].toShapes());return K},function(Z){var G=1e-10,u=function(H,v){var Z=H.length;if(3>Z)return null;var o,r,R,L=[],B=[],u=[];if(g(H)>0)for(r=0;Z>r;r++)B[r]=r;else for(r=0;Z>r;r++)B[r]=Z-1-r;var l=Z,s=2*l;for(r=l-1;l>2;){if(s--<=0)return v?u:L;if(o=r,o>=l&&(o=0),r=o+1,r>=l&&(r=0),R=r+1,R>=l&&(R=0),N(H,o,r,R,l,B)){var F,a,z,c,J;for(F=B[o],a=B[r],z=B[R],L.push([H[F],H[a],H[z]]),u.push([B[o],B[r],B[R]]),c=r,J=r+1;l>J;c++,J++)B[c]=B[J];l--,s=2*l}}return v?u:L},g=function(h){for(var n=h.length,M=0,z=n-1,I=0;n>I;z=I++)M+=h[z].x*h[I].y-h[I].x*h[z].y;return.5*M},N=function(w,q,u,l,r,H){var M,B,U,n,T,Q,c,R,m;if(B=w[H[q]].x,U=w[H[q]].y,n=w[H[u]].x,T=w[H[u]].y,Q=w[H[l]].x,c=w[H[l]].y,G>(n-B)*(c-U)-(T-U)*(Q-B))return!1;var o,S,j,z,W,A,h,v,E,N,f,C,F,I,$;
for(o=Q-n,S=c-T,j=B-Q,z=U-c,W=n-B,A=T-U,M=0;r>M;M++)if(R=w[H[M]].x,m=w[H[M]].y,!(R===B&&m===U||R===n&&m===T||R===Q&&m===c)&&(h=R-B,v=m-U,E=R-n,N=m-T,f=R-Q,C=m-c,$=o*N-S*E,F=W*v-A*h,I=j*C-z*f,$>=-G&&I>=-G&&F>=-G))return!1;return!0};return Z.Triangulate=u,Z.Triangulate.area=g,Z}(Hk),K._typeface_js={faces:Hk.faces,loadFace:Hk.loadFace};var Aj=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},wf=Aj.prototype={constructor:Aj,computeFaceNormals:function(){for(var i=new tc,x=new tc,C=0,r=this.faces.length;r>C;C++){var E=this.faces[C],v=this.vertices[E.a],m=this.vertices[E.b],k=this.vertices[E.c];i.subVectors(k,m),x.subVectors(v,m),i.cross(x),i.normalize(),E.normal.copy(i)}},computeVertexNormals:function(w){var h,q,J,O,W,Y;for(Y=new Array(this.vertices.length),h=0,q=this.vertices.length;q>h;h++)Y[h]=new tc;if(w){var u,P,t,U=new tc,s=new tc;for(J=0,O=this.faces.length;O>J;J++)W=this.faces[J],u=this.vertices[W.a],P=this.vertices[W.b],t=this.vertices[W.c],U.subVectors(t,P),s.subVectors(u,P),U.cross(s),Y[W.a].add(U),Y[W.b].add(U),Y[W.c].add(U)}else for(J=0,O=this.faces.length;O>J;J++)W=this.faces[J],Y[W.a].add(W.normal),Y[W.b].add(W.normal),Y[W.c].add(W.normal);for(h=0,q=this.vertices.length;q>h;h++)Y[h].normalize();for(J=0,O=this.faces.length;O>J;J++)W=this.faces[J],W.vertexNormals[0]=Y[W.a].clone(),W.vertexNormals[1]=Y[W.b].clone(),W.vertexNormals[2]=Y[W.c].clone()},mergeVertices:function(){var d,b,J,Q,l,q,B,a,P={},g=[],j=[],K=4,t=U(10,K);for(J=0,Q=this.vertices.length;Q>J;J++)d=this.vertices[J],b=T(d.x*t)+"_"+T(d.y*t)+"_"+T(d.z*t),P[b]===w?(P[b]=J,g.push(this.vertices[J]),j[J]=g.length-1):j[J]=j[P[b]];var X=[];for(J=0,Q=this.faces.length;Q>J;J++){l=this.faces[J],l.a=j[l.a],l.b=j[l.b],l.c=j[l.c],q=[l.a,l.b,l.c];for(var e=0;3>e;e++)if(q[e]==q[(e+1)%3]){X.push(J);break}}for(J=X.length-1;J>=0;J--){var h=X[J];for(this.faces.splice(h,1),B=0,a=this.faceVertexUvs.length;a>B;B++)this.faceVertexUvs[B].splice(h,1)}var p=this.vertices.length-g.length;return this.vertices=g,p}},Nf=function(b,l,X,w,G,S,k){this.aX=b,this.aY=l,this.xRadius=X,this.yRadius=w,this.aStartAngle=G,this.aEndAngle=S,this.aClockwise=k};Nf.prototype=Ep(gd),Nf.prototype.getPoint=function(F){var j,u=this.aEndAngle-this.aStartAngle;0>u&&(u+=v),u>v&&(u-=v),j=this.aClockwise===!0?this.aEndAngle+(1-F)*(v-u):this.aStartAngle+F*u;var X=this.aX+this.xRadius*P(j),y=this.aY+this.yRadius*t(j);return new td(X,y)};var Hd=function(c,P){this.v1=c,this.v2=P},_h=Hd.prototype=Ep(gd);_h.getPoint=function(n){var M=this.v2.clone().sub(this.v1);return M.multiplyScalar(n).add(this.v1),M},_h.getPointAt=function(N){return this.getPoint(N)},_h.getTangent=function(){var I=this.v2.clone().sub(this.v1);return I.normalize()};var Po=function(k,j,x){this.v0=k,this.v1=j,this.v2=x};Po.prototype=Ep(gd),Po.prototype.getPoint=function(T){var r,v;return r=lc.b2(T,this.v0.x,this.v1.x,this.v2.x),v=lc.b2(T,this.v0.y,this.v1.y,this.v2.y),new td(r,v)};var Mm=function(t,q,k,d){this.v0=t,this.v1=q,this.v2=k,this.v3=d};Mm.prototype=Ep(gd),Mm.prototype.getPoint=function(w){var r,R;return r=lc.b3(w,this.v0.x,this.v1.x,this.v2.x,this.v3.x),R=lc.b3(w,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new td(r,R)},Yr.create(function(F,k){this.v1=F,this.v2=k},function(E){var P=new tc;return P.subVectors(this.v2,this.v1),P.multiplyScalar(E),P.add(this.v1),P});var zb=Yr.create(function(j,t,x){this.v0=j,this.v1=t,this.v2=x},function(k){var W,m,D;return W=lc.b2(k,this.v0.x,this.v1.x,this.v2.x),m=lc.b2(k,this.v0.y,this.v1.y,this.v2.y),D=lc.b2(k,this.v0.z,this.v1.z,this.v2.z),new tc(W,m,D)}),wp=Yr.create(function(x,H,e,v){this.v0=x,this.v1=H,this.v2=e,this.v3=v},function(L){var X,z,u;return X=lc.b3(L,this.v0.x,this.v1.x,this.v2.x,this.v3.x),z=lc.b3(L,this.v0.y,this.v1.y,this.v2.y,this.v3.y),u=lc.b3(L,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new tc(X,z,u)}),Mg=function(X,q,F,I,N,G,d,x){Aj.call(this),I=I!==w?I:.5,N=N!==w?N:.5,x=x!==w?x:1,X=X||8,G=G||0,d=d||v;var D,l,A=1,K=x/2,o=[],h=[],b=this.vertices,y=this.faces,L=this.faceVertexUvs;for(l=0;A>=l;l++){var j=[],i=[],C=l/A,s=C*(N-I)+I;for(D=0;X>=D;D++){var g=D/X,H=new tc,u=-(g*d+G);H.z=s*t(u),H.y=-C*x+K,H.x=s*P(u),b.push(H),j.push(b.length-1),i.push(new td(g,C))}o.push(j),h.push(i)}var B,f,$=(N-I)/x;for(D=0;X>D;D++)for(0!==I?(B=b[o[0][D]].clone(),f=b[o[0][D+1]].clone()):(B=b[o[1][D]].clone(),f=b[o[1][D+1]].clone()),B.setY(O(B.x*B.x+B.z*B.z)*$).normalize(),f.setY(O(f.x*f.x+f.z*f.z)*$).normalize(),l=0;A>l;l++){var U=o[l][D],S=o[l+1][D],m=o[l+1][D+1],Y=o[l][D+1],J=B.clone(),E=B.clone(),c=f.clone(),k=f.clone(),n=h[l][D].clone(),T=h[l+1][D].clone(),e=h[l+1][D+1].clone(),z=h[l][D+1].clone();y.push(new Xf(U,S,Y,[J,E,k])),L[0].push([n,T,z]),y.push(new Xf(S,m,Y,[E.clone(),c,k.clone()])),L[0].push([T.clone(),e,z.clone()])}if(q&&I>0)for(this.vertices.push(new tc(0,K,0)),D=0;X>D;D++){var U=o[0][D],S=o[0][D+1],m=this.vertices.length-1,J=new tc(0,1,0),E=new tc(0,1,0),c=new tc(0,1,0),n=h[0][D].clone(),T=h[0][D+1].clone(),e=new td(T.x,0);y.push(new Xf(U,S,m,[J,E,c],null,1));var Z=D/X*v,Q=P(Z),r=t(Z),M=(D+1)/X*v,p=P(M),a=t(M);L[0].push([new td(.5+.5*Q,.5+.5*r),new td(.5+.5*p,.5+.5*a),new td(.5,.5)])}if(F&&N>0)for(this.vertices.push(new tc(0,-K,0)),D=0;X>D;D++){var U=o[l][D+1],S=o[l][D],m=b.length-1,J=new tc(0,-1,0),E=new tc(0,-1,0),c=new tc(0,-1,0),n=h[l][D+1].clone(),T=h[l][D].clone();y.push(new Xf(U,S,m,[J,E,c],null,2));var Z=D/X*v,Q=P(Z),r=t(Z),M=(D+1)/X*v,p=P(M),a=t(M);L[0].push([new td(.5+.5*p,.5-.5*a),new td(.5+.5*Q,.5-.5*r),new td(.5,.5)])}};Mg.prototype=Ep(wf);var Dh=function(S,r,q,b,k,V,o){Aj.call(this),o=o||.5,S=S||16,r=r||16,q=(q!==w?q:0)-_,b=b!==w?b:v,k=k!==w?k:0,V=V!==w?V:_;var n,m,z=[],E=[],R=this.vertices,i=this.faces,N=this.faceVertexUvs;for(m=0;r>=m;m++){var c=[],e=[];for(n=0;S>=n;n++){var u=n/S,U=m/r,Y=new tc;Y.x=-o*P(q+u*b)*t(k+U*V),Y.y=o*P(k+U*V),Y.z=o*t(q+u*b)*t(k+U*V),R.push(Y),c.push(R.length-1),e.push(new td(u,U))}z.push(c),E.push(e)}for(m=0;r>m;m++)for(n=0;S>n;n++){var D=z[m][n+1],g=z[m][n],C=z[m+1][n],y=z[m+1][n+1],W=R[D].clone().normalize(),O=R[g].clone().normalize(),s=R[C].clone().normalize(),l=R[y].clone().normalize(),X=E[m][n+1].clone(),H=E[m][n].clone(),p=E[m+1][n].clone(),f=E[m+1][n+1].clone();A(R[D].y)===o?(X.x=(X.x+H.x)/2,i.push(new Xf(D,C,y,[W,s,l])),N[0].push([X,p,f])):A(R[C].y)===o?(p.x=(p.x+f.x)/2,i.push(new Xf(D,g,C,[W,O,s])),N[0].push([X,H,p])):(i.push(new Xf(D,g,y,[W,O,l])),N[0].push([X,H,f]),i.push(new Xf(g,C,y,[O.clone(),s,l.clone()])),N[0].push([H.clone(),p,f.clone()]))}};Dh.prototype=Ep(wf);var xd=function(L,b,j,T,f,M){Aj.call(this),L=L||.33,b=b||.17,T=T||8,j=j||6,f=f||0,M=M||v;for(var k=new tc,o=[],p=[],e=0;T>=e;e++)for(var w=e/T*v+_,C=0;j>=C;C++){var m=C/j*M+f;k.x=L*P(m),k.z=-L*t(m);var E=new tc,G=L+b*P(w);E.x=G*P(m),E.z=-G*t(m),E.y=b*t(w),this.vertices.push(E),o.push(new td(C/j,1-e/T)),p.push(E.clone().sub(k).normalize())}for(var e=1;T>=e;e++)for(var C=1;j>=C;C++){var z=(j+1)*e+C-1,A=(j+1)*(e-1)+C-1,Z=(j+1)*(e-1)+C,W=(j+1)*e+C,X=new Xf(z,A,W,[p[z].clone(),p[A].clone(),p[W].clone()]);this.faces.push(X),this.faceVertexUvs[0].push([o[z].clone(),o[A].clone(),o[W].clone()]),X=new Xf(A,Z,W,[p[A].clone(),p[Z].clone(),p[W].clone()]),this.faces.push(X),this.faceVertexUvs[0].push([o[A].clone(),o[Z].clone(),o[W].clone()])}this.computeFaceNormals()};xd.prototype=Ep(wf);var gc=function(s,c,v){return s?(Aj.call(this),s=s instanceof Array?s:[s],this.addShapeList(s,c),c.convertYZ!==!1&&Om(this,v),this.computeFaceNormals(),void 0):(s=[],void 0)},Cj=gc.prototype=Ep(Aj.prototype);Cj.addShapeList=function(x,N){for(var J=x.length,F=0;J>F;F++){var P=x[F];this.addShape(P,N)}},Cj.addShape=function(q,u){function C(){if(u.bottom)for(var d=0;v>d;d++)k=Y[d],g(k[2],k[1],k[0],!0);if(u.top)for(d=0;v>d;d++)k=Y[d],g(k[0]+E*n,k[1]+E*n,k[2]+E*n,!1)}function U(){var N=0;for(t(e,N),N+=e.length,I=0,G=y.length;G>I;I++)W=y[I],t(W,N),N+=W.length}function t(Z,J){for(var H,f,d=Z.length;--d>=0;){H=d,f=d-1,0>f&&(f=Z.length-1);var G=0,T=n;for(G=0;T>G;G++){var R=E*G,B=E*(G+1),z=J+H+R,v=J+f+R,w=J+f+B,m=J+H+B;p(z,v,w,m,Z,G,T,H,f)}}}function i(M,y,Q){D.vertices.push(new tc(M,y,Q))}function g(m,Z,j,W){m+=x,Z+=x,j+=x,D.faces.push(new Xf(m,Z,j,null,null,W?2:1));var s=W?O.generateBottomUV(D,q,u,m,Z,j):O.generateTopUV(D,q,u,m,Z,j);D.faceVertexUvs[0].push(s)}function p(w,H,R,m,v,z,t,U,d){w+=x,H+=x,R+=x,m+=x,D.faces.push(new Xf(w,H,m)),D.faces.push(new Xf(H,R,m));var p=O.generateSideWallUV(D,q,v,u,w,H,R,m,z,t,U,d);D.faceVertexUvs[0].push([p[0],p[1],p[3]]),D.faceVertexUvs[0].push([p[1],p[2],p[3]])}var H,Q,J,N,L,h=u.amount,$=u.curveSegments||Al,n=u.steps||1,B=u.extrudePath,V=!1,O=new wh(u.repeatUVLength);B&&(H=B.getSpacedPoints(n),V=!0,Q=u.frames!==w?u.frames:new Wn.FrenetFrames(B,n,!1),J=new tc,N=new tc,L=new tc);var W,I,G,D=this,x=this.vertices.length,K=q.extractPoints($),P=K.shape,y=K.holes,c=!lc.isClockWise(P);if(c){for(P=P.reverse(),I=0,G=y.length;G>I;I++)W=y[I],lc.isClockWise(W)&&(y[I]=W.reverse());c=!1}var Y=lc.triangulateShape(P,y),e=P;for(I=0,G=y.length;G>I;I++)W=y[I],P=P.concat(W);for(var m,k,E=P.length,v=Y.length,s=0;E>s;s++)m=P[s],V?(N.copy(Q.normals[0]).multiplyScalar(m.x),J.copy(Q.binormals[0]).multiplyScalar(m.y),L.copy(H[0]).add(N).add(J),i(L.x,L.y,L.z)):i(m.x,m.y,0);var z;for(z=1;n>=z;z++)for(s=0;E>s;s++)m=P[s],V?(N.copy(Q.normals[z]).multiplyScalar(m.x),J.copy(Q.binormals[z]).multiplyScalar(m.y),L.copy(H[z]).add(N).add(J),i(L.x,L.y,L.z)):i(m.x,m.y,h/n*z);C(),U()};var Wn=function(R,Z,S,y,c){function A(g,y,G){return e.vertices.push(new tc(g,y,G))-1}Aj.call(this),Z=Z||64,S=S||1,y=y||8,c=c||!1;var G,b,Y,$,p,k,E,n,O,x,j,q,V,r,u,D,B,s,d,L,m=[],e=this,f=Z+1,o=new tc,F=new Wn.FrenetFrames(R,Z,c),N=F.tangents,g=F.normals,M=F.binormals;for(this.tangents=N,this.normals=g,this.binormals=M,O=0;f>O;O++)for(m[O]=[],$=O/(f-1),n=R.getPointAt($),G=N[O],b=g[O],Y=M[O],x=0;y>x;x++)p=x/y*v,k=-S*P(p),E=S*t(p),o.copy(n),o.x+=k*b.x+E*Y.x,o.y+=k*b.y+E*Y.y,o.z+=k*b.z+E*Y.z,m[O][x]=A(o.x,o.y,o.z);for(O=0;Z>O;O++)for(x=0;y>x;x++)j=c?(O+1)%Z:O+1,q=(x+1)%y,V=m[O][x],r=m[j][x],u=m[j][q],D=m[O][q],B=new td(O/Z,x/y),s=new td((O+1)/Z,x/y),d=new td((O+1)/Z,(x+1)/y),L=new td(O/Z,(x+1)/y),this.faces.push(new Xf(V,r,D)),this.faceVertexUvs[0].push([B,s,L]),this.faces.push(new Xf(r,u,D)),this.faceVertexUvs[0].push([s.clone(),d,L.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};Wn.prototype=Ep(wf),Wn.FrenetFrames=function(p,P,E){function e(){s[0]=new tc,V[0]=new tc,k=Number.MAX_VALUE,y=A(C[0].x),Y=A(C[0].y),B=A(C[0].z),k>=y&&(k=y,f.set(1,0,0)),k>=Y&&(k=Y,f.set(0,1,0)),k>=B&&f.set(0,0,1),$.crossVectors(C[0],f).normalize(),s[0].crossVectors(C[0],$),V[0].crossVectors(C[0],s[0])}var U,k,y,Y,B,m,v,f=new tc,C=[],s=[],V=[],$=new tc,L=new gn,F=P+1,M=1e-4;for(this.tangents=C,this.normals=s,this.binormals=V,m=0;F>m;m++)v=m/(F-1),C[m]=p.getTangentAt(v),C[m].normalize();for(e(),m=1;F>m;m++)s[m]=s[m-1].clone(),V[m]=V[m-1].clone(),$.crossVectors(C[m-1],C[m]),$.length()>M&&($.normalize(),U=r(Mk(C[m-1].dot(C[m]),-1,1)),s[m].applyMatrix4(L.makeRotationAxis($,U))),V[m].crossVectors(C[m],s[m]);if(E)for(U=r(Mk(s[0].dot(s[F-1]),-1,1)),U/=F-1,C[0].dot($.crossVectors(s[0],s[F-1]))>0&&(U=-U),m=1;F>m;m++)s[m].applyMatrix4(L.makeRotationAxis(C[m],U*m)),V[m].crossVectors(C[m],s[m])};var tk=function(y,n,L,B){Aj.call(this),n=n||18,L=L||0,B=B==s?v:B;for(var o=1/(y.length-1),J=1/n,r=0,G=n;G>=r;r++)for(var z=L+r*J*B,h=P(z),k=t(z),i=0,I=y.length;I>i;i++){var u=y[i],A=new tc;A.x=h*u.x-k*u.y,A.y=k*u.x+h*u.y,A.z=u.z,this.vertices.push(A)}for(var E=y.length,r=0,G=n;G>r;r++)for(var i=0,I=y.length-1;I>i;i++){var g=i+E*r,l=g,V=g+E,h=g+1+E,q=g+1,H=r*J,e=i*o,b=H+J,U=e+o;this.faces.push(new Xf(l,q,V)),this.faceVertexUvs[0].push([new td(H,e),new td(H,U),new td(b,e)]),this.faces.push(new Xf(V,q,h)),this.faceVertexUvs[0].push([new td(b,e),new td(H,U),new td(b,U)])}this.mergeVertices(),Om(this),this.computeFaceNormals(),this.computeVertexNormals()};tk.prototype=Ep(wf);var lr=function(d,b){b=b||{};var V=Hk.generateShapes(d,b);b.amount=b.amount!==w?b.amount:.5,b.convertYZ=!1,b.fill!==!1&&(b.bottom=!0,b.top=!0),gc.call(this,V,b)};lr.prototype=Ep(Cj);var Zm=c.Node=function(){fm(Zm,this)},Dl={X:_o,Y:zq,Z:Bf},uq={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},Cp="xzy",Mn=function(B,b,i){if(b){var o=b[0],u=b[1],g=b[2];"xzy"===i?(zq(B,u),Bf(B,g),_o(B,o)):"xyz"===i?(Bf(B,g),zq(B,u),_o(B,o)):"yxz"===i?(Bf(B,g),_o(B,o),zq(B,u)):"yzx"===i?(_o(B,o),Bf(B,g),zq(B,u)):"zxy"===i?(zq(B,u),_o(B,o),Bf(B,g)):"zyx"===i?(_o(B,o),zq(B,u),Bf(B,g)):(zq(B,u),Bf(B,g),_o(B,o))}};If("Node",yb,{ms_ac:["rotationMode","anchorElevation"],_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:Cp,_64O:0,_rotationX:0,_53O:0,_host:s,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return Yh},_22Q:function(){return Ik},getX:function(){return this.p().x},setX:function(i){this.p(i,this.p().y)},getY:function(){return this.p().y},setY:function(t){this.p(this.p().x,t)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(D){this.setAnchor(D,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(v){this.setAnchor(this.getAnchor().x,v)},getScaleX:function(){return this.getScale().x},setScaleX:function(J){this.setScale(J,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(l){this.setScale(this.getScale().x,l)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(t,U){kh(t,Fb(s,s,this.r3(),this.getRotationMode())),this.translate3d(t[0]*U,t[1]*U,t[2]*U)},translateFront:function(y){this.translate3dBy([0,0,1],y)},translateBack:function(X){this.translate3dBy([0,0,-1],X)},translateLeft:function(f){this.translate3dBy([-1,0,0],f)},translateRight:function(c){this.translate3dBy([1,0,0],c)},translateTop:function(I){this.translate3dBy([0,1,0],I)},translateBottom:function(V){this.translate3dBy([0,-1,0],V)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(R,w,A){1===arguments.length&&(w=R[1],A=R[2],R=R[0]),this.p(R,A),this.setElevation(w)},translate3d:function(n,w,l){1===arguments.length&&(w=n[1],l=n[2],n=n[0]),this.translate(n,l),this.setElevation(this._54O+w)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(v,s,p){1===arguments.length&&(s=v[1],p=v[2],v=v[0]),this.setSize(v,p),this.setTall(s)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(b,J,m){1===arguments.length&&(J=b[1],m=b[2],b=b[0]),this.setRotationX(b),this.setRotation(-J),this.setRotationZ(m)},setRotationY:function(z){this.setRotation(-z)},getRotationY:function(){return-this._64O},lookAtDirection:function(c,K){K=K||ad;var $=this,Z=dq(c);K===ad?($.r3([-L(c[1]/Z),-o(c[2],c[0])+q,0]),$.setRotationMode("xzy")):K===Oi?($.r3(0,-o(c[2],c[0]),L(c[1]/Z)),$.setRotationMode("zyx")):K===Zq?($.r3(0,-o(c[2],c[0])+_,-L(c[1]/Z)),$.setRotationMode("zyx")):K===Tp?($.r3([-L(c[1]/Z)+q,-o(c[2],c[0])+q,0]),$.setRotationMode("xzy")):K===Rk&&($.r3([-L(c[1]/Z)-q,-o(c[2],c[0])+q,0]),$.setRotationMode("xzy")),K===Ed&&($.r3([-L(c[1]/Z)+_,-o(c[2],c[0])+q,_]),$.setRotationMode("zxy"))},lookAt:function(s,W){return this.lookAtDirection(Wj(s,this.p3()),W)},getLoopedEdges:function(){return this._45I},getEdges:function(){return this._70O},getAgentEdges:function(){return this._49I},getHost:function(){return this._host},setHost:function(M){var W=this;if(W!==M&&W._host!==M){var P=W._host;P&&P._removeAttach(W),W._host=M,W._host&&W._host._addAttach(W),W.fp("host",P,M),W.onHostChanged(P,M)}},getAttaches:function(){return this._69O},_addAttach:function(z){var g=this;g._69O||(g._69O=new Yd),g._69O.add(z),g.fp("attaches",s,z)},_removeAttach:function(i){var X=this;X._69O.remove(i),X._69O.isEmpty()&&delete X._69O,X.fp("attaches",i,s)},getSourceEdges:function(){return this._42I},getTargetEdges:function(){return this._43I},_2I:function(q){var Z=this;Z._44I||(Z._44I=new Yd),Z._42I||(Z._42I=new Yd),Z._44I.add(q),Z._42I.add(q),Z._20I()},_4I:function(j){var x=this;x._44I||(x._44I=new Yd),x._43I||(x._43I=new Yd),x._44I.add(j),x._43I.add(j),x._20I()},_16I:function(b){var p=this;p._44I.remove(b),p._42I.remove(b),p._44I.isEmpty()&&delete p._44I,p._42I.isEmpty()&&delete p._42I,p._20I()},_18I:function(f){var s=this;s._44I.remove(f),s._43I.remove(f),s._44I.isEmpty()&&delete s._44I,s._43I.isEmpty()&&delete s._43I,s._20I()},_20I:function(){var Y=this;if(delete Y._45I,!Y._44I||Y._44I.isEmpty())return delete Y._70O,void 0;var W;Y._44I.each(function(e){e.isLooped()&&(W||(W={}),W[e._id]||(Y._45I||(Y._45I=new Yd),Y._45I.add(e),W[e._id]=e))}),W?(Y._70O=new Yd,Y._44I.each(function(B){W[B._id]?"A"===W[B._id]||(W[B._id]="A",Y._70O.add(B)):Y._70O.add(B)})):Y._70O=Y._44I},hasAgentEdges:function(){return!!this._49I&&!this._49I.isEmpty()},getSourceAgentEdges:function(){return this._46I},getTargetAgentEdges:function(){return this._47I},_1I:function(s){var J=this;J._46I||(J._46I=new Yd),J._48I||(J._48I=new Yd),J._46I.add(s),J._48I.add(s),J._19I()},_3I:function(k){var o=this;o._47I||(o._47I=new Yd),o._48I||(o._48I=new Yd),o._47I.add(k),o._48I.add(k),o._19I()},_15I:function(C){var X=this;X._46I.remove(C),X._48I.remove(C),X._46I.isEmpty()&&delete X._46I,X._48I.isEmpty()&&delete X._48I,X._19I()},_17I:function(x){var j=this;j._47I.remove(x),j._48I.remove(x),j._47I.isEmpty()&&delete j._47I,j._48I.isEmpty()&&delete j._48I,j._19I()},_19I:function(){var R=this;delete R._49I;var r=R._48I;if(r&&!r.isEmpty()){var Q={};r.each(function(T){Q[T._id]?R._49I||(R._49I=new Yd):Q[T._id]=T}),R._49I?r.each(function(F){Q[F._id]&&(R._49I.add(F),delete Q[F._id])}):R._49I=r}},getImage:function(){if(this._pendingCheckImageJSON){var s=Z.getImage(this._image);s&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Eo&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(y){var K=this,O=K._image,p=K.getWidth(),n=K.getHeight();K._image=y,K.fp("image",O,y)&&(null!=y&&(Sg(y)||Fm(y)&&/\.json$/i.test(y))&&(this._pendingCheckImageJSON=!0),K.fp(Lm,p,K.getWidth()),K.fp(me,n,K.getHeight()))},getElevation:function(){return this._54O},setElevation:function(V){var C=this;if(!C._50O){C._50O=1;var v=C._54O;C._54O=V,C.fp(bq,v,V),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(M){var b=this;if(!b._49O){b._49O=1;var E=b._64O;b._64O=M,b.fp(ki,E,M),delete b._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(w){var D=this;if(!D._51O){D._51O=1;var i=D._rotationX;D._rotationX=w,D.fp("rotationX",i,w),delete D._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(D){var O=this;if(!O._52O){O._52O=1;var A=O._53O;O._53O=D,O.fp("rotationZ",A,D),delete O._52O}},getPosition:function(){return this._position},setPosition:function(D,A){var G=this;if(!G._50I){G._50I=1;var w;if(w=2===arguments.length?{x:D,y:A}:D,w.x!==G._position.x||w.y!==G._position.y){var p=G._position;G._position=w,G.fp(dj,p,w)}delete G._50I}},translate:function(m,$){var I=this._position;this.p(I.x+m,I.y+$)},getWidth:function(){var G=this;if(G._width>=0)return G._width;var E=G.getStyle("shape3d");if(E){var g=Ch(E);if(g&&g.rawS3)return g.rawS3[0];if("billboard"===E||"plane"===E){var P=sr(G.getStyle("shape3d.image"));return P?Db(P,G):20}}var P=sr(G._image);return P?Db(P,G):20},setWidth:function(B){var S=this,g=S._width;S._width=B,S.fp(Lm,g,B)},getHeight:function(){var S=this;if(S._height>=0)return S._height;var u=S.getStyle("shape3d");if(u){var X=Ch(u);if(X&&X.rawS3)return X.rawS3[2];if("plane"===u){var P=sr(S.getStyle("shape3d.image"));return P?Vc(P,S):20}if("billboard"===u)return 2}var P=sr(S._image);return P?Vc(P,S):20},setHeight:function(W){var R=this,S=R._height;R._height=W,R.fp(me,S,W)},getTall:function(){var $=this;if($._tall>=0)return $._tall;var J=$.getStyle("shape3d");if(J){var u=Ch(J);if(u&&u.rawS3)return u.rawS3[1];if("billboard"===J){var d=sr($.getStyle("shape3d.image"));return d?Vc(d,$):20}if("plane"===J)return 2}return 20},setTall:function(B){var O=this,M=O._tall;O._tall=B,O.fp("tall",M,B)},setSize:function(r,w){var m=this;2===arguments.length?(m.setWidth(r),m.setHeight(w)):(m.setWidth(r.width),m.setHeight(r.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(m,T,X,h,I){var G=this,t=G.getAnchor(),O=G.getScale();arguments.length<=2&&(I=T,T=m.y,X=m.width,h=m.height,m=m.x);var N=I&&O.x<0?1-t.x:t.x,U=I&&O.y<0?1-t.y:t.y;G.p(m+X*N,T+h*U),I&&(X/=Math.abs(O.x),h/=Math.abs(O.y)),G.setWidth(X),G.setHeight(h)},getMatrix:function(){var t=this,l=t._64O,J=t._position,u=t.getScale();return new Qi(l,J.x,J.y,u.x,u.y)},getAnchorRect:function(){var f=this,A=f.getWidth(),e=f.getHeight(),$=f.getAnchor();return{x:-A*$.x,y:-e*$.y,width:A,height:e}},toLocal:function(Y){return this.getMatrix().tfi(Y)},toGlobal:function(h){return this.getMatrix().tf(h)},isInRect:function(A){A=this.toLocal(A);var z=this.getWidth(),Q=this.getHeight();return A.x+=z*this.getAnchorX(),A.y+=Q*this.getAnchorY(),!(A.x<0||A.y<0||A.x>z||A.y>Q)},getRect:function(){var v=this,X=v.getWidth(),D=v.getHeight(),b=v.getAnchor(),q={x:-X*b.x,y:-D*b.y,width:X,height:D},Q=v.getMatrix();return q=Ge([Q.tf(q.x,q.y),Q.tf(q.x+q.width,q.y),Q.tf(q.x+q.width,q.y+q.height),Q.tf(q.x,q.y+q.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var Y=this,i=Y.getAnchor(),o=Y._anchorElevation;return{x:i.x,y:o,z:i.y}},setAnchorElevation:function(L){var t=this,V=t._anchorElevation;return V!==L?(t._anchorElevation=L,t.fp("anchorElevation",V,L),!0):!1},setAnchor3d:function(D,V,Z,m){var p,O=this;"number"==typeof D?p={x:D,y:V,z:Z}:(p=D.length?{x:D[0],y:D[1],z:D[2]}:D,m=V);var d=O.getDataModel();d&&d.beginTransaction();var _=O.getAnchor3d(),F=O.setAnchor(p.x,p.z);if(O.setAnchorElevation(p.y)&&(F=!0),F&&m&&!cr){O.getAnchor3d();var R=vj(O),s=kh([p.x-_.x,p.y-_.y,p.z-_.z],R);O.p3(s)}return d&&d.endTransaction(),F},getAnchor:function(){var K=this;if(K.hasOwnProperty("_anchor"))return K._anchor;var x=sr(K._image);return x&&x.anchorX!==w?{x:x.anchorX,y:x.anchorY}:K._anchor},setAnchor:function(c,W,M){var q,E=this;"number"==typeof c?q={x:c,y:W}:(q=c.length?{x:c[0],y:c[1]}:c,M=W);var K=E.getAnchor();if(K.x!==q.x||K.y!==q.y){var j=E.getDataModel();if(j&&j.beginTransaction(),E._anchor=q,E.fp("anchor",K,q),M&&!cr){var h=E.getPosition(),Y=E.getSize(),l=E.getRotation(),m=E.getScale(),$=-Y.width*(K.x-q.x)*m.x,Q=-Y.height*(K.y-q.y)*m.y,A=t(l),H=P(l);E.setPosition(h.x+H*$-A*Q,h.y+A*$+H*Q)}return j&&j.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(i,r){var q,z=this;q=2===arguments.length?{x:i,y:r}:i;var s=z.getScale();(s.x!==q.x||s.y!==q.y)&&(z._scale=q,z.fp("scale",s,q))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var k=this,r=k._scaleTall,Y=k.getScale();return[Y.x,r,Y.y]},getFinalScale3d:function(){var x=this,r=x.s3(),H=x._dynamicScale3d,k=x.getScale3d();return r&&(k[0]*=r[0],k[1]*=r[1],k[2]*=r[2]),H&&(k[0]*=H[0],k[1]*=H[1],k[2]*=H[2]),k},getFinalRotation3d:function(){var N=this;return N._dynamicRotation||N.r3()},setScaleTall:function(_){var n=this,A=n._scaleTall;A!==_&&(n._scaleTall=_,n.fp("scaleTall",A,_))},setScale3d:function(z,g,S){var j,c=this;j="number"==typeof z?{x:z,y:g,z:S}:z.length?{x:z[0],y:z[1],z:z[2]}:z,c.setScaleTall(j.y),c.setScale(j.x,j.z)},getCorners:function(E,J){E==s&&(E=0),J==s&&(J=E);var w=this,R=w.getAnchor(),B=w.getWidth(),v=w.getHeight(),k=-B*R.x-E,V=-v*R.y-J,b=B+2*E,K=v+2*J,x=w.getMatrix();return[x.tf(k,V),x.tf(k,V+K),x.tf(k+b,V+K),x.tf(k+b,V)]},getEditControlPoints:function(n,E,f){E==s&&(E=0),f==s&&(f=E);var H=this,h=H.getAnchor(),b=H.getWidth(),o=H.getHeight(),l=-b*h.x-E,B=-o*h.y-f,p=b+2*E,c=o+2*f;if(n)return[{x:l,y:B},{x:l,y:0},{x:l,y:B+c},{x:0,y:B+c},{x:l+p,y:B+c},{x:l+p,y:0},{x:l+p,y:B},{x:0,y:B}];var t=H.getMatrix();return[t.tf(l,B),t.tf(l,0),t.tf(l,B+c),t.tf(0,B+c),t.tf(l+p,B+c),t.tf(l+p,0),t.tf(l+p,B),t.tf(0,B)]},rotateAt:function(A,g,q){var j=this,F=j._position,D=j._64O,c=new Qi(D,F.x,F.y).tf(A,g),y=O(A*A+g*g),f=o(F.y-c.y,F.x-c.x)+q;j.setRotation(D+q),j.p(c.x+y*P(f),c.y+y*t(f))},onParentChanged:function(){Zm.superClass.onParentChanged.apply(this,arguments),this._8I()},_8I:function(){this._70O&&this._70O.each(function(x){x._7I()})},onPropertyChanged:function(Y){var e=this;Zm.superClass.onPropertyChanged.call(e,Y),e._69O&&e._69O.each(function(i){i.handleHostPropertyChange(Y)}),e._49I&&e._49I.each(function(E){E.fp("agentChange",!0,!1)})},onHostChanged:function(){this.updateAttach()},handleHostPropertyChange:function(h){this.updateAttach(h)},onStyleChanged:function(z){Zm.superClass.onStyleChanged.apply(this,arguments),Fj[z]&&this.updateAttach()},updateAttach:function(Q){var W=this;W._51I||cr||(W._51I=1,W._71O(Q),delete W._51I)},_71O:function(U){var O,f,N,W,g,P,h=this,w=h._host,a=U?U.property:s,j=U?U.oldValue:s,B=U?U.newValue:s;if(w instanceof c.Grid){if(a===bq)h.setElevation(h._54O+B-j);else if(!U||ri[a]){if(O=h.s("attach.row.index"),f=h.s("attach.column.index"),N=w.getCellRect(O,f),!N)return;W=h.s("attach.row.span"),g=h.s("attach.column.span"),(1!==W||1!==g)&&(N=hq(N,w.getCellRect(O+W-1,f+g-1))),cj(N,h,"attach.padding",1),h.setRect(N)}}else if(w instanceof He&&(P=h.s("attach.index"))>=0&&(!U||jj[a])){var K=h.s("attach.thickness");K!=s&&h.setHeight(w.getThickness()*K);var x=h.s("attach.offset"),D=w.getPoints(),Y=D.size();if(Y>P){var M=D.get(P),E=Y===P+1?D.get(0):D.get(P+1),$=[E.x-M.x,E.y-M.y],n=dq($);if(n){h.s("attach.offset.relative")&&(x*=n),h.s("attach.offset.opposite")&&(x=n-x);var d={x:M.x+$[0]/n*x,y:M.y+$[1]/n*x},k=h.s("attach.gap");k&&(h.s("attach.gap.relative")&&(k*=w.getThickness()),d=ak(s,d,E,k)),h.p(d),h.setRotation(o($[1],$[0]))}}}else U&&(a===dj?h.translate(B.x-j.x,B.y-j.y):a===bq?h.setElevation(h._54O+B-j):Pb[a]&&h._11Q(w,a,B-j))},_11Q:function(Z,f,G){var s=this,H=Z.p3(),E=Wj(s.p3(),H),O=kr(),z=uq[s.getRotationMode()],y=z[0],o=z[1],j=z[2],U=Dl[y],b=Dl[o],T=Dl[j];f===ki&&(f="rotationY",G=-G),f===ki+y?(T(O,Z[ug+j]()),b(O,Z[ug+o]()),U(O,G),b(O,-Z[ug+o]()),T(O,-Z[ug+j]()),s[ss+y](s[ug+y]()+G)):f===ki+o?(T(O,Z[ug+j]()),b(O,G),T(O,-Z[ug+j]()),s[ss+o](s[ug+o]()+G)):f===ki+j&&(T(O,G),s[ss+j](s[ug+j]()+G)),kh(E,O),s.p3(H[0]+E[0],H[1]+E[1],H[2]+E[2])},isHostOn:function(F){var P=this;if(P._host&&F&&F._69O)for(var A={},B=P._host;B&&B!==P&&!A[B._id];){if(B===F)return!0;A[B._id]=B,B=B._host}return!1},isLoopedHostOn:function(r){return this.isHostOn(r)&&r.isHostOn(this)},getSerializableProperties:function(){var m=Zm.superClass.getSerializableProperties.call(this);return se(m,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),m}});var Wg=c.Edge=function(l,W){var B=this;fm(Wg,B),B.setSource(l),B.setTarget(W)};If("Edge",yb,{_icon:"edge_icon",getUIClass:function(){return Fh},_22Q:function(){return Ym},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},setSource:function(i){var B=this;if(B._source!==i){var Y=B._source;B._source=i,Y&&Y._16I(B),i&&i._2I(B),B._7I(),B.fp("source",Y,i)}},setTarget:function(q){var x=this;if(x._target!==q){var k=x._target;x._target=q,k&&k._18I(x),q&&q._4I(x),x._7I(),x.fp("target",k,q)}},isLooped:function(){var R=this;return R._source===R._target&&!!R._source&&!!R._target},_7I:function(){var H,R=this,B=Uc(R);R._40I!==B&&(H=this._40I,H&&H._15I(R),R._40I=B,B&&B._1I(R),R.fp("sourceAgent",H,B),kq(H,R._41I),kq(B,R._41I));var x=Uh(R);R._41I!==x&&(H=R._41I,H&&H._17I(R),R._41I=x,x&&x._3I(R),R.fp("targetAgent",H,x),kq(H,R._40I),kq(x,R._40I))},_22I:function(t){this._52I=t,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var I=this;return I._52I&&I._52I.get(0)!==I&&!I.getStyle(rh)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var e=this,H=e._52I;return H&&!e.getStyle(rh)&&H.size()>1&&e===H.get(0)},toggle:function(){var t=this._52I,X=!this.s(rh);t&&t.size()>1&&(t.each(function(s){s.s(rh,X)}),t.getSiblings().each(function(Y){Y!==t&&Y.each(function(p){p.fp("edgeGroup",s,Y)})}))},setStyle:function(t,g){(t===Ce||"edge.segments"===t)&&(g=Fn(g)),Wg.superClass.setStyle.call(this,t,g)},onStyleChanged:function(z){Wg.superClass.onStyleChanged.apply(this,arguments),Yn[z]&&kq(this._41I,this._40I)},getSerializableProperties:function(){var m=Wg.superClass.getSerializableProperties.call(this);return se(m,{source:1,target:1}),m}});var nj=c.Group=function(){fm(nj,this)};If("Group",Zm,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return Gn},onChildAdded:function(){nj.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){nj.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var $=this;if(!$._54I&&!cr){var v=$.getChildrenRect();v&&($._53I=1,$.p(ii($.s("group.position"),v,$.getSize())),delete $._53I)}},getChildrenRect:function(){var H,w=this;return w.eachChild(function(Q){H=hq(H,w.getChildRect(Q))}),H},getChildRect:function(G){var e;return Cl(G)&&G.s(Oj)&&(Ur(G)&&G.isExpanded()&&G.eachChild(function(I){e=hq(e,G.getChildRect(I))}),!e&&G.getRect&&(e=G.getRect())),e},setPosition:function(s,t){var J=this;if(!J._54I){var e;e=2===arguments.length?{x:s,y:t}:s,cr||J._53I||(J._54I=1,Sc(J._children,e.x-J._position.x,e.y-J._position.y),delete J._54I),nj.superClass.setPosition.call(this,e)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(u){var z=this;if(z._57O!==u){var b=z._57O;z._57O=u,z.fp("expanded",b,z._57O),z._8I()}},_8I:function(){nj.superClass._8I.call(this),this.eachChild(function(a){Cl(a)&&a._8I()})},onStyleChanged:function(m){nj.superClass.onStyleChanged.apply(this,arguments),"group.position"===m&&this._81I()},getSerializableProperties:function(){var v=nj.superClass.getSerializableProperties.call(this);return v.expanded=1,v}});var xc=c.Block=function(){fm(xc,this)};If("Block",Zm,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Gr},onChildAdded:function(){xc.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){xc.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var l=this;if(!cr&&!l._updatingToChildren&&l._syncSize){var b,a,z,C,U,s=[],D=l.getRotation();if(l.eachChild(function(B){Cl(B)&&s.push.apply(s,B.getCorners())}),s.length){l._updatingFromChildren=1;var n=P(-D),f=t(-D),Y=1/0,k=-1/0,v=1/0,g=-1/0;for(C=0,U=s.length;U>C;C++)z=s[C],b=z.x,a=z.y,z.x=n*b-f*a,z.y=f*b+n*a,Y=d(Y,z.x),k=M(k,z.x),v=d(v,z.y),g=M(g,z.y);var Z=l.getScale();l.setSize(A((k-Y)/Z.x),A((g-v)/Z.y));var _;Z.x<0&&(_=Y,Y=k,k=_),Z.y<0&&(_=v,v=g,g=_),n=P(D),f=t(D);var w=l.getAnchor();b=Y+(k-Y)*w.x,a=v+(g-v)*w.y,l.setPosition(n*b-f*a,f*b+n*a),delete l._updatingFromChildren}}},setPosition:function(G,k){var y=this;if(!y._updatingToChildren){var u;u=2===arguments.length?{x:G,y:k}:G,cr||y._updatingFromChildren||(y._updatingToChildren=1,Sc(y._children,u.x-y._position.x,u.y-y._position.y),delete y._updatingToChildren),xc.superClass.setPosition.call(this,u)}},setWidth:function(w){return this.setSize(w,this.getHeight())},setHeight:function(b){return this.setSize(this.getWidth(),b)},setSize:function(G,f){1>G&&(G=1),1>f&&(f=1);var u=this;
if(!u._updatingToChildren){2!==arguments.length&&(f=G.height,G=G.width);var I=u.getWidth(),k=u.getHeight();if(G!==I&&xc.superClass.setWidth.call(u,G),f!==k&&xc.superClass.setHeight.call(u,f),!cr&&!u._updatingFromChildren){u._updatingToChildren=1;var U=G/I,H=f/k;u._adjustChildScaleOrSize(U,H,"size"),delete u._updatingToChildren,u.updateFromChildren()}}},_adjustChildScaleOrSize:function(Z,T,E){var v=this;if(v._syncSize){var W=v.getPosition(),B=v.getRotation();v.getScale(),v.eachChild(function(b){if(Cl(b)){var A=b.getPosition(),H=b.getRotation(),D=b.getWidth(),F=b.getHeight(),g=b.getScale(),X=g.x*D,y=g.y*F,z=new Qi(H,A.x,A.y,X,y);z.translate(-W.x,-W.y),z.rotate(-B),H=o(z.b*Math.sign(X),z.a*Math.sign(X)),z.scale(Z,T);var c,R,C,v=P(H);if(Math.abs(v)<.001?(c=t(H),R=z.b/c,C=-z.c/c):(R=z.a/v,C=z.d/v),"scale"===E)b.setScale(R/D,C/F);else if("size"===E){var e=R/g.x,i=C/g.y;b.setScale(Fr(R)*Math.abs(g.x),Fr(C)*Math.abs(g.y)),b.setSize(Math.max(.1,Math.abs(e)),Math.max(.1,Math.abs(i)))}z.rotate(B),z.translate(W.x,W.y),b.setPosition(z.tx,z.ty)}})}},_calcChangeFactor:function(S,b,R,H){var Y,J,P,y;return Y=A(S),J=A(R),P=Y>J?Y/J:J/Y,Y=A(b),J=A(H),y=Y>J?Y/J:J/Y,M(P,y)},setAnchor:function(){var S=this;if(!S._updatingToChildren){var T=S.getAnchor();if(xc.superClass.setAnchor.apply(S,arguments),!cr&&!S._updatingFromChildren&&S._syncSize){S._updatingToChildren=1;var R=S.getAnchor();S.getPosition();var F=S.getSize(),y=S.getScale(),q=S.getRotation(),x=-F.width*y.x*(T.x-R.x),H=-F.height*y.y*(T.y-R.y),U=t(q),n=P(q),s=n*x-U*H,Q=U*x+n*H;S.eachChild(function(z){if(Cl(z)){var o=z.getPosition();z.setPosition(o.x-s,o.y-Q)}}),delete S._updatingToChildren}}},setRotation:function(K){var O=this;if(!O._updatingToChildren){var C=O.getRotation();if(xc.superClass.setRotation.apply(O,arguments),!cr&&!O._updatingFromChildren){O._updatingToChildren=1;var J=O.getPosition(),H=K-C;O.eachChild(function(E){if(Cl(E)){var Q=E.getMatrix();Q.translate(-J.x,-J.y),Q.rotate(H),Q.translate(J.x,J.y);var V=Math.sign(E.getScale().x);E.setRotation(o(Q.b*V,Q.a*V)),E.setPosition(Q.tx,Q.ty)}}),delete O._updatingToChildren}}},setScale:function(U,L){var P=this;if(!P._updatingToChildren){null==L&&(L=U.y,U=U.x);var V=P.getScale();if(A(U)<.01&&(U=.01*(Fr(U)||Fr(V.x))),A(L)<.01&&(L=.01*(Fr(L)||Fr(V.y))),xc.superClass.setScale.call(P,U,L),!cr&&!P._updatingFromChildren){P._updatingToChildren=1;var I=U/V.x,r=L/V.y;P._adjustChildScaleOrSize(I,r,"size"),delete P._updatingToChildren,P.updateFromChildren()}}},getSerializableProperties:function(){var N=xc.superClass.getSerializableProperties.call(this);return N.clickThroughEnabled=1,N.syncSize=1,N}});var ek=c.Grid=function(){fm(c.Grid,this)};If("Grid",Zm,{IRotatable:!1,_icon:"grid_icon",_image:s,getUIClass:function(){return qc},setRotation:function(){},getCellRect:function(D,t){var U=this,y=U.s("grid.row.count"),d=U.s("grid.column.count");if(0>=y||0>=d||0>D||D>=y||0>t||t>=d)return s;var r,o,T,X=U.getRect(),A=U.s("grid.row.percents"),p=U.s("grid.column.percents");if(cj(X,U,"grid.border",-1),A&&A._as&&(A=A._as),p&&p._as&&(p=p._as),A&&A.length===y){for(T=0,r=0;D>r;r++)T+=X.height*A[r];X.y+=T,X.height=X.height*A[D]}else X.height=X.height/y,X.y+=X.height*D;if(p&&p.length===d){for(o=0,r=0;t>r;r++)o+=X.width*p[r];X.x+=o,X.width=X.width*p[t]}else X.width=X.width/d,X.x+=X.width*t;return $o(X,-U.s("grid.gap")),X}});var md=c.Text=function(){fm(md,this),this.setSize(100,50),this.s("text","TEXT")};If("Text",Zm,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return wi},setWidth:function(y){y||(y=.001),md.superClass.setWidth.call(this,y)},setHeight:function(g){g||(g=.001),md.superClass.setHeight.call(this,g)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),jb("__text__",{width:{value:100,isSafeFunc:!0,func:function(v){return v._width}},height:{value:50,isSafeFunc:!0,func:function(e){return e._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"}}]});var He=c.Shape=function(){fm(He,this),this._59O=new Yd};He.__de__=_d,If("Shape",Zm,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return yg},_22Q:function(){return dm},getLength:function(F){return je(kb(this._59O,this._58O,F,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var P=this._58O;return P?new Yd(P._as.slice(0)):P},setSegments:function(A){var N=this._58O;A=A?Dc(A)?new Yd(A.slice(0)):new Yd(A._as.slice(0)):null,(N&&A&&N._as.join(",")!==A._as.join(",")||N!==A)&&(this._58O=A,this.fp("segments",N,A))},getPoints:function(){return this._59O},toPoints:function(){var Q=this._59O;return new Yd(Q._as.slice(0))},setPoints:function(R,c){var I=this,E=I._59O;R=R?Dc(R)?new Yd(R.slice(0)):new Yd(R._as.slice(0)):new Yd;var Z,L,N,B,q,H;c&&(Z=I.getPosition(),H=new Qi(I.getRotation(),0,0,I.getScale().x,I.getScale().y)),(E&&R&&E._as.join(",")!==R._as.join(",")||E!==R)&&(I._59O=R,I.fs(),I.fp("points",E,R)),c&&(L=I.getPosition(),N=L.x-Z.x,B=L.y-Z.y,q=H.tf(N,B),I.setPosition(L.x-N+q.x,L.y-B+q.y))},addPoint:function(r,N,A){var L=this.toPoints();L.add(r,N),this.setPoints(L,A)},setPoint:function(E,W,g){var G=this.toPoints();G.set(E,W),this.setPoints(G,g)},removePointAt:function(v){var y=this.toPoints();y.removeAt(v),this.setPoints(y)},setWidth:function(y){var T=this;if(1>y&&(y=1),!T._55I&&!cr&&T.getWidth()){T._55I=1;var P=T._position.x,S=y/T.getWidth(),A=T.toPoints(),N=new Yd;A.each(function(Y){N.add({x:(Y.x-P)*S+P,y:Y.y,e:Y.e})}),T.setPoints(N),fp(T,[S,0,0,1,P*(1-S),0]),T.fs(),delete T._55I}He.superClass.setWidth.call(T,y)},setHeight:function(n){var P=this;if(1>n&&(n=1),!P._55I&&!cr&&P.getHeight()){P._55I=1;var O=P._position.y,i=n/P.getHeight(),p=P.toPoints(),I=new Yd;p.each(function(M){I.add({x:M.x,y:(M.y-O)*i+O,e:M.e})}),P.setPoints(I),fp(P,[1,0,0,i,0,O*(1-i)]),P.fs(),delete P._55I}He.superClass.setHeight.call(P,n)},setAnchorElevation:function(m){var n=this;n._55I=!0;var B=n._updatingAnchor3d,O=!cr&&!B;if(O){var A,e=m,E=n.getAnchorElevation(),t=n.getTall();A=t*(E-e),n.shiftPointsElevation(A)}var T=He.superClass.setAnchorElevation.apply(n,arguments);return B||delete n._55I,T},getShapeElevation:function(){var q=this,k=q._54O;return k-(q.getTall()||0)*(q._anchorElevation-.5)},setAnchor3d:function(b,h,i,n){var X,P=this;"number"==typeof b?X={x:b,y:h,z:i}:(X=b.length?{x:b[0],y:b[1],z:b[2]}:b,n=h),P._55I=!0,P._updatingAnchor3d=!0;var V=P.getDataModel();if(V&&V.beginTransaction(),!cr){var U=P.getAnchor3d(),T=P.getSize(),A=P.getTall(),O=T.width*(U.x-X.x),$=T.height*(U.z-X.z),R=A*(U.y-X.y);n||P.shiftPoints(O,$,R);var f=P.p3()}var N=He.superClass.setAnchor3d.apply(P,arguments);if(!cr&&n){var C=P.p3();P.shiftPoints(C[0]-f[0]+O,C[2]-f[2]+$,C[1]-f[1]+R)}return V&&V.endTransaction(),delete P._updatingAnchor3d,delete P._55I,N},setAnchor:function(n,O,I){var J=this;J._55I=!0;var T=J._updatingAnchor3d,t=!cr&&!T;if(t){var N,Q,R;"number"==typeof n?R={x:n,y:O}:(R=n.length?{x:n[0],y:n[1]}:n,I=O);var c=J.getAnchor(),D=J.getSize();N=D.width*(c.x-R.x),Q=D.height*(c.y-R.y),I||J.shiftPoints(N,Q);var a=J.getPosition()}var A=He.superClass.setAnchor.apply(J,arguments);if(t){var u=J.getPosition();I&&J.shiftPoints(u.x-a.x+N,u.y-a.y+Q)}return T||delete J._55I,A},shiftPoints:function(E,Y,r){var T=this,Z=T.getElevation()||0,i=T.toPoints(),H=new Yd;i.each(function(x){var u=x.e;r&&(u=(u==s?Z:u)+r),H.add({x:x.x+E,y:x.y+Y,e:u})}),T.setPoints(H),T.fs()},shiftPointsElevation:function(W){return this.shiftPoints(0,0,W)},setPosition:function(p,V){var b,S=this;if(!S._28Q){if(S._28Q=1,!S._55I&&!cr){b=2===arguments.length?{x:p,y:V}:p;var f=b.x-S._position.x,y=b.y-S._position.y;if(0===f&&0===y)return delete S._28Q,void 0;S._55I=1,S.shiftPoints(f,y),fp(S,[1,0,0,1,f,y]),delete S._55I}He.superClass.setPosition.apply(S,arguments),delete S._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var O=this;if(2!==O._59O.size())return!1;var U=O._58O;return U?2===U.size()&&1===U.get(0)&&2===U.get(1)?!0:!1:!0},fireShapeChange:function(){var g=this;if(!g._55I&&!cr){var o=Ge(g._59O);o&&(g._55I=1,g.setRect(o),delete g._55I)}g.fp(Ri,!1,!0)},getSerializableProperties:function(){var N=He.superClass.getSerializableProperties.call(this);return N.segments=1,N.points=1,N.thickness=1,N.closePath=1,N}});var rd=c.Polyline=function(){fm(rd,this),this.s({"shape.background":null,"shape.border.width":2})};If("Polyline",He,{_icon:"polyline_icon",_22Q:function(){return _q},getUIClass:function(){return ns},setClosePath:function(){},setTall:function(j){var m=this;if(!m._55I&&!m._24Q&&!cr&&m.getTall()){m._24Q=1;var Z=m._54O,w=j/m.getTall();m._59O.each(function(b){b.e=b.e==s?Z:(b.e-Z)*w+Z}),m.fs(),delete m._24Q}rd.superClass.setTall.call(m,j)},setElevation:function(O){var A=this;if(!A._55I&&!A._24Q&&!cr){A._24Q=1;var D=O-A._54O;A._59O.each(function(w){w.e==s?w.e=O:w.e+=D}),A.fs(),delete A._24Q}rd.superClass.setElevation.apply(A,arguments)},fireShapeChange:function(){var $=this,f=$._59O;if(!$._55I&&!$._24Q&&!cr){var I=f.size();if(I){var l=1,V=f.get(0),g=$._54O;V.e==s&&(V.e=g);for(var Q=V.e,n=0;I>l;l++){V=f.get(l),V.e==s&&(V.e=g);var P=d(Q,V.e),W=M(Q+n,V.e);Q=P,n=W-P}$._24Q=1,$.setTall(n),$.setElevation(Q+n*$._anchorElevation),delete $._24Q}}rd.superClass.fireShapeChange.apply($,arguments)}});var Tq=c.SubGraph=function(){fm(Tq,this)};If("SubGraph",Zm,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){Tq.superClass._8I.call(this),this.eachChild(function(g){Cl(g)&&g._8I()})}}),Z.loadingRefGraph=0;var Eo=c.RefGraph=function(){fm(Eo,this)};If("RefGraph",xc,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(O){var r=this._ref;this._ref=O,this.fp("ref",r,O),this.updateRef()},_21I:function(){Eo.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var t=this;if(Z.loadingRefGraph++,t.clearChildrenFromDataModel(),Z.loadingRefGraph--,t._ref&&t._dataModel){t._xhrLoadHandler&&(t._xhrLoadHandler.cancel=!0);var N=cr,m=t._xhrLoadHandler=function(Q){if(Q&&t._dataModel){Z.loadingRefGraph++;var d=t._pendingUpdateInfo={needToRestore:N};N&&(d.position=t.p(),d.width=t.getWidth(),d.height=t.getHeight(),d.rotation=t.getRotation(),d.anchor=t.getAnchor(),d.scale=t.getScale()),t.p(0,0),t.setAnchor(.5,.5),t.setRotation(0),t.setScale(1,1);var J=Z.parse(Q),T=t._dataModel.deserialize(J,t,{justDatas:!0});T.each(function(Q){Q._refGraph=t}),t.checkPendingUpdateInfo(),Z.loadingRefGraph--,Z.handleRefGraphLoaded(t,T,J)}};m.xhrLoadCalled=!1,Z.load(t._ref,function(H){m.cancel||(m.xhrLoadCalled?m(H):No(function(){m(H)}))}),m.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var I=this,Y=I._pendingUpdateInfo;if(!Y)return I.onPendingUpdated&&(Z.loadingRefGraph++,I.onPendingUpdated(),Z.loadingRefGraph--),void 0;var $=!0;this.eachChild(function(a){(a._pendingCheckImageJSON||a._pendingUpdateInfo)&&($=!1)}),$&&(Z.loadingRefGraph++,I._pendingUpdateInfo=null,I.updateFromChildren(),Y.needToRestore&&(I.setSize(Y.width,Y.height),I.setAnchor(Y.anchor),I.setRotation(Y.rotation),I.setScale(Y.scale),I.p(Y.position)),this.getParent()instanceof Eo&&this.getParent().checkPendingUpdateInfo(),I.onPendingUpdated&&I.onPendingUpdated(),Z.loadingRefGraph--)},getSerializableProperties:function(){var x=Eo.superClass.getSerializableProperties.call(this);return x.ref=1,x}}),c.EdgeGroup=function(l,m){this._70O=l,this._siblings=m;for(var X,I,x=0,H=l.size(),g=k[rh];H>x;x++)if(X=l.get(x).getStyle(rh,!1),X!=s){g=X;break}g==s&&(g=!0);var G=Z.edgeGroupAgentFunc;for(G&&(I=G(l),I&&I!==l.get(0)&&(l.remove(I),l.add(I,0))),x=0;H>x;x++)l.get(x).s(rh,g)},If("EdgeGroup",D,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(E){return this._70O.get(E)},indexOf:function(Y){return this._70O.indexOf(Y)},each:function(I,i){this._70O.each(I,i)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(A,k){this._siblings.each(function(Q){Q._70O.each(A,k)})}});var lb=function(G,h,D){var u=mk[G]={type:G,action:h};if(D)for(var F in D)u[F]=D[F]};lb("host",function(t,A,N){N&&A.setHost(N)},{"delete":{visible:function(k,o){return o.getHost()},action:function(r,p){p.setHost(null)}}}),lb("parent",function(p,K,D){D&&K.setParent(D)},{"delete":{visible:function(Y,B){return B.getParent()},action:function(B,x){x.setParent(null)}}}),lb("copySize",function(V,y,Y){if(Y){var i=Y.getSize();y.setSize(i)}}),lb("copyRotation",function(s,C,n){if(n){var d=n.getRotation();C.setRotation(d)}}),lb("edge",function(W,e,O){if(O){var i=new c.Edge(e,O);e.dm().add(i)}}),se(Z,{setConnectAction:lb,getConnectAction:function(G,h){return h=h||G.getCurrentConnectActionType(),mk[h]},doConnectAction:function(O,G,Q,N){N=N||O.getCurrentConnectActionType();var o=mk[N];if(!o)return!1;var J=o.action;return J?(J.call(null,O,G,Q),!0):!1},doDeleteConnectionAction:function(A,D,S){S=S||A.getCurrentConnectActionType();var w=mk[S];if(!w||!w.delete)return!1;var K=w.delete.action;return K?(K.call(null,A,D),!0):!1}});var hs=c.JSONSerializer=function(V,w){this.dm=this._dataModel=V,this._hierarchical=Z.forceHierarchicalSerialization?!0:w==s?V.isHierarchicalRendering():w};If("JSONSerializer",D,{ms_ac:["hierarchical"],serialize:function(w){return Z.stringify(this.toJSON(),w)},toJSON:function(){var N=this,Y=N.dm,X=Y.getRoots(),$=N.json={v:Z.getVersion(),p:{},a:{},d:[]},r=Y.getSerializableAttrs();Y.getInit()&&($.init=Y.getInit()),Y.getName()&&($.p.name=Y.getName()),Y.getBackground()&&($.p.background=Y.getBackground()),Y.getLayers()&&($.p.layers=Y.getLayers()),$.p.autoAdjustIndex=Y.isAutoAdjustIndex(),$.p.hierarchicalRendering=Y.isHierarchicalRendering();for(var W in r){var E=Y.a(W);E!==w&&N[Pq](W,E,$.a)}return Lr($.a)&&delete $.a,N._hierarchical?X.each(N.serializeData,this):Y.each(function(Q){N.serializeData(Q)}),$},isSerializable:function(){return!0},getProperties:function(I){return I.getSerializableProperties()},getStyles:function(T){return T.getSerializableStyles()},getAttrs:function(q){return q.getSerializableAttrs()},serializeData:function(d){var M=this;if(M.isSerializable(d)&&!d._refGraph){var s,u,N,x,B=ai(d.getClassName())||d.getClass(),l=new B,w={c:d.getClassName(),i:d.getId(),p:{},s:{},a:{}};M.json.d.push(w),s=M.getProperties(d);for(u in s)/^_/.test(u)?(N=d[u],N!==l[u]&&M[Pq](u.substr(1),N,w.p)):(x=Ig(u),d[x]&&(N=d[x](),N!==l[x]()&&M[Pq](u,N,w.p)));s=M.getStyles(d);for(u in s)N=d.s(u),N!==l.s(u)&&M[Pq](u,N,w.s);s=M.getAttrs(d);for(u in s)N=d.a(u),N!==l.a(u)&&M[Pq](u,N,w.a);Lr(w.p)&&delete w.p,Lr(w.s)&&delete w.s,Lr(w.a)&&delete w.a}M._hierarchical&&d.getChildren().each(M.serializeData,M)},serializeValue:function(K,U,m){Qr(U)?U={__a:U._as}:U instanceof yb&&(U={__i:U.getId()}),m[K]=U},deserialize:function(O,T,z){var t=this,w=t.dm;w.beginTransaction(),cr++,z=vs(z)?{setId:z}:z||{},O=t.json=Fm(O)?Z.parse(O):O,t._82I={};var f=new Yd,d=new Yd,X=0,v=O.d.length;if(z.justDatas||(dc(O.init)&&O.init(w),w.setInit(O.init)),!z.justDatas){for(var V in O.a)w.a(V,t[Qn](O.a[V]));for(var P in O.p)w[Ng(P)](O.p[P])}for(;v>X;X++){var q=O.d[X],D=ai(q.c),b=new D,l=q.i;z.setId&&l!=s&&(b._id=l),t._82I[l]=b,f.add(b),d.add(q)}for(X=0;v>X;X++)t.deserializeData(f.get(X),d.get(X));return f.each(function(I){T&&!I.getParent()&&I.setParent(T),w.add(I)}),cr--,w.endTransaction(),f},deserializeData:function(o,R){for(var b in R.p)o[Ng(b)](this[Qn](R.p[b]));for(b in R.s)o.s(b,this[Qn](R.s[b]));for(b in R.a)o.a(b,this[Qn](R.a[b]))},deserializeValue:function(X){if(Sg(X)){var u=X.__i;if(u!=s)return this._82I[u];if(u=X.__a,Dc(u))return new Yd(u)}return X}}),se(Wr,{serialize:function(Y,x){return new hs(this,x).serialize(Y)},toJSON:function(T){return new hs(this,T).toJSON()},deserialize:function(j,P,q){return new hs(this).deserialize(j,P,q)}});var Bp=c.OverlappingBox=function(t){this.gv=t,this.boxes={}};If("OverlappingBox",D,{clear:function(){var Q,T,P=this.boxes;for(Q in P)T=P[Q],T.length=0},isOverlapping:function(w,r){var t,G,X=this,U=X.boxes,A=U[w];A?(t=A.rects,G=A.length):A=U[w]={rects:t=[],length:G=0};var $,i,r;for($=0;G>$;$++)if(i=t[$],i.x<r.x+r.w&&i.x+i.w>r.x&&i.y<r.y+r.h&&i.h+i.y>r.y)return!0;return t.length<=G?(t.push(r),A.length++):t[A.length++]=r,!1}}),Fp.GraphView=function(K){var x=this;x._24I={},x._34I=new Yd,x._25I={},x._56I={},x._view=Op(1,x),x._canvas=qb(x._view),x.dm(K?K:new Wr),this._coreInteractor=new ps(this),x.setEditable(!1),x.setScrollBarVisible(Z.graphViewScrollBarVisible)},zh("GraphView",D,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[cp,hk,$j,Ol,"resettable","editInteractor",vp,"pannable","rectSelectable","autoScrollZone",dn,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_resettable:Z.graphViewResettable,_pannable:Z.graphViewPannable,_rectSelectable:Z.graphViewRectSelectable,_autoScrollZone:Z.graphViewAutoScrollZone,_rectSelectBackground:Z.graphViewRectSelectBackground,_rectSelectBorderColor:Z.graphViewRectSelectBorderColor,_editPointSize:Z.graphViewEditPointSize,_editPointBorderColor:Z.graphViewEditPointBorderColor,_editPointBackground:Z.graphViewEditPointBackground,_scrollBarColor:zr,_scrollBarSize:oq,_autoHideScrollBar:io,_autoMakeVisible:Ud,_currentActionType:"host",getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(f){this._dataModel.setLayers(f)},setEditable:function(n){var Z=this,R=Z.__interactorMap__;if(!R){var v=Fp.XEditInteractor;R=Z.__interactorMap__={scrollBar:new Zh(Z),select:new Cg(Z),edit:v?new v(Z):new Gm(Z),move:new id(Z),"default":new Qh(Z),touch:new eh(Z,{editable:!1})}}n?(Z._uieditable=!0,Z.setInteractors([R.scrollBar,R.select,R.edit,R.move,R.default,R.touch])):(Z._uieditable=!1,Z.setInteractors([R.scrollBar,R.select,R.move,R.default,R.touch]))},getCanvas:function(){return this._canvas},_33I:function(m){var L=m.getUIClass();return L?new L(this,m):s},getDataUI:function(R){var i=this,O=i._25I[R._id];return O===w&&(O=i._33I(R),i._25I[R._id]=O),O},getNodeRect:function(Y){return Z.getNodeRect(this,Y)},getEdgeInfo:function(j){var n=this.getDataUI(j);return n?(n._79o(),n._78o):null},getEdgeSourcePosition:function(c){var F=this,u=F.getDataUI(c),v=u.s,p=u._data._40I;return hd(F,p,v("edge.source.position"),v("edge.source.offset.x"),v("edge.source.offset.y"),v("edge.source.anchor.x"),v("edge.source.anchor.y"))},getEdgeTargetPosition:function(y){var r=this,c=r.getDataUI(y),W=c.s,B=c._data._41I;return hd(r,B,W("edge.target.position"),W("edge.target.offset.x"),W("edge.target.offset.y"),W("edge.target.anchor.x"),W("edge.target.anchor.y"))},invalidateAll:function(U){var i=this;if(U){for(var n in i._25I){var z=i._25I[n];z&&z.dispose()}i._25I={},i._56I={},i._24I={},i._34I.clear(),i.redraw()}else i.dm().each(function(U){i.invalidateData(U)})},invalidateSelection:function(){var P=this;P.sm().each(function(o){P.invalidateData(o)})},invalidateData:function(J){var _=this;_._24I[J._id]=J,_._21Q(J),_.iv()},_21Q:function(M){var $=this,j=$._24I;if($f(M)&&zl[M.s(Rj)]){var p=M.getSourceAgent();p&&p.getAgentEdges().each(function(s){j[s._id]=s}),p=M.getTargetAgent(),p&&p.getAgentEdges().each(function(W){j[W._id]=W}),$.iv()}},redraw:function(L){var R=this;R._32I||(L?R._34I.add(L):(R._32I=1,R._34I.clear()),R.iv())},each:function(G,i){var c,C,h,n=0,R=this.getLayers(),Q=this._dataModel,S=Q._datas._as,F=S.length;if(R){for(var W=R.length;W>n;n++)if(h=R[n],Sg(h)&&(h=h.name),Q.isHierarchicalRendering()){var w=function(R){return R._layer===h?i?G.call(i,R):G(R):void 0};if(this._dataModel.eachByHierarchical(w)===!1)return}else for(var H=0;F>H;H++)if(c=S[H],c._layer===h&&(C=i?G.call(i,c):G(c),C===!1))return}else if(Q.isHierarchicalRendering())this._dataModel.eachByHierarchical(G,null,i);else for(;F>n;n++)if(c=S[n],C=i?G.call(i,c):G(c),C===!1)return},reverseEach:function(Q,p){var s,P,a,f,V=this._dataModel,x=V._layers,m=V._datas._as,R=m.length;if(x){for(s=x.length-1;s>=0;s--)if(f=x[s],Sg(f)&&(f=f.name),V.isHierarchicalRendering()){var A=function(W){return W._layer===f?p?Q.call(p,W):Q(W):void 0};if(V.reverseEachByHierarchical(A)===!1)return}else for(var L=R-1;L>=0;L--)if(P=m[L],P._layer===f&&(a=p?Q.call(p,P):Q(P),a===!1))return}else if(V.isHierarchicalRendering())V.reverseEachByHierarchical(Q,null,p);else for(s=R-1;s>=0;s--)if(P=m[s],a=p?Q.call(p,P):Q(P),a===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var D=this,A=D._84I;if(!A){var Q=this.dm().a("width"),e=this.dm().a("height");Q>0&&e>0?D._84I={x:0,y:0,width:Q,height:e}:(D.each(function(m){D.isVisible(m)&&(A=hq(A,D.getDataUIBounds(m)))}),D._84I=A?A:Kd)}return D._84I},getScrollRect:function(){return hq(this.getContentRect(),this._29I)},makeCenter:function(G,E,Z){var c=this;if(!c.getWidth()||!c.getHeight())return Z||No(c.centerData,c,[G,E,!0],500),void 0;c.makeVisible(G),c.validate();var N=c.getDataUIBounds(G);if(N){var e=c.getWidth(),k=c.getHeight(),j=N.x+N.width/2,K=N.y+N.height/2,l=-j*c._zoom+e/2,T=-K*c._zoom+k/2;c.setTranslate(l,T,E)}},fitData:function(m,Q,t,U,B){var W=this;if(!W.getWidth()||!W.getHeight())return B||No(W.fitData,W,[m,Q,t,U,!0],500),void 0;var J=function(){W.makeVisible(m),W.validate();var V=W.getDataUIBounds(m);V&&(V=cq(V),$o(V,t==s?20:t),W.fitRect(V,Q,U))};Q?Z.callWhenLoaded(J):J()},fitContent:function(b,C,X,j){var y=this;if(!y.getWidth()||!y.getHeight())return j||No(y.fitContent,y,[b,C,X,!0],500),void 0;var B=function(){y.validate();var T=cq(y.getContentRect());$o(T,C==s?20:C),y.fitRect(T,b,X)};b?Z.callWhenLoaded(B):B()},fitRect:function(u,n,v){var i=this,R=i.getWidth(),$=i.getHeight(),Q=u.x+u.width/2,q=u.y+u.height/2,P=d(R/u.width,$/u.height),r=i._zoom,X=-Q*r+R/2,g=-q*r+$/2;0===P||isNaN(P)||(v&&(P=d(1,P)),n?i.setTranslate(X,g,{finishFunc:function(){i.setZoom(P,n)}}):(i.setTranslate(X,g),i.setZoom(P)))},toCanvas:function(q,e){e=e||this._zoom,this.validateImpl();var U=this,Q=U.getContentRect();Q.width||(Q.width=10),Q.height||(Q.height=10);var G=qb(),i=Q.x*e,t=Q.y*e,M=Q.width*e,C=Q.height*e;Dg(G,M,C,1);var c=Ml(G);return q=q||this._dataModel.getBackground(),q&&Yg(c,0,0,M,C,q),Xr(c,-i,-t),c.scale(e,e),U._42(c),c.restore(),G},toDataURL:function(I,e,w){return this.toCanvas(I,w).toDataURL(e||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(Z,T){var h,m,Y=this;Y._93db(Z,T),Y.each(function(g){Y._56I[g._id]&&(h=Y.getDataUI(g),h&&(m=h._79o(),c.HtmlNode&&g instanceof c.HtmlNode?h._42(Z):(!T||Yk(T,m))&&h._42(Z)))}),Y._92db(Z,T)},validateImpl:function(){var n,r,V,G,c,f=this,H=f.tx(),v=f.ty(),T=f._zoom,O=f._canvas,s=this.getWidth(),m=this.getHeight(),F=f._29I,x={x:-H/T,y:-v/T,width:s/T,height:m/T},W={},e=f._34I,J=f._24I,o=f._32I,B=f._23I;f._24I={},(s!==O.clientWidth||m!==O.clientHeight)&&(Dg(O,s,m),o=1),o||vk(x,F)||(o=1),f._29I=x,f.each(function(H){r=H._id;var a=W[r]=f.isVisible(H);a!==f._56I[r]&&(J[r]=H,V=f.getDataUI(J[r]),V&&V._84o(a),f._84o(H,a))},f);for(r in J)V=f.getDataUI(J[r]),V&&(!o&&f._56I[r]&&(c=V._79o(),c&&e.add(c)),V.invalidate()),f._83I=1;if(f._56I=W,!o)for(r in J)W[r]&&(V=f.getDataUI(J[r]),V&&(c=V._79o(),c&&e.add(c)));if(o?G=x:(e.each(function(k){Yk(x,k)&&(G=hq(G,k))}),G&&($o(G,M(1,1/T)),G.x=p(G.x*T)/T,G.y=p(G.y*T)/T,G.width=Q(G.width*T)/T,G.height=Q(G.height*T)/T,G=xs(x,G))),f._74O=G,G){n=Ml(O);var I=G.x,L=G.y,$=G.width,A=G.height;I=Math.floor((I*T+H)*fk),L=Math.floor((L*T+v)*fk),$=Math.ceil($*T*fk)+1,A=Math.ceil(A*T*fk)+1,n.beginPath(),n.rect(I,L,$,A),n.clip(),n.clearRect(I,L,$,A),ol(n,H,v,T),f._42(n,G),n.restore(),delete f._74O}if(e.clear(),delete f._32I,B&&s>0&&m>0){var V=f.getDataUI(B);if(V){var c=V._79o(),a=f._29I,d=a.x,u=a.y,i=a.width,l=a.height,T=f._zoom;c&&!Yk(c,a)&&(c.x+c.width<d&&f.tx(-c.x*T),c.x>d+i&&f.tx(-(c.x+c.width-i)*T),c.y+c.height<u&&f.ty(-c.y*T),c.y>u+l&&f.ty(-(c.y+c.height-l)*T))}delete f._23I}f._83I&&(delete f._83I,delete f._84I),f._98O(),Lr(f._24I)||No(f.iv,f)},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(b){var p=this;b!==p.isScrollBarVisible()&&(b?(zd(p._view,p._79O=mc()),zd(p._79O,p._27I=mc()),zd(p._79O,p._28I=mc())):(bj(p._79O),delete p._79O,delete p._27I,delete p._28I),p.fp("scrollBarVisible",!b,b))},showScrollBar:function(){var L=this;L._79O&&(L._85I||(F(function(){L._86I()},Je),L.iv()),L._85I=new Date)},_86I:function(){var q=this;if(q._85I){var o=new Date,r=o.getTime();r-q._85I.getTime()>=Je?(delete q._85I,q.iv()):F(function(){q._86I()},Je)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var W=this,y=this._27I,d=this._28I;if(W._79O){if(W._autoHideScrollBar&&!W._85I)return y.style.visibility=Fc,d.style.visibility=Fc,void 0;var E=W.getScrollBarColor(),A=W._zoom,b=W.getScrollBarSize(),P=W.getViewRect(),j=W.getScrollRect(),v=P.height*A,C=j.height*A,w=P.width*A-b-2,V=v*((P.y-j.y)*A/C),g=v*(v/C),f=y.style;C-.5>v?($e>g&&(V=V+g/2-$e/2,0>V&&(V=0),V+$e>v&&(V=v-$e),g=$e),_p(y,w,V,b,g),f.visibility=Lj,f.background=E,f.borderRadius=b/2+Wo):f.visibility=Fc;var x=P.width*A,H=j.width*A,V=P.height*A-b-2,w=x*((P.x-j.x)*A/H),z=x*(x/H),f=d.style;H-.5>x?($e>z&&(w=w+z/2-$e/2,0>w&&(w=0),w+$e>x&&(w=x-$e),z=$e),_p(d,w,V,z,b),f.visibility=Lj,f.background=E,f.borderRadius=b/2+Wo):f.visibility=Fc}},setDataModel:function(N){var b=this,A=b._dataModel,f=b._selectionModel;A!==N&&(A&&(A.ump(b.handleDataModelPropertyChange,b),A.umm(b.handleDataModelChange,b),A.umd(b.handleDataPropertyChange,b),A.removeIndexChangeListener(b._75O,b),A.removeHierarchyChangeListener(b.handleHierarchyChange,b),f||A.sm().ums(b.handleSelectionChange,b)),b._dataModel=N,N.mp(b.handleDataModelPropertyChange,b),N.mm(b.handleDataModelChange,b),N.md(b.handleDataPropertyChange,b),N.addIndexChangeListener(b._75O,b),N.addHierarchyChangeListener(b.handleHierarchyChange,b),f?f._21I(N):N.sm().ms(b.handleSelectionChange,b),b.invalidateAll(!0),b.fp(Qm,A,N),b._canvas.style.background=N.getBackground()||"")},getLayersInfo:function(){if(this._layersInfo===w){var e=this.getLayers();e?(this._layersInfo={},e.forEach(function(N){var Z=Sg(N)?N.name:N;this._layersInfo[Z]=N},this)):this._layersInfo=null}return this._layersInfo},updateLayers:function(){this._layersInfo=w,this.invalidateSelection(),this.redraw()},handleDataModelPropertyChange:function(L){if("background"===L.property){var r=this._canvas.style.background,q=L.newValue||"";this._canvas.style.background=q,this.fp("canvasBackground",r,q)}else"a:width"===L.property||"a:height"===L.property?(this._83I=1,this.redraw()):"layers"===L.property?this.updateLayers():"hierarchicalRendering"===L.property&&this.redraw()},handleDataPropertyChange:function(N){this.dm().isHierarchicalRendering()&&"parent"===N.property&&N.data.hasChildren()&&this.redraw(),this.invalidateData(N.data)},onPropertyChanged:function(C){var l=this,h=C.property;if(l.redraw(),"zoom"===h){var K=l.sm().getSelection();K.size()&&K.each(function(Q){Q.invalidate()})}wj[h]?l.showScrollBar():h===vp&&l.onCurrentSubGraphChanged(C)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(j){var r=this,L=j.kind,U=j.data;if(r._83I=1,"add"===L)r.invalidateData(U),$f(U)&&U.getEdgeGroup()&&U.getEdgeGroup().eachSiblingEdge(r.invalidateData,r);else if(L===Dq){r._21Q(U);var c=U._id,W=r._25I[c];if(W){if(r._56I[c]){var x=W._79o();x&&r.redraw(x)}W.dispose(),delete r._25I[c],delete r._24I[c],delete r._56I[c]}U===r._currentSubGraph&&r.setCurrentSubGraph(s)}else L===zo&&(r.invalidateAll(!0),r.setCurrentSubGraph(s))},_75O:function(B){this.invalidateData(B.data)},handleHierarchyChange:function(P){this.dm().isHierarchicalRendering()&&P.data.hasChildren()&&this.redraw(),this.invalidateData(P.data)},adjustIndex:function(W){var O=this;if(O.isVisible(W)){O.dm().beginTransaction();for(var $=W;$._parent&&O.isVisible($._parent);)$=$._parent;$&&$!==W&&O._dataModel.adjustIndex($),O._dataModel.adjustIndex(W),O.dm().endTransaction()}},getImage:function(l){return l.getImage?l.getImage():w},getSelectWidth:function(T){var N=sr(this.getImage(T));return N&&Rp(N.disableSelectedBorder,T,this)?0:T.s("select.width")},getSelectColor:function(V){return V.s("select.color")},isSelectable:function(z){if(!this._clickThroughChecking&&z.getParent()instanceof xc&&z.getParent().isSyncSize())return!1;var Q=this.getLayersInfo();if(Q){var k=Q[z._layer];if(k&&k.selectable===!1)return!1}return z.s("2d.selectable")&&this.sm().isSelectable(z)},isMovable:function(e){var z=this;if($f(e)&&e.getStyle(Rj)!==qg)return!1;var s=this.getLayersInfo();if(s){var B=s[e._layer];if(B&&B.movable===!1)return!1}return e.s("2d.movable")?z._movableFunc?z._movableFunc(e):!0:!1},isEditable:function(L){var W=this;if(c._uiSerializing)return W._uieditable;if(!W._editInteractor||!W.isSelected(L))return!1;if(Ur(L)){var I=W.getDataUI(L);if(!I||I._88I)return!1}if($f(L)&&L.getStyle(Rj)!==qg)return!1;var S=this.getLayersInfo();if(S){var X=S[L._layer];if(X&&X.editable===!1)return!1}return L.s("2d.editable")?W._editableFunc?W._editableFunc(L):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(b){return Cl(b)&&0!==b.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(b):!0},isRectEditable:function(V){return this._rectEditableFunc?this._rectEditableFunc(V):!0},isAnchorEditable:function(C){return this._anchorEditableFunc?this._anchorEditableFunc(C):!0},isRotationEditable:function(T){return T.setRotation&&T.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(T):!0:!1},getRotationPoint:function(y){var M=y.getAnchor(),f=y.getScale(),C=this._zoom,L=zk(y.getRotation(),0,-y.getHeight()*f.y*M.y-(f.y<0?-1:1)*(nb?32:16)/C),X=y.p();return L.x+=X.x,L.y+=X.y,L},getLogicalPoint:function(N){var r=this;return Tg(N,r._canvas,r.tx(),r.ty(),r._zoom,r._zoom)},getSelectedDataAt:function(T){var Y=this;return this.getDataAt(T,function(T){return Y.isSelected(T)})},getDataInfoAt:function(o,w,T){var R,d=this.lp(o),h=this.getDataAt(d,w,T);if(h){var U=this.getDataUI(h);R={data:h,ui:U,point:d};var r=U._38o;if(r){var E=r.icons;for(var $ in E){var K=E[$],X=r.rects[$];if(X)for(var F=Rp(K.names,h,this),V=F?F.length:0,i=X.rotation,k=V-1;k>=0;k--){var v=F[k],W=X[k];if(Mr(W,d,i))return R.part="icons",R.name=$,R.icon=v,R.rect=W,R.index=k,R.rotation=i,R}}}if(this.isNoteVisible(h)){if(U.note2Info&&Mr(U.note2Info.clickRect,d,s,U.note2Info.scale))return R.part="note2",R;if(U.noteInfo&&Mr(U.noteInfo.clickRect,d,s,U.noteInfo.scale))return R.part="note",R}if(this.isLabelVisible(h)){if(U.label2Info&&Mr(U.label2Info.rect,d,U.label2Info.rotation,U.label2Info.scale))return R.part="label2",R;if(U.labelInfo&&Mr(U.labelInfo.rect,d,U.labelInfo.rotation,U.labelInfo.scale))return R.part="label",R}if(h.isInRect&&h.isInRect(d))return R.part="body",R}return R},getDataAt:function(I,M,R){I.target&&(I=this.lp(I));var k,s=this._zoom;return this.reverseEach(function(Q){return(M?M(Q):this.isSelectable(Q))&&this.rectIntersects(Q,dg(I.x,I.y,R,s))?(k=Q,!1):void 0},this),k},getIconInfoAt:function(O,_){var Y=this;if(O.target&&(O=Y.lp(O)),_||(_=Y.getDataAt(O)),_){var A=Y.getDataUI(_);if(A&&A._38o){var $,x=A._38o,r=new Yd;for($ in x.icons)r.add($);for(var d=r.size()-1;d>=0;d--){$=r.get(d);for(var c=x.rects[$],D=c.rotation,p=c.length-1;p>=0;p--){var q=c[p],i=q.width,y=q.height,V={x:O.x-q.x-i/2,y:O.y-q.y-y/2};D!=s&&(V=zk(-D,V.x,V.y));var q={x:-i/2,y:-y/2,width:i,height:y};if(Mr(q,V))return{key:$,index:p,name:x.icons[$].names[p],rect:c[p],point:O,rotation:D,relativeRect:q,relativePoint:V,data:_}}}}}return s},getDatasInRect:function(q,K,O){O===w&&(O=1);var m=this,l=new Yd;return m.reverseEach(function(h){O&&!m.isSelectable(h)||(K?m.rectIntersects(h,q):m.rectContains(h,q))&&l.add(h)
}),l},moveSelection:function(m,P){var $=this;$.dm().beginTransaction(),Sc($.sm().toSelection($.isMovable,$),m,P),$.dm().endTransaction()},moveDatas:function(S,O,X){var m=this;m.dm().beginTransaction(),S instanceof Yd||(S=new Yd(S)),Sc(S,O,X),m.dm().endTransaction()},getDataUIBounds:function(T){var A=this.getDataUI(T);return A?A._79o():s},drawData:function(H,P){var m=this.getDataUI(P);m&&(m._79o(),m._42(H)),P instanceof c.Block&&P.eachChild(function(V){this.drawData(H,V)},this)},getBoundsForGroup:function(A){return A.s(Oj)?this.getDataUIBounds(A):s},rectIntersects:function(k,Q){this.validate();var O=s;if(this._56I[k._id]){var e=this._25I[k._id];if(e){var y=e._79o();if(qi(Q,y))O=!0;else if((Q=xs(Q,y))&&(e.rectIntersects&&(O=e.rectIntersects(Q)),O==s)){if(!k.s("pixelPerfect"))return!0;var l=Q.x,G=Q.y,Y=Q.width,P=Q.height,W=this._zoom,w=Z.hitMaxArea,D=Y*P*W*W;if(D>w){var p=Math.sqrt(w/D);W*=p}Y*=W,P*=W,2>Y&&(Y=2),2>P&&(P=2),l*=W,G*=W;var L=zm(Y,P);Xr(L,-l,-G),L.scale(W,W),this._drawForChecking=!0,this.drawData(L,k),this._drawForChecking=!1;try{for(var c=0,B=L.getImageData(0,0,Y,P).data;c<B.length;c+=4)if(0!==B[c+3]){O=!0;break}L.restore()}catch(N){Co=s,O=!1}}}}return O?!0:!1},rectContains:function(e,m){if(this._56I[e._id]){var E=this._25I[e._id];if(E)return qi(m,E._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(l){if(!Z.isInput(l.target)){var i=this,u=i._focusData,N=u&&i._25I[u._id],g=0,c=i._dataModel._datas;if(!(u&&u._enabled&&u._editable&&N&&N.onKeyDown&&N.onKeyDown(l)===!0))if(9===l.keyCode&&(u&&(g=c.indexOf(u),sb(l)?-1===--g&&(g=0):++g===c.size()&&(g=0)),i._focusData=u=c.get(g),i.sm().setSelection(u)),Un(l)?i.selectAll():mm(l)&&i.isResettable()&&i.reset(),i.sm().isEmpty()){if(i._editing)return;var C=i.tx(),V=i.ty(),w=!1,R=sb()?100:10;Ee(l)&&(C-=R,w=!0),oo(l)&&(V-=R,w=!0),Ck(l)&&(C+=R,w=!0),Ni(l)&&(V+=R,w=!0),w&&i.setTranslate(C,V)}else{sl(l)&&i.handleDelete(l);var E=sb()?10:1;Ee(l)&&(i.moveSelection(-E,0),i.fi({kind:"moveLeft"})),oo(l)&&(i.moveSelection(0,-E),i.fi({kind:"moveUp"})),Ck(l)&&(i.moveSelection(E,0),i.fi({kind:"moveRight"})),Ni(l)&&(i.moveSelection(0,E),i.fi({kind:"moveDown"}))}}},handleScroll:function(u,s){Jr(u);var B=this.lp(u);s>0?this.scrollZoomIn(B):0>s&&this.scrollZoomOut(B)},handlePinch:function(b,J,Q){this._68I||(J>Q?this.pinchZoomIn(b):this.pinchZoomOut(b))},checkDoubleClickOnNote:function(N,V){var t=this,O=t.lp(N),i=t.getDataUI(V),$=i.note2Info;return $&&V.s("note2.toggleable")&&Mr($.clickRect,O)?(V.s(Li,!V.s(Li)),t.fi({kind:"toggleNote2",event:N,data:V}),!0):($=i.noteInfo,$&&V.s("note.toggleable")&&Mr($.clickRect,O)?(V.s(fc,!V.s(fc)),t.fi({kind:"toggleNote",event:N,data:V}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(D,P){var c=this,h=c.getAutoScrollZone(),z=h/c.getZoom(),e=h/4,W=c._29I,B=c.lp(D),q={x:c.tx(),y:c.ty()};return B&&h>0&&W&&(B.x-W.x<z?c.translate(e,0):W.x+W.width-B.x<z&&c.translate(-e,0),B.y-W.y<z?c.translate(0,e):W.y+W.height-B.y<z&&c.translate(0,-e)),q.x=c.tx()-q.x,q.y=c.ty()-q.y,P&&(P.x+=q.x,P.y+=q.y),q},getMoveMode:function(e,G){var p=G.s("2d.move.mode");return p?p:sq["88"]?"x":sq["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(l,O,y){var z=this;return"currentSubGraph"===O?{__i:l.getId()}:y.serializeProperty(l,O,z)},deserializeProperty:function(H,p,y){var D=this;if("currentSubGraph"===p){var q=D.dm(),j=q.__idMap;return j[H.__i]}return y.deserializeProperty(H,p,D)},setDefaultCursor:function(b,z){this._defaultCursor=b,z!==!1&&this.setCursor(b)},setCursor:function(C){"default"===C&&(C=this._defaultCursor||C);var R=this.getView().style;R.cursor=C,R.cursor="-webkit-"+C,R.cursor="-moz-"+C},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(O){return Z.getConnectAction(null,O)?(this._currentActionType=O,!0):!1},isInteractive:function(u){return u.s("interactive")}});var iq=function(P,l){var p=this;p.gv=P,p.s=function(F){return l.getStyle(F)},p._data=l,p._87I=new Yd};xl(iq,D,{_6I:s,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var q=this,J=q.gv.isSelected(q._data);return!J||q.isShadowed()?0:q.gv.getSelectWidth(q._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(d){var N=this._data,L=this.gv.getBodyColor(N);return L?L:d?N.getStyle(d):s},_2Q:function(X){return this.s(X)},_1Q:function(l,G,_,J){var n=this.s,v=n(G+".dash.color");l.strokeStyle=v,l.lineWidth=_,l.stroke(),n(G+".dash.3d")&&zj(l,v,n(G+".dash.3d.color"),_,this.gv._zoom,n(G+".dash.3d.accuracy")),vb(l,J)},invalidate:function(){this._6I=s},_79o:function(){var U=this;if(!U._6I){var u=U._data,X=U.gv;U.labelInfo=U.label2Info=U.noteInfo=U.note2Info=U._38o=s,U._87I.clear(),U.interactiveInfo=X.isInteractive(u)?{}:s,U._3O(),U._55O=X.isEditable(u)?{_42O:X.isRectEditable(u),_43O:X.isPointEditable(u),_56O:X.isRotationEditable(u)}:s,U._6I=U._81o()}return U._6I},_3O:function(){},getPosition:function(){return Kd},_68o:function(K,S){K&&this._87I.add(Zb(K,S))},_81o:function(){var M=this,d=M.s;M._24O(Xo,"getLabel"),M._24O(um,"getLabel2"),M._26O(ip,"getNote"),M._26O(mp,"getNote2"),M._15O(),M._55O&&M._48O();var g;if(M._87I.each(function(B){g=hq(g,B)}),g&&M.isShadowed()){var c=cq(g);c.x+=d("shadow.offset.x"),c.y+=d("shadow.offset.y"),$o(c,d("shadow.blur")),g=hq(g,c)}return M._87I.clear(),g},_42:function(S){var E=this,c=E._data,v=E.gv,F=E.s,I=F("opacity"),o=this.isShadowed();if(o){var y=S.shadowOffsetX,N=S.shadowOffsetY,O=S.shadowBlur,T=S.shadowColor,g=v.getZoom();S.shadowOffsetX=F("shadow.offset.x")*g,S.shadowOffsetY=F("shadow.offset.y")*g,S.shadowBlur=F("shadow.blur")*g,S.shadowColor=E.getSelectColor()}if(I!=s){var w=S.globalAlpha;S.globalAlpha=I}E._80o(S),v.isLabelVisible(c)&&((!v._drawForChecking||F("label.selectable"))&&tr(S,E.labelInfo),(!v._drawForChecking||F("label2.selectable"))&&tr(S,E.label2Info)),v.isNoteVisible(c)&&(Si(S,E.noteInfo),Si(S,E.note2Info)),E._99O(S),I!=s&&(S.globalAlpha=w),o&&(S.shadowOffsetX=y,S.shadowOffsetY=N,S.shadowBlur=O,S.shadowColor=T)},_80o:function(){},_47O:function(){},_24O:function(Y,O){var h=this,R=h._data,M=h.gv,d=h.s,m=M[O](R);if(m!=s){var C=d(Y+".scale"),A=d(Y+".max"),L=d(Y+".position"),P=h[Y+"Info"]={label:m,scale:C,color:M[O+"Color"](R),font:d(Y+".font"),opacity:d(Y+".opacity"),align:d(Y+".align"),rotation:h.getRotation(d(Y+".rotation"),!1,L),background:M[O+"Background"](R)},Z=nq(P,m);A>0&&A<Z.width&&(P.labelWidth=Z.width,Z.width=A),1!==C&&(Z.width*=C,Z.height*=C);var q=h.getPosition(L,d(Y+".offset.x"),d(Y+".offset.y"),Z,d(Y+".position.fixed"));if(Z.x=q.x-Z.width/2,Z.y=q.y-Z.height/2,h._68o(P.rect=Z,P.rotation),1!==C){var G=Z.width/C,E=Z.height/C;P.rect={x:q.x-G/2,y:q.y-E/2,width:G,height:E}}}},_26O:function(r,S){var e=this,p=e.gv,c=e._data,u=e.s,i=p[S](c);if(i!=s){var v,t,C=u(r+".scale"),F=e[r+"Info"]={note:i,scale:C,data:c,view:p,expanded:u(r+".expanded"),font:u(r+".font"),color:u(r+".color"),opacity:u(r+".opacity"),align:u(r+".align"),icon:u(r+".icon"),backgroundImage:u(r+".backgroundImage"),borderWidth:u(r+".border.width"),borderColor:u(r+".border.color"),background:p[S+"Background"](c)},M=e.getPosition(u(r+".position"),u(r+".offset.x"),u(r+".offset.y")),X=M.x,T=M.y;if(F.expanded){var I,m=u(r+".max"),k=u(r+".backgroundImage");k?(k=sr(k),I={width:Db(k,c),height:Vc(k,c)}):I=nq(F,i),I.width+=6,I.height+=2,m>0&&m<I.width&&(F.labelWidth=I.width,I.width=m),v=I.width,t=I.height+8,F.clickRect={x:X-v*C/2,y:T-t*C,width:v*C,height:t*C*I.height/t}}else{var N=u(r+".icon");N?(N=sr(N),v=Db(N,c),t=Vc(N,c)):(v=12,t=18),F.clickRect={x:X-v*C/2,y:T-t*C,width:v*C,height:t*C}}F.rect={x:X-v/2,y:T-t*C/2-t/2,width:v,height:t};var l=Q(F.borderWidth/2)*C;e._68o({x:X-v*C/2-l,y:T-t*C-l,width:v*C+2*l,height:t*C+2*l})}},_48O:function(){},_99O:function($){var z=this,b=z._38o;if(b){var a=z.gv,G=z._data,p=b.icons,g=z.interactiveInfo;g&&(g._38o={});for(var k in p){var N=p[k],Z=b.rects[k];if(Z){g&&(g._38o[k]=[]);var L=Rp(N.opacity,G,a),I=Rp(N.names,G,a),D=I?I.length:0,i=Z.rotation;if(L!=s){var E=$.globalAlpha;$.globalAlpha*=L}for(var F=0;D>F;F++){var W=I[F],x=sr(W),S=Z[F];if(i){var M=S.x+S.width/2,V=S.y+S.height/2;$.save(),Xr($,M,V),Wf($,i),Xr($,-M,-V)}g&&g._38o[k].push($.interactiveInfo={compInfos:[],matrix:i?new nk(i,M,V).appendTranslate(-M,-V):new nk}),pc($,x,Rp(N.stretch,G,a),S.x,S.y,S.width,S.height,z._data,z.gv),$.interactiveInfo=s,i&&$.restore()}L!=s&&($.globalAlpha=E)}}}}});var Yh=function(A,X){fm(Yh,this,[A,X])};xl(Yh,iq,{_checkEmptyRect:!0,_40O:function(p,H){var x=this,z=x.s,R=p.rect;(p.borderColor=x.gv.getBorderColor(x._data))&&(p.borderType=z("border.type"),p.borderWidth=z("border.width"),p.borderPadding=z("border.padding"),H=M(H,p.borderPadding+p.borderWidth/2));var W=x._data.getScale(),N=M(1,M(A(W.x),A(W.y)));if(p.selectWidth=x.getSelectWidth()){var G=x.gv._zoom;p.selectType=z("select.type"),p._97o=x.getSelectColor(),p.selectPadding=z("select.padding"),H=M(H,(p.selectPadding+p.selectWidth/2/G)/N)}H>0&&(H*=N,R=cq(R),$o(R,H)),x._68o(R)},_39O:function(Q,W){var h,H=this,L=W.rect;if(W.borderWidth>0&&(h=W.borderPadding,Q.strokeStyle=W.borderColor,Q.lineWidth=W.borderWidth,om(Q,W.borderType,{x:L.x-h,y:L.y-h,width:L.width+2*h,height:L.height+2*h}),Q.stroke()),W.selectWidth>0){var R=H.gv._zoom;if(h=W.selectPadding,Q.strokeStyle=W._97o,Q.lineWidth=W.selectWidth/R,W.rotation!=s){Q.save(),Q.translate(W.position.x,W.position.y),Q.rotate(W.rotation);var E=H._data,A=E.getWidth(),_=E.getHeight(),l=W.scale,q=W.anchor;L={x:l.x*-A*q.x,y:l.y*-_*q.y,width:l.x*A,height:l.y*_}}om(Q,W.selectType,{x:L.x-h,y:L.y-h,width:L.width+2*h,height:L.height+2*h}),W.rotation!=s&&Q.restore(),Q.stroke()}},_3O:function(){var y=this,h=y.s,$=y._data,e=$.getStyle(Ri),Q=y.getBodyColor(),R=y._83o=e?{shape:e,_53o:y.getBodyColor("shape.background"),_27Q:sr(h("shape.repeat.image"),Q),shapeGradientPack:h("shape.gradient.pack"),_54o:h("shape.border.width"),_55o:h("shape.border.color"),_56o:h("shape.border.3d"),_57o:h("shape.border.3d.color"),_58o:h("shape.border.3d.accuracy"),shapeGradient:h("shape.gradient"),_59o:h("shape.gradient.color"),_60o:h("shape.border.pattern"),_61o:h("shape.border.cap"),_62o:h("shape.border.join"),bodyColor:Q}:{img:sr(y.gv.getImage($),Q),bodyColor:Q,stretch:h("image.stretch")};if(i&&!x);else{R.rect=$.getRect(),R.position=$.p(),R.scale=$.getScale(),R.anchor=$.getAnchor(),R.rotation=$.getRotation(),e===Sh&&(R._63o=h("shape.depth"));var u=0;if(e)u=ig(s,R._54o/2,R._62o),y.s("shape.dash")&&(u=M(u,(y.s("shape.dash.width")||R._54o)/2));else if(R.img&&R.img.boundExtend)if(u=Rp(R.img.boundExtend,$,y.gv),R.img.boundExtendAbsolute){var m=$.getScale();u/=y.gv._zoom*M(1,M(A(m.x),A(m.y)))}else if(!Rp(R.img.fitSize,$,y.gv)){var n=Rp(R.img.width,$,y.gv),V=Rp(R.img.height,$,y.gv);u*=M($.getWidth()/n,$.getHeight()/V)}y._40O(R,u);var X=h("clip.percentage");if(1>X&&(0>X&&(X=0),R.clipRect=gl($.getAnchorRect(),h("clip.direction"),X)),e){var p=h("shape.fill.clip.percentage");1>p&&(0>p&&(p=0),R.shapeClipRect=gl($.getAnchorRect(),h("shape.fill.clip.direction"),p))}}},getPosition:function(l,J,e,B){var j=ii(l,this._83o.rect,B);return j.x+=J,j.y+=e,j},_80o:function(T){var x=this,K=x.s,H=x.gv,B=x._data,L=x._83o,M=L.rect,j=L.position,O=L.rotation,u=L.anchor,w=L.scale,l=L.shape,b=L.clipRect;if(!x._checkEmptyRect||M.width>0&&M.height>0){var J=B.getSize();if(J.x=-J.width*u.x,J.y=-J.height*u.y,T.save(),Xr(T,j.x,j.y),Wf(T,O),Ak(T,w.x,w.y),b&&(T.beginPath(),T.rect(b.x,b.y,b.width,b.height),T.clip()),x.freeDraw)x.freeDraw(T,J,L);else if(l){var X,k,g,h,P=L._60o,U=Jd(T,P),e=L._53o,V=L._27Q,C=L._54o,Q=L._55o,G=L.shapeGradientPack,S=T.lineJoin,E=T.lineCap;if("roundRect"===l?X=K("shape.corner.radius"):"polygon"===l?X=K("shape.polygon.side"):"arc"===l&&(X=K("shape.arc.from"),k=K("shape.arc.to"),g=K("shape.arc.close"),h=K("shape.arc.oval")),T.lineJoin=L._62o,T.lineCap=L._61o,K("shape.background2")&&(om(T,l,J,X,k,g,h),Sp(T,K("shape.background2"),K("shape.gradient2"),K("shape.gradient2.color"),J),T.fill()),e||V||G){var R=L.shapeClipRect;R&&(T.save(),T.beginPath(),T.rect(R.x,R.y,R.width,R.height),T.clip()),om(T,l,J,X,k,g,h),G?lj(T,G):V?Sk(T,V,L.bodyColor,null,B,H):Sp(T,e,L.shapeGradient,L._59o,J),T.fill(),R&&T.restore(),G&&T.restore(),T!==U&&om(U,l,J,X,k,g,h)}else om(U,l,J,X,k,g,h);if(C>0){var N=K("shape.border.width.absolute");N&&(T.save(),T.setTransform(1,0,0,1,0,0)),T.lineWidth=C,T.strokeStyle=Q,T.stroke(),N&&T.restore(),L._56o&&zj(T,Q,L._57o,C,H._zoom,L._58o)}if(vb(T,P),K("shape.dash")){var r=K("shape.dash.width")||C;if(r>0){P=K("shape.dash.pattern");var U=Jd(T,P,x._2Q("shape.dash.offset"));U!==T&&om(U,l,J,X,k,g,h),x._1Q(T,"shape",r,P)}}Bk(T,e,L._63o,J),T.lineJoin=S,T.lineCap=E}else{var A=x.interactiveInfo;A&&(T.interactiveInfo=A.bodyInfo={compInfos:[],matrix:new nk(O,j.x,j.y,w.x,w.y)}),pc(T,L.img,L.stretch,J.x,J.y,J.width,J.height,B,H,L.bodyColor),T.interactiveInfo=s}T.restore()}x._39O(T,L)},_48O:function(){},_47O:function(){}});var Fh=function(n,Y){fm(Fh,this,[n,Y])},ob=function(I,Q,n,y){var z=dq(I,Q);return n=y?d(n,z):Mb(n,z),z?n/=z:n=0,{x:I.x+(Q.x-I.x)*n,y:I.y+(Q.y-I.y)*n}};xl(Fh,iq,{_3O:function(){var Y,E=this,G=E._data,n=E.gv,j=E.s,D=j(Rj),U=G.isLooped(),k=j("edge.width"),p=j("edge.center"),b=j("edge.offset"),g=n.getBorderColor(G),A=g?j("border.width"):0,z=E.getSelectWidth(),i=G._40I,N=G._41I,f=E._78o=i&&N?{looped:U,type:D,width:k,center:p,color:E.getBodyColor("edge.color"),borderColor:g,borderWidth:A,_97o:z?E.getSelectColor():s,selectWidth:z,pattern:j("edge.pattern"),cap:j("edge.cap"),join:j("edge.join"),is3d:j("edge.3d"),_67o:j("edge.3d.color"),_66o:j("edge.3d.accuracy")}:s;if(f){var J=Z.getEdgeType(D);if(J){var d=J(G,sp(E,n,G,U,D),n,E._19Q);d.points&&d.points.size()>1?(f.edgeTypeInfo=d,Y=Ge(f.edgeTypeInfo.points)):d[Pj]&&d.rect&&(f.edgeTypeInfo=d,Y=d.rect)}else{var q=j("edge.source.anchor.x"),h=j("edge.source.anchor.y"),S=j("edge.target.anchor.x"),K=j("edge.target.anchor.y"),e=hd(n,i,j("edge.source.position"),j("edge.source.offset.x"),j("edge.source.offset.y"),q,h),X=hd(n,N,j("edge.target.position"),j("edge.target.offset.x"),j("edge.target.offset.y"),S,K);if(D===qg){var H=f.points=j(Ce)||$l,W=H.size();f.segments=j("edge.segments");var t=q!==w||h!==w,T=S!==w||K!==w;if(!p)if(b)t||(e=ob(e,W?H.get(0):X,b,W)),T||(X=ob(X,W?H.get(W-1):e,b,W));else{var u;t||(u=Fo(e,W?H.get(0):X,mi(n,i)),u&&(e={x:u[0],y:u[1]})),T||(u=Fo(W?H.get(W-1):e,X,mi(n,N)),u&&(X={x:u[0],y:u[1]}))}Y=hq(Ge(f.points),Ge(e,X))}else{var I=sp(E,n,G,U,D);if(E._19Q||(I=-I),U)e=cq(e),e.x=n.getNodeRect(i).x,f.radius=I,Y={x:e.x-I,y:e.y-I,width:2*I,height:2*I};else{var x=dq(e,X),c=Mb(b,x),y={x:c,y:I},L={x:x-c,y:I},v=o(X.y-e.y,X.x-e.x),a=f.mat=new Qi(v);if(f.orienAngle=v,f.angle=X.x<e.x?v+_:v,f.rect={x:y.x,y:y.y,width:L.x-y.x,height:0},f.origin=e,y=a.tf(y),y.x+=e.x,y.y+=e.y,L=a.tf(L),L.x+=e.x,L.y+=e.y,p){var r={x:x,y:0};r=a.tf(r),r.x+=e.x,r.y+=e.y,Y=Ge([e,y,L,r]),f.c1=e,f.c2=r}else Y=Ge(y,L);e=y,X=L}}f.sourcePoint=e,f.targetPoint=X,G._lastSourcePoint=e,G._lastTargetPoint=X}var O=0;j("edge.dash")&&(O=j("edge.dash.width")||k);var $="square"===f.cap?.71:.5;ig(Y,M(O*$,k*$+A+z),f.join),E._68o(Y)}},getRotation:function(M,U,z){M=M||0;var l=this._78o;if(l){var O,X=l.angle,T=l.points,W=l.edgeTypeInfo;if(X!=s)return U?l.orienAngle+M:X+M;if(W&&W[Pj])return W.getRotation?W.getRotation(this,M,U,z):0;if(W&&W.points){var L=W.points;return O=L.size(),Wd[z]?O&&0===O%2?uj(L.get(O/2-1),L.get(O/2),U,M):M:Rd[z]?uj(L.get(0),L.get(1),U,M):uj(L.get(O-2),L.get(O-1),U,M)}if(T)return O=T.size(),Wd[z]?O&&0===O%2?uj(T.get(O/2-1),T.get(O/2),U,M):M:Rd[z]?uj(l.sourcePoint,O?T.get(0):l.targetPoint,U,M):uj(O?T.get(O-1):l.sourcePoint,l.targetPoint,U,M)}return M},getPosition:function(x,s,Y,W,F){var A=this._78o;if(A){var G,y=A.type,p=A.points,_=A.edgeTypeInfo,f=A.sourcePoint,e=A.targetPoint;if(!y)return A.looped?{x:f.x-A.radius+s,y:f.y+Y}:(F&&f&&e&&(f.x>e.x||f.x===e.x&&f.y>e.y)&&(x=Yf[x],Y=-Y),G=ii(x,A.rect,W),G.x+=s,G.y+=Y,G=A.mat.tf(G),G.x+=A.origin.x,G.y+=A.origin.y,G);if(_&&_[Pj])return _.getPosition?_.getPosition(this,x,s,Y,W,F):{x:(f.x+e.x)/2,y:(f.y+e.y)/2};if(p){var G,J=p.size();if(Wd[x]){if(J){var v=J%2;if(0===v)return Qg(p.get(J/2-1),p.get(J/2),x,s,Y,W,F);G=p.get((J-v)/2)}else G={x:(f.x+e.x)/2,y:(f.y+e.y)/2};return G=ii(x,{x:G.x,y:G.y,width:0,height:0},W),G.x+=s,G.y+=Y,G}return Rd[x]?Qg(f,J?p.get(0):e,x,s,Y,W,F):Qg(J?p.get(J-1):f,e,x,s,Y,W,F)}if(_){var u=_.points,J=u.size();if(Wd[x]){var v=J%2;return 0===v?Qg(u.get(J/2-1),u.get(J/2),x,s,Y,W,F):(G=u.get((J-v)/2),G=ii(x,{x:G.x,y:G.y,width:0,height:0},W),G.x+=s,G.y+=Y,G)}return Rd[x]?Qg(u.get(0),u.get(1),x,s,Y,W,F):Qg(u.get(J-2),u.get(J-1),x,s,Y,W,F)}}return Kd},_42:function(f){this._78o&&Fh.superClass._42.call(this,f)},drawPath:function(X,R){X.beginPath();var L=R.type,s=R.points,u=R.segments,G=R.edgeTypeInfo;if(!L||s){var c=R.sourcePoint,K=c.x,w=c.y,x=R.targetPoint,J=x.x,C=x.y;if(L)if(u){var b=new Yd({x:K,y:w});b.addAll(s),b.add({x:J,y:C}),hr(X,b,u)}else X.moveTo(K,w),s.each(function(B){X.lineTo(B.x,B.y)}),X.lineTo(J,C);else R.looped?X.arc(K,w,R.radius,0,v,!0):R.center?(X.moveTo(R.c1.x,R.c1.y),X.lineTo(K,w),X.lineTo(J,C),X.lineTo(R.c2.x,R.c2.y)):(X.moveTo(K,w),X.lineTo(J,C))}else G&&(G.points?hr(X,G.points,G.segments):G[Pj]&&G[Pj](X,G))},_80o:function(x){var o=this,G=o.s,N=o._78o,z=N.width,V=N.selectWidth,H=N.borderWidth,t=N.color,r=x.lineJoin,X=x.lineCap,l=N.pattern;x.lineJoin=N.join,x.lineCap=N.cap,o.drawPath(Jd(x,l),N);var b=G("edge.width.absolute");if(b&&(x.save(),x.setTransform(1,0,0,1,0,0)),V&&(x.strokeStyle=N._97o,x.lineWidth=z+2*(H+V),x.stroke()),H&&(x.strokeStyle=N.borderColor,x.lineWidth=z+2*H,x.stroke()),x.strokeStyle=t,x.lineWidth=z,x.stroke(),N.is3d&&zj(x,t,N._67o,z,o.gv._zoom,N._66o),b&&x.restore(),vb(x,l),G("edge.dash")){l=G("edge.dash.pattern");var T=Jd(x,l,o._2Q("edge.dash.offset"));T!==x&&o.drawPath(T,N),o._1Q(x,"edge",G("edge.dash.width")||z,l)}x.lineJoin=r,x.lineCap=X},_48O:function(){},_47O:function(){},_71o:function(m,h){var n=this,Z=n._data;if(n._19Q=!0,!Z.getEdgeGroup())return m?Z.s("edge.gap"):0;var A,x=0,u=0,z=0;if(Z.getEdgeGroup().getSiblings().each(function(s){s.each(function(e){if(n.gv.isVisible(e)&&e.s(Rj)==h){var N=e.s("edge.gap");A?(u+=z/2+N/2,z=N):(A=e,z=N),e===Z&&(x=u)}})}),m)return u-x+z;var j=x-u/2;return A&&Z._40I!==A._40I&&(n._19Q=!1),j}});var Gn=function(J,f){fm(Gn,this,[J,f])};xl(Gn,Yh,{_3O:function(){var o,z,q=this,K=q.s,A=q._data,d=q.gv;if(q._88I=s,A.isExpanded()&&A.eachChild(function(p){var y=d.getBoundsForGroup(p);y&&(z||(z=[]),z.push(y),o=hq(o,y))}),o){var r=d.getLabel(A),p=K("group.type");o=df(p,z,o),cj(o,A,"group.padding",1);var Z=q._88I={type:p,rect:o,_64o:o};if(!p&&r!=s){var E,_=q.labelInfo={label:r,color:K("group.title.color"),font:K("group.title.font"),align:K("group.title.align")},y=nq(_,r),R=y.width,L=y.height,G=K("group.title.align");R>o.width&&(o.width=R),_.rect={y:o.y-L,width:y.width,height:L},E=G===Zq?o.x:G===Oi?o.x+o.width-R:o.x+o.width/2-R/2,_.rect.x=E,Z.titleRect={x:o.x,y:o.y-L,width:o.width,height:L+1},Z.rect={x:o.x,y:o.y-L,width:o.width,height:o.height+L}}q._40O(Z,K("group.border.width")/2)}else Gn.superClass._3O.call(q)},getPosition:function(T,h,k,q){var F=this._88I;if(F){var $=ii(T,F.rect,q);return $.x+=h,$.y+=k,$}return Gn.superClass.getPosition.apply(this,arguments)},_24O:function(U,c){var O=this._88I;(!O||O.type||"label2"===U)&&Gn.superClass._24O.call(this,U,c)},_80o:function(R){var J=this,O=J._88I;if(O){var m=J._data,X=J.s,r=J.gv,q=O.type,t=O.rect,y=O._64o,s=O.titleRect,p=J.getBodyColor(),H=sr(X("group.image"),p),T=X("group.image.stretch"),M=J.getBodyColor("group.background"),v=sr(X("group.repeat.image"),p),E=X("group.gradient.pack"),u=X("group.gradient"),A=X("group.gradient.color"),h=X("group.depth");if(q){var V=X("group.border.pattern"),l=X("group.border.width"),w=R.lineJoin,f=R.lineCap;if(R.lineJoin=X("group.border.join"),R.lineCap=X("group.border.cap"),H){if(R.save(),om(R,q,t),R.clip(),pc(R,H,T,t.x,t.y,t.width,t.height,m,r,p),R.restore(),l>0){var L=Jd(R,V);om(L,q,t),R.lineWidth=l,R.strokeStyle=X("group.border.color"),R.stroke(),vb(R,V)}}else{var L=Jd(R,V);M||v||E?(om(R,q,t),E?lj(R,E):v?Sk(R,v,p,null,m,r):Sp(R,M,u,A,t),R.fill(),E&&R.restore(),R!==L&&om(L,q,t)):om(L,q,t),l>0&&(R.lineWidth=l,R.strokeStyle=X("group.border.color"),R.stroke()),vb(R,V),q===Sh&&Bk(R,M,h,t)}R.lineJoin=w,R.lineCap=f}else if(H?pc(R,H,T,y.x,y.y,y.width,y.height,m,r,J.getBodyColor()):(M||v)&&(v?Sk(R,v,p,null,m,r):Sp(R,M,u,A,y),om(R,Sh,y),R.fill(),Bk(R,M,h,y)),s){var i=X("group.title.background");Yg(R,s.x,s.y,s.width,s.height,i),Bk(R,i,h,s)}J._39O(R,O)}else Gn.superClass._80o.call(J,R)}});var Gr=function(M,m){fm(Gr,this,[M,m])};xl(Gr,Yh,{_80o:function(N){this._39O(N,this._83o)}});var yg=function(H,Z){fm(yg,this,[H,Z])};xl(yg,Yh,{_3O:function(){var c=this,y=c._data,x=c.s,D=c.gv,t=y.getPoints(),B=D.getBorderColor(y),P=B?x("border.width"):0,w=c.getSelectWidth(),S=x("shape.border.width"),r=y.getRect(),F=D.getBodyColor(y),Q=c._99o=t.isEmpty()?s:{rect:r,rotation:y.getRotation(),fillRule:x("shape.fill.rule"),scale:y.getScale(),position:y.p(),points:t,segments:y.getSegments(),bodyColor:F,borderColor:B,borderWidth:P,_94o:x("shape.border.3d"),_95o:x("shape.border.3d.color"),_96o:x("shape.border.3d.accuracy"),_97o:w?c.getSelectColor():s,selectWidth:w,_53o:x("shape.background"),_27Q:sr(x("shape.repeat.image"),F),shapeGradientPack:x("shape.gradient.pack"),_54o:S,_55o:x("shape.border.color"),shapeGradient:x("shape.gradient"),_59o:x("shape.gradient.color"),_60o:x("shape.border.pattern"),_61o:x("shape.border.cap"),_62o:x("shape.border.join")};if(Q){var H=y.getScale(),m=M(1,M(A(H.x),A(H.y)));x("shape.dash")&&x("shape.dash.width")>S&&(S=x("shape.dash.width"));var R=S*("square"===Q._61o?.71:.5)+P+w/c.gv._zoom/m;R&&(R*=m,r=cq(r),ig(r,R,Q._62o)),c._68o(r);var p=x("clip.percentage");1>p&&(0>p&&(p=0),Q.clipRect=gl(y.getAnchorRect(),x("clip.direction"),p));var U=x("shape.fill.clip.percentage");1>U&&(0>U&&(U=0),Q.shapeClipRect=gl(y.getAnchorRect(),x("shape.fill.clip.direction"),U))}},getPosition:function(G,f,i,S){var c=this._99o;if(c){var N=ii(G,c.rect,S);return N.x+=f,N.y+=i,N}return Kd},_42:function(Z){this._99o&&yg.superClass._42.call(this,Z)},_80o:function(q){var s,W=this,P=W.s,V=W._99o,L=V.position,J=V.scale,A=V.rotation,Q=V.bodyColor,w=V.borderWidth,r=V.selectWidth,N=V._53o,K=V._27Q,b=V.shapeGradientPack,$=V._54o,n=V.clipRect,Z=V.shapeClipRect,S=V.points,Y=V.segments,X=W._data.isClosePath(),a=V.fillRule,p=N||K||b;q.save(),Xr(q,L.x,L.y),Wf(q,A),Ak(q,J.x,J.y),P("shape.background2")&&(Xr(q,-L.x,-L.y),hr(q,S,Y,X),Sp(q,P("shape.background2"),P("shape.gradient2"),P("shape.gradient2.color"),V.rect),q.fill(),Xr(q,L.x,L.y)),n&&(q.beginPath(),q.rect(n.x,n.y,n.width,n.height),q.clip()),p&&Z&&(q.save(),q.beginPath(),q.rect(Z.x,Z.y,Z.width,Z.height),q.clip()),Xr(q,-L.x,-L.y);var O=V._60o,e=Jd(q,O),U=q.lineJoin,z=q.lineCap;q.lineJoin=V._62o,q.lineCap=V._61o,p?(hr(q,S,Y,X),b?lj(q,b):K?Sk(q,K,Q,null,W._data,W.gv):(s=Q?Q:N,Sp(q,s,V.shapeGradient,V._59o,V.rect)),q.fill(a),Z&&(q.restore(),Xr(q,-L.x,-L.y)),b&&q.restore(),e!==q&&hr(e,S,Y,X)):hr(e,S,Y,X);var E=P("shape.border.width.absolute");if(E&&(q.save(),q.setTransform(1,0,0,1,0,0)),r&&(q.strokeStyle=V._97o,q.lineWidth=$+2*(w+r),q.stroke()),w&&(q.strokeStyle=V.borderColor,q.lineWidth=$+2*w,q.stroke()),$&&(s=V._55o,!N&&Q&&(s=Q),q.strokeStyle=s,q.lineWidth=$,q.stroke(),V._94o&&zj(q,s,V._95o,$,W.gv._zoom,V._96o)),E&&q.restore(),vb(q,O),P("shape.dash")){var g=P("shape.dash.width")||$;if(g>0){O=P("shape.dash.pattern");var e=Jd(q,O,W._2Q("shape.dash.offset"));e!==q&&hr(e,S,Y,X),W._1Q(q,"shape",g,O)}}q.lineJoin=U,q.lineCap=z,q.restore()},_48O:function(){},_47O:function(){}});var ns=function(w,o){fm(ns,this,[w,o])};xl(ns,yg,{getRotation:function(J,O,w){J=J||0;var e=this._data.getPoints(),T=e.size();return T>1?Wd[w]?T&&0===T%2?uj(e.get(T/2-1),e.get(T/2),O,J):J:Rd[w]?uj(e.get(0),e.get(1),O,J):uj(e.get(T-2),e.get(T-1),O,J):J},getPosition:function(M,o,B,$,N){var A=this._data.getPoints(),z=A.size();if(z>1){if(Wd[M]){var u=z%2;if(0===u)return Qg(A.get(z/2-1),A.get(z/2),M,o,B,$,N);var C=A.get((z-u)/2),t={x:C.x,y:C.y,width:0,height:0};return C=ii(M,t,$),C.x+=o,C.y+=B,C}return Rd[M]?Qg(A.get(0),A.get(1),M,o,B,$,N):Qg(A.get(z-2),A.get(z-1),M,o,B,$,N)}return Kd}});var qc=function(N,i){fm(qc,this,[N,i])};xl(qc,Yh,{_3O:function(){var g=this;qc.superClass._3O.call(g);var o=g.s,v=g._83o;g._82o=v.img||v.shape?s:{background:g.getBodyColor("grid.background"),depth:o("grid.depth"),rect:v.rect,_88o:o("grid.cell.depth"),cellBorderColor:o("grid.cell.border.color"),_89o:o("grid.row.count"),_90o:o("grid.column.count"),block:o("grid.block"),_91o:o("grid.block.color"),_92o:o("grid.block.padding"),_93o:o("grid.block.width")}},_80o:function(G){var K=this,g=K._82o;if(!g)return qc.superClass._80o.call(K,G),void 0;var Z,q,Y=K._data,P=g.background,b=g.rect,f=g.block,v=g._91o,o=g._92o,Q=g._93o,A=g._88o,X=g.cellBorderColor,n=g._89o,R=g._90o;if(P)if(Yg(G,b.x,b.y,b.width,b.height,P),Bk(G,P,g.depth,b),A)for(Z=0;n>Z;Z++)for(q=0;R>q;q++)b=Y.getCellRect(Z,q),b&&Bk(G,P,A,b);else if(X){for(G.beginPath(),Z=0;n>Z;Z++)for(q=0;R>q;q++)b=Y.getCellRect(Z,q),b&&G.rect(b.x,b.y,b.width,b.height);G.strokeStyle=X,G.lineWidth=1,G.stroke()}if("h"===f)for(Z=0;n>Z;Z++)b=hq(Y.getCellRect(Z,0),Y.getCellRect(Z,R-1)),$o(b,o),Hb(G,v,b.x,b.y,b.width,b.height,Q);else if("v"===f)for(q=0;R>q;q++)b=hq(Y.getCellRect(0,q),Y.getCellRect(n-1,q)),$o(b,o),Hb(G,v,b.x,b.y,b.width,b.height,Q);K._39O(G,K._83o)}});var wi=function(R,Z){fm(wi,this,[R,Z])};xl(wi,Yh,{_checkEmptyRect:!1,_81o:function(){var I=this._data,c=wi.superClass._81o.call(this),w=I.s("text");if(w!=s){var N,n,t=I.s("text.font"),B=I.s("text.align"),L=I.s("text.vAlign"),R=Bm(t,w),P=R.width,Z=R.height,z=I.getAnchor(),T=I.getWidth(),C=I.getHeight();"left"===B?N=-T*z.x:"center"===B?N=-T*z.x+(T-P)/2:"right"===B&&(N=T*(1-z.x)-R.width),"top"===L?n=-C*z.y:"middle"===L?n=-C*z.y+(C-Z)/2:"bottom"===L&&(n=C*(1-z.y)-R.height);var p,Y=I.getMatrix();if(p=Ge([Y.tf(N,n),Y.tf(N+P,n),Y.tf(N+P,n+Z),Y.tf(N,n+Z)]),c=hq(c,p),c&&I.s("text.shadow")){var G=cq(c);G.x+=I.s("text.shadow.offset.x"),G.y+=I.s("text.shadow.offset.y"),$o(G,I.s("text.shadow.blur")),c=hq(c,G)}}return c}});var Dk=Fp.Interactor=function(l){this.gv=this._graphView=l};zh("Interactor",D,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(O){this.gv.fi(O)},setCursor:function(d){nb||this.gv.setCursor(d)},startDragging:function(l){var A=this;A._lastClientPoint=gh(l),A._lastLogicalPoint=A.gv.lp(l),ym(A,l)},clearDragging:function(){var G=this;G._lastClientPoint=G._lastLogicalPoint=G._logicalPoint=s},autoScroll:function(b){return this.gv.autoScroll(b,this._lastClientPoint)}});var ps=function(U){var Y=this;Y.gv=U,Y._is2d=U instanceof Fp.GraphView,Y._is2d&&(Y.filter=function(C){return U.isSelectable(C)&&U.isInteractive(C)}),U.getView(),["mousedown","mousemove","touchstart","touchmove"].forEach(function(i){Y.addListener(i)}),K.addEventListener(rb,function(I){db(I)&&Y.handleWindowMove(I)},!1),K.addEventListener(dh,function(_){db(_)&&Y.handleWindowUp(_)},!1),K.addEventListener(fr,function(q){db(q)&&Y.handleWindowMove(q)},!1),K.addEventListener(Yc,function(p){db(p)&&Y.handleWindowUp(p)},!1)};xl(ps,Dk,{addListener:function(z){var H=this;H.gv.getView().addEventListener(z,function(j){Z.preventDefault(j),db(j)&&!H.disabled&&H["handle_"+z](j)},!1)},handle_touchstart:function(w){this.handle_mousedown(w)},handle_touchmove:function(O){this.handle("onMove",O)},handleWindowMove:function(c){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",c):(this.handleDownInfo("onBeginDrag",c),this.isDragging=!0))},handleWindowUp:function(i){if(this.isDragging&&(this.handleDownInfo("onEndDrag",i),this.isDragging=!1),this.downInfo){var W=this.handle("onUp",i);W&&W.data===this.downInfo.data?this.handleMissingUp(i):this.handleDownInfo("onUp",i),this.downInfo=s}},handle_mousedown:function(I){this.isDragging&&(this.handleDownInfo("onEndDrag",I),this.isDragging=!1),this.downInfo=this.handle("onDown",I)},handle_mousemove:function(o){var D=this,d=D.gv;D._hoverTimer&&(W(D._hoverTimer),delete D._hoverTimer);var v,h,u,r=D.handle("onMove",o),j=this.currentInfo?this.currentInfo.data:s,B=this.currentInfo?this.currentInfo.hits:s;if(r&&(h=r.data,u=r.hits,D._hoverTimer=F(function(){W(D._hoverTimer),delete D._hoverTimer,D.handle("onHover",o,r)},d.getHoverDelay()||Z.hoverDelay)),h!==j){if(h&&h.s("onEnter")&&h.s("onEnter")(o,h,d),j&&j.s("onLeave")&&j.s("onLeave")(o,j,d),B)for(v in B)B[v].target.onLeave&&this.handleLeave(o,v);if(u)for(v in u)u[v].target.onEnter&&u[v].target.onEnter(o,h,d,u[v].point,u[v].width,u[v].height)}else{if(B)for(v in B)u&&u[v]||B[v].target.onLeave&&this.handleLeave(o,v);if(u)for(v in u)B&&B[v]||u[v].target.onEnter&&u[v].target.onEnter(o,h,d,u[v].point,u[v].width,u[v].height)}this.currentInfo=r},handle:function(i,X,p){var T,_=this,U=_.gv;if(_._is2d){if(p=p||U.getDataInfoAt(X,this.filter),!p)return;if(T=p.ui.interactiveInfo){var M,c=p.data;if(c.s(i)&&c.s(i)(X,c,U),"body"===p.part&&T.bodyInfo)M="body",p.hits=this.handleImage(M,U.getImage(c),i,X,c,p.point,T.bodyInfo);else if("icons"===p.part&&T._38o){var z=T._38o[p.name];z&&z[p.index]&&(M="icons|"+p.name+"|"+p.index,p.hits=this.handleImage(M,p.icon,i,X,c,p.point,z[p.index]))}}return p}if(!p){if(p=U.getDataInfoAt(X),!p)return;p&&(p={data:p.data,part:p.part})}var c=p.data,m=U.getData3dUI(c);if(p.ui=m,T=m.interactiveInfo,!T)return p;var r=U.intersectObject(X,c);if(r){c.s(i)&&c.s(i)(X,c,U);var $,b=r.part;if("body"!==b&&($=c.s(b+".image")||c.s("shape3d."+b+".image")),$||($=c.s("all.image")||c.s("shape3d.image")),T=T[$])return p.part="body",p.interactiveInfo=T,p.point=r.uv.multiply({x:T.bodyInfo.rect.width,y:T.bodyInfo.rect.height}),p.image=$,p.hits=this.handleImage("body",$,i,X,c,p.point,T.bodyInfo),p}},_handleLeaveOrMissing:function(H,I,i){var q="leave"===H?this.currentInfo:this.downInfo;if(q){var g=q.interactiveInfo||q.ui.interactiveInfo;if(g){var v,V,T=q.data;if(this._is2d){if(V=this.gv.lp(I),"body"===q.part&&g.bodyInfo)v="body","leave"===H?this.handleLeaveImage(i,v,this.gv.getImage(T),I,T,V,g.bodyInfo):this.handleMissingUpImage(v,this.gv.getImage(T),I,T,V,g.bodyInfo);else if("icons"===q.part&&g._38o){var Q=g._38o[q.name];Q&&Q[q.index]&&(v="icons|"+q.name+"|"+q.index,"leave"===H?this.handleLeaveImage(i,v,q.icon,I,T,V,Q[q.index]):this.handleMissingUpImage(v,q.icon,I,T,V,Q[q.index]))}}else{var o=this.gv.intersectObject(I,T);V=o?o.uv.multiply({x:g.bodyInfo.rect.width,y:g.bodyInfo.rect.height}):{x:1/0,y:1/0},"leave"===H?this.handleLeaveImage(i,"body",q.image,I,T,V,g.bodyInfo):this.handleMissingUpImage("body",q.image,I,T,V,g.bodyInfo)}}}},handleDownInfo:function(m,y){if(this.downInfo){var B=this.downInfo,s=B.interactiveInfo||B.ui.interactiveInfo;if(s){var _,T=B.data;if(T.s(m)&&T.s(m)(y,T,this.gv),this._is2d){var v=this.gv.lp(y);if("body"===B.part&&s.bodyInfo)_="body",this.handleDownInfoImage(_,this.gv.getImage(T),m,y,T,v,s.bodyInfo);else if("icons"===B.part&&s._38o){var k=s._38o[B.name];k&&k[B.index]&&(_="icons|"+B.name+"|"+B.index,this.handleDownInfoImage(_,B.icon,m,y,T,v,k[B.index]))}}else{var h=this.gv.intersectObject(y,T);if(!h)return;v=h.uv.multiply({x:s.bodyInfo.rect.width,y:s.bodyInfo.rect.height}),this.handleDownInfoImage("body",B.image,m,y,T,v,s.bodyInfo)
}}}},handleImage:function(g,$,i,l,H,o,W){var c={};if($&&($=sr($))){var e=this.gv,L=W.rect,Z=this.convertPoint(o,W);Z.inRect&&($[i]&&$[i](l,H,e,Z,L.width,L.height),c[g+"|image"]={target:$,point:Z,width:L.width,height:L.height});for(var s=W.compInfos,O=$,a=s.length-1;a>=0;a--){var z=s[a],F=z.comp;Z=this.convertPoint(o,z,O,F,e,H),Z.inRect&&(L=z.rect,F[i]&&F[i](l,H,e,Z,L.width,L.height),($=L.image)&&$[i]&&$[i](l,H,e,Z,L.width,L.height),c[g+"|"+a]={target:F,point:Z,width:L.width,height:L.height},$&&(c[g+"|"+a+"|image"]={target:$,point:Z,width:L.width,height:L.height}))}}return c},handleLeave:function(Q,H){return this._handleLeaveOrMissing("leave",Q,H)},handleMissingUp:function(I){return this._handleLeaveOrMissing("missing",I)},handleLeaveImage:function(n,L,b,q,R,p,B){if(b&&(b=sr(b))){var m=this.gv,X=B.rect,C=this.convertPoint(p,B);n===L+"|image"&&b.onLeave&&b.onLeave(q,R,m,C,X.width,X.height);for(var S=B.compInfos,i=b,J=S.length-1;J>=0;J--){var V=S[J],O=V.comp;C=this.convertPoint(p,V,i,O,m,R),X=V.rect,O.onLeave&&n===L+"|"+J&&O.onLeave(q,R,m,C,X.width,X.height),(b=X.image)&&b.onLeave&&n===L+"|"+J+"|image"&&b.onLeave(q,R,m,C,X.width,X.height)}}},handleMissingUpImage:function(b,G,f,o,i,E){var r="onUp",R=this.downInfo.hits;if(R&&G&&(G=sr(G))){var D=E.rect,c=this.convertPoint(i,E);!c.inRect&&R[b+"|image"]&&G[r]&&G[r](f,o,this.gv,c,D.width,D.height);for(var Z=E.compInfos,S=G,B=Z.length-1;B>=0;B--){var u=Z[B],X=u.comp;c=this.convertPoint(i,u,S,X,this.gv,o),c.inRect||(D=u.rect,X[r]&&R[b+"|"+B]&&X[r](f,o,this.gv,c,D.width,D.height),(G=D.image)&&G[r]&&R[b+"|"+B+"|image"]&&G[r](f,o,this.gv,c,D.width,D.height))}}},handleDownInfoImage:function(t,N,Y,P,z,k,$){var e=this.downInfo.hits;if(e&&N&&(N=sr(N))){var w=this.gv,n=$.rect,T=this.convertPoint(k,$);e[t+"|image"]&&N[Y]&&N[Y](P,z,w,T,n.width,n.height);for(var s=$.compInfos,K=N,p=s.length-1;p>=0;p--){var U=s[p],C=U.comp;T=this.convertPoint(k,U,K,C,w,z),n=U.rect,C[Y]&&e[t+"|"+p]&&C[Y](P,z,w,T,n.width,n.height),(N=n.image)&&N[Y]&&e[t+"|"+p+"|image"]&&N[Y](P,z,w,T,n.width,n.height)}}},convertPoint:function(h,J,Q,q,M,E){var i=J.rect,t=J.matrix.applyInverse(h).sub(i),_=t.x>=0&&t.y>=0&&t.x<=i.width&&t.y<=i.height;if(!_)return t;if(q&&q.pixelPerfect){var i,L=1;this._is2d?(L=M.getZoom(),i=dg(h.x,h.y,w,L)):i=dg(h.x,h.y);var P=!1,C=i.x,Y=i.y,I=i.width,g=i.height,D=Z.hitMaxArea,O=I*g*L*L;if(O>D){var K=Math.sqrt(D/O);L*=K}I*=L,g*=L,2>I&&(I=2),2>g&&(g=2),C*=L,Y*=L;var z=zm(I,g),A=new nk(0,-C,-Y,L,L);A.append(J.matrix),M._drawForChecking=!0,q.transform=A;var x=Q.comps;Q.comps=[q],ff(z,Q,0,0,I,g,E,self),Q.comps=x,delete q.transform,M._drawForChecking=!1;try{for(var N=0,c=z.getImageData(0,0,I,g).data;N<c.length;N+=4)if(0!==c[N+3]){P=!0;break}z.restore()}catch(b){Co=s,P=!1}t.inRect=P}else t.inRect=!0;return t}});var Qh=Fp.DefaultInteractor=function(a){fm(Qh,this,[a])};zh("DefaultInteractor",Dk,{handle_mousedown:function(e){Jr(e);var R=this,$=R.gv,r=$.getDataAt(e);!$.setFocus(e)||$._editing||$._scrolling||(yk(e)?$.handleDoubleClick(e,r):$.handleClick(e,r),!mm()&&r&&($.isMovable(r)||$.isInteractive(r))||!$.isPannable()||!db(e)||sf(e)||(R._tx=$.tx(),R._ty=$.ty(),R.startDragging(e)))},handleWindowMouseUp:function(U){var u=this,Q=u.gv;Q._panning&&(delete Q._panning,Q.onPanEnded(),u.fi({kind:"endPan",event:U})),delete u._tx,delete u._ty,u.clearDragging()},handle_mousemove:function(w){var V=this,X=V.gv;V._hoverTimer&&(W(V._hoverTimer),delete V._hoverTimer),V._hoverTimer=F(function(){V.fi({kind:"hover",event:w}),W(V._hoverTimer),delete V._hoverTimer},X.getHoverDelay()||Z.hoverDelay)},handle_touchmove:function(L){this.handle_mousemove(L)},handleWindowMouseMove:function(o){var H=this,y=H.gv,e=H._lastClientPoint;H.fi({kind:y._panning?"betweenPan":"beginPan",event:o}),y._panning=1,y.setTranslate(H._tx+o.clientX-e.x,H._ty+o.clientY-e.y)},handle_mousewheel:function(m){this.gv.handleScroll(m,m.wheelDelta)},handle_DOMMouseScroll:function(u){2===u.axis&&this.gv.handleScroll(u,-u.detail)},handle_keydown:function(m){this.gv.handleKeyDown(m)}});var Cg=Fp.SelectInteractor=function(E){fm(Cg,this,[E])};zh("SelectInteractor",Dk,{_42:function(){var q=this,U=q.gv,t=U.getZoom(),N=q.mark,g=q.div;g||(g=q.div=mc(),zd(q.getView(),g));var j={};j.x=N.x*t+U.tx(),j.y=N.y*t+U.ty(),j.width=N.width*t,j.height=N.height*t,_p(g,j),this.intersects()?(g.style.border="",g.style.background=U.getRectSelectBackground()):(g.style.background="",g.style.border="1px solid "+U.getRectSelectBorderColor())},handle_mousedown:function(S){var K=this,c=K.gv;if(K._57I=s,!(c._editing||c._scrolling||mm())){var n=c.getDataAt(S),w=c.sm();if(n)if(sf(S))w.co(n)?w.rs(n):w.as(n);else if(w.co(n)){if(yk(S)&&n instanceof xc&&n.isClickThroughEnabled()){var b=c.getDataAt(S,function(m){c._clickThroughChecking=!0;var _=m.getParent()===n&&c.isSelectable(m);return delete c._clickThroughChecking,_});b&&(S.clickThrough=!0,w.ss(b))}}else w.ss(n);else sf(S)||!c.isPannable()?db(S)&&(sf(S)||w.cs(),c.isRectSelectable()&&(K.startDragging(S),c._77O=1)):db(S)&&(K._57I=gh(S))}},handle_mouseup:function(I){var m=this,u=m._57I;u&&(dq(u,gh(I))<=1&&m.gv.sm().cs(),m._57I=s)},handleWindowMouseUp:function($){this.clear($)},handleWindowMouseMove:function(P){var M=this,L=M.gv;M._logicalPoint=L.lp(P),M.mark?(M.fi({kind:"betweenRectSelect",event:P}),L.isPannable()&&M.autoScroll(P),M.redraw()):M.fi({kind:"beginRectSelect",event:P}),M.mark=Ge(M._lastLogicalPoint,M._logicalPoint),M.redraw()},intersects:function(){var H=this,L=H._lastLogicalPoint,n=H._logicalPoint;return L.x>n.x||L.y>n.y},clear:function(F){var o=this,H=o.gv,c=o.mark;if(o._57I=s,o._lastLogicalPoint){if(c){if(0!==c.width&&0!==c.height){var M=H.getDatasInRect(c,o.intersects());if(!M.isEmpty()){var U=H.sm(),Q=U.toSelection();M.each(function(i){U.co(i)?Q.remove(i):Q.add(i)}),U.ss(Q)}}bj(o.div),delete o.div,delete o.mark,o.redraw(),o.fi({kind:"endRectSelect",event:F}),H.onRectSelectEnded()}o.clearDragging(),delete H._77O}},redraw:function(){var f=this;f._draw||(f._draw=1,F(function(){f.mark&&f._42(),delete f._draw},16))}});var id=Fp.MoveInteractor=function(h){fm(id,this,[h])};zh("MoveInteractor",Dk,{handle_mousedown:function(B){var C=this,A=C.gv;if(db(B)&&!A._editing&&!A._scrolling&&!mm()){var x=A.getSelectedDataAt(B);x?(C._data=x,A.handleMouseDown&&A.handleMouseDown(B,x),C.startDragging(B),A.isMovable(x)&&(A._moving=1)):A._focusData=s}},handleWindowMouseUp:function(z){var O=this,s=O.gv;s.handleMouseUp&&s.handleMouseUp(z,O._data),O.clear(z)},handleWindowMouseMove:function(M){var E=this,q=E._data,L=E.gv;if((!L._93O||!L._93O(M,q))&&L._moving){E._logicalPoint||E.fi({kind:"prepareMove",event:M});var r=E._logicalPoint?"betweenMove":"beginMove",B={kind:r,event:M},Z=E._logicalPoint=L.lp(M);"beginMove"!==r||E._alreadyBeginTransaction||(E._alreadyBeginTransaction=!0,L.getDataModel().beginTransaction());var A=E._calcShift(r,M),f=A.x,G=A.y,o=E.gv.getMoveMode(M,q);o&&("x"===o?G=0:"y"===o?f=0:"xy"!==o&&(f=G=0)),L.moveSelection(f,G),E._lastLogicalPoint=Z,E.autoScroll(M),E.fi(B)}},_calcShift:function(){var $=this,m=$._logicalPoint,H=$._lastLogicalPoint,x=m.x-H.x,h=m.y-H.y;return{x:x,y:h}},clear:function(w){var e=this,O=e.gv;e._lastLogicalPoint&&(e._lastLogicalPoint=e._data=O._moving=s,e._logicalPoint&&(e.fi({kind:"endMove",event:w}),O.onMoveEnded()),e.clearDragging()),e._alreadyBeginTransaction&&(e._alreadyBeginTransaction=!1,O.getDataModel().endTransaction())}});var Zh=Fp.ScrollBarInteractor=function(R){fm(Zh,this,[R])};zh("ScrollBarInteractor",Dk,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(Y){var c=this.gv.getViewRect();return this._41o()&&(c.x+c.width-this.gv.lp(Y).x)*this.gv.getZoom()<pi},isH:function(A){var f=this.gv.getViewRect();return this._40o()&&(f.y+f.height-this.gv.lp(A).y)*this.gv.getZoom()<pi},handle_mousemove:function(I){this.handle_touchmove(I)},handle_touchmove:function(N){if(!wk&&db(N)&&this.gv.isScrollBarVisible()){var S=this,e=S.isV(N),X=S.isH(N);(e||X)&&S.gv.showScrollBar(),S.gv._scrolling=e||X}},handleWindowMouseUp:function(u){this.handleWindowTouchEnd(u)},handleWindowTouchEnd:function(X){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=s,this.fi({kind:"endScroll",event:X})},handle_mousedown:function(F){this.handle_touchstart(F)},handle_touchstart:function(k){var N=this;if(N.gv.setFocus(k),Jr(k),N.handle_touchmove(k),!(qe(k)>1)&&N.gv._scrolling&&N.gv.isScrollBarVisible()){N._cp=gh(k),N._tx=N.gv.tx(),N._ty=N.gv.ty();var G=N.isV(k);N._state=G?"vScroll":"hScroll",ym(N,k),N.fi({kind:"beginScroll",event:k})}},handleWindowMouseMove:function(r){this.handleWindowTouchMove(r)},handleWindowTouchMove:function(U){var W=gh(U),u=this.gv.getViewRect(),f=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-W.y)*f.height/u.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-W.x)*f.width/u.width),this.fi({kind:"betweenScroll",event:U})}});var eh=Fp.TouchInteractor=function(H,d){d=d||{},d.selectable===w&&(d.selectable=!0),d.movable===w&&(d.movable=!0),d.pannable===w&&(d.pannable=!0),d.pinchable===w&&(d.pinchable=!0),d.editable===w&&(d.editable=!0),this.params=d,fm(eh,this,[H])};zh("TouchInteractor",Dk,{ms_edit:1,setUp:function(){var Y=this;eh.superClass.setUp.call(Y),nb&&Y.params.editable&&Y.gv.setEditInteractor(Y)},tearDown:function(){var l=this;eh.superClass.tearDown.call(l),nb&&l.params.editable&&l.gv.setEditInteractor(s)},clear:function(Q){var N=this,V=N.gv;V._moving&&(N.fi({kind:"endMove",event:Q}),delete V._moving,V.onMoveEnded(),V.dm().endTransaction()),V._panning&&(N.fi({kind:"endPan",event:Q}),delete V._panning,V.onPanEnded()),V._pinching&&(N.fi({kind:"endPinch",event:Q}),delete V._pinching,V.onPinchEnded()),V._editing&&(N._46O(Q),N._77I=N._node=N._edge=N._shape=N._rect=N._89I=N._index=V._editing=s),N._moving=N._panning=N._pinching=N._editing=N._57I=N._data=N._beginHistory=s,N.clearDragging()},handle_touchstart:function(p){var C=this;if(!C.gv._editing){Jr(p),C._57I=s;var n=C.params,F=C.gv,f=F.sm(),J=F.getDataAt(p),P=qe(p);if(1===P){if(yk(p))return F.handleDoubleClick(p,J),void 0;F.handleClick(p,J),J&&(F.handleMouseDown&&F.handleMouseDown(p,J),C._data=J),n.selectable||(J=s),J?(f.co(J)||f.ss(J),n.editable&&F.isEditable(J)&&C._79I(p,J,!0)?(C._editing=1,C.startDragging(p)):n.movable&&F.isMovable(J)&&(C._moving=1,C.startDragging(p))):(C._57I=gh(p),n.pannable&&F.isPannable()&&(C._panning=1,C.startDragging(p),C._translate={x:F.tx(),y:F.ty()}))}else if(n.pinchable&&2===P){C._pinching=1,C.startDragging(p);var $=F.getView(),H=F.getZoom(),T=$.getBoundingClientRect(),t=p.touches[0],b=p.touches[1],w={x:(t.clientX+b.clientX)/2-T.left,y:(t.clientY+b.clientY)/2-T.top};w.x-=F.tx(),w.y-=F.ty(),w.x/=H,w.y/=H,C._p=w,C._d=Kf(p)}}},handle_touchend:function(J){var n=this,Q=n.gv,b=n._57I,O=n._data;b&&(dq(b,gh(J))<=1&&Q.sm().cs(),n._57I=s),O&&Q.handleMouseUp&&Q.handleMouseUp(J,O)},handleWindowTouchEnd:function(n){this.clear(n)},handleWindowTouchMove:function(b){var r=this,S=r.gv,P=qe(b);if(1===P){if(r._editing&&(r._beginHistory||(r._beginHistory=1,S.dm().beginTransaction()),S._editing=1,r._78I(b)),r._moving)r._beginHistory||(r._beginHistory=1,S.dm().beginTransaction()),r.handleMove(b);else if(r._panning){var O=gh(b);S.setTranslate(r._translate.x+O.x-r._lastClientPoint.x,r._translate.y+O.y-r._lastClientPoint.y),r.fi({kind:S._panning?"betweenPan":"beginPan",event:b}),S._panning=1}}else if(2===P&&r._pinching){var h=Kf(b);S.handlePinch(r._p,h,r._d),r._d=h,r.fi({kind:S._pinching?"betweenPinch":"beginPinch",event:b}),S._pinching=1}},handleMove:function(G){var c=this,r=c.gv,b=r.lp(G);r._93O&&r._93O(G,c._data)||(r.moveSelection(b.x-c._lastLogicalPoint.x,b.y-c._lastLogicalPoint.y),c._lastLogicalPoint=b,c.autoScroll(G),c.fi({kind:r._moving?"betweenMove":"beginMove",event:G}),r._moving=1)}});var c=K.ht,mq=c.graph._editor={Math:c.Math,Guide:{}};mq.getStyle=function(K){var $,E=mq.StyleMap;return E&&($=E[K],$!==w)?$:mq.DefaultStyleMap[K]},mq.setStyle=function(E,u){var L=mq.StyleMap;L||(L=mq.StyleMap={}),L[E]=u},mq.inEdit=function(b){return b._inXEdit===!0},mq.startEdit=function(D){D._inXEdit=!0,mq.Inject.doInject(D)},mq._46O=function(k){k._inXEdit=!1,mq.Inject.undoInject(k)},mq.toScreenPosition=function(E,T){var I=E.tx(),J=E.ty(),O=E._zoom;return new mq.Math.Vector2(T.x*O+I,T.y*O+J)},mq.checkHit=function(p,L,x){return p.distanceTo(L)<x?!0:!1},mq.toWorldPosition=function(h,c){var A=h.tx(),F=h.ty(),r=h._zoom;return{x:(c.x-A)/r,y:(c.y-F)/r}},mq.setAntialias=function(e,K){for(var v,H=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],b=0,y=H.length;y>b&&(v=H[b],!(v in e));b++);e[v],e[v]=K},mq.getTargetCornersOnScreen=function(v,B){if(!B)return null;var e,A=[];if(Yj(B,v)){var P=mi(v,B);e=[{x:P.x,y:P.y},{x:P.x+P.width,y:P.y},{x:P.x+P.width,y:P.y+P.height},{x:P.x,y:P.y+P.height}]}else{if(!B.getCorners)return null;e=B.getCorners()}return e.forEach(function(a){var H=mq.toScreenPosition(v,a);A.push(H.x,H.y)}),A},mq.log=function(){};var oi=mq.Inject={_modules:[]};oi.registAsModule=function(o,F){var W={},x={};for(var c in o){var t=F.prototype[c];W[c]=t}o.getBackup=function(_){return W[_]},o.getBackups=function(){return W},x.doInject=function(){for(var M in o)"getBackup"!==M&&(F.prototype[M]=o[M])},x.undoInject=function(){for(var K in o)"getBackup"!==K&&(F.prototype[K]=W[K])},oi._modules.push(x)},oi.doInject=function(K){for(var h,l=oi._modules,D=0,n=l.length;n>D;D++)h=l[D],h.doInject(K)},oi.undoInject=function(w){for(var V,Q=oi._modules,_=0,l=Q.length;l>_;_++)V=Q[_],V.undoInject(w)};var Dk=c.graph.EditInteractor=function(e){var K=this,_=G.createElement("canvas");_.className="editCanvas",_.style.position="absolute",K._styleMap={},K._canvas=_,K._context=_.getContext("2d"),Dk.superClass.constructor.call(K,e),mq.setAntialias(K._context,!1),K._subModules=[new mq.Anchor(K),new mq.Rect(K),new mq.Curve(K),new mq.MoveHelper(K)],K._gridGuide=new mq.Guide.Grid(K),K._rectGuide=new mq.Guide.Rect(K)},Gm=Dk;c.Default.def(Dk,c.graph.Interactor,{ms_edit:1,ms_fire:1}),D.defineProperties(Dk.prototype,{editDetail:{get:function(){var Z=!!this._editDetail;return Z},set:function(r){var P=this,g=P._editDetail;g!==r&&(P._editDetail=r,P.gv._editing=r,P.fp("editDetail",g,r),P.fp("pointsEditingMode",g,r),P.fi({kind:r?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(h){(!this._editDetail||h)&&(this.gv._editing=h,h||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(g){this._editing=g,this.gvEditing=g}},pointsEditingMode:{get:function(){return this.editDetail},set:function(z){var Q=this;Q.editDetail!==z&&(z?Q._tryEnterEditDetailMode():Q._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var $=this._gridEnabled;if(!$)return!1;var g=this.gv;return g?!0:!0},set:function(R){R!==this._gridEnabled&&(this._gridEnabled=R,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(d){d!==this._agEnabled&&(this._agEnabled=d,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}}}),Dk.prototype.getSubModule=function(l){var B,d,Z,H=this._subModules;for(d=0,Z=H.length;Z>d;d++)if(B=H[d],B.catalog===l)return B},Dk.prototype.invokeSubModule=function(M,S){var Q=this,C=Q._subModules;if(C)for(var x,d,h,c=Array.prototype.slice.call(arguments,2),u=0,O=C.length;O>u;u++)if(x=C[u],d=x[M],d&&(h=d.apply(x,c),h!=w&&S))return x},Dk.prototype.invokeSubModuleInverse=function(s,c){var v=this,C=v._subModules;if(C)for(var k,u,I,t=Array.prototype.slice.call(arguments,2),y=C.length-1;y>=0;y--)if(k=C[y],u=k[s],u&&(I=u.apply(k,t),I!=w&&c))return k},Dk.prototype.setUp=function(){mq.log("setUp");var M=this,c=M.gv,x=c.getView(),S=M._canvas;Dk.superClass.setUp.call(M),c.setEditInteractor(M),c._79O?x.insertBefore(S,c._79O):x.appendChild(S),mq.startEdit(c),M.invokeSubModule("setUp"),c.dm().mm(M._onDataModelChanged,M),c.dm().md(M._onDataPropertyChanged,M)},Dk.prototype.tearDown=function(){mq.log("tearDown");var y=this,r=y.gv,C=r.getView();y._resetCustomCursorStyle(),Dk.superClass.tearDown.call(y),r.dm().umm(y._onDataModelChanged,y),r.dm().umd(y._onDataPropertyChanged,y),r.setEditInteractor(null),C.removeChild(y._canvas),y._drawTimer&&(W(y._drawTimer),y._drawTimer=null),mq._46O(r),y.invokeSubModule("tearDown")},Dk.prototype._onDataModelChanged=function(l){var i=this;("clear"===l.kind||"remove"===l.kind&&i.editDetail&&l.data===i.getSubModule("Curve").target)&&(i.editDetail=!1,i._42())},Dk.prototype._onDataPropertyChanged=function(g){var W=this;if(W.editDetail){var X=W.getSubModule("Curve"),y=g.data;y===X.target&&(y._writing||X._handleDataChanged())}},Dk.prototype.clear=function(){mq.log("clear")},Dk.prototype.redraw=function(){this._42()},Dk.prototype._42=function(){var Y=this;Y._drawTimer||(Y._drawTimer=F(function(){Y._drawTimer=null,Y.drawImpl()},0))},Dk.prototype.drawImpl=function(){var w;for(w in{_42:!0})break;return function(){var o=this,V=o._canvas,g=o.gv,e=g.getWidth(),u=g.getHeight(),v=o._context,E=c.Default.getInternal();(V.width!==e||V.height!==u)&&E.setCanvas(V,e,u),v.clearRect(0,0,V.width,V.height);var U=o._getValidSelection();v.save();var X=c.Default.devicePixelRatio;v.scale(X,X),o._gridGuide._42(),o.invokeSubModuleInverse(w,!1,v,g,U),o._rectGuide._42(),v.restore()}}(),Dk.prototype._getValidSelection=function(){var R=this,J=R.gv,I=J.sm().getSelection(),d=[];return I.each(function(p){J.isVisible(p)&&J.isEditable(p)&&d.push(p)}),d},Dk.prototype.handle_touchmove=function(r){return this.handle_mousemove(r)},Dk.prototype.handle_mousemove=function(d){if(!c.Default.isDragging()){var G=this;(G.editDetail||!mm())&&(G.gvEditing=!1,G._checkEdit(d)&&(G.gvEditing=!0))}},Dk.prototype.handle_touchstart=function(r){return this.handle_mousedown(r)},Dk.prototype.handle_mousedown=function(E){Jr(E);var h=this;if(h.editDetail||!mm()){if(yk(E)&&!E.clickThrough){if(h.editDetail){if(h._tryQuitEditDetailMode(E))return}else if(h._tryEnterEditDetailMode())return;h.gv.dm().beginTransaction();var U=h.invokeSubModule("handleDoubleClick",!0,E);if(h.gv.dm().endTransaction(),U)return}var c=h._checkEdit(E);c&&(h._downPosition=h._getLogicalPoint(E),h.gv.dm().beginTransaction(),c.startEdit(h,E),h.editing=!0)}},Dk.prototype._checkEdit=function(T){var H=this,u=H.gv,E=H._getLogicalPoint(T),B=H.invokeSubModule("check",!0,u,T,E)||null;return H._editMod=B,B},Dk.prototype.handleWindowTouchMove=function(x){return this.handleWindowMouseMove(x)},Dk.prototype.handleWindowMouseMove=function(T){var x=this,r=x._downPosition;if(r){var v=x._getLogicalPoint(T);if(v.distanceTo(r)<x.getStyle("moveSensitivity"))return;delete x._downPosition}var B=x._editMod;B&&B.handleEdit(x.gv,T)},Dk.prototype._getLogicalPoint=function(v){var h=this,Z=c.Default.getLogicalPoint(v,h._canvas);return new mq.Math.Vector2(Z)},Dk.prototype.handleWindowTouchEnd=function(M){return this.handleWindowMouseUp(M)},Dk.prototype.handleWindowMouseUp=function(){var e;for(e in{_46O:!0})break;return function(r){var x=this;x.editing=!1,x.setCursor("default"),x.invokeSubModule(e,!1,r),x._42(),x.gv.dm().endTransaction()}}(),Dk.prototype.handle_mousewheel=function(o){var P=this;Jr(o),P.invokeSubModule("preHandleScroll",!0)||P.gv.handleScroll(o,o.wheelDelta)},Dk.prototype.handleDelete=function(){var T=this;if(!T.editDetail){T.gv.dm().beginTransaction();var r=T.invokeSubModule("handleNormalStateDelete",!0);return T.gv.dm().endTransaction(),r||T.gv.removeSelection(),void 0}T.gv.dm().beginTransaction(),T.invokeSubModule("handleDelete",!0),T.gv.dm().endTransaction(),T._42()},Dk.prototype.handle_keydown=function(o){var P=this;if((o.metaKey||o.ctrlKey)&&P._42(),mm(o)&&!P.editing)return P.gvEditing=!1,P.setCursor("default"),P._42(),void 0;var l=Rg(o);return P.editDetail?((l||af(o))&&(P.editDetail=!1,P._42()),P.gv.dm().beginTransaction(),P.invokeSubModule("handle_keydown",!0,o),P.gv.dm().endTransaction(),void 0):(P.gv.dm().beginTransaction(),P.invokeSubModule("handleNormalStateKeyDown",!0,o),P.gv.dm().endTransaction(),l&&P._tryEnterEditDetailMode(),void 0)},Dk.prototype.handle_keyup=function(b){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,b),this.gv.dm().endTransaction()},Dk.prototype._tryEnterEditDetailMode=function(){var s=this;return!s.editDetail&&s.invokeSubModule("canEnterEditDetailMode",!0)&&1===s._getValidSelection().length?(s.editDetail=!0,s._42(),!0):void 0},Dk.prototype._tryQuitEditDetailMode=function(N){var q=this;if(q.editDetail){var d=q.gv,w=q.getSubModule("Curve").target;return N&&d.getDataAt(N)===w?void 0:(q.editDetail=!1,q._42(),!0)}},Dk.prototype.setStyle=function(B,U,P){var i=this;P?mq.setStyle(B,U):i._styleMap[B]=U,i.fp("styleChanged",null,{key:B,value:U,base:P}),i._42()},Dk.prototype.getStyle=function(y){var J=this,U=J._styleMap[y];return U!==w?U:mq.getStyle(y)},Dk.prototype.setCursor=function(Q){this._resetCustomCursorStyle(),c.graph.EditInteractor.superClass.setCursor.call(this,Q)},Dk.prototype._resetCustomCursorStyle=function(){var E=this;if(E._customStyle){var z=this.gv.getView();z.classList&&z.classList.remove&&z.classList.remove(E._customStyle),E._customStyle=null}},Dk.prototype._setRotateCursor=function(M){var R=this,u=R._cursorFactory;u||(u=R._cursorFactory=new mq.CursorFactory(R));var c=u.getRotateCursor(M),A=R.gv.getView();R._resetCustomCursorStyle(),R._customStyle=c,A.classList&&A.classList.add&&A.classList.add(c)};var Qk=mq.Group=function(Z){var q=this;q._entities=Z,q._64O=0,q._position={x:0,y:0},q._scale={x:1,y:1},q._anchor={x:.5,y:.5},q._anchor2={x:.5,y:.5}};Qk.prototype={},Qk.prototype.constructor=Qk;var mb=null;Qk.findOrCreateGroup=function(g){if(mb&&mb.checkIsMe(g))return mb;var X=new mq.Group(g);return X.getKeyOb()?(mb=X,X):void 0},Qk.prototype.checkIsMe=function(E){var r=this._entities;if(r.length!==E.length)return!1;var x,N={},D=E.length;for(x=0;D>x;x++)N[E[x]._id]=!0;for(x=0;D>x;x++)if(!N[r[x]._id])return!1;return!0},Qk.prototype.getRotation=function(){return this._64O},Qk.prototype.getPosition=function(){return this._position},Qk.prototype.getAnchor=function(){return this._anchor},Qk.prototype.getWidth=function(){return this._width},Qk.prototype.getScale=function(){return this._scale},Qk.prototype.getSize=function(){return{width:this._width,height:this._height}},Qk.prototype.getHeight=function(){return this._height},Qk.prototype.getKeyOb=function(){for(var W=this._entities,O=W.length-1;O>=0;O--){var b=W[O];if(this.isNode(b))return b}},Qk.prototype.getAnchor2=function(){var z=this,e=z.rotateCenter;if(e)return e;var c=z.getKeyOb();if(!c)return z._anchor;var D=z._anchor2,p=c.getMatrix();return p.tf({x:c.getWidth()*(D.x-c.getAnchor().x),y:c.getHeight()*(D.y-c.getAnchor().y)})},Qk.prototype.setAnchor2=function(f,e){var C=this,l=C.getKeyOb();if(l){var E,W=l.getMatrix();E="number"==typeof f?{x:f,y:e}:f;var J=W.tfi(E);C._anchor2={x:l.getAnchor().x+J.x/l.getWidth(),y:l.getAnchor().y+J.y/l.getHeight()}}},Qk.prototype.setRotation=function(){},Qk.prototype.beginRotate=function(X){this.rotateCenter=X.pos,this.rotateMode=X.groupRotateMode},Qk.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},Qk.prototype.addRotation=function(Y,t){return"batch"===t?this._addRotationInBatchMode(Y):"block"===t?this._addRotationInBlockMode(Y):void 0},Qk.prototype._addRotationInBlockMode=function(N){var D=this,c=D.rotateCenter||D.getPosition();D._entities.forEach(function(J){if(D.isNode(J)){var U=J.getMatrix();U.translate(-c.x,-c.y),U.rotate(N),U.translate(c.x,c.y);var u=Math.sign(J.getScale().x);J.setRotation(o(U.b*u,U.a*u)),J.setPosition(U.tx,U.ty)}})},Qk.prototype._addRotationInBatchMode=function(f){var S=this,x=S._anchor2;S._entities.forEach(function(i){if(S.isNode(i)){var E=i.getAnchor(),A=i.getMatrix(),c=A.tf({x:i.getWidth()*(x.x-E.x),y:i.getHeight()*(x.y-E.y)}),Y=new mq.Math.Matrix2d;Y.set(A.a,A.b,A.c,A.d,A.tx,A.ty),Y.translate(-c.x,-c.y),Y.rotate(f),Y.translate(c.x,c.y);var t=Math.sign(i.getScale().x);i.setRotation(o(Y.b*t,Y.a*t)),i.setPosition(Y.tx,Y.ty)}})},Qk.prototype.setPosition=function(Y){var c,P,T,v,S=this,j=S._position,H=Y.x-j.x,q=Y.y-j.y,G=S._entities;for(P=0,T=G.length;T>P;P++)c=G[P],Cl(c)&&(v=c.getPosition(),c.setPosition(v.x+H,v.y+q));S._position=Y},Qk.prototype.setScale=function(q,J){var j=this,L=q/j._scale.x,x=J/j._scale.y;j._adjustChildScaleOrSize(L,x,"size"),j._scale={x:q,y:J}},Qk.prototype.getRect=function(){var O=this,_=O._position,z=O._width,G=O._height;return{x:_.x-z/2,y:_.y-G/2,width:z,height:G}},Qk.prototype.setSize=function(Y,T){var K=this,Y=Math.max(1,Y),T=Math.max(1,T),C=Y/K._width,V=T/K._height;K._adjustChildScaleOrSize(C,V,"size"),K._width=Y,K._height=T},Qk.prototype._adjustChildScaleOrSize=function(C,i,a){var t,l,S,x,c,X,v,r,R,H,k,B,I,V,A=this,E=A._position,n=A._entities,P=new mq.Math.Matrix2d;for(l=0,S=n.length;S>l;l++)if(t=n[l],A.isNode(t)){if(x=t.getPosition(),c=t.getRotation(),X=t.getWidth(),v=t.getHeight(),r=t.getScale(),k=r.x*X,B=r.y*v,P.identity().scale(k,B).rotate(c).translate(x.x,x.y).translate(-E.x,-E.y).rotate(-A._64O),c=o(P.b*Math.sign(k),P.a*Math.sign(k)),P.scale(C,i),R=Math.cos(c),H=Math.sin(c),Math.abs(R)<.001?(I=P.b/H,V=-P.c/H):(I=P.a/R,V=P.d/R),"scale"===a)t.setScale(I/X,V/v);else if("size"===a){var g=I/r.x,K=V/r.y;t.setScale(Fr(I)*Math.abs(r.x),Fr(V)*Math.abs(r.y)),t.setSize(Math.max(.1,Math.abs(g)),Math.max(.1,Math.abs(K)))}P.rotate(A._64O).translate(E.x,E.y),t.setPosition(P.tx,P.ty)}},Qk.prototype.getMatrix=function(){var O=this,o=O._position,L=c.Default.getInternal(),J=O._scale;return new L.Mat(O._64O,o.x,o.y,J.x,J.y)},Qk.prototype.getCorners=function(){var m=this,J=m._width,e=m._height,i=m._anchor,X=-J*i.x,k=-e*i.y,G=m.getMatrix();return[G.tf(X,k),G.tf(X,k+e),G.tf(X+J,k+e),G.tf(X+J,k)]},Qk.prototype.calcInfo=function(){var X,V,F,j,E,U,T=this,L=[],t=T._entities,R=T._64O;for(j=0,E=t.length;E>j;j++)U=t[j],T.isNode(U)&&U.getCorners&&L.push.apply(L,U.getCorners());if(L.length){var i=Math.cos(-R),u=Math.sin(-R),x=1/0,q=-1/0,r=1/0,Y=-1/0;for(j=0,E=L.length;E>j;j++)F=L[j],X=F.x,V=F.y,F.x=i*X-u*V,F.y=u*X+i*V,x=Math.min(x,F.x),q=Math.max(q,F.x),r=Math.min(r,F.y),Y=Math.max(Y,F.y);T._width=(q-x)/T._scale.x,T._height=(Y-r)/T._scale.y,i=Math.cos(R),u=Math.sin(R);var y=T._anchor;X=x+(q-x)*y.x,V=r+(Y-r)*y.y,T._position={x:i*X-u*V,y:u*X+i*V}}},Qk.prototype.isNode=function(K){return Cl(K)?Yj(K)?!1:!0:!1},Qk.prototype._42=function(_,w,b){var o,N,G,v,C,m,I,h,Y=this,z=Y._entities,R=Y.rotateMode;for("batch"===R&&(h=Y.getKeyOb()),o=0,N=z.length;N>o;o++)G=z[o],Y.isNode(G)&&(m=G.getRect(),v=mq.toScreenPosition(b,{x:m.x,y:m.y}),C=mq.toScreenPosition(b,{x:m.x+m.width,y:m.y+m.height}),I={min:v,max:C},G===h&&(I.isKeyOb=!0),mq.Icons.DrawIcon(_,w,mq.Icons.GroupSubEntityRect,I))};var ld=mq.CurveActiving=function(M,Y){this._curve=M,this._interactor=M._interactor;for(var O in Y)this[O]=Y[O]};ld.prototype={},ld.prototype.constructor=ld,D.defineProperties(ld.prototype,{point:{get:function(){return this._point},set:function(i){var T=this;T._point=i,T.editingCtrl||T._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(I){var m=this;m._pairs=I,m.editingCtrl&&m._firePointChange()}}}),ld.prototype._firePointChange=function(){var N=this,i=N.getCurrentEditingPoint();if(!i)return V.fi({kind:"selectPoint"}),void 0;var V=N._interactor,p=this._curve.target;if(p){var e=mq.getDataMatrix(p).invert(),J=i.e;i=e.apply(mq.toWorldPosition(V.gv,i)),i.e=J;var F=N._lastFirePoint;F&&Math.abs(i.x-F.x)<1e-5&&Math.abs(i.y-F.y)<1e-5&&(i.e==w&&F.e==w||Math.abs(i.e-F.e)<1e-5)||(N._lastFirePoint=i,V.fi({kind:"selectPoint",x:i.x,y:i.y,e:i.e}))}},ld.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},ld.prototype.getCurrentEditingPoint=function(){var m=this,C=m.editingCtrl;if(C){var u=m.pairs;if(u){var q=u[C.pairId],R=q[C.type];if(R)return R}}return m._point};var pg=mq.CursorFactory=function(K){var h=this;h._interactor=K,h._rotateCursorStyles={}};pg.prototype={},pg.prototype.constructor=pg,pg.prototype.getRotateCursor=function(h){var r=this;0>h&&(h+=2*Math.PI);var A=r._interactor,l=A.getStyle("rotateCursorSize"),n=A.getStyle("rotateCursorRound"),R=Math.round(180*(h/Math.PI)/n);R*n>=360&&(R=0);var X=r._rotateCursorStyles,w="htCustomRotateStyle_"+l+"_"+n+"_"+R;return X[w]||(r._produceRotateCursor(w,l,n,R),X[w]=!0),w},pg.prototype._produceRotateCursor=function(W,l,U,s){var F=this;F._interactor;var B=F._canvas;B||(B=F._canvas=G.createElement("canvas")),B.width=B.height=l*devicePixelRatio,B.style.width=B.style.height=l+" px";var Q=B.getContext("2d");mq.setAntialias(Q,!1),Q.scale(devicePixelRatio,devicePixelRatio);var $,j,x,t,p,w=Math.round(l/2),b=""+w+" "+w+",auto !important;";$=Math.PI/180*s*U,Q.clearRect(0,0,l,l),Q.save(),Q.scale(l/32,l/32),Q.translate(16,16),Q.rotate($+Math.PI/2),Q.beginPath(),Q.moveTo(-8,0),Q.lineTo(-8,3),Q.lineTo(-5,3),Q.moveTo(8,0),Q.lineTo(8,3),Q.lineTo(5,3),Q.moveTo(-8,3),Q.quadraticCurveTo(0,-6,8,3),Q.restore(),Q.strokeStyle="white",Q.lineWidth=4,Q.stroke(),Q.strokeStyle="black",Q.lineWidth=2,Q.stroke(),j=JSON.stringify(B.toDataURL()),t="cursor:url("+j+")"+b,1!==devicePixelRatio&&(x='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+l+'px" height="'+l+'px"><image xlink:href='+j+' width="'+l+'" height="'+l+'"/></svg>',t+="cursor:url(data:image/svg+xml;base64,"+btoa(x)+")"+b,t+="cursor:-webkit-image-set(url("+j+")"+devicePixelRatio+"x,url("+j+")1x)"+b),p=G.createElement("style"),p.textContent="body."+W+" *, ."+W+"{"+t+"}",G.head.appendChild(p)};var ek=mq.Guide.Grid=function(s){var K=this;K._interactor=s,K._alignmentGuideId=0,K._xAlignmentGuide=[],K._yAlignmentGuide=[]};ek.prototype={},ek.prototype.constructor=ek,D.defineProperties(ek.prototype,{gridBlockSize:{get:function(){var B=this;return B._gridBlockSize||B._interactor.getStyle("gridBlockSize")},set:function(m){this._gridBlockSize=m,this._interactor._42()}},gridThickLinesEvery:{get:function(){var J=this;return J._gridThickLinesEvery||J._interactor.getStyle("gridThickLinesEvery")},set:function(a){this._gridThickLinesEvery=a,this._interactor._42()}},gridEnabled:{get:function(){var g=this,E=g._interactor;return E.gridEnabled&&g.isValidGrid()}}}),ek.prototype._42=function(){var b=this,y=b._interactor;b.gridEnabled&&b.drawGrid(),y.alignmentGuideEnabled&&b.drawAlignmentGuide()},ek.prototype.makeMatrix=function(){var L=this,Y=L._interactor.getStyle("gridAngle"),U=L._interactor.getStyle("gridRotation"),h=new mq.Math.Matrix2d,i=Math.sin(Y),C=Math.cos(Y);return h.set(1,0,C,i,0,0),h.rotate(U),h},ek.prototype.isValidGrid=function(){var K=this,p=Math.PI,c=K._interactor,T=c.gv;if(T._zoom<c.getStyle("gridZoomThreshold"))return!1;var y=c.getStyle("gridAngle"),N=Math.abs(180*(y%p/p)),E=1-1e-8;return E>N||N>180-E?!1:!0},ek.prototype.drawAlignmentGuide=function(){var K=this,U=K._interactor,Y=U.gv,$=U._canvas,b=U._context,Q=$.width,v=$.height,r=Y.tx(),s=Y.ty(),F=Y._zoom;b.beginPath(),b.strokeStyle=U.getStyle("gridAlignmentGuideColor"),b.lineWidth=1,K._xAlignmentGuide.forEach(function(k){var P=k.p*F+r;b.moveTo(P,0),b.lineTo(P,v)}),K._yAlignmentGuide.forEach(function(O){var L=O.p*F+s;b.moveTo(0,L),b.lineTo(Q,L)}),b.stroke()},ek.prototype.drawGrid=function(){function V(_,E,G,t){var k=mq.toScreenPosition(e,w.apply({x:_,y:E})),I=mq.toScreenPosition(e,w.apply({x:G,y:t}));D.moveTo(k.x,k.y),D.lineTo(I.x,I.y)}var c=this,r=c._interactor,F=c.gridBlockSize,P=c.gridThickLinesEvery,H=r.getStyle("gridThickColor"),I=r.getStyle("gridLightColor"),e=r.gv,L=r._canvas,D=r._context,g=L.width,z=L.height,w=c.makeMatrix(),u=w.applyInverse(mq.toWorldPosition(e,{x:0,y:0})),x=w.applyInverse(mq.toWorldPosition(e,{x:g,y:0})),t=w.applyInverse(mq.toWorldPosition(e,{x:0,y:z})),E=w.applyInverse(mq.toWorldPosition(e,{x:g,y:z})),b=Math.min(u.x,x.x,t.x,E.x),i=Math.max(u.x,x.x,t.x,E.x),p=Math.min(u.y,x.y,t.y,E.y),n=Math.max(u.y,x.y,t.y,E.y);g=i-b,z=n-p;var K=Math.ceil(b/F),j=Math.floor(i/F),A=Math.ceil(p/F),C=Math.floor(n/F);e.tx(),e.ty(),e._zoom;
var U,_,Y;for(D.save(),D.lineWidth=1,D.beginPath(),D.strokeStyle=H,Y=Math.ceil(K/P)*P;j>=Y;Y+=P)U=Y*F,V(U,p,U,n);for(Y=Math.ceil(A/P)*P;C>=Y;Y+=P)_=Y*F,V(b,_,i,_);for(D.stroke(),D.beginPath(),D.strokeStyle=I,Y=K;j>=Y;Y++)0!==Y%P&&(U=Y*F,V(U,p,U,n));for(Y=A;C>=Y;Y++)0!==Y%P&&(_=Y*F,V(b,_,i,_));D.stroke(),D.restore()},ek.prototype.getAlignmentGuides=function(){var N=this;return{x:N._xAlignmentGuide,y:N._yAlignmentGuide}},ek.prototype.addAlignmentGuide=function(q,K,d){var M=this,E="x"===q?M._xAlignmentGuide:M._yAlignmentGuide,d=d?d:++M._alignmentGuideId,i={p:K,id:d};if(E.length){var g=M._findClosestAlignmentGuide(i.p,E);g.dis<0?E.splice(g.index+1,0,i):E.splice(g.index,0,i)}else E.push(i);return M._interactor._42(),d},ek.prototype.findClosest=function(l,T,z){var t=this,J=t._interactor,q=J.gv;z&&(l=mq.toWorldPosition(q,l));var M,w,X,e=1/0,G=1/0,K=l.x,H=l.y;if(t.gridEnabled){var j=t.gridBlockSize,V=t.makeMatrix(),b=V.applyInverse(l);b=V.apply({x:Math.round(b.x/j)*j,y:Math.round(b.y/j)*j}),e=b.x-K,G=b.y-H,X=!0}if(J.alignmentGuideEnabled&&(M=t._findClosestAlignmentGuide(K,t._xAlignmentGuide).dis,w=t._findClosestAlignmentGuide(H,t._yAlignmentGuide).dis,Math.abs(M)<Math.abs(e)&&(e=M,X=!0),Math.abs(w)<Math.abs(G)&&(G=w,X=!0)),X){X=!1;var g=q._zoom,Z=J.getStyle("smartGuideSensitivity")/g,i={};if(Math.abs(e)<Z&&"y"!==T&&(i.x=z?e*g:e,X=!0),Math.abs(G)<Z&&"x"!==T&&(i.y=z?G*g:G,X=!0),X)return i}},ek.prototype._findClosestAlignmentGuide=function(Q,j){if(!j.length)return{dis:1/0};for(var z,r=0,B=j.length-1;B-r>1;)z=Math.floor((r+B)/2),j[z].p<Q?r=z:B=z;var h=j[r].p-Q,e=j[B].p-Q;return Math.abs(h)<=Math.abs(e)?{line:j[r],dis:h,index:r}:{line:j[B],dis:e,index:B}},ek.prototype.removeAllAlignmentGuide=function(J){var B=this;"y"!==J&&(B._xAlignmentGuide=[]),"x"!==J&&(B._yAlignmentGuide=[]),B._interactor._42()},ek.prototype.removeAlignmentGuide=function(k){for(var b,F,Z,K=this,O=K._xAlignmentGuide,W=0;2>W;W++)for(O=0===W?K._xAlignmentGuide:K._yAlignmentGuide,b=0,F=O.length;F>b;b++)if(Z=O[b],Z.id===k)return O.splice(b,1),K._interactor._42(),{axis:0===W?"x":"y",position:Z.p};return!1},ek.prototype.adjustAlignmentGuide=function(Y,b){var I=this,A=I.removeAlignmentGuide(Y);return A?(I.addAlignmentGuide(A.axis,b,Y),!0):!1};var Sb=mq.Guide.Rect=function(D){var I=this;I._interactor=D};Sb.prototype={},Sb.prototype.constructor=Sb,Sb.prototype.gatherRects=function(){var y,A,l,x,f=this,g=f._interactor.gv,E=[],m=[],k={x:E,y:m},V={},e=g.getDataModel(),P=e.a("width"),t=e.a("height");P&&t&&(y=0,A=0,l=P,x=t,E.push({node:e,type:0,p:y},{node:e,type:1,p:y+l/2},{node:e,type:2,p:y+l}),m.push({node:e,type:0,p:A},{node:e,type:1,p:A+x/2},{node:e,type:2,p:A+x}),V[e._id||0]={x:y,y:A,width:l,height:x}),e.each(function(b){if(Cl(b)&&!g.isSelected(b)&&g.isVisible(b)){var j=!1;if(g.sm().getSelection().each(function(I){j||(b.isHostOn(I)?j=!0:b.isDescendantOf(I)&&(j=!0))}),!j){var F=b.getRect();y=F.x,A=F.y,l=F.width,x=F.height,E.push({node:b,type:0,p:y},{node:b,type:1,p:y+l/2},{node:b,type:2,p:y+l}),m.push({node:b,type:0,p:A},{node:b,type:1,p:A+x/2},{node:b,type:2,p:A+x}),V[b._id]=F}}}),E.sort(function(l,z){return l.p-z.p}),m.sort(function(k,D){return k.p-D.p}),f._grid=k,f._87I=V},Sb.prototype.gatherLines=function(_,y,O){var c,r,b,G,v,X,z,H,s,x,C,J,W=this,S=[W.findClosest({x:_.x,y:_.y},y),W.findClosest({x:_.x+_.w/2,y:_.y+_.h/2},y),W.findClosest({x:_.x+_.w,y:_.y+_.h},y)],e={},n=W._87I;O=O||255;var D,F;for(W._guideLine=[],c=0;2>c;c++)for(e={},0===c?(G="y",H=_.x,s=H+_.w):(G="x",H=_.y,s=H+_.h),r=0;3>r;r++)v=S[r],v&&isFinite(v[G])&&(D=1<<3*c+r,O&D&&(X=v[G+"Line"],z=X.node,F=z._id||0,e[F]||(e[F]=!0,J=n[F],"y"===G?(x=J.x,C=J.x+J.width):(x=J.y,C=J.y+J.height),b=X.p,W._guideLine.push({type:G,a:H,b:s,c:x,d:C,p:b,center:1===X.type}))))},Sb.prototype._binarySearchClosest=function(V,e){if(!e.length)return{dis:1/0};for(var B,L=0,P=e.length-1;P-L>1;)B=Math.floor((L+P)/2),e[B].p<V?L=B:P=B;var k=e[L].p-V,I=e[P].p-V;return Math.abs(k)<=Math.abs(I)?{line:e[L],dis:k}:{line:e[P],dis:I}},Sb.prototype.findClosest=function(_,v,P){var h=this,S=h._interactor,j=S.gv,M=h._grid;P&&(_=mq.toWorldPosition(j,_));var i,g=h._binarySearchClosest(_.x,M.x),R=h._binarySearchClosest(_.y,M.y),Y=g.dis,o=R.dis,x=j._zoom,I=S.getStyle("smartGuideSensitivity")/x,n={};return Math.abs(Y)<I&&"y"!==v&&(n.x=P?Y*x:Y,n.xLine=g.line,i=!0),Math.abs(o)<I&&"x"!==v&&(n.y=P?o*x:o,n.yLine=R.line,i=!0),i?n:void 0},Sb.prototype._42=function(){var V=this,A=V._guideLine;if(A&&!c.Default.isCtrlDown()){var x,g,r,J,y,i,K,N,Q,s,S,W,Z,u,D,w,z,B=V._interactor,t=B.gv,o=B._context,C=t.tx(),L=t.ty(),l=t._zoom,T=B.getStyle("guideLineTextSpacing");for(x=0,g=A.length;g>x;x++)r=A[x],N=r.type,Q=r.p,s=r.a,S=r.b,W=r.c,Z=r.d,u=Math.min(s,W),D=Math.max(S,Z),"x"===N?(J=Q*l+C,y=u*l+L,i=J,K=D*l+L):(J=u*l+C,y=Q*l+L,i=D*l+C,K=y),mq.Icons.DrawIcon(B,o,mq.Icons.MoveLineGuide,{rect:[J,y,i,K],center:r.center}),Z>=s&&S>=W||(u=s>Z?Z:S,D=s>Z?s:W,z=D-u,"x"===N?(r.center2center||(J-=T,i=J),y=u*l+L,K=D*l+L,w=mq.Icons.MoveLineGuideDistanceV):"y"===N&&(r.center2center||(y-=T,K=y),J=u*l+C,i=D*l+C,w=mq.Icons.MoveLineGuideDistanceH),mq.Icons.DrawIcon(B,o,w,{x0:J,y0:y,x1:i,y1:K,dis:z}))}},Sb.prototype.clear=function(){this._guideLine=null},mq.DefaultStyleMap={pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,rotateRound:Math.PI/2,rotateSensitivity:Math.PI/60,shiftRotateRound:Math.PI/12,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,guideLineTextSpacing:0,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var pr=mq.Icons={},Oh=1e4,Tb=null,xh="rgb(51,153,255)",wd="rgb(183,232,135)",or="rgb(255,204,153)",As=6;c.Default.setImage("Icons.RectPoint",{width:As,height:As,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:xh,rect:[0,0,As,As]}]});var Kp="#e000e0";pr.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var S=pr.GroupSubEntityRect.data;if(!S)return[];var i=S.min,h=S.max;return[i.x,i.y,i.x,h.y,h.x,h.y,h.x,i.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return pr.GroupSubEntityRect.data.isKeyOb?Kp:"#666666"}}}]},pr.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[pr.Line.data.P1.x,pr.Line.data.P1.y],As,As]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[pr.Line.data.P2.x,pr.Line.data.P2.y],As,As]}}}]},pr.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return pr.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},pr.Rect={comps:[{type:"shape",points:{func:function(){var r=pr.Rect.data;if(!r)return[];var k=r.LT,d=r.LB,x=r.RB,y=r.RT;return[k.x,k.y,d.x,d.y,x.x,x.y,y.x,y.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:xh},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return pr.Rect.data.rotation}},rect:{func:function(){return[[pr.Rect.data.LT.x,pr.Rect.data.LT.y],As,As]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return pr.Rect.data.rotation}},rect:{func:function(){return[[pr.Rect.data.LB.x,pr.Rect.data.LB.y],As,As]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return pr.Rect.data.rotation}},rect:{func:function(){return[[pr.Rect.data.RB.x,pr.Rect.data.RB.y],As,As]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return pr.Rect.data.rotation}},rect:{func:function(){return[[pr.Rect.data.RT.x,pr.Rect.data.RT.y],As,As]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return pr.Rect.data.rotation}},visible:{func:function(){return pr.Rect.data.L?!0:!1}},rect:{func:function(){return[[pr.Rect.data.L.x,pr.Rect.data.L.y],As,As]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return pr.Rect.data.rotation}},visible:{func:function(){return pr.Rect.data.R?!0:!1}},rect:{func:function(){return[[pr.Rect.data.R.x,pr.Rect.data.R.y],As,As]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return pr.Rect.data.rotation}},visible:{func:function(){return pr.Rect.data.T?!0:!1}},rect:{func:function(){return[[pr.Rect.data.T.x,pr.Rect.data.T.y],As,As]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return pr.Rect.data.rotation}},visible:{func:function(){return pr.Rect.data.B?!0:!1}},rect:{func:function(){return[[pr.Rect.data.B.x,pr.Rect.data.B.y],As,As]}}}]};var rr=16;c.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:xh,borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:xh,shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),pr.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[pr.Anchor.data.POS.x,pr.Anchor.data.POS.y],rr,rr]}}}]},pr.TipShiftX=12,pr.TipShiftY=12;var bg=[8,28];pr.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[pr.TipHelper.data.helperPos.x,pr.TipHelper.data.helperPos.y,bg[0]*pr.TipHelper.data.size,bg[1]]}},background:{func:function(){return Tb.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return pr.TipHelper.data.text}},rect:{func:function(){return[pr.TipHelper.data.helperPos.x,pr.TipHelper.data.helperPos.y,bg[0]*pr.TipHelper.data.size,bg[1]]}},color:{func:function(){return Tb.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var An=7;pr.ShapePoint={comps:[{type:"circle",rect:{func:function(){var I=pr.ShapePoint.data;return[I,An,An]}},background:"#ffffff",borderWidth:1,borderColor:xh}]},pr.ShapeBgCurve={comps:[{type:"shape",points:{func:function(){return pr.ShapeBgCurve.data.P}},segments:{func:function(){return pr.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:xh}]};var vo=8;pr.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var D=pr.ShapeHighlighPoint.data;return[[D.x,D.y],vo,vo]}},background:{func:function(){return Tb.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var di=10;pr.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var p=pr.ShapeHighlighRealPoint.data;return[[p.x,p.y],di,di]}},background:"#ffffff",borderWidth:2,borderColor:xh}]};var Ql=8;pr.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var p=pr.ShapeHighlighCtrlPoint.data,b=p.x,Q=p.y,m=Ql/2;return[b-m,Q-m,b-m,Q+m,b+m,Q+m,b+m,Q-m]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Tb.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Tb.getStyle("shapeCtrlPointBorderColor")||xh}}}]};var Cr=3;pr.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return pr.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Cr,borderColor:{func:function(){return Tb.getStyle("curveHighlightColor")}}}]},pr.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return pr.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},pr.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return pr.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return pr.MoveLineGuide.data.center?wd:or}}}]};var Ye=5;pr.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var i=pr.MoveLineGuideDistanceH.data,A=i.x0,T=i.y0;return[A,T-Ye,A,T+Ye]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:or},{type:"shape",points:{func:function(){var w=pr.MoveLineGuideDistanceH.data,H=w.x1,o=w.y1;return[H,o-Ye,H,o+Ye]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:or},{type:"text",text:{func:function(){return Math.round(pr.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var Y=pr.MoveLineGuideDistanceH.data;return[[(Y.x0+Y.x1)/2,Y.y0-10],20,20]}},color:or,font:"12px Arial",align:"center"}]},pr.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var G=pr.MoveLineGuideDistanceV.data,c=G.x0,x=G.y0;return[c-Ye,x,c+Ye,x]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:or},{type:"shape",points:{func:function(){var a=pr.MoveLineGuideDistanceV.data,s=a.x1,u=a.y1;return[s-Ye,u,s+Ye,u]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:or},{type:"text",text:{func:function(){return Math.round(pr.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var m=pr.MoveLineGuideDistanceV.data;return[[m.x0-10,(m.y0+m.y1)/2],20,20]}},color:or,font:"12px Arial",align:"center"}]},c.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),pr.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var r=pr.EdgeElevationGuide.data,S=r.x,m=r.y,W=Tb.getStyle("curveElevationIntersectSize"),o=Tb.getStyle("curveElevationGuideShift");return S+=o[0],m+=o[1],[S-W,m-W,2*W,2*W]}}}]},c.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),c.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),pr.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return pr.ConnectGuide.data.rotation}},rect:{func:function(){var O=pr.ConnectGuide.data.connect;O.x,O.y;var c=Tb.getStyle("connectGuideIntersectSize");return[[O.x,O.y],2*c,2*c]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var i=pr.ConnectGuide.data.cursorPos||pr.ConnectGuide.data.connect,B=Tb.getStyle("connectGuideIntersectSize");return[[i.x,i.y],2*B-2,2*B-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var $=pr.ConnectGuide.data.connect,J=pr.ConnectGuide.data.cursorPos||$;return[$.x,$.y,$.x+.5*(J.x-$.x),$.y,J.x+.5*($.x-J.x),J.y,J.x,J.y]}}}]},c.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),c.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),pr.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var G=pr.ConnectGuideGarbage.data.hover;return G?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var U=pr.ConnectGuideGarbage.data,h=Tb.getStyle("connectGuideGarbageIntersectsize");return U.hover&&(h+=5),[[U.x,U.y],2*h,2*h]}}}]};var ph=6;pr.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return pr.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var F=pr.ShapeActivingCtrl.data;return[F.point.x,F.point.y,F.c1.x,F.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:xh},{type:"shape",visible:{func:function(){return pr.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var T=pr.ShapeActivingCtrl.data;return[T.point.x,T.point.y,T.c2.x,T.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:xh},{type:"shape",visible:{func:function(){return pr.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var H=pr.ShapeActivingCtrl.data.c1,e=H.x,F=H.y,P=ph/2;return"c1"===pr.ShapeActivingCtrl.data.hl&&(P+=.5),[e-P,F-P,e-P,F+P,e+P,F+P,e+P,F-P]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Tb.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===pr.ShapeActivingCtrl.data.hl?Tb.getStyle("shapeCtrlPointHighlightBorder")||xh:Tb.getStyle("shapeCtrlPointBorderColor")||xh}}},{type:"shape",visible:{func:function(){return pr.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var L=pr.ShapeActivingCtrl.data.c2,b=L.x,V=L.y,z=ph/2;return"c2"===pr.ShapeActivingCtrl.data.hl&&(z+=.5),[b-z,V-z,b-z,V+z,b+z,V+z,b+z,V-z]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Tb.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===pr.ShapeActivingCtrl.data.hl?Tb.getStyle("shapeCtrlPointHighlightBorder")||xh:Tb.getStyle("shapeCtrlPointBorderColor")||xh}}}]},mq.Icons.DrawIcon=function(X,W,q,$){q.width=q.height=Oh,q.data=$,Tb=X,c.Default.drawImage(W,q,0,0,Oh,Oh)},mq.Icons.MapPoints=function(K,g){for(var O=0,z=K.length;z>O;O++)K[O]/=g},mq.roundTo=function(s,r,i){var k=Math.abs(s%r);return i>k||i>r-k?r*Math.round(s/r):s},mq.toFixed=function(e){return Math.round(100*e)/100},mq.getDataMatrix=function(C){if(C instanceof c.Shape){var u=new c.Math.Matrix2d,z=C.getPosition();return u.translate(-z.x,-z.y).scale(C.getScale().x,C.getScale().y).rotate(C.getRotation()).translate(z.x,z.y),u}return C.getMatrix?C.getMatrix():new c.Math.Matrix2d};var Gf=mq.Math.Curve=function(){this._curves=[]};Gf.prototype={},Gf.prototype.constructor=Gf,Gf.prototype.createFromHtShape=function(k,Z,H){Z instanceof c.List&&(Z=Z.toArray());var I,A,e,p,F,R,n,Y=this,B=null,l=null,z=0,E=mq.Math.Vector2,N=mq.Math.CubicBezier,m=function(i){return new E(k[i],k[i+1],H?H[i/2]:w)};for(A=0,e=Z.length;e>A;A++){switch(p=Z[A],F=null,p){case 1:l=m(z),B=l,z+=2;break;case 2:I=m(z),z+=2,F=new N(l,l.clone(),I.clone(),I),l=I;break;case 3:R=m(z),I=m(z+2),z+=4,F=new N(l,R.clone().sub(l).multiplyScalar(2/3).add(l),R.clone().sub(I).multiplyScalar(2/3).add(I),I),l=I;break;case 4:R=m(z),n=m(z+2),I=m(z+4),z+=6,F=new N(l,R,n,I),l=I;break;case 5:if(!B)break;F=new N(l,l.clone(),B.clone(),B),l=null,B=null}F&&(F._index=Y._curves.length,Y._curves.push(F))}},Gf.prototype.checkPoint=function(h,c){var $,t,f,W,C,g=this,u=g._curves;for($=0,t=u.length;t>$;$++)if(W=u[$],C=W.intersectRect(h,c,c),C.length)return f=0,C.forEach(function(i){f+=i.t}),f/=C.length,h=W.getPointAt(f),h.t=f,{bezier:W,intersection:h}},Gf.prototype.insertKnot=function(o,w){var X=o.insertKnot(w),G=this,M=G._curves;M.splice(o._index,1,X[0],X[1])},Gf.prototype._isCloseEnough=function(D,I){return Math.abs(D.x-I.x)<1e-6&&Math.abs(D.y-I.y)<1e-6},Gf.prototype._isSamePoint=function(Q,H){return Q===H},Gf.prototype.moveRealPoint=function(e,D){var V=this,s=V._curves,E=D.clone().sub(e);s.forEach(function(S){var l=S._p1;S._p2,S._p3;var i=S._p4;V._isSamePoint(l,e)&&(S._p2.add(E),S._p1=D),V._isSamePoint(i,e)&&(S._p3.add(E),S._p4=D)})},Gf.prototype.moveCtrlDueToRealPointMovement=function(l,p){var T=this,m=T._curves,$=function(v){v.add(p),v.e&&p.e&&(v.e+=p.e)};m.forEach(function(v){var w=v._p1;v._p2,v._p3;var A=v._p4;T._isSamePoint(w,l)&&$(v._p2),T._isSamePoint(A,l)&&$(v._p3)})},Gf.prototype.moveCtrlPoint=function(N,y,O){var U=N[O];if(U){U.e!==w&&(y.e=U.e);var Z=this,V=Z._curves;y.clone().sub(U),V.forEach(function(c){var $;"c2"===O?$="_p2":"c1"===O&&($="_p3"),Z._isSamePoint(c[$],U)&&(c[$]=y)}),N[O]=y}},Gf.prototype.deleteRealPoint=function(x,d){var l,a,h,t,s,e,Y,$=this,_=$._curves,m={},r=[],I=mq.Math.CubicBezier;for(a=0,h=_.length;h>a;a++)l=_[a],t=l._p1,s=l._p2,e=l._p3,Y=l._p4,(m[a]||!$._isSamePoint(t,x))&&($._isSamePoint(Y,x)?h>a+1&&$._isSamePoint(_[a+1]._p1,x)&&(d||r.push(new I(t,s,_[a+1]._p3,_[a+1]._p4))):r.push(l));$._curves=r},Gf.prototype.findPairs=function(B,Z){var y,K,p,m,l,D,Q,T,q=this,x=q._curves,Y={},k=[];for(K=0,p=x.length;p>K;K++)y=x[K],m=y._p1,l=y._p2,D=y._p3,Q=y._p4,!Y[K]&&q._isSamePoint(m,B)&&(Z?k.push({point:m,r2:Q}):k.push({point:m,c2:l})),q._isSamePoint(Q,B)&&(T=Z?{point:Q,r1:m}:{point:Q,c1:D},p>K+1&&q._isSamePoint(x[K+1]._p1,B)&&(Z?T.r2=x[K+1]._p4:T.c2=x[K+1]._p2,Y[K+1]=!0),k.push(T));return k},Gf.prototype.toHtShape=function(){var N=this,Y=N._curves,C=[],i=[],n={x:1/0,y:1/0};return Y.forEach(function(x){var J=x._p1,$=x._p2,_=x._p3,y=x._p4;return N._isCloseEnough(J,n)||(C.push(1),i.push(J.clone())),n=y,N._isCloseEnough(J,$)&&N._isCloseEnough(_,y)?(C.push(2),i.push(y.clone()),void 0):(C.push(4),i.push($.clone(),_.clone(),y.clone()),void 0)}),{segments:C,points:i}};var Tl=mq.Math.CubicBezier=function(P,H,m,K){var G=this;G._id=mq.Math.CubicBezier._globalId++,G._p1=P,G._p2=H,G._p3=m,G._p4=K};Tl._globalId=1,Tl.prototype={},Tl.prototype.constructor=Tl,Tl.prototype.toString=function(){return this._id},Tl.prototype.intersectRect=function(g,K,R){var P=K/2,W=R/2,c=g.x,D=g.y,e=mq.Math.Vector2,$=new e(-P+c,-W+D),w=new e(P+c,W+D),d=new e(w.x,$.y),A=new e($.x,w.y),q=this,U=q.intersectLine($,d),F=q.intersectLine(d,w),f=q.intersectLine(w,A),Q=q.intersectLine(A,$),h=U.concat(F).concat(f).concat(Q);return h},Tl.prototype.intersectLine=function(e,d){var X,l,J,f,q,M,N,z,k,r,Z,h,G,n=this,Q=e.clone().min(d),A=e.clone().max(d);f=n._p1,q=n._p2,M=n._p3,N=n._p4,X=f.clone().multiplyScalar(-1),l=q.clone().multiplyScalar(3),J=M.clone().multiplyScalar(-3),Z=X.add(l).add(J).add(N),X=f.clone().multiplyScalar(3),l=q.clone().multiplyScalar(-6),J=M.clone().multiplyScalar(3),r=X.add(l).add(J),X=f.clone().multiplyScalar(-3),l=q.clone().multiplyScalar(3),k=X.add(l),z=f.clone(),G=new mq.Math.Vector2(e.y-d.y,d.x-e.x),h=e.x*d.y-d.x*e.y;for(var $=n.getRoots(G.dot(Z),G.dot(r),G.dot(k),G.dot(z)+h),B=new Array,v=0,L=$.length;L>v;v++){var y=$[v];if(!(0>y||y>1)){var O=f.clone().lerp(q,y),i=q.clone().lerp(M,y),s=M.clone().lerp(N,y),o=O.lerp(i,y),m=i.lerp(s,y),c=o.lerp(m,y);c.t=y,e.x==d.x?Q.y<=c.y&&c.y<=A.y&&B.push(c):e.y==d.y?Q.x<=c.x&&c.x<=A.x&&B.push(c):c.x>=Q.x&&c.y>=Q.y&&c.x<=A.x&&c.y<=A.y&&B.push(c)}}return B},Tl.prototype.solveTForPoint=function(G){var x,O,i,R,j=this;x=j._p1.x-G.x,O=j._p2.x-G.x,i=j._p3.x-G.x,R=j._p4.x-G.x;for(var K=j.getRoots(R-3*i+3*O-x,3*i-6*O+3*x,3*O-3*x,x),n=w,c=1/0,T=0,y=K.length;y>T;T++){var h=K[T];if(!(0>h||h>1)){var I=j._p1.clone().lerp(j._p2,h),t=j._p2.clone().lerp(j._p3,h),F=j._p3.clone().lerp(j._p4,h),Z=I.lerp(t,h),U=t.lerp(F,h),W=Z.lerp(U,h);W.t=h;var u=Math.abs(W.y-G.y);c>u&&(c=u,n=W)}}return n},Tl.prototype.getPointAt=function(P){var D=this,N=D._p1,W=D._p2,R=D._p3,L=D._p4,$=N.clone().lerp(W,P),h=W.clone().lerp(R,P),F=R.clone().lerp(L,P),T=$.lerp(h,P),t=h.lerp(F,P);return T.lerp(t,P)},Tl.prototype.getRoots=function(U,D,N,W){var w,V,I,v,j,M=new Array;if(Math.abs(U)<1e-6){var w=D,V=N/w,I=W/w,v=V*V-4*I;if(v>0){var j=Math.sqrt(v);M.push(.5*(-V+j)),M.push(.5*(-V-j))}else 0==v&&M.push(.5*-V)}D/=U,N/=U,W/=U,w=(3*N-D*D)/3,V=(2*D*D*D-9*N*D+27*W)/27;var A=D/3,m=V*V/4+w*w*w/27,E=V/2;if(Math.abs(m)<=1e-6&&(m=0),m>0){var Z,K,j=Math.sqrt(m);Z=-E+j,K=Z>=0?Math.pow(Z,1/3):-Math.pow(-Z,1/3),Z=-E-j,Z>=0?K+=Math.pow(Z,1/3):K-=Math.pow(-Z,1/3),M.push(K-A)}else if(0>m){var d=Math.sqrt(-w/3),T=Math.atan2(Math.sqrt(-m),-E)/3,C=Math.cos(T),z=Math.sin(T),i=Math.sqrt(3);M.push(2*d*C-A),M.push(-d*(C+i*z)-A),M.push(-d*(C-i*z)-A)}else{var Z;Z=E>=0?-Math.pow(E,1/3):Math.pow(-E,1/3),M.push(2*Z-A),M.push(-Z-A)}return M},Tl.prototype._70I=function(){var v=this;return v._p1.distanceToSquared(v._p2)<1e-10&&v._p3.distanceToSquared(v._p4)<1e-10},Tl.prototype.insertKnot=function(D){var s=this,n=s._p1,Z=s._p2,I=s._p3,K=s._p4,Y=n.clone().lerp(Z,D),e=Z.clone().lerp(I,D),B=I.clone().lerp(K,D),c=Y.clone().lerp(e,D),M=e.clone().lerp(B,D),C=c.clone().lerp(M,D);return s._70I()?(n.clone().lerp(K,D),[new mq.Math.CubicBezier(n,n.clone(),C.clone(),C),new mq.Math.CubicBezier(C,C.clone(),K.clone(),K)]):[new mq.Math.CubicBezier(n,Y,c,C),new mq.Math.CubicBezier(C,M,B,K)]};var Fh=c.Default.getInternal().ui().EdgeUI,og={_47O:function(v){var j=this,o=og.getBackups()._47O;mq.inEdit(j.gv)||o.call(j,v)}};mq.Inject.registAsModule(og,Fh);var Yh=c.Default.getInternal().ui().NodeUI,ms={_47O:function(b){var S=this,w=ms.getBackups()._47O;mq.inEdit(S.gv)||w.call(S,b)},getSelectWidth:function(){var i=this,Q=i.gv,B=i._data;if(Q.isEditable(B)&&mq.inEdit(Q))return 0;var V=ms.getBackup("getSelectWidth");return V.call(i)}};mq.Inject.registAsModule(ms,Yh);var Vq=c.graph.GraphView,tl={_editPointSize:function(){var u=c.Default.isTouchable,n=mq.getStyle("pointSize");return n[u?0:1]}(),isPointEditable:function(N){var p=this;if(mq.inEdit(p))return p._pointEditableFunc?p._pointEditableFunc(N):!0;var P=tl.getBackup("isPointEditable");P.call(p,N)},isEditable:function(d){var E,z=this,y=tl.getBackup("isEditable");if(E=d instanceof mq.Group?!0:y.call(z,d),!mq.inEdit(z))return E;if(!(d instanceof c.Edge))return E;if(!d.s("2d.editable"))return!1;var W=z.getEditableFunc();return W?W(d):!0},_42:function(W,t){var p=this,O=tl.getBackups()._42;if(O.call(p,W,t),mq.inEdit(p)){var r=p.getEditInteractor();r.drawImpl()}}};mq.Inject.registAsModule(tl,Vq);var yg=c.Default.getInternal().ui().ShapeUI,em={_47O:function(D){var O=this,i=em.getBackups()._47O;mq.inEdit(O.gv)||i.call(O,D)}};mq.Inject.registAsModule(em,yg);var Qh=c.graph.DefaultInteractor,Aq={handle_mousewheel:function(P){var m=this,X=Aq.getBackup("handle_mousewheel");mq.inEdit(m.gv)||X.call(m,P)}};mq.Inject.registAsModule(Aq,Qh);var id=c.graph.MoveInteractor,vd={_calcShift:function(t,J){var g=this,G=vd.getBackup("_calcShift"),h=g.gv;if(!mq.inEdit(h))return G.call(g,t,J);var S=h.getEditInteractor(),P=S.getSubModule("Move").calcShift(t,J,g);return P||G.call(g,t,J)},clear:function(W){var j=this,J=vd.getBackup("clear");J.call(j,W);var l=j.gv;if(mq.inEdit(l)){var i=l.getEditInteractor();i.getSubModule("Move").clear(W)}}};mq.Inject.registAsModule(vd,id);var Sb=mq.Rect=function(j){this.catalog="Rect",this._interactor=j};Sb.prototype={},Sb.prototype.constructor=Sb,Sb.prototype.gatherInfo=function(o,J){var e=this;if(1===J.length){var n=J[0];return n instanceof c.Shape&&n._70I()?e.gatherLine(o,n):Yj(n,o)?!1:e.gatherSingleTarget(o,n)}return J.length>1?e.gatherMultiTargets(o,J):!1},Sb.prototype.gatherSingleTarget=function(T,y){if(y.getCorners){var $,L=this,Q=L.info;L.target=y,$=L.screenInfo={};var e=y.getCorners();Q.LT=new mq.Math.Vector2(e[0]),Q.LB=new mq.Math.Vector2(e[1]),Q.RB=new mq.Math.Vector2(e[2]),Q.RT=new mq.Math.Vector2(e[3]),Q.T=Q.LT.clone().add(Q.RT).divideScalar(2),Q.B=Q.LB.clone().add(Q.RB).divideScalar(2),Q.L=Q.LT.clone().add(Q.LB).divideScalar(2),Q.R=Q.RT.clone().add(Q.RB).divideScalar(2);for(var X in Q)$[X]=mq.toScreenPosition(T,Q[X]);var I=L._interactor,b=I.getStyle("checkSize"),H=function(f,Y,h){var U=Y.clone().sub(f).setLength(-b),X=h.clone().sub(f).setLength(-b),g=U.add(X).add(f);return g};return $.rotLT=H($.LT,$.RT,$.LB),$.rotLB=H($.LB,$.LT,$.RB),$.rotRB=H($.RB,$.LB,$.RT),$.rotRT=H($.RT,$.LT,$.RB),$.rotT=$.rotLT.clone().add($.rotRT).divideScalar(2),$.rotB=$.rotLB.clone().add($.rotRB).divideScalar(2),$.rotL=$.rotLT.clone().add($.rotLB).divideScalar(2),$.rotR=$.rotRT.clone().add($.rotRB).divideScalar(2),$.rotation=y.getRotation(),L.gatherConnectInfo(),!0}},Sb.prototype.gatherConnectInfo=function(){var k=this,x=k.target,g=k._interactor,Z=k.screenInfo,C=g.gv;if(x instanceof c.Node&&g.getStyle("connectGuideVisible")){var S=x.s("connectGuideShift")||g.getStyle("connectGuideShift"),P=x.getAnchor(),H=x.getSize(),j=x.toGlobal({x:H.width*(S[0]-P.x),y:H.height*(S[1]-P.y)});j=mq.toScreenPosition(C,j),Z.P1?j.add(Z.P2.clone().sub(Z.P1).setLength(S[2])):(j.add(Z.RT.clone().sub(Z.LT).setLength(S[2])),j.add(Z.LB.clone().sub(Z.LT).setLength(S[3]))),Z.connect=j}},Sb.prototype.gatherMultiTargets=function(Q,W){var B=mq.Group.findOrCreateGroup(W);if(!B)return!1;var d=this;return d.editing&&"rotate"!==d.editing.mode||B.calcInfo(),d.gatherSingleTarget(Q,B)},Sb.prototype.gatherLine=function(u,b){this.target=b;var g=this.screenInfo={},f=b.getPoints(),E=mq.getDataMatrix(b);return g.P1=mq.toScreenPosition(u,E.apply(f.get(0))),g.P2=mq.toScreenPosition(u,E.apply(f.get(1))),this.gatherConnectInfo(),!0},Sb.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],Sb.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],Sb.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],Sb.prototype.check=function(Y,f,S){if(c.Default.isLeftButton(f)){var d=this;if(d.editing=null,d.tipInfo=null,d.screenInfo){var M=d.target,Z=Y.isEditable(M),x=d.screenInfo;if(Z&&x.connect){var u=d._checkConnect(S);if(u)return u}if(x.P1)return d._checkLine(S);var H,N,V,W=null,k=d._interactor,w=k.getStyle("checkSize");if(Z&&Y.isRectEditable(M))for(N=0;N<mq.Rect.ResizeKeys.length;N++)if(V=mq.Rect.ResizeKeys[N],mq.checkHit(S,x[V],w)){W=V,H="resize";break}if(!W&&Z&&Y.isRotationEditable(M)){var $=k.getStyle("rotateCheckSize");for(N=0;N<mq.Rect.RotateKeys.length;N++)if(V=mq.Rect.RotateKeys[N],mq.checkHit(S,x[V],$)){W=V,H="rotate";break}}if(!W)return k.setCursor("default"),void 0;if("rotate"===H){var g,z=Y.lp(f);if(M instanceof mq.Group){var j=k.getStyle("groupRotateModeKey");"string"==typeof j&&(j=[j]);for(var s=!1,O=0,Q=j.length;Q>O;O++)if(f[j[O]]){s=!0;break}var o=k.getStyle("groupRotateModeDefault");g=s?"batch"===o?"block":"batch":o}var n="batch"===g?M.getAnchor2():M.getPosition(),r=Math.atan2(z.y-n.y,z.x-n.x);k._setRotateCursor(r),d.editing={mode:H,key:W,pos:n,flipY:M.getScale().y<0,rotation:M.getRotation(),hitRot:r},g&&(d.editing.groupRotateMode=g)}else{var T=mq.Rect.ResizeKeys.indexOf(W),t=mq.Rect.ResizeDirection[T],b=Math.cos(M.getRotation()),E=Math.sin(M.getRotation()),G=t.x*Math.sign(M.getScale().x),B=t.y*Math.sign(M.getScale().y),D=Math.atan2(-E*G-b*B,b*G-E*B),q=(Math.round(D/(Math.PI/4))+8)%8,v=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][q];
this._interactor.setCursor(v);var _=M.getWidth(),P=M.getHeight(),C=M.getAnchor();d.editing={mode:H,key:W,rect:{x:-_*C.x,y:-P*C.y,width:_,height:P},anchor:C,matrix:M.getMatrix()}}return W}}},Sb.prototype._checkLine=function(k){var B=this;B.screenInfo;var h,t=B._interactor.getStyle("checkSize");if(mq.checkHit(k,B.screenInfo.P1,t))h="P1";else{if(!mq.checkHit(k,B.screenInfo.P2,t))return this._interactor.setCursor("default"),void 0;h="P2"}return B.editing={mode:"line",key:h},h},Sb.prototype._checkConnect=function(o){var s=this,R=s.screenInfo,$=s._interactor,A=$.getStyle("connectGuideIntersectSize"),X=R.connect,k=o.x,b=X.x;if(b>k&&A>b-k&&Math.abs(X.y-o.y)<A||k>=b&&mq.checkHit(o,X,A)){var E="connect",C=Z.getConnectAction($.gv);return s.editing={mode:E},C&&C.delete&&C.delete.visible.call(null,$.gv,s.target)&&(s.editing.hasDeleteAction=!0),$.setCursor("default"),E}},Sb.prototype._fireEditEvent=function(j,b){var p=this._interactor,V=this.editing;if(V){var T=V.mode;T="rotate"===T?"Rotation":"connect"===T?"Connection":T[0].toUpperCase()+T.slice(1),p.fi({kind:j+"Edit"+T,event:b})}},Sb.prototype.startEdit=function(v,n){v.startDragging(n);var G=this;G._interactor.fi({kind:"prepareEdit",event:n});var Q=G.editing,o=G.target;if(Q){if(G._fireEditEvent("begin",n),"rotate"===Q.mode)return Q.groupRotateMode&&o.beginRotate(Q),void 0;if("connect"!==Q.mode)("line"===Q.mode||o&&0===o.getRotation())&&(G._inSmartGuide=!0,G._interactor.rectGuide.gatherRects());else if(Q.hasDeleteAction){var u=v.gv,z=G._interactor.getStyle("connectGuideGarbageShift");Q.garbageInfo={x:u.getWidth()*z[0]+z[2],y:u.getHeight()*z[1]+z[3],size:G._interactor.getStyle("connectGuideGarbageIntersectsize")},v._42()}}},Sb.prototype._46O=function(o){var X,W=this,M=W.editing;if(M){if("connect"===M.mode&&!M.canceled&&!M.deleted)try{M.garbageInfo&&M.garbageInfo.hover?Z.doDeleteConnectionAction(W._interactor.gv,W.target):Z.doConnectAction(W._interactor.gv,W.target,M.target)}catch(L){console.error(L)}X=W.editing.groupRotateMode,W._fireEditEvent("end",o),W.editing=null}W.tipInfo=null,W._inSmartGuide&&(W._interactor.rectGuide.clear(),W._inSmartGuide=!1),X&&W.target&&W.target.endRotate()},Sb.prototype.handleNormalStateDelete=function(){var r=this,w=r.editing;if(w&&"connect"===w.mode&&!w.canceled&&!w.deleted){if(w.garbageInfo){try{Z.doDeleteConnectionAction(r._interactor.gv,r.target)}catch(d){console.error(d)}w.garbageInfo=null}return w.cursorPos=null,w.targetCorners=null,w.deleted=!0,r._interactor._42(),!0}},Sb.prototype.handleNormalStateKeyDown=function(A){var f=this,i=f.editing;return!i||"connect"!==i.mode||i.canceled||i.deleted?void 0:c.Default.isEsc(A)?(i.cursorPos=null,i.targetCorners=null,i.canceled=!0,f._interactor._42(),!0):void 0},Sb.prototype.handleEdit=function(m,F){var r=this,O=r.editing;if(O){var f,y,E,D,_,M=r.target,H=O.key,g=O.mode,Q=m.lp(F),e=r._interactor;if("connect"===g){if(O.canceled)return;if(O.deleted)return;O.cursorPos=e._getLogicalPoint(F);var N=O.garbageInfo;return N&&mq.checkHit(O.cursorPos,N,N.size)?(N.hover=!0,O.target=null,O.targetCorners=null):(N&&(N.hover=!1),O.target=m.getDataAt(Q,function(T){return m.isSelectable(T)?Cl(T)?!0:!1:!1})||null,O.targetCorners=mq.getTargetCornersOnScreen(m,O.target)),e._42(),void 0}if("rotate"===g){var v,G,a=O.pos,W=Math.atan2(Q.y-a.y,Q.x-a.x);if(O.groupRotateMode?G=W-O.hitRot:(v=W-O.hitRot,G=O.rotation+v),G%=2*Math.PI,0>G&&(G+=2*Math.PI),!c.Default.isCtrlDown(F)){var K,$;sb(F)?(K=e.getStyle("shiftRotateRound"),$=K/2):(K=e.getStyle("rotateRound"),$=e.getStyle("rotateSensitivity")),G=mq.roundTo(G,K,$)}O.groupRotateMode?(v=G-(O.lastRotation||0),0!==v&&(M.addRotation(v,O.groupRotateMode),O.lastRotation=G)):M.setRotation(G),e._setRotateCursor(W),G>Math.PI&&(G-=2*Math.PI);var j=180*(G/Math.PI);j=j.toFixed(2),f=""+j+"°"}else if("resize"===g){var L=O.rect;E=L.x,D=L.y;var l,T=L.width,C=L.height,p=O.anchor,o=O.matrix,B=sb(F),Y=r._unionPointMode1,s=r._unionPointMode2;if(r._inSmartGuide&&!c.Default.isCtrlDown(F)&&!B){var Z;"L"===H||"R"===H?Z="x":("T"===H||"B"===H)&&(Z="y"),r._adsorbedToClosest(Q,Z),_=!0}l=o.tfi(Q);var q;"LT"===H?(L=Y(l,{x:E+T,y:D+C},T,C,B),q=9):"T"===H?(L=s({x:E,y:l.y},{x:E+T,y:D+C},T,C,B,"v"),q=1):"RT"===H?(L=Y(l,{x:E,y:D+C},T,C,B),q=33):"L"===H?(L=s({x:l.x,y:D},{x:E+T,y:D+C},T,C,B,"h"),q=8):"R"===H?(L=s({x:E,y:D},{x:l.x,y:D+C},T,C,B,"h"),q=32):"LB"===H?(L=Y(l,{x:E+T,y:D},T,C,B),q=12):"B"===H?(L=s({x:E,y:D},{x:E+T,y:l.y},T,C,B,"v"),q=4):"RB"===H&&(L=Y(l,{x:E,y:D},T,C,B),q=36);var h=o.tf(L.x+L.width*p.x,L.y+L.height*p.y);M.setPosition(h),M.setSize(L.width,L.height),_&&(y=M.getRect(),e.rectGuide.gatherLines({node:M,x:y.x,y:y.y,w:y.width,h:y.height},Z,q)),f=""+Math.round(L.width)+" * "+Math.round(L.height)}else if("line"===g){if(sb(F)){var J=M.getPoints(),w="P1"===H?J.get(1):J.get(0),z={x:Q.x-w.x,y:Q.y-w.y},x=e.getStyle("shiftLineRotateRound"),I=r._shiftDirList;if(!I||r._shiftRotateRound!==x){r._shiftRotateRound=x,r._shiftDirList=I=[];for(var U=0;U<Math.PI;U+=x)I.push({x:t(U),y:P(U)})}for(var k,R=0,A=0,i=I.length;i>A;A++){var n=I[A],V=n.x*z.x+n.y*z.y;Math.abs(V)>Math.abs(R)&&(R=V,k=n)}Q={x:w.x+k.x*R,y:w.y+k.y*R},e.rectGuide.clear()}else r._inSmartGuide&&!c.Default.isCtrlDown(F)&&(r._adsorbedToClosest(Q),_=!0);var u=mq.getDataMatrix(M).applyInverse(Q);M.setPoint("P1"===H?0:1,u,!0);var S=M.getPoints(),d=S.get(0),X=S.get(1);E=d.x-X.x,D=d.y-X.y,f=" "+Math.round(Math.sqrt(E*E+D*D))+" ",_&&(y=M.getRect(),e.rectGuide.gatherLines({node:M,x:y.x,y:y.y,w:y.width,h:y.height}))}if(f){var b=c.Default.getLogicalPoint(F,e._canvas);b.x+=mq.Icons.TipShiftX,b.y+=mq.Icons.TipShiftY,r.tipInfo={helperPos:b,text:f,size:f.length}}r._fireEditEvent("between",F)}},Sb.prototype._unionPointMode1=function(R,A,O,Z,p){if(p&&O&&Z){var h=R.x-A.x,j=R.y-A.y;Math.abs(h*Z)<Math.abs(j*O)?(j=Math.sign(j)*Math.abs(h*Z/O),R.y=A.y+j):(h=Math.sign(h)*Math.abs(j*O/Z),R.x=A.x+h)}return c.Default.unionPoint(R,A)},Sb.prototype._unionPointMode2=function(I,B,t,j,m,W){var e=c.Default.unionPoint(I,B);if(m&&t&&j){var r;"v"===W?(r=e.x+e.width/2,e.width=t*e.height/j,e.x=r-e.width/2):(r=e.y+e.height/2,e.height=j*e.width/t,e.y=r-e.height/2)}return e},Sb.prototype._adsorbedToClosest=function(Z,l){var K=this,I=K._interactor,N=I.rectGuide.findClosest(Z,l),W=I.gridGuide.findClosest(Z,l),V=1/0,Y=1/0;N&&(isFinite(N.x)&&(V=N.x),isFinite(N.y)&&(Y=N.y)),W&&(isFinite(W.x)&&Math.abs(W.x)<Math.abs(V)&&(V=W.x),isFinite(W.y)&&Math.abs(W.y)<Math.abs(Y)&&(Y=W.y)),isFinite(V)&&(Z.x+=V),isFinite(Y)&&(Z.y+=Y)},Sb.prototype._42=function(G,a,T){var c=this;c.info={},c.screenInfo=null;var r=c._interactor;if(!r.editDetail&&c.gatherInfo(a,T)){var o=c.editing,y=o?o.groupRotateMode:null,k=c.screenInfo;"block"!==y&&(k.P1?mq.Icons.DrawIcon(r,G,mq.Icons.Line,k):mq.Icons.DrawIcon(r,G,mq.Icons.Rect,k),k.connect&&(mq.Icons.DrawIcon(r,G,mq.Icons.ConnectGuide,{rotation:k.rotation,connect:k.connect,cursorPos:o?o.cursorPos:null}),o&&(o.targetCorners&&mq.Icons.DrawIcon(r,G,mq.Icons.NodeHoverGuide,o.targetCorners),o.garbageInfo&&mq.Icons.DrawIcon(r,G,mq.Icons.ConnectGuideGarbage,o.garbageInfo))),c.tipInfo&&mq.Icons.DrawIcon(r,G,mq.Icons.TipHelper,c.tipInfo)),c.target instanceof mq.Group&&c.target._42(r,G,a)}};var Gc=mq.Anchor=function(Z){this.catalog="Anchor",this._interactor=Z};Gc.prototype={},Gc.prototype.constructor=Gc,Gc.prototype.gatherInfo=function(r,B){var o=this;if(1===B.length){var A=B[0];if(!A.getAnchor)return;if(A instanceof c.Shape&&A._70I())return;if(Yj(A,r))return;return o.gatherSingleTarget(r,B[0])}return B.length>1?o.gatherMultiTargets(r,B):!1},Gc.prototype.gatherSingleTarget=function(i,I){var g=this;return g.info.POS=I.getPosition(),g.screenInfo.POS=mq.toScreenPosition(i,g.info.POS),g.target=I,!0},Gc.prototype.gatherMultiTargets=function(N,F){var v=this,d=mq.Group.findOrCreateGroup(F);return d?(v.screenInfo.POS=mq.toScreenPosition(N,d.getAnchor2()),v.target=d,!0):!1},Gc.prototype.isVisible=function(){var s=this,T=s._interactor;if(T.getStyle("anchorVisible")===!1)return!1;var D=s.target;if(D){if(this.editing)return!0;var f=D.getAnchor(),R=T.getStyle("anchorOutsideVisibleThreshold");if(f.x<-R||f.x>1+R||f.y<-R||f.y>1+R)return!0;var b=D.getSize(),E=D.getScale(),q=Math.min(Math.abs(b.width*E.x),Math.abs(b.height*E.y));if(q*T.gv._zoom<T.getStyle("anchorHideThreshold"))return!1}return!0},Gc.prototype.check=function(w,S,J){if(c.Default.isLeftButton(S)){var o=this,y=o._interactor;if(o.isVisible()&&y.getStyle("anchorMovable")!==!1){o.editing=null,o.tipInfo=null;var X=o.target;if(X&&w.isAnchorEditable(X)&&w.isEditable(X)){var p;if(o.screenInfo&&(p=o.screenInfo.POS)&&mq.checkHit(J,new mq.Math.Vector2(p),y.getStyle("checkSize"))){if(X instanceof mq.Group)return o.editing={},!0;var k=X.getWidth(),s=X.getHeight(),O=X.getAnchor();return o.editing={rect:{x:-k*O.x,y:-s*O.y,width:k,height:s},anchor:O,matrix:X.getMatrix()},!0}}}}},Gc.prototype.startEdit=function(i,A){i.startDragging(A),i.fi({kind:"beginEditAnchor",event:A})},Gc.prototype._46O=function(_){var $=this;$.editing&&($.editing=null,$._interactor.fi({kind:"endEditAnchor",event:_})),$.tipInfo=null},Gc.prototype.handleEdit=function(z,V){var G=this,O=G.target;if(O){var u=G.editing;if(u){var k=z.lp(V),a=G._interactor;if(O instanceof mq.Group)return O.setAnchor2(k),a._42(),void 0;var U=u.matrix,h=U.tfi(k),M=u.rect,J=(h.x-M.x)/M.width,y=(h.y-M.y)/M.height;if(!c.Default.isCtrlDown(V)){var D=a.getStyle("anchorRound"),e=a.getStyle("anchorSensitivity");J=mq.roundTo(J,D,e),y=mq.roundTo(y,D,e)}O.setAnchor(J,y,!0);var s=c.Default.getLogicalPoint(V,a._canvas);s.x+=mq.Icons.TipShiftX,s.y+=mq.Icons.TipShiftY;var X=""+J.toFixed(2)+", "+y.toFixed(2);G.tipInfo={helperPos:s,text:X,size:X.length},a.fi({kind:"betweenEditAnchor",event:V})}}},Gc.prototype._42=function(M,X,y){var w=this;w.info={},w.screenInfo={};var S=w._interactor;S.editDetail||w.gatherInfo(X,y)&&w.isVisible()&&(mq.Icons.DrawIcon(S,M,mq.Icons.Anchor,w.screenInfo),w.tipInfo&&mq.Icons.DrawIcon(S,M,mq.Icons.TipHelper,w.tipInfo))};var Gf=mq.Curve=function(f){this.catalog="Curve",this._interactor=f};Gf.prototype={},Gf.prototype.constructor=Gf,D.defineProperties(Gf.prototype,{activing:{get:function(){return this._activing},set:function(j){var V=this;if(j)V._activing=new mq.CurveActiving(this,j);else{var g=V._activing;g&&g.dispose(),V._activing=null}}}}),Gf.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},Gf.prototype.setUp=function(){var b=this,E=b._interactor;E&&E.gv.mp(b._onGraphviewPropertyChanged,b)},Gf.prototype._onGraphviewPropertyChanged=function(S){("zoom"===S.property||"translateX"===S.property||"translateY"===S.property)&&this._handleDataChanged()},Gf.prototype.tearDown=function(){var A=this,p=A._interactor;p&&p.gv.ump(A._onGraphviewPropertyChanged,A)},Gf.prototype.canEnterEditDetailMode=function(){var y=this,U=y._interactor,t=U._getValidSelection();if(1===t.length){var A=t[0],g=A instanceof c.Edge;if(A instanceof c.Shape||g){if(g){var O=A.s("edge.type");if(O&&"points"!==O)return}var i=U.gv;if(i.isPointEditable(A)&&i.isEditable(A))return y.target=A,!0}}},Gf.prototype.preHandleScroll=function(){var F=this.editing;return F&&F.inEdit?!0:void 0},Gf.prototype.getCurrentSelectintStatus=function(){var m=this;if(m.activing&&!m.activing.selections){if(m.activing.status!=w)return m.activing.status;var Z=function(e){var N=m.activing.status;m.activing.status=e,m._interactor.fp("shapePointStatus",N,e)},X=mq.Curve.PointType,j=m.activing.point,F=m.activing.pairs;if(!F||1!==F.length)return Z(X.Mirrored);var B=F[0],P=B.c1&&B.c1.isNearEnough(j),s=B.c2&&B.c2.isNearEnough(j);if(!B.c1||!B.c2)return P||s?Z(X.Straight):Z(X.Disconnected);if(P&&s)return Z(X.Straight);if(P||s)return Z(X.Asymmetric);var G=B.c1.clone().sub(j),C=B.c2.clone().sub(j);return Math.abs(G.x*C.y-G.y*C.x)>1e-5||G.x*C.x>0?Z(X.Disconnected):Math.abs(G.length()-C.length())>1e-5?Z(X.Asymmetric):Z(X.Mirrored)}},Gf.prototype.handle_keydown=function(U){var P=this;if(P._interactor.editDetail){var $=mq.Curve.PointType;"1"===U.key?P._setCurrentSelectionStatus($.Straight):"2"===U.key?P._setCurrentSelectionStatus($.Mirrored):"3"===U.key?P._setCurrentSelectionStatus($.Disconnected):"4"===U.key&&P._setCurrentSelectionStatus($.Asymmetric)}},Gf.prototype.setCurrentSelectionStatus=function(p){var x=this,c=x._interactor;if(c){var N=c.gv;N.dm().beginTransaction(),this._setCurrentSelectionStatus(p),N.dm().endTransaction()}},Gf.prototype._setCurrentSelectionStatus=function(u){var t=this,K=t.activing;if(K){var V=t.getCurrentSelectintStatus();if(null!==V&&V!==u){K.status=u;var r=t.activing.point,q=t.activing.pairs;if(q&&1===q.length){var F=q[0],d=t.screenInfo.curve,g=mq.Curve.PointType,W=function(){t._writeToHt(),t._interactor.fp("shapePointStatus",V,u)};if(u===g.Straight)return d.moveCtrlPoint(F,r,"c1"),d.moveCtrlPoint(F,r,"c2"),W(),void 0;if(V===g.Straight){var Z=d.findPairs(r,!0),Q=Z[0],y=Q.r1||r,p=Q.r2||r,L=p.clone().sub(y).multiplyScalar(.25);return d.moveCtrlPoint(F,r.clone().sub(L),"c1"),d.moveCtrlPoint(F,r.clone().add(L),"c2"),W(),void 0}var x=F.c1,j=F.c2;if(x&&j){if(u===g.Mirrored)return d.moveCtrlPoint(F,r.clone().multiplyScalar(2).sub(j),"c1"),W(),void 0;if(u===g.Asymmetric&&V===g.Disconnected){var v=x.clone().sub(r).length(),L=r.clone().sub(j).setLength(v).add(r);return d.moveCtrlPoint(F,L,"c1"),W(),void 0}}K._firePointChange(),t._interactor.fp("shapePointStatus",V,u)}}}},Gf.prototype._handleDataChanged=function(y){var n=this;if(n.screenInfo&&n.target){var q=n._interactor;n.gatherSingleTarget(q.gv,n.target,!0),n.check(q.gv,null,y?q._getLogicalPoint(y):new mq.Math.Vector2(q._lastClientPoint)),q._42()}},Gf.prototype.gatherSingleTarget=function(B,Y,P){var A,s,t=this;t.screenInfo&&t.screenInfo.curve&&(s=t.screenInfo.curve._curves);var i=t.editing;A=i?t.screenInfo:t.screenInfo={};var Z,y,M=Y instanceof c.Edge;M?(Z=Y.s("edge.segments"),y=Y.s("edge.points")||new c.List):(Z=Y._58O,y=Y._59O),A.S=Z;var K,D=A.P=[],l=mq.getDataMatrix(Y);if(Y instanceof c.Polyline&&(K=Y.getElevation()||0,A.E=[]),y.each(function(J){A.E&&A.E.push(J.e||K),J=l.apply(J);var C=mq.toScreenPosition(B,J);D.push(C.x,C.y)}),M){var F=mq.toScreenPosition(B,Y._lastSourcePoint),U=mq.toScreenPosition(B,Y._lastTargetPoint);D.splice(0,0,F.x,F.y),D.push(U.x,U.y)}if(!A.S||!A.S.size()){A.S=new c.List,A.S.add(1);for(var k=0;k<D.length/2-1;k++)A.S.add(2)}if((!i||P)&&t.convertToCubicBezier(s),t.activing&&(P||!t.editing||"realPoint"===t.editing.type)){var S=A.curve.findPairs(t.activing.point);t.activing.pairs=S}M&&"points"!==Y.s("edge.type")&&t._writeToHt()},Gf.prototype._convertToNewPoint=function(J,w,k){var X,e,h;for(X=0,e=w.length;e>X;X++){if(h=w[X],h._p1.isNearEnough(J))return h._p1;if(h._p4.isNearEnough(J))return h._p4}if(k)for(X=0,e=Math.min(k.length,e);e>X;X++){if(h=k[X],h._p1===J)return w[X]._p1;if(h._p4===J)return w[X]._p4}},Gf.prototype.convertToCubicBezier=function(M){var i,z,E=this,m=new mq.Math.Curve,D=E.screenInfo;if(m.createFromHtShape(D.P,D.S,D.E),D.curve=m,E.activing){var v=m._curves;if(i=E.activing.point,z=E._convertToNewPoint(i,v,M),z&&(E.activing.point=z),E.activing.selections){var K=-1,J=E.activing.selections;J.forEach(function(I){K++,z=E._convertToNewPoint(I,v,M),z&&(J[K]=z)})}}},Gf.prototype.check=function(y,v,q){if(!v||c.Default.isLeftButton(v)){var t=this;if(t._interactor.setCursor("default"),t.editing=null,t.highlight=null,t.tipInfo=null,t.screenInfo){if(mm())return t._interactor._42(),!0;if(t._checkEditCtrlPoint(q))return t._interactor._42(),!0;if(t._checkEditRealPoint(q))return t._interactor._42(),!0;if(t._checkEditElevation(q))return t._interactor._42(),!0;var p=t.screenInfo.curve,G=p.checkPoint(q,t._interactor.getStyle("curveIntersectSize"));if(G){var C=t.highlight={};C.type="insertKnot",C.bezier=G.bezier,C.point=G.intersection}return t._interactor._42(),!0}}},Gf.prototype._checkEditRealPoint=function(K){var L,v,Y,i,U,l,g=this,P=g.screenInfo.curve._curves,I=g._interactor.getStyle("curvePointIntersectSize"),G=1/0;for(I*=I,Y=0,i=P.length;i>Y;Y++)L=P[Y],U=L._p1,l=K.distanceToSquared(U),G>l&&(G=l,v=U),U=L._p4,l=K.distanceToSquared(U),G>l&&(G=l,v=U);if(G>I)return!1;var k=g.highlight={};return k.type="changeRealPoint",k.point=v,g.editing={type:"realPoint",point:v,shiftGuide:{point:v.clone(),dir:"x",limit:0}},g._interactor.setCursor("crosshair"),!0},Gf.prototype._checkEditElevation=function(Y){var o=this;if(!o._interactor.getStyle("curveElevationVisible"))return!1;var x=o.activing;if(!x)return!1;var t=x.getCurrentEditingPoint();if(!t)return!1;var K=o._interactor,i=K.getStyle("curveElevationGuideShift"),k=K.getStyle("curveElevationIntersectSize"),T=Y.distanceToSquared({x:t.x+i[0],y:t.y+i[1]});if(!(T>k*k)){var A=o.highlight={};A.type="elevation";var Q=new mq.Math.Vector2(Y.x,Y.y,t.e);return o.editing={type:"elevation",startPoint:Q},o._interactor.setCursor("crosshair"),!0}},Gf.prototype._checkEditCtrlPoint=function(B){var K=this;if(K.activing&&!K.activing.selections){var O=K.getCurrentSelectintStatus();if(O!==mq.Curve.PointType.Straight){var M=K.activing.pairs;if(M){var i=K._interactor.getStyle("curvePointIntersectSize");i*=i;var D,N,d,l,k,g,u,a,m,H=1/0;for(u=0,m=M.length;m>u;u++)for(l=M[u],a=0;2>a;a++)k=0===a?"c1":"c2",l[k]&&(g=B.distanceToSquared(l[k]),H>g&&(H=g,D=l,N=u,d=k));if(H>i)return!1;K.activing.hlpair=D,K.activing.hltype=d;var _=K.highlight={};return _.type="changeCtrlPoint",_.point=D[d],K.editing={type:"ctrlPoint",pair:D,pairId:N,ctrlType:d,direction:D[d].clone().sub(K.activing.point).normalize()},K._interactor.setCursor("crosshair"),!0}}}},Gf.prototype.startEdit=function(r,P){r.startDragging(P);var X=this;X.highlight&&"insertKnot"===X.highlight.type&&(X.insertKnot(),X.gatherSingleTarget(X._interactor.gv,X.target),X.activing=null,X._checkEditRealPoint(X._interactor._getLogicalPoint(P)));var K=X._activing;if(K){var Z=X.editing?X.editing.type:null;"ctrlPoint"===Z?K.editingCtrl={pairId:X.editing.pairId,type:K.hltype}:"realPoint"===Z&&(K.editingCtrl=!1)}var J=X.highlight,z=c.Default.isCtrlDown(P);if(!J||mm()){var N=X._interactor.gv;if(!N.setFocus(P)||N._scrolling)return;return N.isPannable()&&db(P)&&!z&&(X._pan={tx:N.tx(),ty:N.ty()},r.fi({kind:"beginPan",event:P})),void 0}if("changeRealPoint"===J.type){var O,p=X.activing?X.activing.point:null,q=X.activing?X.activing.selections:null;if(z&&X.activing)p===J.point?(q?(X.activing={point:q[0]},q.length>1&&(q.splice(0,1),X.activing.selections=q)):X.activing=null,X.editing=null):q&&(O=q.indexOf(J.point))>=0?(q.length>1?q.splice(O,1):delete X.activing.selections,X.editing=null):q?(q.push(p),X.activing={point:J.point,selections:q}):X.activing={point:J.point,selections:[p]};else if(q)p===J.point||((O=q.indexOf(J.point))>=0?(q.splice(O,1,p),X.activing={point:J.point,selections:q}):X.activing={point:J.point});else{var W;p===J.point&&(W=X.activing.status),X.activing={point:J.point},W&&(X.activing.status=W)}r.fi({kind:"beginEditPoint",event:P})}},Gf.prototype.insertKnot=function(){var n=this,f=n.highlight,B=n.screenInfo.curve;B.insertKnot(f.bezier,f.point.t),n._writeToHt()},Gf.prototype._writeToHt=function(){var d,b,G,Q,g=this,F=g.screenInfo.curve,K=F.toHtShape(),e=K.points,B=[],$=K.segments,f=g._interactor.gv,J=g.target,n=J instanceof c.Edge,M=mq.getDataMatrix(J).invert();Q=J instanceof c.Polyline,Q&&(G=J.getElevation());for(var R=0,s=e.length;s>R;R++)d=e[R],b=mq.toWorldPosition(f,d),b=M.apply(b),d.e!=w&&d.e!==G&&(b.e=d.e),B.push(b);if(J._writing=!0,n){J.s("edge.type","points"),J.setStyle("edge.segments",$),J.setStyle("edge.points",B.slice(1,B.length-1)),J.setStyle("edge.source.offset.x",0),J.setStyle("edge.source.offset.y",0),J.setStyle("edge.target.offset.x",0),J.setStyle("edge.target.offset.y",0);var m=g._nextChangeEdgeHost;delete g._nextChangeEdgeHost,m&&("source"===m.type?J.setSource(m.host):J.setTarget(m.host)),g._writeEdgeHostAnchor("source",B[0]),g._writeEdgeHostAnchor("target",B[B.length-1])}else B.length?(J.setSegments($),J.setPoints(B,!0)):J.removeFromDataModel();delete J._writing},Gf.prototype._writeEdgeHostAnchor=function(y,h){var i=this,w=i.target,d=i._calcHostAnchor(w,y,h);w.s("edge."+y+".anchor.x",d.x),w.s("edge."+y+".anchor.y",d.y)},Gf.prototype._calcHostAnchor=function(m,V,d,T){T||(T="source"===V?m.getSource():m.getTarget());var k=T.getRotation(),p=T.getAnchor(),n=this._interactor.gv;if(Yj(T,n)&&(k=0),k){var z=T.getMatrix(),X=z.tfi(d),c=T.getSize();return{x:X.x/c.width+p.x,y:X.y/c.height+p.y}}var R=mi(n,T),v={x:(d.x-R.x)/R.width,y:(d.y-R.y)/R.height};return v},Gf.prototype._handlePanning=function(d){var f=this,F=f._pan;if(F){F.started=!0;var B=f._interactor,J=B.gv,w=B._lastClientPoint,x=gh(d);J.setTranslate(F.tx+x.x-w.x,F.ty+x.y-w.y),f.gatherSingleTarget(B.gv,f.target),B._42(),B.fi({kind:"betweenPan",event:d})}},Gf.prototype.handleEdit=function(l,A){var n=this,M=n.editing;if(n._pan)return n._handlePanning(A),void 0;if(M){M.inEdit=!0;var p,I,a,E=n._interactor._getLogicalPoint(A),g=c.Default.isCtrlDown(A),z=c.Default.isShiftDown(A),C=M.type,D=n.activing;if(n._guideInfo=null,"ctrlPoint"===C&&z){var v=n.editing.direction.clone();p=D.point;var i=v.dot(E.clone().sub(p));E=v.setLength(i).add(p)}else if("ctrlPoint"===C||"realPoint"===C){var v;if("realPoint"===C&&z){var Z=n.editing.shiftGuide;I=Z.point;var x=Math.abs(E.x-I.x),y=Math.abs(E.y-I.y);x>y&&x>Z.limit&&"y"===Z.dir&&(Z.dir="x"),y>x&&y>Z.limit&&"x"===Z.dir&&(Z.dir="y"),v=Z.dir,"x"===v?(E.y=I.y,Z.limit=Math.max(Z.limit,x)):"y"===v&&(E.x=I.x,Z.limit=Math.max(Z.limit,y))}var m=n._isEditEdgeSourceTarget();if(m){var $=n._editEdgeSourceTarget(m,E,g);$&&(a=$.tipText)}else if(!g){var G=n._guidingToEdit(E,v),r="realPoint"===C?n._interactor.gridGuide.findClosest(E,v,!0):null,j=1/0,V=1/0;r&&(r.x&&(j=r.x),r.y&&(V=r.y));var _=!1;G&&(G.xList&&(Math.abs(G.x)<=Math.abs(j)?(_=!0,j=G.x):delete G.xList),G.yList&&(Math.abs(G.y)<=Math.abs(V)?(_=!0,V=G.y):delete G.yList),_&&(n._guideInfo=G)),isFinite(j)&&(E.x+=j),isFinite(V)&&(E.y+=V),_&&(G.v=E)}}var s=n.screenInfo.curve;if("realPoint"===M.type){p=M.point,p.e!==w&&(E.e=p.e),s.moveRealPoint(p,E),M.point=E,n.highlight.point=E;var U=D.status,J=D.selections;if(n.activing={point:E,status:U},J){var B=E.clone().sub(p),Y=0;J.forEach(function(M){var O=M.clone().add(B);s.moveRealPoint(M,O),J[Y++]=O}),n.activing.selections=J}}else if("ctrlPoint"===M.type){var h=D.pairs,o=h[M.pairId];s.moveCtrlPoint(o,E,M.ctrlType);var q=D.status,f=mq.Curve.PointType;if((q===f.Mirrored||q===f.Asymmetric)&&o.c1&&o.c2){var p=new mq.Math.Vector2(D.point),e="c1"===M.ctrlType?"c2":"c1";if(q===mq.Curve.PointType.Mirrored)s.moveCtrlPoint(o,p.clone().multiplyScalar(2).sub(E),e);else if(q===f.Asymmetric){var i=o[e].clone().sub(p).length(),u=p.clone().sub(o[M.ctrlType]).setLength(i).add(p);isNaN(u.x)||s.moveCtrlPoint(o,u,e)}}D._firePointChange()}else if("elevation"===M.type){I=M.startPoint;var k=I.e+(I.y-E.y)/l._zoom;n._setCurrentPointImpl("e",k),D._firePointChange(),a="E: "+mq.toFixed(k)}var F=c.Default.getLogicalPoint(A,n._interactor._canvas);if(F.x+=mq.Icons.TipShiftX,F.y+=mq.Icons.TipShiftY,!a){var X=mq.toWorldPosition(l,E);a=""+mq.toFixed(X.x)+", "+mq.toFixed(X.y)}n.tipInfo={helperPos:F,text:a,size:a.length},n._writeToHt(),n._interactor.fi({kind:"betweenEditPoint",event:A})}},Gf.prototype._setCurrentPointImpl=function(U,S){var M=this,H=M._activing;if(!H)return!1;var m=M.target;if(!m)return!1;var $=H.getCurrentEditingPoint();if(!$)return!1;var c=H.editingCtrl;if(!c)var N=$.clone();if("e"===U)$.e=S;else{var s;if("x"===U||"y"===U){var z=H._lastFirePoint;s="x"===U?{x:S,y:z?z.y:0}:{x:z?z.x:0,y:S}}else"object"==typeof U?(s=U,U.e!==w&&($.e=U.e)):(s={x:arguments[0],y:arguments[1]},arguments[2]!==w&&($.e=arguments[2]));var J=mq.getDataMatrix(m);s=mq.toScreenPosition(M._interactor.gv,J.apply(s)),$.x=s.x,$.y=s.y}if(!c){var G=N.multiplyScalar(-1).add($);$.e&&N.e&&(G.e=$.e-N.e),M.screenInfo.curve.moveCtrlDueToRealPointMovement($,G)}return!0},Gf.prototype.setCurrentPoint=function(M,G){return this._setCurrentPointImpl(M,G)?(this._writeToHt(),!0):!1},Gf.prototype._isEditEdgeSourceTarget=function(){var U=this,F=U.target;if(!(F instanceof c.Edge))return!1;var w=U.editing.point,k=U.screenInfo.curve._curves;return w===k[0]._p1?"source":w===k[k.length-1]._p4?"target":!1},Gf.prototype._editEdgeSourceTarget=function(M,u,d){var D,h=this,j=h.target;if(D="source"===M?j.getSource():j.getTarget()){var W=h._interactor.gv,J=mq.toWorldPosition(W,u),B=h._calcHostAnchor(j,M,J,D);if(!d){var L=h._interactor.getStyle("anchorRound"),k=h._interactor.getStyle("anchorSensitivity");B.x=mq.roundTo(B.x,L,k),B.y=mq.roundTo(B.y,L,k)}if(h._interactor.getStyle("edgeHostDetectPerFrame")||B.x<0||B.x>1||B.y<0||B.y>1){var T=W.getDataAt(J,function(Y){return W.isSelectable(Y)?Cl(Y)?!0:!1:!1});if(T){var s=h._calcHostAnchor(j,M,J,T);D=T,h._nextChangeEdgeHost={type:M,host:T},B=s,d||(B.x=mq.roundTo(B.x,L,k),B.y=mq.roundTo(B.y,L,k))}}if(!d){var c=hd(W,D,0,0,0,B.x,B.y),Y=mq.toScreenPosition(W,c);u.x=Y.x,u.y=Y.y}return h._edgeHostGuideInfo=mq.getTargetCornersOnScreen(W,D),{host:D,anchor:B,tipText:""+B.x.toFixed(2)+", "+B.y.toFixed(2)}}},Gf.prototype._guidingToEdit=function(p,F){var v,n,D=this;if(v=D.screenInfo.curve){n=v._curves;var j,d,U,e,J,h,H,z,C=1/0,l=1/0,X=[];for(D.editing&&"realPoint"===D.editing.type&&(z=D.editing.point),J=0,h=2*n.length;h>J;J++)H=n[Math.floor(J/2)][J%2?"_p4":"_p1"],X.indexOf(H)>=0||(X.push(H),z&&z===H||(U=H.x-p.x,e=H.y-p.y,Math.abs(U)<Math.abs(C)?(C=U,j=[H]):U===C&&j.push(H),Math.abs(e)<Math.abs(l)?(l=e,d=[H]):e===l&&d.push(H)));var o=D._interactor.getStyle("smartGuideSensitivity");if((Math.abs(C)>o||"y"===F)&&(j=null),(Math.abs(l)>o||"x"===F)&&(d=null),j||d){var O=!1,V={};if(j&&(O=!0,V.xList=j,V.x=C),d&&(O=!0,V.yList=d,V.y=l),O)return V}}},Gf.prototype._46O=function(i){var F=this;F.editing&&(F.editing=null,F._interactor.fi({kind:"endEditPoint",event:i})),F._guideInfo=null,F._edgeHostGuideInfo=null,F._pan&&(F._pan=null,F._interactor.fi({kind:"endPan",event:i})),F.tipInfo=null},Gf.prototype._canDeletePoint=function(h,A){var b=this.target;if(!(b instanceof c.Edge))return!0;var z=h._curves[0],B=h._curves[h._curves.length-1];return z._p1===A||B._p4===A?!1:!0},Gf.prototype.handleDelete=function(){var V=this;if(V.activing&&V.screenInfo){var x=c.Default.isShiftDown(),q=V.screenInfo.curve;V._canDeletePoint(q,V.activing.point)&&q.deleteRealPoint(V.activing.point,x),V.activing.selections&&V.activing.selections.forEach(function(r){V._canDeletePoint(q,r)&&q.deleteRealPoint(r,x)}),V.activing=null,delete V.editing,delete V.tipInfo,delete V._pan,V._writeToHt(),V._interactor.fp("deleteShapePoint",!1,!0)}},Gf.prototype.handleDoubleClick=function(d){var p=this,U=p._interactor._getLogicalPoint(d);if(p.screenInfo&&p._checkEditRealPoint(U)){var V=p.getCurrentSelectintStatus(),M=mq.Curve.PointType;return V=V===M.Mirrored?M.Straight:M.Mirrored,p._setCurrentSelectionStatus(V),p._interactor._42(),!0}},Gf.prototype._drawHighlight=function(m){var J=this,o=J.highlight;if(o){var u=o.bezier,v=J._interactor;u&&mq.Icons.DrawIcon(v,m,mq.Icons.ShapeHighlightCurve,[u._p1.x,u._p1.y,u._p2.x,u._p2.y,u._p3.x,u._p3.y,u._p4.x,u._p4.y]);var A=o.point;A&&"insertKnot"===o.type&&mq.Icons.DrawIcon(v,m,mq.Icons.ShapeHighlighPoint,A)}},Gf.prototype._drawGuide=function(P){var J=this,W=J._guideInfo;if(W){var k,t,I,c,s=W.v;for(k=0;2>k;k++)if(c=0===k?W.xList:W.yList)for(t=0,I=c.length;I>t;t++)mq.Icons.DrawIcon(J._interactor,P,mq.Icons.ShapeGuideLine,[s.x,s.y,c[t].x,c[t].y])}},Gf.prototype._drawCurrentPoint=function(l){var J=this;if(J.activing){var k=J.activing,w=J.getCurrentSelectintStatus(),T=J._interactor;if(w!==mq.Curve.PointType.Straight){var s=k.pairs;k.hlpair,k.hltype;var v=k.selections,r=k.editingCtrl;if(s&&!v){var j,L,Y;for(L=0,Y=s.length;Y>L;L++)j=s[L],r&&L===r.pairId&&j[r.type]?mq.Icons.DrawIcon(T,l,mq.Icons.ShapeActivingCtrl,{point:j.point,c1:j.c1,c2:j.c2,hl:r.type}):mq.Icons.DrawIcon(T,l,mq.Icons.ShapeActivingCtrl,j)}}mq.Icons.DrawIcon(T,l,mq.Icons.ShapeHighlighRealPoint,J.activing.point),v&&v.forEach(function(g){mq.Icons.DrawIcon(T,l,mq.Icons.ShapeHighlighRealPoint,g)})}},Gf.prototype.clear=function(){var I=this;I.editing=null,I._guideInfo=null,I.activing=null,I.highlight=null},Gf.prototype._42=function(W){var C=this;C.info={},C.editing||(C.screenInfo=null);var d=C._interactor;if(!d.editDetail)return C.clear(),void 0;if(!C.target||!C._interactor.gv.isSelected(C.target)||!C._interactor.gv.isVisible(C.target))return d.editDetail=!1,C.clear(),void 0;if(C.gatherSingleTarget(d.gv,C.target),mq.Icons.DrawIcon(d,W,mq.Icons.ShapeBgCurve,C.screenInfo),C._drawHighlight(W),C._drawCurrentPoint(W),C._getRealPoint().forEach(function(f){mq.Icons.DrawIcon(d,W,mq.Icons.ShapePoint,f)}),C._drawGuide(W),C.tipInfo&&mq.Icons.DrawIcon(d,W,mq.Icons.TipHelper,C.tipInfo),C._edgeHostGuideInfo&&mq.Icons.DrawIcon(d,W,mq.Icons.NodeHoverGuide,C._edgeHostGuideInfo),C._interactor.getStyle("curveElevationVisible")&&C.target instanceof c.Polyline&&C.activing){var F=C.activing.getCurrentEditingPoint();F&&mq.Icons.DrawIcon(d,W,mq.Icons.EdgeElevationGuide,F)}},Gf.prototype._getRealPoint=function(){var U=this.screenInfo,f=U.P,e=U.S,L=-1,R=[];return e.each(function(n){var Y=1;if(3===n)Y=2;else if(4===n)Y=3;else if(5===n)return;L+=Y,R.push({x:f[2*L],y:f[2*L+1]})}),R};var Nc=mq.MoveHelper=function(p){var U=this;U.catalog="Move",U._interactor=p};Nc.prototype={},Nc.prototype.constructor=Nc,Nc.prototype.calcShift=function(v,Y,X){var r,K,$=this,z=$._interactor.gv,A=z.lp(Y);if("beginMove"===v&&$._gatherGridInfo(X._lastLogicalPoint||A),r=$._target){var m=r.downPosition;if(m){var u=$._interactor.getStyle("moveSensitivity")/z._zoom;if(m.distanceTo(A)<u)return{x:0,y:0};delete r.downPosition}var S;K=c.Default.isShiftDown(Y),K&&(A=$._dealShiftDown(A),S=r.shiftGuide.dir);var e,I=r.rawPos={x:r.pos.x+A.x-r.lp.x,y:r.pos.y+A.y-r.lp.y};if(c.Default.isCtrlDown(Y)){if(e=$._calcShiftByAddon(),$._target.node instanceof mq.Group){var x=$._target.node;x._position.x+=e.x,x._position.y+=e.y}return e}for(var E,s=r.x+I.x,f=r.y+I.y,l={x:s,y:f},h={x:s+r.w/2,y:f+r.h/2},k={x:s+r.w,y:f+r.h},P=$._interactor.rectGuide,b=$._interactor.gridGuide,g=[P.findClosest(l,S),P.findClosest(h,S),P.findClosest(k,S),b.findClosest(l,S),b.findClosest(h,S),b.findClosest(k,S)],U=1/0,G=1/0,N=0,w=g.length;w>N;N++)E=g[N],E&&(s=E.x,f=E.y,isFinite(s)&&Math.abs(s)<Math.abs(U)&&(U=s),isFinite(f)&&Math.abs(f)<Math.abs(G)&&(G=f));if(isFinite(U)||(U=0),isFinite(G)||(G=0),e=$._calcShiftByAddon(U,G),$._target.node instanceof mq.Group){var x=$._target.node;x._position.x+=e.x,x._position.y+=e.y}var J=r.node;if(!Yj(J,z)){var F=I.x+U,T=I.y+G;$._interactor.rectGuide.gatherLines({node:J,x:r.x+F,y:r.y+T,w:r.w,h:r.h},S)}return e}},Nc.prototype._calcShiftByAddon=function(V,R){var D=this._target,e=D.rawPos,Q=D.node.getPosition();return V=V||0,R=R||0,{x:e.x-Q.x+V,y:e.y-Q.y+R}},Nc.prototype._dealShiftDown=function(p){var U=this,Q=U._target.shiftGuide,k=U._target.lp,L=Math.abs(p.x-k.x),N=Math.abs(p.y-k.y);L>N&&L>Q.limit&&"y"===Q.dir&&(Q.dir="x"),N>L&&N>Q.limit&&"x"===Q.dir&&(Q.dir="y");var Y=Q.dir;return"x"===Y?(p.y=k.y,Q.limit=Math.max(Q.limit,L)):"y"===Y&&(p.x=k.x,Q.limit=Math.max(Q.limit,N)),p},Nc.prototype._gatherGridInfo=function(w){var H,P=this,k=P._interactor,b=k._getValidSelection();if(1===b.length){if(H=b[0],!H.getRect)return P._target=null,void 0}else if(H=mq.Group.findOrCreateGroup(b),!H)return P._target=null,void 0;var I=H.getPosition(),X=H.getRect();P._target={node:H,x:X.x-I.x,y:X.y-I.y,w:X.width,h:X.height,lp:{x:w.x,y:w.y},pos:{x:I.x,y:I.y},shiftGuide:{dir:"x",limit:0},downPosition:new mq.Math.Vector2(w)},k.rectGuide.gatherRects()},Nc.prototype.clear=function(){var e=this;e._interactor.rectGuide.clear(),e._interactor._42()};var Qp="directional",kl="point",_m="spot",hc="light.color",uo=function(z,G){Fm(G)&&Jn.test(G)?Of(z,G):Sg(G)&&G.modelType?Nn(z,G):Mo[z]=G},Ch=function(Y){if(Sg(Y))return Y;var c=Mo[Y];return Y&&c===w&&Jn.test(Y)&&(ce&&ce[Y]||Of(Y,Y)),c};se(Z,{graph3dViewAttributes:s,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:_/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:_l,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:_/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,setShape3dModel:uo,getShape3dModel:Ch,createMatrix:function(h,c){Dc(h)||(h=[h]);
for(var o=h.length-1;o>=0;o--){var e=h[o];c=Fb(e.mat,e.s3,e.r3,e.rotationMode,e.t3,c)}return c},transformVec:function(v,q){return kh(v,q)},createBoxModel:function(){return{vs:ll,ns:tb,uv:ih,is:$r}},createRoundRectModel:function(R,E){return Rq.roundRect(R,E)},createStarModel:function(W,a){return Rq.star(W,a)},createRectModel:function(p,C){return Rq.rect(p,C)},createTriangleModel:function(_,K){return Rq.triangle(_,K)},createRightTriangleModel:function(y,p){return Rq.rightTriangle(y,p)},createParallelogramModel:function(E,B){return Rq.parallelogram(E,B)},createTrapezoidModel:function(Z,v){return Rq.trapezoid(Z,v)},createSmoothSphereModel:function(e,l,w,o,Z,u,y){return $m(new Dh(e,l,w,o,Z,u,y))},createSphereModel:function(I,k,g,v,c,M){return I?Jb(I,k,g,v,c,M):Z.createSmoothSphereModel()},createSmoothConeModel:function(a,i,X,N,r){return yr(a,i,X,N,r)},createConeModel:function(z,O,b,J,R,K){return z?er(z,O,b,J,R,K):yr(K)},createSmoothCylinderModel:function(U,g,e,o,J,E,v,h){return $m(new Mg(U,g,e,o,J,E,v,h))},createCylinderModel:function(x,j,L,h,e,z,d){return x?fb(x,j,L,h,e,z,d):fi(z,d)},createSmoothTorusModel:function(M,i,Q,d,K,T){return $m(new xd(M,i,Q,d,K,T))},createTorusModel:function(w,t,N,H,X,k,g){return w?eo(w,t,N,H,X,k,g):Ej(k,g)},createExtrusionModel:function(Y,E,e,I,Q,H,K,b){return xm(Y,E,e,I,Q,H,K,b)},createSmoothRingModel:function(d,m,j,z,o,G){for(var y=[],e=0;e<d.length-1;e+=2)y.push({x:d[e],y:d[e+1]});for(d=kb(y,m,j)[0],y=[],e=0;e<d.length;e++){var P=d[e];y.push(new tc(P.x,0,P.y))}return $m(new tk(y,G,z,o))},createTextGeometry:function($,y){return $m(new lr($,y))},loadFontFace:function(W,V){Z.xhrLoad(W,function(P){if(!P)return V();var K;try{K=JSON.parse(P)}catch(U){K=JSON.parse(P.substring(65,P.length-2))}Hk.loadFace(K),V&&V(K.familyName.toLowerCase())},V?null:{sync:!0})},getRotationFromMatrix4:function(){var w={};return function(Z,n,O){var E=Y,f=Z[0],k=Z[4],x=Z[8],S=Z[1],m=Z[5],d=Z[9],L=Z[2],e=Z[6],i=Z[10];if(n=n||"xyz",n=n[2]+n[1]+n[0],n=n.toUpperCase(),"XYZ"===n)w._y=Math.asin(E(x,-1,1)),Math.abs(x)<.99999?(w._x=Math.atan2(-d,i),w._z=Math.atan2(-k,f)):(w._x=Math.atan2(e,m),w._z=0);else if("YXZ"===n)w._x=Math.asin(-E(d,-1,1)),Math.abs(d)<.99999?(w._y=Math.atan2(x,i),w._z=Math.atan2(S,m)):(w._y=Math.atan2(-L,f),w._z=0);else if("ZXY"===n)w._x=Math.asin(E(e,-1,1)),Math.abs(e)<.99999?(w._y=Math.atan2(-L,i),w._z=Math.atan2(-k,m)):(w._y=0,w._z=Math.atan2(S,f));else if("ZYX"===n)w._y=Math.asin(-E(L,-1,1)),Math.abs(L)<.99999?(w._x=Math.atan2(e,i),w._z=Math.atan2(S,f)):(w._x=0,w._z=Math.atan2(-k,m));else if("YZX"===n)w._z=Math.asin(E(S,-1,1)),Math.abs(S)<.99999?(w._x=Math.atan2(-d,m),w._y=Math.atan2(-L,f)):(w._x=0,w._y=Math.atan2(x,i));else{if("XZY"!==n)return null;w._z=Math.asin(-E(k,-1,1)),Math.abs(k)<.99999?(w._x=Math.atan2(e,m),w._y=Math.atan2(x,f)):(w._x=Math.atan2(-d,i),w._y=0)}return O?(O[0]=w._x,O[1]=w._y,O[2]=w._z,O):[w._x,w._y,w._z]}}(),createRingModel:function(Q,$,X,C,i,r,H,M,I,U){for(var K=[],A=0;A<Q.length-1;A+=2)K.push({x:Q[A],y:Q[A+1]});r=r||Z.shapeSide,H=H||0,M=M||r;var D,E,Y,v,d,u,S,g,W,z,A,O,J,R,b,T,h,e,f=[],q=[],c=I?[]:s,G=I?[]:s,p=U?[]:s,l=U?[]:s,w=C?[]:s,x=C?[]:s,m=i?[]:s,N=i?[]:s,Q=kb(K,$,X),V=je(Q),y=0,k=2*Math.PI/r;return Q.forEach(function(L){if(Y=L.length,Y>1){if(v=L[0],C)for(u=v.x,g=v.y,A=H;M>A;A++)O=A+1,J=A*k,R=O*k,b=P(J),T=t(J),h=P(R),e=t(R),w.push(b*u,g,-T*u,h*u,g,-e*u,0,g,0),x.push(.5-.5*b,.5-.5*T,.5-.5*h,.5-.5*e,.5,.5);for(z=0;Y>z;z++){for(d=L[z],u=v.x,S=d.x,g=v.y,W=d.y,D=y/V,y+=dq(v,d),E=y/V,A=H;M>A;A++)O=A+1,J=A*k,R=O*k,b=P(J),T=t(J),h=P(R),e=t(R),f.push(b*S,W,-T*S,h*S,W,-e*S,b*u,g,-T*u,h*S,W,-e*S,h*u,g,-e*u,b*u,g,-T*u),q.push(A/r,E,O/r,E,A/r,D,O/r,E,O/r,D,A/r,D),I&&A===H&&(c.push(0,g,0,0,W,0,b*S,W,-T*S,b*S,W,-T*S,b*u,g,-T*u,0,g,0),G.push(0,.5-g,0,.5-W,2*S,.5-W,2*S,.5-W,2*u,.5-g,0,.5-g)),U&&O===M&&(p.push(0,g,0,h*S,W,-e*S,0,W,0,h*S,W,-e*S,0,g,0,h*u,g,-e*u),l.push(1,.5-g,1-2*S,.5-W,1,.5-W,1-2*S,.5-W,1,.5-g,1-2*u,.5-g));v=d}if(i)for(u=v.x,g=v.y,A=H;M>A;A++)O=A+1,J=A*k,R=O*k,b=P(J),T=t(J),h=P(R),e=t(R),m.push(h*u,g,-e*u,b*u,g,-T*u,0,g,0),N.push(.5-.5*h,.5+.5*e,.5-.5*b,.5+.5*T,.5,.5)}}),{vs:f,uv:q,bottom_vs:m,bottom_uv:N,top_vs:w,top_uv:x,from_vs:c,from_uv:G,to_vs:p,to_uv:l}}},!0),se(k,{"3d.move.mode":w,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":w,"edge.gradient.color":w,"edge.source.t3":w,"edge.target.t3":w,"light.type":kl,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":_/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":Wp,"wf.short":!1,"wf.mat":w,"wf.geometry":!1,batch:w,"transparent.mask":!1,brightness:w,"select.brightness":.7,"repeat.uv.length":w,alphaTest:.4,"label.face":ad,"label.t3":w,"label.r3":w,"label.texture.scale":2,"label.rotationMode":Cp,"label.light":!1,"label.blend":w,"label.reverse.flip":!1,"label.reverse.color":ei,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":ad,"label2.t3":w,"label2.r3":w,"label2.texture.scale":2,"label2.rotationMode":Cp,"label2.light":!1,"label2.blend":w,"label2.reverse.flip":!1,"label2.reverse.color":ei,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":ad,"note.t3":w,"note.r3":w,"note.texture.scale":2,"note.rotationMode":Cp,"note.light":!1,"note.blend":w,"note.reverse.flip":!1,"note.reverse.color":ei,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":ad,"note2.t3":w,"note2.r3":w,"note2.texture.scale":2,"note2.rotationMode":Cp,"note2.light":!1,"note2.blend":w,"note2.reverse.flip":!1,"note2.reverse.color":ei,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:w,"shape3d.color":dl,"shape3d.top.color":w,"shape3d.bottom.color":w,"shape3d.from.color":w,"shape3d.to.color":w,"shape3d.image":w,"shape3d.top.image":w,"shape3d.bottom.image":w,"shape3d.from.image":w,"shape3d.to.image":w,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":w,"shape3d.side.to":w,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":w,"shape3d.opacity":w,"shape3d.reverse.flip":!1,"shape3d.reverse.color":ei,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":w,"shape3d.uv.scale":w,"shape3d.top.uv.offset":w,"shape3d.top.uv.scale":w,"shape3d.bottom.uv.offset":w,"shape3d.bottom.uv.scale":w,"shape3d.from.uv.offset":w,"shape3d.from.uv.scale":w,"shape3d.to.uv.offset":w,"shape3d.to.uv.scale":w,"shape3d.top.cap":w,"shape3d.bottom.cap":w,"shape3d.start.angle":0,"shape3d.sweep.angle":v,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":w,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"all.light":!0,"all.visible":!0,"all.color":dl,"all.image":w,"all.blend":w,"all.opacity":w,"all.reverse.flip":!1,"all.reverse.color":ei,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":w,"all.uv.offset":w,"all.uv.scale":w,"all.discard.selectable":!0,mat:w,"left.mat":w,"right.mat":w,"top.mat":w,"bottom.mat":w,"front.mat":w,"back.mat":w},!0);var bl,ro=!1,Ie=[0,0,0,0],Io={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:Zq,2:Oi,3:Tp,4:Rk,5:ad,6:Ed}},yl=function(i,t,V,D){if(t.getFaceVisible(i,V)){gk(t,vj(i,t.getFaceMat(i,V)||t.getMat(i)));var w=t._26I;t.getFaceReverseCull(i,V)?w.enable(w.CULL_FACE):w.disable(w.CULL_FACE),so(w,t._prg.uFixPickReverseColor,Io[V]),go(w),fn(w,D,6),Pc(w),jd(t)}},ok=function(o){return o instanceof Vm},cf=function(P){return[P.x,P.e||0,P.y]},Pg=function(G,N,W){for(var N=Xe(N),R=N[0],c=N[1],f=N[2];W--;)G.push(R,c,f)},Xn=function(V,p,Y){for(var p=Xe(p),F=p[0],z=p[1],n=p[2],A=p[3];Y--;)V.push(F,z,n,A)},wn=function(s,$,U){if($)for(var r,d,l,N=$[0],x=$[1],T=$[2],D=$[4],b=$[5],P=$[6],C=$[8],j=$[9],A=$[10],L=$[12],m=$[13],e=$[14],W=U.length,i=0,i=0;W>i;i+=3)r=U[i],d=U[i+1],l=U[i+2],s.push(N*r+D*d+C*l+L,x*r+b*d+j*l+m,T*r+P*d+A*l+e);else wm(s,U)},vr=function(K,O){var o=O.s("light.intensity"),F=Xe(O.s(hc)),P=F[0],R=F[1],v=F[2];1!==o&&(P*=o,R*=o,v*=o),K.push(P,R,v,O.s("light.disabled")?1:0)},Fk=function(E,$,o){so($,o.uHeadlightRange,E._headlightRange);var z=E._headlightIntensity,J=Xe(E._headlightColor);1!==z&&(J=[J[0]*z,J[1]*z,J[2]*z]),so($,o.uHeadlightColor,[J[0],J[1],J[2],E._headlightDisabled?1:0]);var i=E._59O,W=E._spots,q=E._dirs;if(i.length){var x=[],_=[],U=[];i.forEach(function(l){vr(x,l),wm(_,E._transformPointToViewSpace(l.p3())),U.push(l.s("light.range"))}),$.uniform4fv(o.uPointColor,x),$.uniform1fv(o.uPointRange,U),$.uniform3fv(o.uPointPosition,_)}if(W.length){var A=[],m=[],S=[],N=[],j=[],M=[];W.forEach(function(o){vr(A,o),wm(m,E._transformPointToViewSpace(o.p3())),wm(j,E._transformDirectionToViewSpace(o.p3(),o.s("light.center"))),S.push(o.s("light.range")),N.push(P(o.s("light.angle")/2)),M.push(o.s("light.exponent"))}),$.uniform4fv(o.uSpotColor,A),$.uniform1fv(o.uSpotRange,S),$.uniform1fv(o.uSpotAngle,N),$.uniform1fv(o.uSpotExponent,M),$.uniform3fv(o.uSpotPosition,m),$.uniform3fv(o.uSpotDirection,j)}if(q.length){var I=[],a=[];q.forEach(function(g){vr(I,g),wm(a,E._transformDirectionToViewSpace(g.p3()))}),$.uniform4fv(o.uDirColor,I),$.uniform3fv(o.uDirDirection,a)}},sh=function(X){return X>0&&0===(X-1&X)},Sf=function(W){return W=M(0,d(_,W)),W=M(sg,d(_-sg,W))},pp=function(){return.05+X()/2},nh=function(m,s,P,O){var $,x=m.getEye();return m.isOrtho()?($=Wj(m.getCenter(),x),$[0]+=O[0],$[1]+=O[1],$[2]+=O[2]):$=x,Nr(s,P,O,$)},Nr=function($,w,J,V){var K=Eq($,w),n=Wj(V,J,!0),l=Eq(n,w);if(A(l)<sg)return s;var k=(K-Eq(J,w))/l;return[J[0]+n[0]*k,J[1]+n[1]*k,J[2]+n[2]*k]},pk=function(z,o){return{x:2*z.x-o.x,y:2*z.y-o.y}},ak=function(L,I,N,T){var W,S;if(!L)return W=o(I.y-N.y,N.x-I.x),{x:I.x+T*t(W),y:I.y+T*P(W)};if(!N)return W=o(L.y-I.y,I.x-L.x),{x:I.x+T*t(W),y:I.y+T*P(W)};var q=Wj([L.x,L.y,0],[I.x,I.y,0],!0),k=Wj([N.x,N.y,0],[I.x,I.y,0],!0),w=-(q[0]+k[0])/2,n=-(q[1]+k[1])/2,z=O(w*w+n*n);if(sg>z)return W=o(L.y-I.y,I.x-L.x),{x:I.x+T*t(W),y:I.y+T*P(W)};var d=L.x-I.x,x=L.y-I.y,G=N.x-I.x,e=N.y-I.y,U=O(d*d+x*x),Z=O(G*G+e*e);W=r(Eq(q,k))/2,S=q[1]*k[0]-q[0]*k[1]>0?-1:1,w/=z,n/=z;var h=T/t(W),y=M(U,Z)/P(W);z=Math.min(h,y);var b={x:I.x+S*z*w,y:I.y+S*z*n};return N.b&&h>Z/P(W)&&(b.adjust=!0),b},Cb=function(k){var Q=k[1],H=k[2],l=k[3],u=k[6],g=k[7],W=k[11];k[1]=k[4],k[2]=k[8],k[3]=k[12],k[4]=Q,k[6]=k[9],k[7]=k[13],k[8]=H,k[9]=u,k[11]=k[14],k[12]=l,k[13]=g,k[14]=W},jf=function(b){var P=b[0],M=b[1],B=b[2],C=b[3],n=b[4],L=b[5],Y=b[6],A=b[7],D=b[8],G=b[9],N=b[10],_=b[11],k=b[12],g=b[13],Z=b[14],I=b[15],O=P*L-M*n,l=P*Y-B*n,q=P*A-C*n,e=M*Y-B*L,h=M*A-C*L,U=B*A-C*Y,F=D*g-G*k,u=D*Z-N*k,Q=D*I-_*k,j=G*Z-N*g,w=G*I-_*g,m=N*I-_*Z,i=O*m-l*w+q*j+e*Q-h*u+U*F;return i?(i=1/i,b[0]=(L*m-Y*w+A*j)*i,b[1]=(B*w-M*m-C*j)*i,b[2]=(g*U-Z*h+I*e)*i,b[3]=(N*h-G*U-_*e)*i,b[4]=(Y*Q-n*m-A*u)*i,b[5]=(P*m-B*Q+C*u)*i,b[6]=(Z*q-k*U-I*l)*i,b[7]=(D*U-N*q+_*l)*i,b[8]=(n*w-L*Q+A*F)*i,b[9]=(M*Q-P*w-C*F)*i,b[10]=(k*h-g*q+I*O)*i,b[11]=(G*q-D*h-_*O)*i,b[12]=(L*u-n*j-Y*F)*i,b[13]=(P*j-M*u+B*F)*i,b[14]=(g*l-k*e-Z*O)*i,b[15]=(D*e-G*l+N*O)*i,void 0):s},Ih=function(r,k){if(k){var P=k[0],H=k[1],R=k[2];r[12]=r[0]*P+r[4]*H+r[8]*R+r[12],r[13]=r[1]*P+r[5]*H+r[9]*R+r[13],r[14]=r[2]*P+r[6]*H+r[10]*R+r[14],r[15]=r[3]*P+r[7]*H+r[11]*R+r[15]}},Ld=function(g,A){if(A){var s=A[0],z=A[1],B=A[2];g[0]=g[0]*s,g[1]=g[1]*s,g[2]=g[2]*s,g[3]=g[3]*s,g[4]=g[4]*z,g[5]=g[5]*z,g[6]=g[6]*z,g[7]=g[7]*z,g[8]=g[8]*B,g[9]=g[9]*B,g[10]=g[10]*B,g[11]=g[11]*B}},nc=function(j,P,m){var J=P[0],K=P[1],D=P[2],S=P[3],G=P[4],u=P[5],p=P[6],C=P[7],$=P[8],k=P[9],M=P[10],x=P[11],Z=P[12],O=P[13],T=P[14],I=P[15],H=m[0],b=m[1],V=m[2],E=m[3];return j[0]=H*J+b*G+V*$+E*Z,j[1]=H*K+b*u+V*k+E*O,j[2]=H*D+b*p+V*M+E*T,j[3]=H*S+b*C+V*x+E*I,H=m[4],b=m[5],V=m[6],E=m[7],j[4]=H*J+b*G+V*$+E*Z,j[5]=H*K+b*u+V*k+E*O,j[6]=H*D+b*p+V*M+E*T,j[7]=H*S+b*C+V*x+E*I,H=m[8],b=m[9],V=m[10],E=m[11],j[8]=H*J+b*G+V*$+E*Z,j[9]=H*K+b*u+V*k+E*O,j[10]=H*D+b*p+V*M+E*T,j[11]=H*S+b*C+V*x+E*I,H=m[12],b=m[13],V=m[14],E=m[15],j[12]=H*J+b*G+V*$+E*Z,j[13]=H*K+b*u+V*k+E*O,j[14]=H*D+b*p+V*M+E*T,j[15]=H*S+b*C+V*x+E*I,j},Sr=function(P,I,W,S){var L,r,Q,X,m,F,D,y,J,$,z=I[0],o=I[1],_=I[2],w=S[0],x=S[1],R=S[2],n=W[0],p=W[1],B=W[2];return A(z-n)<sg&&A(o-p)<sg&&A(_-B)<sg?mg(P):(D=z-n,y=o-p,J=_-B,$=1/O(D*D+y*y+J*J),D*=$,y*=$,J*=$,L=x*J-R*y,r=R*D-w*J,Q=w*y-x*D,$=O(L*L+r*r+Q*Q),$?($=1/$,L*=$,r*=$,Q*=$):(L=0,r=0,Q=0),X=y*Q-J*r,m=J*L-D*Q,F=D*r-y*L,$=O(X*X+m*m+F*F),$?($=1/$,X*=$,m*=$,F*=$):(X=0,m=0,F=0),P[0]=L,P[1]=X,P[2]=D,P[3]=0,P[4]=r,P[5]=m,P[6]=y,P[7]=0,P[8]=Q,P[9]=F,P[10]=J,P[11]=0,P[12]=-(L*z+r*o+Q*_),P[13]=-(X*z+m*o+F*_),P[14]=-(D*z+y*o+J*_),P[15]=1,P)},cm=function(N,i,Y,u,U){var X=1/l(i/2),k=1/(u-U);return N[0]=X/Y,N[1]=0,N[2]=0,N[3]=0,N[4]=0,N[5]=X,N[6]=0,N[7]=0,N[8]=0,N[9]=0,N[10]=(U+u)*k,N[11]=-1,N[12]=0,N[13]=0,N[14]=2*U*u*k,N[15]=0,N},fq=function(o,A,S,z,s,F,H){var d=1/(A-S),B=1/(z-s),u=1/(F-H);return o[0]=-2*d,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*B,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*u,o[11]=0,o[12]=(A+S)*d,o[13]=(s+z)*B,o[14]=(H+F)*u,o[15]=1,o},Hl=function(C,E){var i=E[0],t=E[1],z=E[2],Y=E[3],c=i*i+t*t+z*z+Y*Y,m=c?1/c:0;return C[0]=-i*m,C[1]=-t*m,C[2]=-z*m,C[3]=Y*m,C},Gj=function(x,r){var g=r[0]+r[5]+r[10],z=0;return g>0?(z=2*Math.sqrt(g+1),x[3]=.25*z,x[0]=(r[6]-r[9])/z,x[1]=(r[8]-r[2])/z,x[2]=(r[1]-r[4])/z):r[0]>r[5]&r[0]>r[10]?(z=2*Math.sqrt(1+r[0]-r[5]-r[10]),x[3]=(r[6]-r[9])/z,x[0]=.25*z,x[1]=(r[1]+r[4])/z,x[2]=(r[8]+r[2])/z):r[5]>r[10]?(z=2*Math.sqrt(1+r[5]-r[0]-r[10]),x[3]=(r[8]-r[2])/z,x[0]=(r[1]+r[4])/z,x[1]=.25*z,x[2]=(r[6]+r[9])/z):(z=2*Math.sqrt(1+r[10]-r[0]-r[5]),x[3]=(r[1]-r[4])/z,x[0]=(r[8]+r[2])/z,x[1]=(r[6]+r[9])/z,x[2]=.25*z),x},Kk=function(R,k,h){var Q=k[0],A=k[1],V=k[2],u=k[3],Y=Q+Q,T=A+A,z=V+V,g=Q*Y,F=Q*T,i=Q*z,D=A*T,y=A*z,v=V*z,Z=u*Y,C=u*T,H=u*z;return R[0]=1-(D+v),R[1]=F+H,R[2]=i-C,R[3]=0,R[4]=F-H,R[5]=1-(g+v),R[6]=y+Z,R[7]=0,R[8]=i+C,R[9]=y-Z,R[10]=1-(g+D),R[11]=0,R[12]=h[0],R[13]=h[1],R[14]=h[2],R[15]=1,R},Hc=Z.getRotationFromMatrix4,rk=function(){var p=[0,0,0],J=[0,0,0],r=[0,0,0],M=function(R,g,j){R[0]=g[1]*j[2]-g[2]*j[1],R[1]=g[2]*j[0]-g[0]*j[2],R[2]=g[0]*j[1]-g[1]*j[0]},O=function(a){return a[0]*a[0]+a[1]*a[1]+a[2]*a[2]},H=function(h){var i=Math.sqrt(O(h));h[0]/=i,h[1]/=i,h[2]/=i},T=function(c,w,X){c[0]=w[0]-X[0],c[1]=w[1]-X[1],c[2]=w[2]-X[2]};return function(W,G,R){var X=kr();return T(r,W,G),0===O(r)&&(r[2]=1),H(r),M(p,R,r),0===O(p)&&(1===Math.abs(R[2])?r[0]+=1e-4:r[2]+=1e-4,H(r),M(p,R,r)),H(p),M(J,r,p),X[0]=p[0],X[4]=J[0],X[8]=r[0],X[1]=p[1],X[5]=J[1],X[9]=r[1],X[2]=p[2],X[6]=J[2],X[10]=r[2],X}}(),xb=function(E,q){if(E.vr.enable){var v=E.vr.getViewMatrix(q);if(v)return v}return Sr(q?q:kr(),E._eye,E._center,E._up)},Dn=function(X){if(X.vr.enable){var g=X.vr.getProjectMatrix();if(g)return g}var c=X.getAspect(),S=X._near,O=X._far,i=kr();if(X._ortho){var q=X._orthoWidth/2,h=q/c;fq(i,-q,q,-h,h,S,O)}else cm(i,X._fovy,c,S,O);return i},gs=function(e,d){if(!e)return s;var q=0,E=1,I=2,F=[],R=0,f=e.length,P=f/3;if(d){for(;f>R;R++)F[R]=0;for(R=0;R<d.length;R+=3){var J=[],T=[],c=[];J[q]=e[3*d[R+1]+q]-e[3*d[R]+q],J[E]=e[3*d[R+1]+E]-e[3*d[R]+E],J[I]=e[3*d[R+1]+I]-e[3*d[R]+I],T[q]=e[3*d[R+2]+q]-e[3*d[R+1]+q],T[E]=e[3*d[R+2]+E]-e[3*d[R+1]+E],T[I]=e[3*d[R+2]+I]-e[3*d[R+1]+I],c[q]=J[E]*T[I]-J[I]*T[E],c[E]=J[I]*T[q]-J[q]*T[I],c[I]=J[q]*T[E]-J[E]*T[q];for(var o=0;3>o;o++)F[3*d[R+o]+q]+=c[q],F[3*d[R+o]+E]+=c[E],F[3*d[R+o]+I]+=c[I]}}else for(R=0;P>R;R+=3){var J=[],T=[],c=[];J[q]=e[3*(R+1)+q]-e[3*R+q],J[E]=e[3*(R+1)+E]-e[3*R+E],J[I]=e[3*(R+1)+I]-e[3*R+I],T[q]=e[3*(R+2)+q]-e[3*(R+1)+q],T[E]=e[3*(R+2)+E]-e[3*(R+1)+E],T[I]=e[3*(R+2)+I]-e[3*(R+1)+I],c[q]=J[E]*T[I]-J[I]*T[E],c[E]=J[I]*T[q]-J[q]*T[I],c[I]=J[q]*T[E]-J[E]*T[q];for(var o=0;3>o;o++)F[3*(R+o)+q]=c[q],F[3*(R+o)+E]=c[E],F[3*(R+o)+I]=c[I]}for(R=0;f>R;R+=3){var Z=[];Z[q]=F[R+q],Z[E]=F[R+E],Z[I]=F[R+I];var n=O(Z[q]*Z[q]+Z[E]*Z[E]+Z[I]*Z[I]);0===n&&(n=sg),Z[q]=Z[q]/n,Z[E]=Z[E]/n,Z[I]=Z[I]/n,F[R+q]=Z[q],F[R+E]=Z[E],F[R+I]=Z[I]}return new Jm(F)},Am=function(g,i,d,e){if(d||(d=g.createTexture()),i){var b=g.TEXTURE_2D,m=g.REPEAT,I=g.CLAMP_TO_EDGE,J=g.TEXTURE_MIN_FILTER;e!==g.NEAREST&&(e=g.LINEAR),bb(g,d),g.texImage2D(b,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,i),Xm(g,g.TEXTURE_MAG_FILTER,e),sh(i.width)&&sh(i.height)&&!i.clampToEdge?(Xm(g,g.TEXTURE_WRAP_S,m),Xm(g,g.TEXTURE_WRAP_T,m),Xm(g,J,g.LINEAR_MIPMAP_LINEAR),g.generateMipmap(b)):(Xm(g,g.TEXTURE_WRAP_S,I),Xm(g,g.TEXTURE_WRAP_T,I),Xm(g,J,e)),bb(g,s)}return d},ne=function(H,n){var u=new Uint8Array(3);return n=n||H.createTexture(),bb(H,n),Xm(H,H.TEXTURE_MIN_FILTER,H.LINEAR),H.texImage2D(H.TEXTURE_2D,0,H.RGB,1,1,0,H.RGB,H.UNSIGNED_BYTE,u),n},bc=function(h){h._26I&&h._prg&&(h._26I.deleteProgram(h._prg),h._prg=s)},el=function(g,G,q,f){var P=g.createShader(q);return g.shaderSource(P,f),g.compileShader(P),g.attachShader(G,P),P},Le=function(X){return X.createBuffer()},bb=function(l,U){l.bindTexture(l.TEXTURE_2D,U)},ve=function(d,b){d.bindFramebuffer(d.FRAMEBUFFER,b)},Xm=function(t,g,B){t.texParameteri(t.TEXTURE_2D,g,B)},oe=function(b,K){if(K){var K=Xe(K);b.clearColor(K[0],K[1],K[2],K[3])}},yo=function(a,e){so(a,e.uFix,!0),Go(a,e.aNormal)},pn=function(S,a){so(S,a.uFix,!1),Kl(S,a.aNormal)},xk=function(D,V,u,o,X,i,U,$){D._picking||(u?(so(D,V.uBlend,!0),so(D,V.uBlendColor,u)):so(D,V.uBlend,!1),so(D,V.uLight,o==s?!0:o),Rb(X)&&1!==X&&so(D,V.uPartOpacity,X),so(D,V.uReverseFlip,i==s?!1:i),so(D,V.uFixPickReverseColor,U||ei)),$?D.enable(D.CULL_FACE):D.disable(D.CULL_FACE)},fe=function(D,j){D._picking||so(D,j.uPartOpacity,1)},go=function(n,O,H,i,g,S,z,Z,h){if(!H)return n.activeTexture(n.TEXTURE0),bb(n,n._emptyTexture),n.activeTexture(n.TEXTURE1),bb(n,n._emptyBlendTexture),void 0;so(n,O.uTexture,!0),so(n,O.uDiscardSelectable,vs(i)?i:!0),Kl(n,O.aUv),Td(n,g,S,O.aUv,2),h?(so(n,O.uBlendTexture,!0),n.activeTexture(n.TEXTURE1),bb(n,h),n.uniform1i(O.uBlendSampler,1)):(so(n,O.uBlendTexture,!1),n.activeTexture(n.TEXTURE1),bb(n,n._emptyBlendTexture)),n.activeTexture(n.TEXTURE0),bb(n,H),n.uniform1i(O.uSampler,0);var J=[0,0,1,1];z&&(J[0]=z[0],J[1]=z[1]),Z&&(J[2]=Z[0],J[3]=Z[1]),so(n,O.uOffsetScale,J)},Pc=function(D,w,h){D.activeTexture(D.TEXTURE0),bb(D,s),D.activeTexture(D.TEXTURE1),bb(D,s),h&&(Go(D,w.aUv),so(D,w.uTexture,!1),so(D,w.uBlendTexture,!1))},Bo=function(C,A,U,I,K,q){!U||a||f||C.lineWidth(U),I&&!C._picking&&so(C,A.uFixPickReverseColor,I),K&&Td(C,K,q,A.aPosition)},Xc=function(P,N,Y,D){bl&&(D=P[bl]),P.drawArrays(D==s?P.TRIANGLES:D,N,Y);var l=P._renderInfo;l&&(l.calls++,l.vertices+=Y,(D==s||D===P.TRIANGLES)&&(l.faces+=Y/3),D===P.LINES&&(l.lines+=Y/2))},fn=function(K,x,E,V){bl&&(V=K[bl]),K.drawElements(V==s?K.TRIANGLES:V,E,K.UNSIGNED_SHORT,x==s?0:2*x);var F=K._renderInfo;F&&(F.calls++,F.vertices+=E,(V==s||V===K.TRIANGLES)&&(F.faces+=E/3),V===K.LINES&&(F.lines+=E/2))},Ec=function(D,q,g,j,U){var B=D.ARRAY_BUFFER;D.bindBuffer(B,q),g&&D.bufferData(B,g,D.STATIC_DRAW),j!=s&&D.vertexAttribPointer(j,U?U:3,D.FLOAT,!1,0,0)},Td=function(O,n,j,V,Z){return j?(Kh(O,O.ARRAY_BUFFER,n,j),V!=s&&O.vertexAttribPointer(V,Z?Z:3,O.FLOAT,!1,0,0),void 0):Ec(O,n,j,V,Z)},ae=function(k,C,J){var v=k.ELEMENT_ARRAY_BUFFER;k.bindBuffer(v,C),J&&k.bufferData(v,J,k.STATIC_DRAW)},up=function(n,K,h){Kh(n,n.ELEMENT_ARRAY_BUFFER,K,h)},Kh=function(i,W,z,S){var z,H=S.glBuf,u=i._id;H&&(z=H[u])&&z._buf?i.bindBuffer(W,z._buf):(z={_buf:Le(i)},i._bufPool.push(z),i.bindBuffer(W,z._buf),i.bufferData(W,S,i.STATIC_DRAW),H||(H=S.glBuf={}),H[u]=z),z._fid=i._renderInfo.frame},so=function(h,p,g){if(g!=s&&p!=s){g=Xe(g);var z=g.length;3===z?h.uniform3fv(p,g):4===z?h.uniform4fv(p,g):16===z?h.uniformMatrix4fv(p,!1,g):vs(g)?h.uniform1i(p,g?1:0):2===z?h.uniform2fv(p,g):h.uniform1f(p,g)}},Kl=function(D,x){x!=s&&x>=0&&D.enableVertexAttribArray(x)},Go=function(C,R){R!=s&&R>=0&&C.disableVertexAttribArray(R)},jd=function(X,G){var h=X.getGL(),z=X._prg;X._7O=X._8O.pop(),G&&(so(h,z.uMVMatrix,X._7O),X._6O=G,so(h,z.uNMatrix,G))},am=function(F,l){return l||(l=kr()),Nd(l,F),jf(l),Cb(l),l},gk=function(U,S){var M=U.getGL(),T=U._prg,Q=U._7O;S&&(U._8O.push(Do(Q)),nc(Q,Q,S)),so(M,T.uMVMatrix,Q),so(M,T.uNMatrix,am(Q,U._6O))},Tn=function(u,L,d,Y,X,O){if(d){if(Y){var k=d.value++,$=2147483648|k,t=[(255&$>>16)/255,(255&$>>8)/255,(255&$)/255,(255&$>>24)/255];d[k]={data:X,part:O}}else t=Ie;return so(u,L.uFixPickReverseColor,t),t}},Jg=function(){var U={center:function(y,L,U,p,w){var T=-L[1]/2,K={x:-L[0]/2,y:T,width:L[0],height:L[1]},q=ii(y,K,U);return[q.x+p,-q.y-w,pp()]},front:function(r,x,A,i,u){var m=-x[1]/2,e={x:-x[0]/2,y:m,width:x[0],height:x[1]},L=ii(r,e,A);return[L.x+i,-L.y-u,x[2]/2+pp()]},back:function(k,e,O,B,W){var a=-e[0]/2,I=-e[1]/2,A={x:a,y:I,width:e[0],height:e[1]},Z=ii(k,A,O);return[-Z.x-B,-Z.y-W,-e[2]/2-pp()]},left:function(f,j,Q,C,q){var J=-j[1]/2,s={x:-j[2]/2,y:J,width:j[2],height:j[1]},t=ii(f,s,Q);return[-j[0]/2-pp(),-t.y-q,t.x+C]},right:function(g,P,f,K,p){var $=-P[2]/2,v=-P[1]/2,m={x:$,y:v,width:P[2],height:P[1]},o=ii(g,m,f);return[P[0]/2+pp(),-o.y-p,-o.x-K]},top:function(M,P,z,D,B){var $={x:-P[0]/2,y:-P[2]/2,width:P[0],height:P[2]},x=ii(M,$,z);return[x.x+D,P[1]/2+pp(),x.y+B]},bottom:function(h,k,p,Z,e){var w=-k[2]/2,Y={x:-k[0]/2,y:w,width:k[0],height:k[2]},X=ii(h,Y,p);return[X.x+Z,-k[1]/2-pp(),-X.y-e]}};return function(k,G,e,m,J,b){return U[m](k,G,e,J||0,b||0)}}(),pe=function(g,C,n,x,M,b,S,B,z,Y){if(M&&(C[0]+=M[0],C[1]+=M[1],C[2]+=M[2]),Ih(g,n),B){var A=kr();if(Mn(A,z,Y),kh(C,A),Ih(g,C),g.auto=B,g.pos=kh([0,0,0],g),b){var W=g.mat2=kr();Mn(W,b,S)}}else Mn(g,z,Y),Ih(g,C),x===Zq?zq(g,-q):x===Oi?zq(g,q):x===Tp?_o(g,-q):x===Rk?_o(g,q):x===Ed&&zq(g,_),Mn(g,b,S);return g},dk=function(R,c){var M=c.auto,d=c.mat2,L=R.gv;if(M){var Y,v=kr(),K=[0,0,0,0];Y="string"==typeof M?[M.indexOf("x")<0?L._eye[0]:L._center[0],M.indexOf("y")<0?L._eye[1]:L._center[1],M.indexOf("z")<0?L._eye[2]:L._center[2]]:L._eye,Gj(K,Sr(kr(),Y,L._center,L._up)),Kk(v,Hl(K,K),c.pos),d&&nc(v,v,d),gk(L,v)}else gk(L,c)},Hq=function(F,X,P,H,L){var _=F.s,T=F.gv,r=T.getGL(),d=T._prg,Y=T._buffer,m=T._1O;Am(r,Co,m),dk(F,P),xk(r,d,_(X+".blend"),_(X+".light"),_(X+".opacity"),_(X+".reverse.flip"),_(X+".reverse.color"),_(X+".reverse.cull")),go(r,d,m,L,Y.uv,ls),Td(r,Y.vs,H,d.aPosition),Td(r,Y.ns,il,d.aNormal),up(r,Y.is,Gq),fn(r,0,Gq.length),Pc(r,d,m),fe(r,d),jd(T)},Tf=function(a,z,_){var B=a.gv,n=a.data,q=a[z]={blend:B.getBodyColor(n)||B.getFaceBlend(n,z),light:B.getFaceLight(n,z),color:B.getFaceColor(n,z),opacity:B.getFaceOpacity(n,z),transparent:B.getFaceTransparent(n,z),reverseFlip:B.getFaceReverseFlip(n,z),reverseColor:B.getFaceReverseColor(n,z),reverseCull:B.getFaceReverseCull(n,z),texture:B.getFaceImage(n,z),blendTexture:B.getFaceBlendImage(n,z),discardSelectable:B.getFaceDiscardSelectable(n,z)};if("csg"!==z){q.uv=B.getFaceUv(n,z)||_&&_[z+"Uv"],q.uvScale=B.getFaceUvScale(n,z)||_&&_[z+"UvScale"],q.uvOffset=B.getFaceUvOffset(n,z)||_&&_[z+"UvOffset"];var F=B.getFaceMat(n,z);F&&(q.mat=vj(n,F))}return q},cd=function(j,S,t,G,R){if(G){if(!R(G.transparent))return;var N=j.data,_=j.gv,Z=_._buffer,q=_.getTexture(G.texture,N),H=_.getTexture(G.blendTexture,N);go(S,t,q,G.discardSelectable,Z.uv,G.tuv,G.uvOffset,G.uvScale,H),xk(S,t,G.blend,G.light,G.opacity,G.reverseFlip,G.reverseColor,G.reverseCull),so(S,t.uDiffuse,G.color),Td(S,Z.vs,G.vs,t.aPosition),Td(S,Z.ns,G.ns,t.aNormal),Xc(S,0,G.vs.length/3),fe(S,t),Pc(S,t,q)}},Ro=function(w,I,G,C,s,h){var n,J,E,P,K,T,Z,S,o,v,c,B=[C-I,s-G],a=w?w.length:0;for(E=0;a>E;E++){for(P=2,n=w[E],K=n[0],T=n[1];P+1<n.length;){if(Z=n[P],S=n[P+1],J=Qd(I,G,C,s,K,T,Z,S,!0)){o=[Z-K,S-T],v=dq(o),o[0]/=v,o[1]/=v,v=Eq(B,o),v=v>0?h:-h,c=[o[0]*v,o[1]*v];break}K=Z,T=S,P+=2}if(c)break}if(c)for(C=I+c[0],s=G+c[1],E=0;a>E;E++)for(P=2,n=w[E],K=n[0],T=n[1];P+1<n.length;){if(Z=n[P],S=n[P+1],J=Qd(I,G,C,s,K,T,Z,S,!0))return[0,0];K=Z,T=S,P+=2}return c?c:[C-I,s-G]},Hg=c.graph3d={},Fg=function(Y,A,B){xl(H+".graph3d."+Y,A,B)},ir="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",mj="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~<spmpd!>!eJ|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw<*yfusfWw.)f{jmbnspo!>!F!4dfw<*mbnspOw)f{jmbnspo!>!O!4dfw!gjeof$!<ftvggjEv!>!spmpd!ftmf$!~<ftvggjEv!>!spmpd|ftmf~<spmpDidubCw!>!spmpd|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!<spmpd!5dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";se(Z,{setBatchInfo:function(C,j){jh[C]=j},getBatchInfo:function(B){return jh[B]}},!0);var Wc=[1,1,1],Np=[1,0,0,0,0,1,0,1,1,1,1,0],Iq=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],fg=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],hg=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],vh=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],Pm=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],hi=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],rj=function(B,Q){$n(B,Q,"_batchModelMap","_batchIndexMap"),Ao(B,Q,"_wireframeModelMap","_wireframeIndexMap"),Ao(B,Q,"_polylineModelMap","_polylineIndexMap"),Ao(B,Q,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),Ao(B,Q,"_polylineModelMapSwap","_polylineIndexMapSwap")},$n=function(T,$,d,r){if(!$)return T[d]={},T[r]={},void 0;var e=$._id,L=T[r],b=L[e];if(b){var D=T[d],C=b.batch,s=D[C],i=s.ds,z=b.index;if(s.invalidate=!0,delete L[e],i.splice(z,1),Rf(i))return delete D[C],void 0;for(var c=b.begin,J=b.size,B=3*c,o=3*J,x=4*c,Z=4*J,h=s.vs,l=s.ps,W=s.uv,j=s.cs,E=s.bs,w=s.rs,f=s.ns,R=s.ls;z<i.length;z++)b=L[i[z]._id],b.index--,b.begin-=J;h.splice(B,o),l.splice(x,Z),W&&W.splice(2*c,2*J),j&&j.splice(x,Z),E&&E.splice(B,o),w&&w.splice(c,J),f&&f.splice(B,o),R&&R.splice(c,J)}},Ao=$n,Lk=function(q,k,$,S){if(!S)return s;var j=k[S];if(!j){var T=jh[S]||Cc,A=T.image?[]:s;j=k[S]={vs:[],ns:[],uv:A,cs:A?s:T.color?s:[],bs:T.blend?[]:s,ps:[],rs:T.brightness?[]:s,ds:[]}
}return j.invalidate=!0,q[$._id]={index:j.ds.length,begin:j.vs.length/3,batch:S},j.ds.push($),j},ec=function(r,C){return C!=s&&1!==C?[r[0]*C,r[1]*C,r[2]*C,r[3]]:r},Kb=function(g,V,F){var Q=g.getBrightness(V),i=Xe(F.color||"white"),L=i[3]<1,D=Math.ceil(F.width)||1,w=(L?"T":"O")+D,s=g._wireframeIndexMap,J=g._wireframeModelMap,p=J[w];p||(p=J[w]={vs:[],cs:[],ps:[],ds:[],T:L,W:D});var k,N=g.getData3dUI(V),u=Me(N);if(F.geometry){if(!u)return;if(k=Eb(u),!k)return}else k=F.short?Dd:qq;p.invalidate=!0;var O=p.vs,b=p.cs,m=p.ds,S=s[V._id]={index:m.length,begin:O.length/3,batch:w};m.push(V);var c=vj(V,F.mat),e=N._calcAnchorMat(V);e&&nc(c,c,e),wn(O,c,k);var E=S.size=O.length/3-S.begin;Xn(b,ec(i,Q),E)},cc=function(b,M,V,h,t,F,S,E,e){var d=b.getBrightness(M);d==s&&(d=1);var z=ec(Xe(h),d),f=z[3]<1;F=Math.ceil(F)||1;var l=(f?"T":"O")+F;if(S){var r=S[0],X=(S[1]||r)+r;l+="-"+r+"-"+X,e&&(l+="-"+Ai(e)+"-"+d,e=ec(Xe(e),d))}var O=b._polylineIndexMap,a=b._polylineModelMap,Y=a[l];Y||(Y=a[l]={vs:[],cs:[],ps:[],ds:[],ls:S?[]:s,T:f,W:F},S&&(Y.D=r,Y.G=X,Y.A=e)),Y.invalidate=!0;var o,J=Y.vs,x=Y.cs,P=Y.ds,y=Y.ls,Z=O[M._id]={index:P.length,begin:J.length/3,batch:l};P.push(M),wm(J,V);var p,n=Z.size=J.length/3-Z.begin,D=V.length,L=0,W=[];if(S||t)for(o=0;D>o;o+=6)p=dq([V[o],V[o+1],V[o+2]],[V[o+3],V[o+4],V[o+5]]),W.push(p),L+=p;if(L&&t){var j,g=ec(Xe(t),d),I=[g[0]-z[0],g[1]-z[1],g[2]-z[2],g[3]-z[3]],R=0;for(o=0;D>o;o+=6)j=R/L,Xn(x,[z[0]+I[0]*j,z[1]+I[1]*j,z[2]+I[2]*j,z[3]+I[3]*j],1),R+=W[o/6],j=R/L,Xn(x,[z[0]+I[0]*j,z[1]+I[1]*j,z[2]+I[2]*j,z[3]+I[3]*j],1)}else Xn(x,z,n);if(S)for(R=E||0,o=0;D>o;o+=6)y.push(R),R+=W[o/6],y.push(R)},yq=function(T,e,V){if(e)for(var i=4*e.begin,b=V[e.batch].ps,f=0;f<e.size;f++)b[i++]=T[0],b[i++]=T[1],b[i++]=T[2],b[i++]=T[3]},qh=function(G,U){var L=U+["32"],t=G[U],X=G[L];t?X&&X.length===t.length?(X.set(t),X.glBuf=null):G[L]=new Jm(t):delete G[L]},Sm=function(R,w,o,L,N,j,_,Q,p){if(Dc(o))o.forEach(function(a){Sm(R,w,a,L,N,j,_,Q,p)});else if(Fm(o))Sm(R,w,Me(L,o),L,N,j,_,Q,p);else if(Sg(o)){var J,r=Rp(o.mat,w,R),P=Rp(o.s3,w,R),b=Rp(o.t3,w,R),D=Rp(o.r3,w,R);if((P||D||b||r)&&(J=Fb(r,P,D,Rp(o.rotationMode,w,R),b),j.push(J)),o.shape3d)Sm(R,w,o.shape3d,L,N,j,_,Q,o);else{var I=L.s;p=p||Cc;var G=j[0],F=j.length,V=I("shape3d.color",o.color,p.color);if(N||(N=I("shape3d.blend",o.blend,p.blend)),F>1){G=Do(G);for(var y=1;F>y;y++)nc(G,G,j[y])}o.vs&&I(Yp,o.visible,p.visible)&&$d(G,_,Q,o.vs,o.uv,o.is,N,V),o.top_vs&&I(Cq,o.topVisible,p.topVisible)&&$d(G,_,Q,o.top_vs,o.top_uv,o.top_is,N,I("shape3d.top.color",o.topColor,p.topColor)||V),o.bottom_vs&&I(Yb,o.bottomVisible,p.bottomVisible)&&$d(G,_,Q,o.bottom_vs,o.bottom_uv,o.bottom_is,N,I("shape3d.bottom.color",o.bottomColor,p.bottomColor)||V),o.from_vs&&I(rn,o.fromVisible,p.fromVisible)&&$d(G,_,Q,o.from_vs,o.from_uv,o.from_is,N,I("shape3d.from.color",o.fromColor,p.fromColor)||V),o.to_vs&&I(kp,o.toVisible,p.toVisible)&&$d(G,_,Q,o.to_vs,o.to_uv,o.to_is,N,I("shape3d.to.color",o.toColor,p.toColor)||V)}J&&j.pop()}},$d=function(n,E,S,A,v,r,T,b){var w,Z=E.cs,s=E.uv,W=E.bs;if(r){w=r.length;for(var t=0;w>t;t++){var O=r[t];wn(S,n,[A[3*O],A[3*O+1],A[3*O+2]]),s&&wm(s,[v[2*O],v[2*O+1]])}}else w=A.length/3,wn(S,n,A),s&&wm(s,v);Z&&Xn(Z,b,w),W&&(T?Pg(W,T,w):wm(W,Wc,w))},bs=function(w,j,z,b){var $=[];b?Sm(w.gv,w.data,b,w,w.getBodyColor(),[j],z,$):(Nk(w,Zq,j,z,$),Nk(w,Oi,j,z,$),Nk(w,ad,j,z,$),Nk(w,Ed,j,z,$),Nk(w,Tp,j,z,$),Nk(w,Rk,j,z,$),Nk(w,"csg",j,z,$)),$.length&&(wm(z.vs,$),wm(z.ns,gs($)))},Nk=function(_,W,S,h,t){var q=_[W];if(q){var J=q.tuv;if(J){var m,I,N,r,i=q.uvScale,g=q.uvOffset;if(i)for(m=J.length,I=i[0],N=i[1],r=0;m>r;r+=2)J[r]*=I,J[r+1]*=N;if(g)for(m=J.length,I=g[0],N=g[1],r=0;m>r;r+=2)J[r]+=I,J[r+1]+=N}$d(S,h,t,q.vs,J,s,q.blend,q.color)}},_n=function(X,S,J,F,v,m,U,N){var o,l=J.cs,V=J.uv,b=J.bs;if(X.getFaceVisible(S,m)){var G=X.getFaceMat(S,m);if(G&&(v=vj(S,G)),wn(U,v,N),l&&Xn(l,X.getFaceColor(S,m),6),V){var y=X.getFaceUv(S,m)||F[m+"Uv"],T=X.getFaceUvScale(S,m)||F[m+"UvScale"],Y=X.getFaceUvOffset(S,m)||F[m+"UvOffset"];y=y?[y[6],y[7],y[0],y[1],y[2],y[3],y[2],y[3],y[4],y[5],y[6],y[7]]:Np;var O=y[0],g=y[1],I=y[2],i=y[3],M=y[4],e=y[5],f=y[6],R=y[7],A=y[8],Q=y[9],h=y[10],Z=y[11];if(T){var t=T[0],W=T[1];O*=t,g*=W,I*=t,i*=W,M*=t,e*=W,f*=t,R*=W,A*=t,Q*=W,h*=t,Z*=W}if(Y){var p=Y[0],r=Y[1];O+=p,g+=r,I+=p,i+=r,M+=p,e+=r,f+=p,R+=r,A+=p,Q+=r,h+=p,Z+=r}V.push(O,g,I,i,M,e,f,R,A,Q,h,Z)}b&&(o=X.getBodyColor(S)||X.getFaceBlend(S,m),o?Pg(b,o,6):wm(b,Wc,6))}},Ah=function(l,h,n,Z){var D=l.getGL(),A=l._prg,W=l._buffer;if(!Lr(h)){gk(l),yo(D,A);for(var v in h){var o=h[v];if(!(Z&&!o.T||!Z&&o.T)){o.invalidate?(o.invalidate=!1,qh(o,"vs"),qh(o,"cs"),qh(o,"ls"),qh(o,"ps")):n&&qh(o,"ps");var M=o.vs32,X=n?o.ps32:o.cs32;Bo(D,A,o.W,s,W.vs,M);var U=o.D,_=!l._dashDisabled&&U;so(D,A.uAlphaTest,k.alphaTest),_&&(so(D,A.uDash,!0),so(D,A.uDashDistance,U),so(D,A.uDashGapDistance,o.G),Kl(D,A.aLineDistance),Td(D,W.lineDistance,o.ls32,A.aLineDistance,1),so(D,A.uDiffuse,o.A||Jo));var F=!l._batchColorDisabled;F&&(so(D,A.uBatchColor,!0),Kl(D,A.aBatchColor),Td(D,W.batchColor,X,A.aBatchColor,4)),go(D),Xc(D,0,M.length/3,D.LINES),Pc(D),F&&(so(D,A.uBatchColor,!1),Go(D,A.aBatchColor)),_&&(so(D,A.uDash,!1),Go(D,A.aLineDistance))}}pn(D,A)}},Jh=function(O,v,H){var V,Q,R,m,o,S,X,J,y,j,C,z=O.getGL(),I=O._prg,P=O._buffer,p=O._batchModelMap;if(!Lr(p)){gk(O);for(V in p)if(Q=jh[V]||Cc,!(H&&!Q.transparent||!H&&Q.transparent)&&(R=p[V],v||!Q.transparentMask)){var G=H&&Q.autoSort!==!1&&(O._33Q||R.invalidate);if(R.invalidate?(R.invalidate=!1,qh(R,"vs"),qh(R,"ns"),qh(R,"cs"),qh(R,"rs"),qh(R,"ps"),qh(R,"bs"),qh(R,"uv")):v&&qh(R,"ps"),o=R.vs32,S=v?R.ps32:R.cs32,y=R.uv32,X=R.bs32,J=R.rs32,C=o.length/3,G&&(R.is=Pn(o,O.getEye())),C){m=Q.light,j=O.getTexture(Q.image),xk(z,I,s,Q.light,Q.opacity,Q.reverseFlip,Q.reverseColor,Q.reverseCull),S?O._batchColorDisabled||(so(z,I.uBatchColor,!0),Kl(z,I.aBatchColor),Td(z,P.batchColor,S,I.aBatchColor,4)):so(z,I.uDiffuse,Q.color||Jo);var u=Q.alphaTest;so(z,I.uAlphaTest,u===w?k.alphaTest:u);var i=X&&!O._batchBlendDisabled;i&&(so(z,I.uBatchBlend,!0),Kl(z,I.aBatchBlend),Td(z,P.batchBlend,X,I.aBatchBlend));var A=J&&!O._batchBrightnessDisabled;A&&(so(z,I.uBatchBrightness,!0),Kl(z,I.aBatchBrightness),Td(z,P.batchBrightness,J,I.aBatchBrightness,1)),y?go(z,I,j,Q.discardSelectable,P.uv,y,Q.uvOffset,Q.uvScale):go(z),Td(z,P.vs,o,I.aPosition),Td(z,P.ns,R.ns32,I.aNormal),R.is?(ae(z,P.is,R.is),fn(z,0,C)):Xc(z,0,C),y?Pc(z,I,j):Pc(z),S&&!O._batchColorDisabled&&(so(z,I.uBatchColor,!1),Go(z,I.aBatchColor)),i&&(so(z,I.uBatchBlend,!1),Go(z,I.aBatchBlend)),A&&(so(z,I.uBatchBrightness,!1),Go(z,I.aBatchBrightness)),fe(z,I)}}}},Pn=function(U,x){for(var W=U.length/3,s=new Array(W),k=W/3,O=new Array(k),q=0;k>q;q++)O[q]=q;O.sort(function(C,D){var Z=9*C,E=[(U[Z]+U[Z+3]+2*U[Z+6])/4,(U[Z+1]+U[Z+4]+2*U[Z+7])/4,(U[Z+2]+U[Z+5]+2*U[Z+8])/4];Z=9*D;var z=[(U[Z]+U[Z+3]+2*U[Z+6])/4,(U[Z+1]+U[Z+4]+2*U[Z+7])/4,(U[Z+2]+U[Z+5]+2*U[Z+8])/4],n=dq(x,E)-dq(x,z);return n>0?-1:0>n?1:0});for(var q=0;k>q;q++){var o=3*q,N=3*O[q];s[o]=N,s[o+1]=N+1,s[o+2]=N+2}return new js(s)},lk={obj:function(p,Y){var c={mat:p.mat,s3:p.s3,r3:p.r3,rotationMode:p.rotationMode,t3:p.t3,cube:p.cube==s?!0:p.cube,center:p.center==s?!0:p.center,ignoreMtls:p.ignoreMtls,ignoreTransparent:p.ignoreTransparent,ignoreColor:p.ignoreColor,ignoreImage:p.ignoreImage,ignoreNormal:p.ignoreNormal,prefix:p.prefix,flipY:p.flipY,flipFace:p.flipFace,reverseFlipMtls:p.reverseFlipMtls,finishFunc:function(z,s){if(z){var s=[];for(var I in z){var E=z[I];s.rawS3=E.rawS3,s.push(E),p.eachModel&&p.eachModel(I,E)}s.json=p,Y(s)}else Y()}};Z.loadObj(p.obj,p.mtl,c)}};Z.getModelTypeHandlers=function(){return lk},Z.setModelTypeHandler=function(C,e){lk[C]=e},Z.getModelTypeHandler=function(S){return lk[S]},Z.handleModelLoaded=function(){},Z.handleUnfoundModel=function(){};var ce=s,Xj=s,yd=function(f){ce&&!f._loadingModelView_&&(Xj||(Xj={}),Xj[f._loadingModelView_=Xi()]=f)},Of=function(z,h){ce||(ce={});var E=ce[z];if(E){if(E.url===h)return;E.request.onload=sn,E.request.onerror=sn}var $=new XMLHttpRequest;if(ce[z]={request:$,url:h},$.overrideMimeType&&$.overrideMimeType("text/plain"),h=Z.beforeLoadURL(h),h.data){var O=Z.parse(h.data);Nn(z,O,h)}else $.open("GET",encodeURI(h),!0),$.onload=function(H){if(200===this.status||0===this.status){var r=Z.parse(H.target.response||H.target.responseText);Nn(z,r,h)}else ik(z,Z.handleUnfoundModel(z,h)||s)},$.onerror=function(){ik(z,Z.handleUnfoundModel(z,h)||s)},$.send(null)},Nn=function(z,x,u){var $=x.modelType;if(!$)return ik(z,x),Z.handleModelLoaded(z,x),void 0;var V=Z.getModelTypeHandler($);if(V){var c=function(O){O?(ik(z,O),Z.handleModelLoaded(z,O)):ik(z,Z.handleUnfoundModel(z,u)||s)};V(x,c)}else ik(z,Z.handleUnfoundModel(z,u)||s)},ik=function(D,c){if(Mo[D]=c,delete ce[D],Lr(ce)&&(ce=s,Xj)){for(var O in Xj){var d=Xj[O];d._2O&&(d._2O={}),d.invalidateAll&&d.invalidateAll(w,"modelLoaded",D),d.redraw&&d.redraw(),d.iv(),delete d._loadingModelView_}Xj=s}if(c&&Xj)for(var O in Xj){var d=Xj[O];d.invalidateAll&&d.invalidateAll(w,"modelLoading",D),d.redraw&&d.redraw(),d.iv()}},ls=new Jm([0,0,0,1,1,1,1,0]),il=new Jm([0,0,1,0,0,1,0,0,1,0,0,1]),Gq=new js([0,1,2,2,3,0]),ll=new Jm([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),$r=new js([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),ih=new Jm([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),tb=gs(ll,$r),Md=(new Jm([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new js([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[Zq,ad,Oi,Ed,Tp,Rk]),qq=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],Dd=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Jb=function(m,b,j,q,z,U){U=U||16,m=m||16,b=b||0,j=j||m;var G,O,L,V,E,T,l,X,R=.5,n=[],Y=[],i=v/m,D=_/U;for(G=0;U>G;G++)for(E=G+1,V=G*D,X=E*D,O=b;j>O;O++)T=O+1,L=O*i,l=T*i,n.push(R*t(V)*P(L),R*P(V),-R*t(V)*t(L),R*t(X)*P(l),R*P(X),-R*t(X)*t(l),R*t(V)*P(l),R*P(V),-R*t(V)*t(l),R*t(V)*P(L),R*P(V),-R*t(V)*t(L),R*t(X)*P(L),R*P(X),-R*t(X)*t(L),R*t(X)*P(l),R*P(X),-R*t(X)*t(l)),Y.push(O/m,G/U,T/m,E/U,T/m,G/U,O/m,G/U,O/m,E/U,T/m,E/U);if(q){var f=[],W=[];for(L=b*i,G=0;U>G;G++)E=G+1,V=G*D,X=E*D,f.push(0,0,0,R*t(X)*P(L),R*P(X),-R*t(X)*t(L),R*t(V)*P(L),R*P(V),-R*t(V)*t(L)),W.push(0,.5,b/m,E/U,b/m,G/U)}if(z){var C=[],u=[];for(L=j*i,G=0;U>G;G++)E=G+1,V=G*D,X=E*D,C.push(0,0,0,R*t(V)*P(L),R*P(V),-R*t(V)*t(L),R*t(X)*P(L),R*P(X),-R*t(X)*t(L)),u.push(1,.5,j/m,G/U,j/m,E/U)}return{vs:n,uv:Y,from_vs:f,from_uv:W,to_vs:C,to_uv:u}},Ej=function(V,w,O){V=V||.17,w=w||12,O=O||18,0>V?V=0:V>.25&&(V=.25);var i,C,u,E,c,T,N,g=.5,$=[],J=[],S=[],K=v/O,e=v/w,Q=g-V;for(C=0;w>=C;C++)for(E=-_+C*e,T=P(E),c=t(E),i=0;O>=i;i++)u=i*K,N=Q+V*T,$.push(P(u)*N,c*V,-t(u)*N),J.push(i/O,1-C/w);for(C=0;w>C;C++){var L=C*(O+1),R=(C+1)*(O+1);for(i=0;O>i;i++)S.push(L+i,R+i+1,R+i,L+i,L+i+1,R+i+1)}return{vs:$,uv:J,is:S}},eo=function(d,x,L,D,Q,K,i){i=i||12,d=d||18,x=x||0,L=L||d,K=K||.17,0>K?K=0:K>.25&&(K=.25);var J,e,O,M,b,F,f,q,X,W,E=.5,I=[],s=[],T=v/d,N=v/i,B=E-K;for(O=0;i>O;O++)for(M=O+1,f=-_+O*N,q=-_+M*N,J=x;L>J;J++)e=J+1,b=J*T,F=e*T,X=B+K*P(f),W=B+K*P(q),I.push(P(b)*X,t(f)*K,-t(b)*X,P(F)*X,t(f)*K,-t(F)*X,P(F)*W,t(q)*K,-t(F)*W,P(b)*X,t(f)*K,-t(b)*X,P(F)*W,t(q)*K,-t(F)*W,P(b)*W,t(q)*K,-t(b)*W),s.push(J/d,1-O/i,e/d,1-O/i,e/d,1-M/i,J/d,1-O/i,e/d,1-M/i,J/d,1-M/i);if(D){var m=[],p=[];for(O=0;i>O;O++)M=O+1,f=-_+O*N,q=-_+M*N,b=x*T,X=B+K*P(f),W=B+K*P(q),m.push(P(b)*X,t(f)*K,-t(b)*X,P(b)*W,t(q)*K,-t(b)*W,P(b)*B,0,-t(b)*B),p.push(.5+.5*P(f),.5-.5*t(f),.5+.5*P(q),.5-.5*t(q),.5,.5)}if(Q){var C=[],w=[];for(O=0;i>O;O++)M=O+1,f=-_+O*N,q=-_+M*N,b=L*T,X=B+K*P(f),W=B+K*P(q),C.push(P(b)*X,t(f)*K,-t(b)*X,P(b)*B,0,-t(b)*B,P(b)*W,t(q)*K,-t(b)*W),w.push(.5-.5*P(f),.5-.5*t(f),.5,.5,.5-.5*P(q),.5-.5*t(q))}return{vs:I,uv:s,from_vs:m,from_uv:p,to_vs:C,to_uv:w}},fi=function(B,m){for(var g,e,k,R=.5,Q=16,D=[],U=[],F=[],T=v/Q,r=0;Q>=r;r++)g=r*T,e=P(g)*R,k=t(g)*R,D.push(e,-R,k,e,R,k),U.push(1-r/Q,1,1-r/Q,0);for(r=0;Q>r;r++)F.push(2*r,2*r+1,2*r+3,2*r,2*r+3,2*r+2);if(m){var L=[],p=[],V=[];for(L.push(0,-R,0),p.push(.5,.5),r=0;Q>=r;r++)g=r*T,e=P(g),k=t(g),L.push(e*R,-R,-k*R),p.push(.5+.5*e,.5+.5*k);for(r=0;Q>r;r++)V.push(0,r+2,r+1)}if(B){var $=[],S=[],I=[];for($.push(0,R,0),S.push(.5,.5),r=0;Q>=r;r++)g=r*T,e=P(g),k=t(g),$.push(e*R,R,-k*R),S.push(.5+.5*e,.5-.5*k);for(r=0;Q>r;r++)I.push(0,r+1,r+2)}return{vs:D,uv:U,is:F,bottom_vs:L,bottom_uv:p,bottom_is:V,top_vs:$,top_uv:S,top_is:I}},fb=function(b,s,n,e,Y,r,d){b=b||12,s=s||0,n=n||b;for(var O,X,V,y,C,k,z,U,R=.5,j=[],x=[],q=v/b,l=s;n>l;l++)O=l+1,X=l*q,V=O*q,y=P(X)*R,C=t(X)*R,k=P(V)*R,z=t(V)*R,j.push(y,-R,-C,k,-R,-z,y,R,-C,k,-R,-z,k,R,-z,y,R,-C),x.push(l/b,1,O/b,1,l/b,0,O/b,1,O/b,0,l/b,0);if(d){var Q=[],A=[];for(l=s;n>l;l++)X=q*l,V=q*(l+1),y=P(X),C=t(X),k=P(V),z=t(V),Q.push(y*R,-R,-C*R,0,-R,0,k*R,-R,-z*R),A.push(.5+.5*y,.5+.5*C,.5,.5,.5+.5*k,.5+.5*z)}if(r){var K=[],h=[];for(l=s;n>l;l++)X=q*l,V=q*(l+1),y=P(X),C=t(X),k=P(V),z=t(V),K.push(y*R,R,-C*R,k*R,R,-z*R,0,R,0),h.push(.5+.5*y,.5-.5*C,.5+.5*k,.5-.5*z,.5,.5)}if(e){var w=[],H=[];X=q*s,y=P(X)*R,C=t(X)*R,U=s/b,w.push(0,R,0,0,-R,0,y,-R,-C,y,-R,-C,y,R,-C,0,R,0),H.push(0,0,0,1,U,1,U,1,U,0,0,0)}if(Y){var N=[],u=[];X=q*n,y=P(X)*R,C=t(X)*R,U=n/b,N.push(0,-R,0,0,R,0,y,R,-C,y,R,-C,y,-R,-C,0,-R,0),u.push(1,1,1,0,U,0,U,0,U,1,1,1)}return{vs:j,uv:x,bottom_vs:Q,bottom_uv:A,top_vs:K,top_uv:h,from_vs:w,from_uv:H,to_vs:N,to_uv:u}},yr=function(O,_,w,E,e){_=_||18,w=w||0,E=E==s?v:E,e=e==s?.5:e;for(var r,g,X,B,N,J,y=[0,.5,.75,.875,.9375],q=[],x=[],C=[],c=E/_,Q=0;Q<y.length;Q++){var I=0===Q%2?0:.5;for(r=0;_>=r;r++)g=(r+I)*c+w,X=1-y[Q],q.push(P(g)*e*X,-e+2*y[Q]*e,-t(g)*e*X),x.push((r+I)/_,X)}for(Q=0;Q<y.length-1;Q++){var o=Q*(_+1),u=(Q+1)*(_+1);for(r=0;_>r;r++)C.push(o+r,u+r+1,u+r,o+r,o+r+1,u+r+1)}for(J=q.length/3-(_+1),r=0;_>r;r++)q.push(0,e,0),x.push((r+.5)/_,0);for(r=0;_>r;r++)C.push(J+r,J+r+1,J+(_+1)+r);if(O){var U=[],h=[],d=[];for(U.push(0,-e,0),h.push(.5,.5),r=0;_>=r;r++)g=r*c+w,B=P(g),N=t(g),U.push(B*e,-e,-N*e),h.push(.5+.5*B,.5+.5*N);for(r=0;_>r;r++)d.push(0,r+2,r+1)}return{vs:q,uv:x,is:C,bottom_vs:U,bottom_uv:h,bottom_is:d}},er=function(l,Q,G,I,c,V){l=l||16,Q=Q||0,G=G||l;for(var s=.5,L=[],i=[],X=v/l,z=Q;G>z;z++){var p=z+1,Y=X*z,h=X*p;L.push(P(Y)*s,-s,-t(Y)*s,P(h)*s,-s,-t(h)*s,0,s,0),i.push(z/l,1,p/l,1,(z+p)/2/l,0)}if(V){var w=[],O=[];for(z=Q;G>z;z++){Y=X*z,h=X*(z+1);var S=P(Y),D=t(Y),U=P(h),B=t(h);w.push(S*s,-s,-D*s,0,-s,0,U*s,-s,-B*s),O.push(.5+.5*S,.5+.5*D,.5,.5,.5+.5*U,.5+.5*B)}}if(I){var Z=[],R=[];Y=X*Q,Z.push(0,s,0,0,-s,0,P(Y)*s,-s,-t(Y)*s),R.push(0,0,0,1,Q/l,1)}if(c){var k=[],n=[];Y=X*G,k.push(0,-s,0,0,s,0,P(Y)*s,-s,-t(Y)*s),n.push(1,1,1,0,G/l,1)}return{vs:L,uv:i,bottom_vs:w,bottom_uv:O,from_vs:Z,from_uv:R,to_vs:k,to_uv:n}},xm=function(B,M,E,l,$,D,T,N){for(var J=[],O=0;O<B.length-1;O+=2)J.push({x:B[O],y:B[O+1]});return _j(J,M,E,l,$,D,T,N,!1)},Rq={roundRect:function(j,o){return xm([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],j,o,3)},star:function(A,N){return xm([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],A,N)},rect:function(O,b){return xm([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],O,b)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(Y,c){return xm([0,-.5,.5,.5,-.5,.5],[1,2,2,5],Y,c)},rightTriangle:function(u,m){return xm([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],u,m)},parallelogram:function(g,G){return xm([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],g,G)},trapezoid:function(d,W){return xm([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],d,W)}},Dp={sphere:1,cylinder:1,cone:1,torus:1},jc={torus:1,sphere:1},Bl=se(cq(Rq),{cylinder:1}),Ok=se(cq(Rq),{cylinder:1,cone:1}),Be=function(v,t,j){var z,I=Rp(v.mat,j,t),g=Rp(v.s3,j,t),c=Rp(v.t3,j,t),H=Rp(v.r3,j,t);return(g||H||c||I)&&(z=Do(t._6O),gk(t,Fb(I,g,H,Rp(v.rotationMode,j,t),c))),z},Or=function(p,R,w,S,o,U,k){if(Dc(w))w.forEach(function(Z){Or(p,R,Z,S,o,U,k)});else if(Fm(w))Or(p,R,Me(S,w),S,o,U,k);else if(Sg(w))if(w.shape3d){var i=Be(w,p,R);Or(p,R,w.shape3d,S,o,U,w),i&&jd(p,i)}else jp(p,R,w,S.s,o,U,k)},jp=function(v,Q,q,V,h,S,U){if(U=U||Cc,!S||S(V("shape3d.transparent",q.transparent,U.transparent))){var m=Be(q,v,Q);en(q);var $=v._26I,N=v._prg,t=v._buffer,i=V("shape3d.color",q.color,U.color);h||(h=V("shape3d.blend",q.blend,U.blend));var E,O=q.opacity==s?U.opacity:q.opacity,g=V("shape3d.opacity");E=g!=s&&O!=s?O*g:O!=s?O:g,xk($,N,h,V("shape3d.light",q.light,U.light),E,V("shape3d.reverse.flip",q.reverseFlip,U.reverseFlip),V("shape3d.reverse.color",q.reverseColor,U.reverseColor),V("shape3d.reverse.cull",q.reverseCull,U.reverseCull)),q.vs&&V(Yp,q.visible,U.visible)&&tf($,N,t,i,v.getTexture(V("shape3d.image",q.image,U.image),Q),V("shape3d.discard.selectable",q.discardSelectable,U.discardSelectable),q.vs,q.uv,q.ns,q.is,V("shape3d.uv.offset",q.uvOffset,U.uvOffset),V("shape3d.uv.scale",q.uvScale,U.uvScale)),q.top_vs&&V(Cq,q.topVisible,U.topVisible)&&tf($,N,t,V("shape3d.top.color",q.topColor,U.topColor)||i,v.getTexture(V("shape3d.top.image",q.topImage,U.topImage),Q),V("shape3d.top.discard.selectable",q.topDiscardSelectable,U.topDiscardSelectable),q.top_vs,q.top_uv,q.top_ns,q.top_is,V("shape3d.top.uv.offset",q.topUvOffset,U.topUvOffset),V("shape3d.top.uv.scale",q.topUvScale,U.topUvScale)),q.bottom_vs&&V(Yb,q.bottomVisible,U.bottomVisible)&&tf($,N,t,V("shape3d.bottom.color",q.bottomColor,U.bottomColor)||i,v.getTexture(V("shape3d.bottom.image",q.bottomImage,U.bottomImage),Q),V("shape3d.bottom.discard.selectable",q.bottomDiscardSelectable,U.bottomDiscardSelectable),q.bottom_vs,q.bottom_uv,q.bottom_ns,q.bottom_is,V("shape3d.bottom.uv.offset",q.bottomUvOffset,U.bottomUvOffset),V("shape3d.bottom.uv.scale",q.bottomUvScale,U.bottomUvScale)),q.from_vs&&V(rn,q.fromVisible,U.fromVisible)&&tf($,N,t,V("shape3d.from.color",q.fromColor,U.fromColor)||i,v.getTexture(V("shape3d.from.image",q.fromImage,U.fromImage),Q),V("shape3d.from.discard.selectable",q.fromDiscardSelectable,U.fromDiscardSelectable),q.from_vs,q.from_uv,q.from_ns,q.from_is,V("shape3d.from.uv.offset",q.fromUvOffset,U.fromUvOffset),V("shape3d.from.uv.scale",q.fromUvScale,U.fromUvScale)),q.to_vs&&V(kp,q.toVisible,U.toVisible)&&tf($,N,t,V("shape3d.to.color",q.toColor,U.toColor)||i,v.getTexture(V("shape3d.to.image",q.toImage,U.toImage),Q),V("shape3d.to.discard.selectable",q.toDiscardSelectable,U.toDiscardSelectable),q.to_vs,q.to_uv,q.to_ns,q.to_is,V("shape3d.to.uv.offset",q.toUvOffset,U.toUvOffset),V("shape3d.to.uv.scale",q.toUvScale,U.toUvScale)),fe($,N),m&&jd(v,m)}},tf=function(L,$,P,z,Z,p,G,j,s,b,w,A){G&&(so(L,$.uDiffuse,z),j?go(L,$,Z,p,P.uv,j,w,A):go(L),Td(L,P.vs,G,$.aPosition),Td(L,P.ns,s,$.aNormal),b?(up(L,P.is,b),fn(L,0,b.length)):Xc(L,0,G.length/3),j?Pc(L,$,Z):Pc(L))},Me=function(O,K){var A=O.s;if(K||(K=A(mn)),!K)return s;var o=Ch(K);if(o)return o;if("text"===K){var h={amount:A("shape3d.text.amount"),size:A("shape3d.text.size"),font:A("shape3d.text.font"),style:A("shape3d.text.style"),weight:A("shape3d.text.weight"),fill:A("shape3d.text.fill"),curveSegments:A("shape3d.text.curveSegments"),spacing:A("shape3d.text.spacing")},d=O.gv.getShape3dText(O.data),e=d;for(var G in h)e+="_"+(h[G]===w?"U":h[G]);return O._cachedTextKey===e?O._cachedTextGeometry:(O._cachedTextKey=e,O._cachedTextGeometry=Z.createTextGeometry(d,h))}var G=K;if(Dp[K]){var X=A("shape3d.side"),B=A("shape3d.side.from"),S=A("shape3d.side.to"),a=A(rn),n=A(kp);3>X?(X=0,B=0,S=0,a=!1,n=!1):((B==s||0>B)&&(B=0),(S==s||S>X)&&(S=X),0===B&&S===X&&(a=!1,n=!1)),G+="-"+X+"-"+B+"-"+S+"-"+a+"-"+n}if(Bl[K]){var U=A(Cq);G+="-"+U}if(Ok[K]){var r=A(Yb);G+="-"+r}if("torus"===K){var N=A("shape3d.torus.radius");0>N?N=0:N>.25&&(N=.25),G+="-"+N}if(jc[K]){var M=A(re);G+="-"+M}return o=ho[G],o||("box"===K?o=Z.createBoxModel():Rq[K]?o=Rq[K](U,r):"sphere"===K?o=Z.createSphereModel(X,B,S,a,n,M):K===es?o=Z.createCylinderModel(X,B,S,a,n,U,r):"cone"===K?o=Z.createConeModel(X,B,S,a,n,r):"torus"===K&&(o=Z.createTorusModel(X,B,S,a,n,N,M)),ho[G]=o),o},en=function(){var t=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],B=["is","top_is","bottom_is","from_is","to_is"];return h=Dm(ir.substr(ir.indexOf("^#")+2)),rq(Z[Ig($p+t[15]+"n"+t[16])]())&&Jf()?function(o){o&&!o._complete_&&(o._complete_=!0,o.vs&&Rf(o.ns)&&(o.ns=gs(o.vs,o.is)),o.top_vs&&Rf(o.top_ns)&&(o.top_ns=gs(o.top_vs,o.top_is)),o.bottom_vs&&Rf(o.bottom_ns)&&(o.bottom_ns=gs(o.bottom_vs,o.bottom_is)),o.from_vs&&Rf(o.from_ns)&&(o.from_ns=gs(o.from_vs,o.from_is)),o.to_vs&&Rf(o.to_ns)&&(o.to_ns=gs(o.to_vs,o.to_is)),t.forEach(function(j){var v=o[j];Dc(v)&&(o[j]=new Jm(v))}),B.forEach(function(d){var p=o[d];Dc(p)&&(o[d]=new js(p))}))}:void 0}(),vm=function(h,k){var u=h[k];Dc(u)&&(h[k]=new Jm(u))};se(Zf,{_25Q:function(T){T._16O=function(D,F,R,p,U,E,P,O,r){var Z=this.info;if(Z){var j,y,Y,T,k,f,g=kr();if(Wd[F]?(j=Z.p3,y=Z.c1,Y=Z.c2):Rd[F]?(y=Z.s1||Z.c1,Y=Z.s2||Z.c2):(y=Z.t1||Z.c1,Y=Z.t2||Z.c2),j)f=Jg(F,Nl,R,p,O,r);else{var m=Wj(Y,y),A=dq(y,Y);T=[0,-o(m[2],m[0]),L(m[1]/A)],k="zyx",j=[(y[0]+Y[0])/2,(y[1]+Y[1])/2,(y[2]+Y[2])/2],f=Jg(F,[A,0,0],R,p,O,r)}return pe(g,f,j,p,U,E,P,D,T,k)}return rl},T._80o=function(V,D,g){var x=this,T=x.shapeModel;if(T){var h=x.gv;gk(h),Or(h,x.data,T,x,x.getBodyColor(),g)}},T.createLineModel=function(x,t,d,E,v){for(var l=this,U=l.s,W=lh(x,t,U(re)),r=[],J=0;J<W.length;J++){var F=W[J],X=F.length;if(X>1){var h=F[0];r.push(h.x,h.y,h.z);for(var B=1;X-1>B;B++)h=F[B],r.push(h.x,h.y,h.z),r.push(h.x,h.y,h.z);h=F[X-1],r.push(h.x,h.y,h.z)}}var _,w,M,G=U(E+".color"),p=U(v),C=0;return p&&(w=U(v+".color"),_=U(v+".pattern"),C=U(v+".offset"),M=G),cc(l.gv,l.data,r,w||G,M?s:U(E+".gradient.color"),d,_||U(E+".pattern"),C,M),W},T.createTubeModel=function(m,B,e,J){for(var u=this,C=u.s,f=C("shape3d.side")||Cm,o=C("shape3d.start.angle"),l=C("shape3d.sweep.angle"),Y=C(Cq)?C("shape3d.top.cap"):s,z=C(Yb)?C("shape3d.bottom.cap"):s,t="flat"===Y,v="flat"===z,r=t&&(J?J.uv:C("shape3d.top.image")),I=v&&(J?J.uv:C("shape3d.bottom.image")),b=J?J.uv:C("shape3d.image"),n={vs:[],uv:b?[]:s,top_vs:t?[]:s,top_uv:r?[]:s,bottom_vs:v?[]:s,bottom_uv:I?[]:s},D=lh(m,B,C(re),e),U=0,Q=D.length;Q>U;U++)ue(n,D[U],C($q),e,f,o,l,Y,z);if(J){var S=[];Sm(u.gv,u.data,n,u,u.getBodyColor(),[],J,S),S.length&&(wm(J.vs,S),wm(J.ns,gs(S)))}else u.shapeModel=n;return D},T.getCache=function(){var Y=this.info;if(Y){var U=Y.list;if(U){var M=Y.cache;return M||(M=Y.cache=ln(U)),M}}return s}}});var Pd=function(r,n){for(var $,o=0,B=r.length,D=0,l=B-1;l>=D;)if(o=p(D+(l-D)/2),$=r[o].length-n,0>$)D=o+1;else{if(!($>0)){l=o;break}l=o-1}o=l;var K=r[o],X=K.point;return o===B-1||K.length===n||(X=(new tc).subVectors(r[o+1].point,X).normalize().multiplyScalar(n-K.length).add(X)),{point:X,tangent:K.tangent}},ln=function(Q){for(var C,O,h=[],p=0,W=0;W<Q.length;W++){for(var k=Q[W],i=0;i<k.length;i++){C=k[i],O&&(p+=O.distanceTo(C));var Y=new tc,x=k[i+1];x?Y.subVectors(x,C):O?Y.subVectors(C,O):Y.x=1,Y.normalize(),h.push({point:C,length:p,tangent:Y}),O=C}O=null}return h},lh=function(p,U,$,G){$=$||we;for(var l=[],u=0,S=p.size();S>u;u++){var R=p.get(u);l.push(new tc(R.x,R.e||0,R.y))}U&&(Qr(U)&&(U=U._as),U.length||(U=null));for(var f,r,Q,v,w,g=[],H=0,T=0,b=U?U.length:S;b>T;T++)if(w=U?U[T]:0===T?1:2,1===w)g.push(Q=[]),Q.push(l[H++]);else if(2===w||5===w)if(v=2===w?l[H++]:Q[0],G){var J=U?U[T+1]:b>T+1?2:s;if(2===J||5===J){var N=Q[Q.length-1],o=2===J?l[H]:Q[0],P=(new tc).subVectors(N,v),E=(new tc).subVectors(o,v),j=P.length(),n=E.length();if(j&&n)if(G>j/2&&G>n/2)Q.push(v);else for(P.multiplyScalar(d(G,j/2)/j).add(v),E.multiplyScalar(d(G,n/2)/n).add(v),f=new zb(P,v,E).getPoints($),r=0;$>=r;r++)Q.push(f[r])}else Q.push(v)}else Q.push(v);else if(3===w)for(f=new zb(Q[Q.length-1],l[H++],l[H++]).getPoints($),r=1;$>=r;r++)Q.push(f[r]);else if(4===w)for(f=new wp(Q[Q.length-1],l[H++],l[H++],l[H++]).getPoints($),r=1;$>=r;r++)Q.push(f[r]);return g},hb=function(n){for(var W,F,E=new tc,j=[],b=[],G=[],S=0,M=n.length;M>S;S++)W=n[S],F=n[S+1],F?E.subVectors(F,W):E.subVectors(W,n[S-1]),j.push(E.normalize().clone());var t,z,X,d,_=new tc,m=new tc,h=new gn,p=1e-4,c=Number.MAX_VALUE,U=j[0],s=b[0]=new tc,i=G[0]=new tc;for(z=A(U.x),X=A(U.y),d=A(U.z),c>=z&&(c=z,_.set(1,0,0)),c>=X&&(c=X,_.set(0,1,0)),c>=d&&_.set(0,0,1),m.crossVectors(U,_).normalize(),s.crossVectors(U,m),i.crossVectors(U,s),S=1;M>S;S++)b[S]=b[S-1].clone(),G[S]=G[S-1].clone(),m.crossVectors(j[S-1],j[S]),m.length()>p&&(m.normalize(),t=r(Mk(j[S-1].dot(j[S]),-1,1)),b[S].applyMatrix4(h.makeRotationAxis(m,t))),G[S].crossVectors(j[S],b[S]);return{B:G,T:j,N:b}},ue=function(){var l=function(t){for(var _=1;_<arguments.length;_++){var S=arguments[_];t.push(S.x,S.y,S.z)}},d=function($){for(var T=1;T<arguments.length;T++){var S=arguments[T].uv;$.push(S[0],S[1])}},L=function(W,g,$,R,G){var E=-R*P(G),r=R*t(G);return new tc(W.x+E*$.x+r*g.x,W.y+E*$.y+r*g.y,W.z+E*$.z+r*g.z)},g=function(l,f,x,r,V,J,E,U){E=E||v;for(var d=[],P=E/V,j=0;V>=j;j++){var W=L(l,f,x,r,j*P+J);d.push(W),U!=s&&(W.uv=[U,j/V])}return d},q=function(M,p,h,o,E,$,m,R,H){H=H||v;var W=p?M.top_vs:M.bottom_vs;if(W)for(var F=p?M.top_uv:M.bottom_uv,w=H/m,Z=0;m>Z;Z++){var K,A;p?(K=Z*w+R,A=(Z+1)*w+R):(A=Z*w+R,K=(Z+1)*w+R),l(W,L(h,o,E,$,K),L(h,o,E,$,A),h),F&&F.push(.5-.5*P(K),.5-.5*t(K),.5-.5*P(A),.5-.5*t(A),.5,.5)}};return function(H,D,I,p,V,Z,J,Y,_){var z=D.length;if(z>1){var C,X,n,h,f,K,L,i=hb(D),v=i.T,j=i.N,e=i.B;"flat"===Y&&q(H,!0,D[0],e[0],j[0],p,V,Z,J),"flat"===_&&q(H,!1,D[z-1],e[z-1],j[z-1],p,V,Z,J);var B,c,P=[],M=Q(V/2),G="round"===Y,N="round"===_,m=D[0],W=v[0],u=e[0],A=j[0],r=D[z-1],$=v[z-1],F=e[z-1],E=j[z-1];if(G){for(n=1;M>=n;n++)j.splice(0,0,A),e.splice(0,0,u),v.splice(0,0,W),c=-n/M*p,D.splice(0,0,W.clone().multiplyScalar(c).add(m)),P[M-n]=O(p*p-c*c);z+=M}if(N){for(n=1;M>=n;n++)j.push(E),e.push(F),v.push($),c=n/M*p,D.push($.clone().multiplyScalar(c).add(r)),P[D.length-1]=O(p*p-c*c);z+=M}if(H.uv){var b=0,T=0,x=[];for(I&&(b=I),f=D[0],x[0]=0,n=1;z>n;n++)h=D[n],x[n]=f.distanceTo(h),f=h,I||(b+=x[n]);for(B=[],n=0;z>n;n++)T+=x[n],B[n]=b?T/b:0}for(n=0;z>n;n++){if(h=D[n],K=e[n],L=j[n],C=g(h,K,L,P[n]===w?p:P[n],V,Z,J,B?B[n]:s),X)for(var y=0;V>y;y++){var a=X[y],t=X[y+1]||X[0],o=C[y],R=C[y+1]||C[0];l(H.vs,t,a,o,o,R,t),H.uv&&d(H.uv,t,a,o,o,R,t)}X=C}}}}();se(Z,{getLineLength:function(h){return h[h.length-1].length},getLineOffset:function(n,m){return Pd(n,m)},getLineCacheInfo:function($,l,c,w){return ln(lh($,l,c,w))}});var Vm=c.Light=function(){fm(Vm,this),this.s(hc,k[hc]),this.s(mn,"sphere"),this.s3(20,20,20)};If("Light",Zm,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(c,B,s){Vm.superClass.onStyleChanged.apply(this,arguments),c===hc&&this.s("shape3d.color",s)}});var pq=Hg.Graph3dView=function(e,q){var n=this;n._attributes=q||Z.graph3dViewAttributes,n._25I={},n._view=Op(1,n);var l=n._canvas=qb(n._view);l.addEventListener("webglcontextlost",function(Q){Q.preventDefault(),bc(n),n._26I&&n._doBufferGC(n._26I,!0),n._26I=s,n._1o.texture=s,n._35O=!0},!1),l.addEventListener("webglcontextrestored",function(){n._35O=!1,n.iv()},!1),n._batchIndexMap={},n._batchModelMap={},n._wireframeIndexMap={},n._wireframeModelMap={},n._wireframeIndexMapSwap={},n._wireframeModelMapSwap={},n._polylineIndexMap={},n._polylineIndexMap={},n._polylineIndexMapSwap={},n._polylineIndexMapSwap={},n._8O=[],n._7O=kr(),n._6O=kr(),n._1o=new Lp(n),n._30O=new op(n),n._31O=new Oo(n),n._32O=new eq(n),n._raycaster=new Ac(n),n.vr=new ui(n),n._33Q=!0,n._eye=cq(Z.graph3dViewEye),n._center=cq(Z.graph3dViewCenter),n._up=cq(Z.graph3dViewUp),n._lightChanged=!1,n._59O=[],n._spots=[],n._dirs=[],n._frameId=0,n.overlappingBox=new Bp(n),n.dm(e?e:new Wr),n._coreInteractor=new ps(this),n.setInteractors([new Rc(n)])},_i={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1},Fe=0;Fg("Graph3dView",D,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",vp,$j,"firstPersonMode",dn,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",is,Vp,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:Z.graph3dViewEditHelperDisabled,_devicePixelRatio:w,_boundaries:w,_moveStep:Z.graph3dViewMoveStep,_rotateStep:Z.graph3dViewRotateStep,_pannable:Z.graph3dViewPannable,_rotatable:Z.graph3dViewRotatable,_walkable:Z.graph3dViewWalkable,_resettable:Z.graph3dViewResettable,_zoomable:Z.graph3dViewZoomable,_firstPersonMode:Z.graph3dViewFirstPersonMode,_mouseRoamable:Z.graph3dViewMouseRoamable,_gridVisible:Z.graph3dViewGridVisible,_gridSize:Z.graph3dViewGridSize,_gridGap:Z.graph3dViewGridGap,_gridColor:Z.graph3dViewGridColor,_originAxisVisible:Z.graph3dViewOriginAxisVisible,_centerAxisVisible:Z.graph3dViewCenterAxisVisible,_axisXColor:Z.graph3dViewAxisXColor,_axisYColor:Z.graph3dViewAxisYColor,_axisZColor:Z.graph3dViewAxisZColor,_ortho:Z.graph3dViewOrtho,_orthoWidth:Z.graph3dViewOrthoWidth,_fovy:Z.graph3dViewFovy,_near:Z.graph3dViewNear,_far:Z.graph3dViewFar,_headlightColor:Z.graph3dViewHeadlightColor,_headlightIntensity:Z.graph3dViewHeadlightIntensity,_headlightRange:Z.graph3dViewHeadlightRange,_headlightDisabled:Z.graph3dViewHeadlightDisabled,_rectSelectable:Z.graph3dViewRectSelectable,_rectSelectBackground:Z.graph3dViewRectSelectBackground,_editSizeColor:Z.graph3dViewEditSizeColor,_autoMakeVisible:Ud,_fogDisabled:Z.graph3dViewFogDisabled,_fogColor:Z.graph3dViewFogColor,_fogNear:Z.graph3dViewFogNear,_fogFar:Z.graph3dViewFogFar,_dashDisabled:Z.graph3dViewDashDisabled,_batchColorDisabled:Z.graph3dViewBatchColorDisabled,_batchBlendDisabled:Z.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:Z.graph3dViewBatchBrightnessDisabled,setEye:function(L,P,c){1===arguments.length&&(P=L[1],c=L[2],L=L[0]);var q=this._eye;q[0]=L,q[1]=P,q[2]=c,this.fp(is,s,q)},setCenter:function(H,N,r){1===arguments.length&&(N=H[1],r=H[2],H=H[0]);var P=this._center;P[0]=H,P[1]=N,P[2]=r,this.fp(Vp,s,P)},setUp:function(S,Z,f){1===arguments.length&&(Z=S[1],f=S[2],S=S[0]);var B=this._up;B[0]=S,B[1]=Z,B[2]=f,this.fp("up",s,B)},isTransparentMask:function(E){return E.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getAspect:function(){var C=this,$=C._aspect;return $?$:C.getWidth()/C.getHeight()},getCanvas:function(){return this._canvas
},setDataModel:function(U){var g=this,O=g._dataModel,E=g._selectionModel;O!==U&&(O&&(O.ump(g.handleDataModelPropertyChange,g),O.umm(g.handleDataModelChange,g),O.umd(g.handleDataPropertyChange,g),E||O.sm().ums(g.handleSelectionChange,g)),g._dataModel=U,U.mp(g.handleDataModelPropertyChange,g),U.mm(g.handleDataModelChange,g),U.md(g.handleDataPropertyChange,g),E?E._21I(U):U.sm().ms(g.handleSelectionChange,g),g.invalidateAll(!0),g.invalidateLight(),g.fp(Qm,O,U),g._canvas.style.background=U.getBackground()||"")},handleDataModelPropertyChange:function(Y){if("background"===Y.property){var A=this._canvas.style.background,$=Y.newValue||"";this._canvas.style.background=$,this.fp("canvasBackground",A,$)}},handleDataPropertyChange:function(J){var G=J.data;this.invalidateData(G),ok(G)&&"s:light.type"===J.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(E){var h=this,J=E.property;h.iv(),h._18Q=s,"eye"===J?h._33Q=!0:"devicePixelRatio"===J?h._42(s,h._devicePixelRatio||fk):_i[J]&&bc(h)},_5O:function(M){var i=M._22Q();return i?new i(this,M):s},getData3dUI:function(m){var Q=this._25I[m._id];return Q===w&&(Q=this._5O(m),this._25I[m._id]=Q),Q},invalidateAll:function(X){var O=this;if(X){for(var B in O._25I){var r=O._25I[B];r&&r.dispose()}O._25I={},O.iv(),rj(O)}else rj(O),O.dm().each(function(k){O.invalidateData(k)})},invalidateSelection:function(){var z=this;z.sm().each(function(U){z.invalidateData(U)})},invalidateData:function(z){var Z=this,b=Z.getData3dUI(z);b&&(b.iv(),Z.iv()),rj(Z,z)},getShape3dText:function(L){return L.getStyle("shape3d.text")||this.getLabel(L)},invalidateBatch:function(M){var X=this,Y=X._batchModelMap,s=Y[M],k=[],C={};if(s){s.ds.forEach(function(m){var D=X.getData3dUI(m);D&&D.iv(),delete X._batchIndexMap[m._id],k.push(m._id)}),delete Y[M];for(var v,b,L,H,Q,g,p,e,V,U=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],D=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],B=0;B<U.length;B++){var y=X[U[B]],j=X[D[B]];for(C={},e=0;e<k.length;e++){var T=j[k[e]];if(T){delete j[k[e]],V=T.batch,v=y[V];var I=T.begin,i=T.size,a=3*I,o=3*i,R=4*I,P=4*i;for(b=v.ds,L=v.vs,H=v.cs,Q=v.ps,g=v.ls,p=T.index,v.invalidate=!0,b[p]=w,p=a;a+o>p;p++)L[p]=w;for(p=R;R+P>p;p++)H[p]=w;for(p=R;R+P>p;p++)Q[p]=w;if(g)for(p=a;a+o>p;p++)g[p]=w;C[V]=!0}}for(V in C){v=y[V],b=v.ds,L=v.vs,H=v.cs,Q=v.ps,g=v.ls;var z=[];for(p=0;p<b.length;p++)b[p]!==w&&z.push(b[p]);if(0===z.length)delete y[V];else{for(v.ds=z,z=[],p=0;p<L.length;p++)L[p]!==w&&z.push(L[p]);for(v.vs=z,z=[],p=0;p<H.length;p++)H[p]!==w&&z.push(H[p]);for(v.cs=z,z=[],p=0;p<Q.length;p++)Q[p]!==w&&z.push(Q[p]);if(v.ps=z,g){for(z=[],p=0;p<g.length;p++)g[p]!==w&&z.push(g[p]);v.ls=z}}}}X.iv()}},handleDataModelChange:function(C){var H=this,b=C.kind,T=C.data;if("add"===b)H.invalidateData(T),$f(T)&&T.getEdgeGroup()&&T.getEdgeGroup().eachSiblingEdge(H.invalidateData,H),ok(T)&&H.invalidateLight();else if(b===Dq){var D=T._id,L=H._25I[D];L&&(L.dispose(),delete H._25I[D],H.iv()),T===H._currentSubGraph&&H.setCurrentSubGraph(s),rj(H,T),ok(T)&&H.invalidateLight()}else b===zo&&(H.invalidateAll(!0),H.setCurrentSubGraph(s),rj(H),H.invalidateLight())},toCanvas:function(Q){var C=this,$=C.getGL();if(C.validate(),Q){var f=$.getParameter($.COLOR_CLEAR_VALUE);oe($,Q)}C._42(s,1);var U=C.getWidth(),j=C.getHeight(),G=new Uint8Array(4*U*j),k=qb(),S=k.getContext("2d");$.readPixels(0,0,U,j,$.RGBA,$.UNSIGNED_BYTE,G),Dg(k,U,j,1);for(var E=S.getImageData(0,0,U,j),m=E.data,g=0;g<m.length;g+=4){var _=g/4,b=p(_/U),R=_-b*U;_=4*((j-1-b)*U+R),m[_]=G[g],m[_+1]=G[g+1],m[_+2]=G[g+2],m[_+3]=G[g+3]}return S.putImageData(E,0,0),Q&&oe($,f),C._42(s,C._devicePixelRatio||fk),k},toDataURL:function(J,u){var $=this,n=$.getGL();if($.validate(),J){var d=n.getParameter(n.COLOR_CLEAR_VALUE);oe(n,J)}$._42(s,1);var H=$._canvas.toDataURL(u||"image/png",1);return J&&oe(n,d),$._42(s,$._devicePixelRatio||fk),H},getGL:function(){var T=this,A=T._26I,x=T._prg;if(!A)try{T._2O={},A=T._26I=T._canvas.getContext("webgl",T._attributes)||T._canvas.getContext("experimental-webgl",T._attributes),A._emptyTexture=ne(A),A._emptyBlendTexture=ne(A),A._bufPool=[],A._id=++Fe,T._buffer={vs:Le(A),ns:Le(A),is:Le(A),uv:Le(A),batchColor:Le(A),batchBlend:Le(A),batchBrightness:Le(A),lineDistance:Le(A)},T._1O=Am(A);var E=T._cube={vs:Le(A),ns:Le(A),is:Le(A),uv:Le(A)};Ec(A,E.vs,ll),Ec(A,E.ns,tb),Ec(A,E.uv,ih),ae(A,E.is,$r)}catch(Q){}if(A&&!x){if(x=T._prg=A.createProgram(),!x)return s;var q=T._dirs.length,B=T._spots.length,n=T._59O.length,M=["uPMatrix","uMVMatrix","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];q&&M.push("uDirColor","uDirDirection"),B&&M.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),n&&M.push("uPointColor","uPointRange","uPointPosition"),oe(A,[0,0,0,0]),A.clearDepth(1),A.enable(A.DEPTH_TEST),A.depthFunc(A.LEQUAL),A.enable(A.BLEND),A.blendFuncSeparate(A.SRC_ALPHA,A.ONE_MINUS_SRC_ALPHA,A.ONE,A.ONE_MINUS_SRC_ALPHA),ro||(ir=Dm(ir.substring(0,ir.indexOf("^#"))),mj=Dm(mj),ro=!0);var V=["#define MAX_DIR "+q,"#define MAX_SPOT "+B,"#define MAX_POINT "+n,T._fogDisabled?"":"#define FOG",T._dashDisabled?"":"#define DASH",T._batchColorDisabled?"":"#define BATCHCOLOR",T._batchBlendDisabled?"":"#define BATCHBLEND",T._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),v=el(A,x,A.VERTEX_SHADER,ir.replace("PREFIX",V)),r=el(A,x,A.FRAGMENT_SHADER,mj.replace("PREFIX",V));a?M.push("aPosition"):(x.aPosition=0,A.bindAttribLocation(x,0,"aPosition")),A.linkProgram(x),M.forEach(function(W){x[W]=/^u/.test(W)?A.getUniformLocation(x,W):A.getAttribLocation(x,W)}),A.useProgram(x),A.deleteShader(v),A.deleteShader(r)}return A},getBrightness:function(z){var P=z.s("brightness"),_=this.isSelected(z)?z.s("select.brightness"):s;return P==s?_:_==s?P:P*_},getWireframe:function(G){var b=G.s("wf.visible"),a=G.s("wf.width");return b===!0||a>0&&"selected"===b&&this.isSelected(G)?{color:G.s("wf.color"),width:a,"short":G.s("wf.short"),mat:G.s("wf.mat")}:void 0},_transformPointToViewSpace:function(R){var g=[R[0],R[1],R[2]];return kh(g,this._viewMatrix),g},_transformDirectionToViewSpace:function(c,R){var v=[c[0],c[1],c[2]];kh(v,this._viewMatrix);var Z=R?[R[0],R[1],R[2]]:[0,0,0];kh(Z,this._viewMatrix);var P=Z[0]-v[0],W=Z[1]-v[1],n=Z[2]-v[2],U=Math.sqrt(P*P+W*W+n*n);return U?[P/U,W/U,n/U]:[P,W,n]},getWireframeGeometry:function(Q){return Q.s("wf.geometry")?{color:Q.s("wf.color"),width:Q.s("wf.width"),mat:Q.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(p){return p.s("body.color")},getMat:function(j){return j.getMat?j.getMat():j.s("mat")},getFaceMat:function(Q,k){return Q.getFaceMat?Q.getFaceMat(k):Q.s(k+".mat")},getFaceBlend:function(K,F){return K.s(F+".blend")||K.s("all.blend")},getFaceColor:function(i,z){return i.s(z+".color")||i.s("all.color")},getFaceImage:function(u,r){return u.s(r+".image")||u.s("all.image")},getFaceBlendImage:function(c,_){return c.s(_+".blend.image")||c.s("all.blend.image")},getFaceDiscardSelectable:function(t,v){var F=t.s(v+".discard.selectable");return F==s?t.s("all.discard.selectable"):F},getFaceUv:function(i,f){return i.s(f+".uv")||i.s("all.uv")},getFaceUvOffset:function($,Z){return $.s(Z+".uv.offset")||$.s("all.uv.offset")},getFaceUvScale:function(A,e){return A.s(e+".uv.scale")||A.s("all.uv.scale")},getFaceLight:function(Z,T){var v=Z.s(T+".light");return v==s?Z.s("all.light"):v},getFaceVisible:function(q,R){var k=q.s(R+".visible");return k==s?q.s("all.visible"):k},getFaceOpacity:function(r,Y){var L=r.s(Y+".opacity");return L==s?r.s("all.opacity"):L},getFaceTransparent:function(v,g){var C=v.s(g+".transparent");return C==s?v.s("all.transparent"):C},getFaceReverseColor:function(d,P){return d.s(P+".reverse.color")||d.s("all.reverse.color")},getFaceReverseFlip:function(L,K){var C=L.s(K+".reverse.flip");return C==s?L.s("all.reverse.flip"):C},getFaceReverseCull:function(C,j){var Y=C.s(j+".reverse.cull");return Y==s?C.s("all.reverse.cull"):Y},getTextureMap:function(){return this._2O},deleteTexture:function(E){var $=this,X=$._2O[E];X&&(delete $._2O[E],$.getGL().deleteTexture(X))},invalidateShape3dCachedImage:function(Y){var t=this.getData3dUI(Y);t.invalidateCachedTexture(this.getGL())},isInteractive:function(B){return B.s("interactive")},getTexture:function(Z,X){if(!Z)return s;var w=this,C=w.getGL(),P=w._2O[Z];if(!P){var x=sr(Z);if(x)if(x.tagName){if(x.dynamic)return Am(C,x,w._1O);P=w._2O[Z]=Am(C,x)}else{var p,y=X&&X.s("shape3d.image.cache")&&!w.isInteractive(X);if(y&&(p=w.getData3dUI(X),P=p.getCachedTexture()),!P){var k=X&&X.s("shape3d.fixSizeOnScreen"),J=k?C.NEAREST:C.LINEAR;k||X&&X.s("shape3d.vector.dynamic")&&(p||(p=w.getData3dUI(X)),k=p.getVectorDynamicSize());var Y=X&&X.s("shape3d.texture.scale")||1,K=k&&k[0]>0?k[0]:Y*Db(x,X),R=k&&k[1]>0?k[1]:Y*Vc(x,X);if(K>=1&&R>=1){K*=devicePixelRatio,R*=devicePixelRatio;var g=zm(K,R);if(!p&&X&&(p=w.getData3dUI(X)),p&&p.interactiveInfo){var o=p.interactiveInfo[Z]={};g.interactiveInfo=o.bodyInfo={compInfos:[],matrix:new nk,rect:{x:0,y:0,width:K,height:R}}}ff(g,x,0,0,K,R,X,w),g.interactiveInfo&&(g.interactiveInfo=null),g.restore(),y&&xj(x,X)?(P=Am(C,Co,null,J),p.setCachedTexture(P),Co=null):P=Am(C,Co,w._1O,J)}}}}return P},redraw:function(){this.iv()},validateImpl:function(){var i=this;if(i._lightChanged){i._lightChanged=!1;var F=[],U=[],h=[];i.dm().each(function(J){if(ok(J)){var A=J.s("light.type");A===kl?F.push(J):A===_m?U.push(J):A===Qp&&h.push(J)}}),(F.length!==i._59O.length||U.length!==i._spots.length||h.length!==i._dirs.length)&&bc(i),i._59O=F,i._spots=U,i._dirs=h}i._42(),i._1o.iv()},getRenderInfo:function(){var U=this.getGL();return U?U._renderInfo:void 0},showDebugTip:function(){var x=this,A=x._debugDiv;if(!A){A=x._debugDiv=G.createElement("div"),A.style.position="absolute",A.style.overflow="hidden",A.style.backgroundColor="white",A.style.color="black";var d=x.getView();x._79O?d.insertBefore(A,x._79O):d.appendChild(A),x._debugTipTimerId=setInterval(function(){var N=x.getRenderInfo();if(N){var q=x.getGL()._bufPool,X=q.length-(q._ivCount||0),p="Draw Calls: "+N.calls+"<br/>"+"Vertices: "+N.vertices+"<br/>"+"Faces: "+N.faces+"<br/>"+"Lines: "+N.lines+"<br/>"+"Buffer Count: "+X;A.innerHTML=p}},10)}},hideDebugTip:function(){var l=this,v=l._debugDiv;v&&(delete l._debugDiv,cancelAnimationFrame(l._debugTipTimerId),delete l._debugTipTimerId,l.getView().removeChild(v))},_42:function(u,D){var H=this;if(!H._35O&&(!qp||bk(qp))){var m,A;u&&(u instanceof Zm?A=u:m=u);var P=H._canvas,g=H.getWidth(),p=H.getHeight(),R=H.getGL(),x=H._prg;if(R){D?u||Dg(P,g,p,D):(D=H._devicePixelRatio||fk,u||g===P.clientWidth&&p===P.clientHeight||Dg(P,g,p,D)),R.clear(R.COLOR_BUFFER_BIT);var f=function(){if(R._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:++H._frameId},H.overlappingBox.clear(),H._81O=s,R.clear(R.DEPTH_BUFFER_BIT),so(R,x.uBrightness,1),so(R,x.uOpacity,1),so(R,x.uPartOpacity,1),R._picking=!!u,so(R,x.uPick,!!u),so(R,x.uTexture,!1),so(R,x.uBlendTexture,!1),so(R,x.uAlphaTest,k.alphaTest),so(R,x.uTransparent,!1),so(R,x.uFix,!1),so(R,x.uBatchColor,!1),so(R,x.uBatchBlend,!1),so(R,x.uBatchBrightness,!1),so(R,x.uPMatrix,H._projectMatrix=Dn(H)),so(R,x.uViewMatrix,xb(H,H._7O)),H._viewMatrix=Do(H._7O),u||(Fk(H,R,x),H._fogDisabled||(so(R,x.uFogColor,H._fogColor),so(R,x.uFogNear,H._fogNear),so(R,x.uFogFar,H._fogFar))),Kl(R,x.aPosition),Kl(R,x.aNormal),Go(R,x.aUv),Go(R,x.aBatchColor),Go(R,x.aBatchBlend),Go(R,x.aBatchBrightness),Go(R,x.aLineDistance),A){var Q=R.getParameter(R.COLOR_CLEAR_VALUE);R.clearColor(0,0,0,0),R.disable(R.BLEND),Go(R,x.aNormal),Ec(R,H._cube.vs,s,x.aPosition),ae(R,H._cube.is),yl(A,H,Zq,0),yl(A,H,ad,6),yl(A,H,Oi,12),yl(A,H,Ed,18),yl(A,H,Tp,24),yl(A,H,Rk,30),Kl(R,x.aNormal),oe(R,Q)}else if(m){m.value=2;var Q=R.getParameter(R.COLOR_CLEAR_VALUE);R.clearColor(0,0,0,0),R.disable(R.BLEND),H._95I(R,x,m),Jh(H,m),Ah(H,H._polylineModelMap,m),Ah(H,H._wireframeModelMap,m),so(R,x.uTransparent,!0),H._95I(R,x,m,!0),Jh(H,m,!0),Ah(H,H._polylineModelMap,m,!0),Ah(H,H._wireframeModelMap,m,!0),so(R,x.uTransparent,!1),R.clear(R.DEPTH_BUFFER_BIT),H._swapLineMap(),H._95I(R,x,m,!1,!0),Ah(H,H._polylineModelMap,m),Ah(H,H._wireframeModelMap,m),H._swapLineMap(),R.disable(R.DEPTH_TEST),H._30O._42(R,x,m),R.enable(R.DEPTH_TEST),oe(R,Q)}else R.disable(R.BLEND),H.drawSky(R,x),H._31O._42(R,x),H._95I(R,x),Jh(H),Ah(H,H._polylineModelMap),Ah(H,H._wireframeModelMap),R.enable(R.BLEND),so(R,x.uTransparent,!0),R.depthMask(!1),H._95I(R,x,s,!0),Jh(H,s,!0),Ah(H,H._polylineModelMap,s,!0),Ah(H,H._wireframeModelMap,s,!0),R.depthMask(!0),so(R,x.uTransparent,!1),R.clear(R.DEPTH_BUFFER_BIT),H._swapLineMap(),H._95I(R,x,s,!1,!0),Ah(H,H._polylineModelMap),Ah(H,H._wireframeModelMap),H._swapLineMap(),R.disable(R.DEPTH_TEST),R.disable(R.BLEND),H._32O._42(R,x),H._30O._42(R,x),R.enable(R.DEPTH_TEST);Ec(R,s),ae(R,s)},r=!1,$=g*D,S=p*D,I=H.vr;I.enable&&I._42(R,$,S,f)&&(r=!0);var y=H.envRenderer;y&&y.enable&&y._42(R,$,S,f)&&(r=!0),r||(R.viewport(0,0,g*D,p*D),f()),H._33Q=!1,H._doBufferGC(R)}}},setBufferGCInterval:function(u){this._bufferGCInterval=u},_doBufferGC:function(H,g){var h=H._bufPool,e=h.length;if(e){var J,L,u=H._renderInfo.frame,y=this._bufferGCInterval||10,x=0;for(J=0;e>J;J++)L=h[J],L?(g||u-L._fid>y)&&(x++,H.deleteBuffer(L._buf),L._buf=null,h[J]=null):x++;if(x>e/2&&x>128){var Z=[];for(J=0;e>J;J++)h[J]&&Z.push(h[J]);H._bufPool=Z}else h._ivCount=x}},_swapLineMap:function(){var R=this;z=R._polylineModelMap,R._polylineModelMap=R._polylineModelMapSwap,R._polylineModelMapSwap=z,z=R._wireframeModelMap,R._wireframeModelMap=R._wireframeModelMapSwap,R._wireframeModelMapSwap=z,z=R._polylineIndexMap,R._polylineIndexMap=R._polylineIndexMapSwap,R._polylineIndexMapSwap=z,z=R._wireframeIndexMap,R._wireframeIndexMap=R._wireframeIndexMapSwap,R._wireframeIndexMapSwap=z},_updateSkyBoxPosition:function(G){if(this._skyBox&&G&&"eye"===G.property){var q=G.newValue;this._skyBox.p3(q[0],q[1],q[2]),this.invalidateData(this._skyBox)}},setSkyBox:function(f){this._skyBox=f,this.ump(this._updateSkyBoxPosition,this),this.invalidateAll(),f&&(this.mp(this._updateSkyBoxPosition,this),this._updateSkyBoxPosition())},drawSky:function(T,K,s){var t=this,P=t._skyBox;if(P){var W=t._headlightIntensity,d=Xe(t._headlightColor),K=t._prg;1!==W&&(d=[d[0]*W,d[1]*W,d[2]*W]),so(T,K.uHeadlightColor,[d[0],d[1],d[2],1]);var I=t.getData3dUI(P);I&&I._42(T,K,s,function(){return!0}),T.clear(T.DEPTH_BUFFER_BIT),so(T,K.uHeadlightColor,[d[0],d[1],d[2],t._headlightDisabled?1:0])}},_95I:function(g,C,Q,_,q){function j(F){if(!!F.s("shape3d.alwaysOnTop")==!!q&&M.isVisible(F)&&(!i||x)){if(!Q&&M.isTransparentMask(F))return;var Z=M.getData3dUI(F);Z&&Z._42(g,C,Q,f)}}var M=this,f=function(u){return _?u:!u};M.sky&&g.clear(g.DEPTH_BUFFER_BIT),M.dm().each(j)},getLogicalPoint:function(V){return Tg(V,this._canvas)},isRectOverlapping:function(G){var E=this.getData3dUI(G);return E._rectOverlapping},getHitFaceInfo:function(p){p.target&&(p=this.lp(p));var e=this.getDataInfoAt(p);if(e){var G=this._1o.face(e.data,dg(p.x,p.y));if(G)return{data:e.data,face:G}}return s},unproject:function(x,G){var R=this,I=R.getWidth(),_=R.getHeight(),v=x.target?R.lp(x):x,K=v.x-I/2,s=v.y-_/2,w=2*(K/I),n=2*(-1*s/_);G=G||0;var C=kr(),V=Dn(R),O=xb(R);nc(C,V,O),jf(C);var j=zi([w,n,G,1],C);return[j[0]/j[3],j[1]/j[3],j[2]/j[3]]},getDataAt:function(x){var H=this.getDataInfoAt(x);return H?H.data:s},getDataInfoAt:function(G,e){return G.target&&(G=this.lp(G)),this._1o.get(dg(G.x,G.y,e),!0)},getDatasInRect:function(i){return this._1o.get(i)},setEditable:function(t){var d=this,E=d._editable;d._editable=t,this.fp(Wk,E,t)},isEditable:function(B){var Y=this;return Y._editable?Cl(B)?B.s("3d.editable")?Y._editableFunc?Y._editableFunc(B):!0:!1:!1:!1},isSelectable:function(H){return H.s("3d.selectable")&&this.sm().isSelectable(H)},isMovable:function(i){var I=this;return $f(i)&&i.getStyle(Rj)!==qg?!1:i.s("3d.movable")?I._movableFunc?I._movableFunc(i):!0:!1},isSizeEditable:function(v){return Cl(v)?this._sizeEditableFunc?this._sizeEditableFunc(v):!0:!1},isRotationEditable:function(i){return Cl(i)&&i.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(i):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(p){this.setZoom(li,p)},zoomOut:function(I){this.setZoom(1/li,I)},setZoom:function(q,O){if(1!==q){var u=this;if(u._ortho)return u.setOrthoZoom(q,O),void 0;u._14o&&u._14o.stop(!0);var j=1/q,g=u._eye,V=u._center,k=V[0]+(g[0]-V[0])*j-g[0],G=V[1]+(g[1]-V[1])*j-g[1],C=V[2]+(g[2]-V[2])*j-g[2];if(!(dq(g,V)<u._moveStep&&1>j)){if(O=tq(O)){var v=cq(g);return O.action=function(J){u.fi({kind:u._zooming?"betweenZoom":"beginZoom"}),u._zooming=1,g[0]=v[0]+k*J,g[1]=v[1]+G*J,g[2]=v[2]+C*J,u.fp(is,s,g)},O._37o=function(){delete u._14o,delete u._zooming,u.fi({kind:"endZoom"}),u.onZoomEnded()},u._14o=Vb(O)}g[0]+=k,g[1]+=G,g[2]+=C,u.fp(is,s,g)}}},setOrthoZoom:function(j,O){if(1!==j){var z=this;z._14o&&z._14o.stop(!0);var i=z._orthoWidth,L=i/j-i;if(!(i<z._moveStep&&j>1))return(O=tq(O))?(O.action=function(f){z.fi({kind:z._zooming?"betweenZoom":"beginZoom"}),z._zooming=1,z.setOrthoWidth(i+L*f)},O._37o=function(){delete z._14o,delete z._zooming,z.fi({kind:"endZoom"}),z.onZoomEnded()},z._14o=Vb(O)):(z.setOrthoWidth(i/j),void 0)}},getPositionInfo:function(g){var c=this,v=c._eye,P=c._center,A=c.getAspect(),S=g?Eq(Wj(P,v,!0),Wj(g,v)):dq(v,P);if(c._ortho){var M=c._orthoWidth;return{length:S,height:M/A,width:M}}var K=2*l(c._fovy/2)*S;return{length:S,height:K,width:K*A}},getCenterInfo:function(){var h=this;return h._81O||(h._81O=h.getPositionInfo()),cq(h._81O)},rotate:function(M,i,D,K){var j=this;if(M||i){K==s&&(K=j._firstPersonMode),j._88O&&j._88O.stop(!0);var c=j._center,Y=j._eye,V=j.getCenterInfo().length,e=K?c:Y,p=K?Y:c,E=Wj(e,p),T=o(E[0],E[2]),m=o(O(E[0]*E[0]+E[2]*E[2]),E[1]),_=K?Vp:is;return K&&(i=-i),(D=tq(D))?(D.action=function(g){j.fi({kind:j._rotating?"betweenRotate":"beginRotate"}),j._rotating=1;var f=T+M*g,w=m+i*g;w=Sf(w),E[0]=V*t(w)*t(f),E[1]=V*P(w),E[2]=V*t(w)*P(f),e[0]=p[0]+E[0],e[1]=p[1]+E[1],e[2]=p[2]+E[2],j.fp(_,s,e)},D._37o=function(){delete j._88O,delete j._rotating,j.fi({kind:"endRotate"}),j.onRotateEnded()},j._88O=Vb(D)):(T+=M,m+=i,m=Sf(m),E[0]=V*t(m)*t(T),E[1]=V*P(m),E[2]=V*t(m)*P(T),e[0]=p[0]+E[0],e[1]=p[1]+E[1],e[2]=p[2]+E[2],j.fp(_,s,e),void 0)}},pan:function(k,q,M,Z){if(k||q){var x=this;Z==s&&(Z=x._firstPersonMode),x._89O&&x._89O.stop(!0);var m=xb(x),n=[m[0]*k,m[4]*k,m[8]*k],W=[m[1]*q,m[5]*q,m[9]*q],f=n[0]+W[0],y=n[1]+W[1],G=n[2]+W[2],h=x._center,a=x._eye;if(Z){var E=Ro(x.getBoundaries(),a[0],a[2],a[0]+f,a[2]+G,O(f*f+G*G));f=E[0],G=E[1]}if(M=tq(M)){var w=cq(a),r=cq(h);return M.action=function(F){x.fi({kind:x._panning?"betweenPan":"beginPan"}),x._panning=1,h[0]=r[0]+f*F,h[1]=r[1]+y*F,h[2]=r[2]+G*F,a[0]=w[0]+f*F,a[1]=w[1]+y*F,a[2]=w[2]+G*F,x.fp(is,s,a),x.fp(Vp,s,h)},M._37o=function(){delete x._89O,delete x._panning,x.fi({kind:"endPan"}),x.onPanEnded()},x._89O=Vb(M)}h[0]+=f,h[1]+=y,h[2]+=G,a[0]+=f,a[1]+=y,a[2]+=G,x.fp(is,s,a),x.fp(Vp,s,h)}},walk:function(m,c,Y){if(m){var H=this;Y==s&&(Y=H._firstPersonMode),H._90O&&H._90O.stop(!0);var i=H._center,b=H._eye,h=Wj(i,b,!0);if(Y){var O=Ro(H.getBoundaries(),b[0],b[2],b[0]+h[0]*m,b[2]+h[2]*m,A(m));if(m=dq(O),!m)return;h=[O[0]/m,0,O[1]/m]}if(c=tq(c)){var g=cq(b),f=cq(i);return c.action=function(A){H.fi({kind:H._walking?"betweenWalk":"beginWalk"}),H._walking=1;var M=m*A;b[0]=g[0]+h[0]*M,b[1]=g[1]+h[1]*M,b[2]=g[2]+h[2]*M,i[0]=f[0]+h[0]*M,i[1]=f[1]+h[1]*M,i[2]=f[2]+h[2]*M,H.fp(is,s,b),H.fp(Vp,s,i)},c._37o=function(){delete H._90O,delete H._walking,H.fi({kind:"endWalk"}),H.onWalkEnded()},H._90O=Vb(c)}b[0]+=h[0]*m,b[1]+=h[1]*m,b[2]+=h[2]*m,i[0]+=h[0]*m,i[1]+=h[1]*m,i[2]+=h[2]*m,H.fp(is,s,b),H.fp(Vp,s,i)}},handleScroll:function(T,_){T.preventDefault();var h=this,i=h._moveStep;h.isFirstPersonMode()?h.isPannable()&&h.pan(0,_>0?i:-i):h.isZoomable()&&h.setZoom(0>_?1/aq:aq)},handlePinch:function(j,m){this.isZoomable()&&this.setZoom(m>j?1/ts:ts)},reset:function(){this.setCenter(Z.graph3dViewCenter),this.setEye(Z.graph3dViewEye),this.setUp(Z.graph3dViewUp)},moveSelection:function(O,G,u){var L=this;L.dm().beginTransaction(),Sc(this.sm().toSelection(this.isMovable,this),O,G,u),L.dm().endTransaction()},getMoveMode:function(V,X){var g=X.s("3d.move.mode");if(g)return g;var b="88",C="89",_="90";return sb(V)||sq[b]&&sq[C]&&sq[_]?"xyz":sq[b]&&sq[C]?"xy":sq[b]&&sq[_]?"xz":sq[C]&&sq[_]?"yz":sq[b]?"x":sq[C]?"y":sq[_]?"z":"xz"},handleTick:function(){var G=this,e=!1,R=G._moveStep,z=R,X=!1,q=!0,r=G._rotateStep*(q?-1:1);if(G.isWalkable()||(z=0),G.isPannable()||(R=0),G.isRotatable()||(r=0),G._32Q){var $=(qo()-G._32Q)/50;z*=$,R*=$,r*=$}G._31Q&&(mh(G._31Q),delete G._31Q,delete G._32Q),Vd()&&(e=!0,G.pan(-R,0,X,q)),Tc()&&(e=!0,G.pan(R,0,X,q)),ij()&&(e=!0,sb()?G.pan(0,R,X,q):G.walk(z,X,q)),Dr()&&(e=!0,sb()?G.pan(0,-R,X,q):G.walk(-z,X,q)),Ee()&&(e=!0,G.rotate(-r,0,X,q)),Ck()&&(e=!0,G.rotate(r,0,X,q)),oo()&&(e=!0,G.rotate(0,-r/2,X,q)),Ni()&&(e=!0,G.rotate(0,r/2,X,q)),e&&(G._32Q=qo(),G._31Q=No(G.handleTick,G))},handleKeyDown:function(y){var c=this;!sf(y)&&Em[y.keyCode]?c.handleTick():Un(y)?c.selectAll():sl(y)?c.handleDelete(y):mm(y)&&this.isResettable()&&c.reset()},checkDoubleClickOnNote:function(I,N,h){var X=this;if(h===ip){if(N.s("note.toggleable"))return N.s(fc,!N.s(fc)),X.fi({kind:"toggleNote",event:I,data:N,part:h}),!0}else if(h===mp&&N.s("note2.toggleable"))return N.s(Li,!N.s(Li)),X.fi({kind:"toggleNote2",event:I,data:N,part:h}),!0;return!1},checkDoubleClickOnRotation:function(w,c,s){return s===Qb?(c.setRotationX(0),!0):s===jo?(c.setRotationY(0),!0):s===Ij?(c.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},toViewPosition:function(B){var K=this,i=K.getWidth()/2,d=K.getHeight()/2,Z=K._18Q;return Z&&Z._wh===i/d||(Z=Dn(K),K._18Q=nc(Z,Z,xb(K)),K._18Q._wh!==i/d),B=zi([B[0],B[1],B[2],1],Z),{x:i+i*B[0]/B[3],y:d-d*B[1]/B[3]}},getHitPosition:function(D,h,E){var O=this,v=O.getWidth(),B=O.getHeight(),Y=D.target?O.lp(D):D,t=Y.x-v/2,j=Y.y-B/2,p=O.getCenterInfo(),$=xb(O);h=h?h:[0,0,0],E=E?E:[0,1,0],t=t/v*p.width,j=-1*j/B*p.height;var V=[$[0]*t,$[4]*t,$[8]*t],R=[$[1]*j,$[5]*j,$[9]*j],d=[V[0]+R[0],V[1]+R[1],V[2]+R[2]],T=O.getCenter(),K=nh(O,h,E,[d[0]+T[0],d[1]+T[1],d[2]+T[2]]);return K?K:[0,0,0]},intersectObject:function(R,k){return this._raycaster.intersectObject(R,k)},getLineLength:function(v){this.validate();var J=this.getData3dUI(v);if(J&&J.getCache){var l=J.getCache();if(l)return l[l.length-1].length}return 0},getLineOffset:function(h,m){var y=this.getData3dUI(h);if(y&&y.getCache){var C=y.getCache();if(C)return Pd(C,m)}return s},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},flyTo:function(){function $(X,S,n){D.fromArray(vj(n,S.getMat(n)));var F=n.getAnchor3d();X.push((new tg).set(0-F.x,0-F.y,0-F.z).applyMatrix4(D)),X.push((new tg).set(0-F.x,0-F.y,1-F.z).applyMatrix4(D)),X.push((new tg).set(0-F.x,1-F.y,0-F.z).applyMatrix4(D)),X.push((new tg).set(0-F.x,1-F.y,1-F.z).applyMatrix4(D)),X.push((new tg).set(1-F.x,0-F.y,0-F.z).applyMatrix4(D)),X.push((new tg).set(1-F.x,0-F.y,1-F.z).applyMatrix4(D)),X.push((new tg).set(1-F.x,1-F.y,0-F.z).applyMatrix4(D)),X.push((new tg).set(1-F.x,1-F.y,1-F.z).applyMatrix4(D))}var Q=new tg,P=new tg,J=new tg,q=new tg,D=new rg;return function(U,y,B){var G=this;Q.fromArray(G.getEye()),P.fromArray(G.getCenter());var o,Z,F=[];if(U instanceof c.Node)J.fromArray(U.p3()),$(F,G,U),o=F.length;else{if(!U.length)return;for(F=[],U.forEach(function(V){$(F,G,V)}),J.set(0,0,0),o=F.length,Z=0;o>Z;Z++)J.add(F[Z]);J.multiplyScalar(1/o)}G.setCenter(J.x,J.y,J.z);var m,D=G.getNear();q.subVectors(Q,P),B||(B=.8);for(var s,I,K,b,S=10;S--;){for(G._eye[0]=q.x+J.x,G._eye[1]=q.y+J.y,G._eye[2]=q.z+J.z,m=Dn(G),nc(m,m,xb(G)),K=!0,b=-1/0,Z=0;o>Z;Z++){if(I=F[Z],s=zi([I.x,I.y,I.z,1],m),s[3]<D&&S){q.multiplyScalar(2),K=!1;break}b=Math.max(b,Math.max(Math.abs(s[0]),Math.abs(s[1]))/B-s[3])}if(K)break}if(q.setLength(b+q.length()).add(J),G._flyAnim&&G._flyAnim.stop(!0),y=tq(y)){G.setEye(Q.x,Q.y,Q.z),G.setCenter(P.x,P.y,P.z);var M=(new tg).subVectors(q,Q),Y=(new tg).subVectors(J,P),X=new tg,C=new tg;return y.action=function($){X.copy(Q).addScaledVector(M,$),C.copy(P).addScaledVector(Y,$),G.setCenter(C.x,C.y,C.z),G.setEye(X.x,X.y,X.z)},y._37o=function(){delete G._flyAnim},{lastEye:Q,lastCenter:P,eye:q,center:J,animation:G._flyAnim=Vb(y)}}return G.setEye(q.x,q.y,q.z),{lastEye:Q,lastCenter:P,eye:q,center:J}}}()}),Hg.RenderEnv=function(H){this.gv=H,this.enable=!1},D.defineProperties(Hg.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(Y){this._debugOn=Y,this.capture&&this.capture()}}}),D.assign(Hg.RenderEnv.prototype,{renderEnvToCube:function(j,$,b,w){var L=this,t=L.gv;if(!j||!$||!b)return L.enable=!1,L._42=null,void 0;L.enable=!0;var N=Math.floor(w/j*$),R=t.getGL(),r=L._renderTargets;r?r.length<b&&(r=L._renderTargets=r.concat(new Array(b-r.length))):r=L._renderTargets=new Array(b);for(var k=0;b>k;k++)r[k]?r[k].setSize(R,w,N):r[k]=new Hg.RenderTarget(t,R,w,N);var B=!1;L.capture=function(){B=!0,t._42(),B=!1};var I=new tg,l=new tg,y=new tg,F=new tg,u=(new tg).setY(0),i=2*Math.PI/b,a=j/2/Math.tan(Math.PI/b),J=2*Math.atan2($/2,a),d=j/$;L._42=function(W,O,D,H){var T=L._debugOn;if(!B&&!T)return!1;I.copy(t.getEye()),F.copy(t.getCenter()).sub(I);var c=Math.atan2(F.z,F.x),f=t.getNear(),P=t.getFovy(),Q=t.getAspect();l.copy(t.getCenter());for(var C,S=0;b>S;S++)if(C=r[S],u.setZ(Math.cos(c)).setX(Math.sin(c)).multiplyScalar(a),c-=i,y.addVectors(I,u),t.setNear(a),t.setCenter([y.x,y.y,y.z]),t.setFovy(J),t.setAspect(d),T){var o=Math.round(O/b);W.viewport(o*S,0,o,D),H()}else ve(W,C.frame),W.viewport(0,0,C.width,C.height),W.clear(W.COLOR_BUFFER_BIT),H(),ve(W,s),C.assureTexture();return t.setNear(f),t.setCenter([l.x,l.y,l.z]),t.setFovy(P),t.setAspect(Q),!0},L.capture()},getTextureInfo:function(V){var K=this._renderTargets;if(!K)return null;var $=this._renderTargets[V];return $?{index:V,texture:$.texture,textureName:$.uuid}:null}}),D.assign(Hg.Graph3dView.prototype,{renderEnvToCube:function(t,K,D,q){var G=this;G.envRenderer||(G.envRenderer=new Hg.RenderEnv(G)),G.envRenderer.renderEnvToCube(t,K,D,q)}}),Hg.RenderTarget=function(r,D,n,k){var d=this;d.uuid=c.Math.generateUUID(),d.gv=r,d.init(r,D),d.setSize(D,n,k)},D.assign(Hg.RenderTarget.prototype,{init:function(P,_){var s=this,W=s.texture=_.createTexture();_.activeTexture(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,W),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,_.NEAREST),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,_.NEAREST),_.bindTexture(_.TEXTURE_2D,null),s.render=_.createRenderbuffer(),s.frame=_.createFramebuffer(),P._2O[s.uuid]=W},assureTexture:function(){var l=this,X=l.uuid,d=l.gv._2O;d[X]||(d[X]=l.texture)},setSize:function(H,U,L){var T=this;if(T.width!==U||T.height!==L){var i=H.RGBA,z=H.TEXTURE_2D,p=H.RENDERBUFFER,D=H.FRAMEBUFFER;bb(H,T.texture),H.texImage2D(z,0,i,U,L,0,i,H.UNSIGNED_BYTE,s),Xm(H,H.TEXTURE_MIN_FILTER,H.LINEAR),H.bindRenderbuffer(p,T.render),H.renderbufferStorage(p,H.DEPTH_COMPONENT16,U,L),ve(H,T.frame),H.framebufferTexture2D(D,H.COLOR_ATTACHMENT0,z,T.texture,0),H.framebufferRenderbuffer(D,H.DEPTH_ATTACHMENT,p,T.render),bb(H,s),H.bindRenderbuffer(p,s),ve(H,s),T.width=U,T.height=L}},toCanvas:function(){var C=this,h=C.gv.getGL();h.bindFramebuffer(h.FRAMEBUFFER,C.frame);var O=C.width,W=C.height,m=new Uint8Array(4*O*W);h.readPixels(0,0,O,W,h.RGBA,h.UNSIGNED_BYTE,m),h.bindFramebuffer(h.FRAMEBUFFER,null);var j=G.createElement("canvas");j.width=O,j.height=W;var r=j.getContext("2d"),d=r.createImageData(O,W);return d.data.set(m),r.putImageData(d,0,0),j}});var lg=Hg.Interactor=function(J){this.gv=J};Fg("Interactor",D,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var Rc=Hg.DefaultInteractor=function(c){fm(Rc,this,[c])};Fg("DefaultInteractor",lg,{handle_contextmenu:function(f){Jr(f)},handle_mousewheel:function(T){this.gv.handleScroll(T,T.wheelDelta/40)},handle_DOMMouseScroll:function(R){2===R.axis&&this.gv.handleScroll(R,-R.detail)},handle_keydown:function(G){this.gv.handleKeyDown(G)},handle_mousedown:function(J){this.handle_touchstart(J)},handle_touchstart:function(A){Jr(A);var X=this,_=X.gv,h=db(A),n=_.getDataInfoAt(A),r=n?n.data:s,z=n?n.part:s,N=_.sm(),Z=Uo(A),S=qe(A);_.setFocus(A)&&(X._62O=s,X._57I=s,r?sf(A)?N.co(r)?N.rs(r):N.as(r):N.co(r)||N.ss(r):h&&(sf(A)?_.isRectSelectable()&&(X._62O=Gh):X._57I=gh(A)),X._31Q&&(mh(X._31Q),delete X._31Q,delete X._32Q),X._62O||(_.isFirstPersonMode()&&(sb(A)||S>2?X._62O="pan":_.isMouseRoamable()||nb?(X._62O="roaming",X.foward=Z&&db(A),X._32Q=qo(),X._31Q=No(X.tick,X)):h||(X._62O="roaming")),X._62O||(h&&Z&&gr[z]?(X._62O=z,X.p3=r.p3()):h&&Z&&Cl(r)&&_.isSelected(r)?_.isMovable(r)?(X._62O="move",X.p3=r.p3(),X.movedata=r):_.isInteractive(r)&&(X._62O="none"):nb&&(S>2?X._62O="pan":2===S&&(X.dist=Kf(A),X._62O="pinch")))),X.point=_.lp(A),ym(X,A),yk(A)?_.handleDoubleClick(A,r,z):_.handleClick(A,r,z))},tick:function(){var n=this,Q=n.gv,E=Q._moveStep;n.point&&Q.isWalkable()&&(n._32Q&&(E*=(qo()-n._32Q)/50),Q.walk(n.foward?E:-E),n._32Q=qo(),n._31Q=No(n.tick,n))},handle_mouseup:function($){this.handle_touchend($)},handle_touchend:function(h){var L=this._57I;L&&(dq(L,gh(h))<=1&&this.gv.sm().cs(),this._57I=s)},handleWindowMouseMove:function(P){this.handleWindowTouchMove(P)},handleWindowTouchMove:function(Y){var S,u,m=this,g=m.gv,x=m._62O,D=m.point,_=g.dm(),p=g.lp(Y),j=p.x-D.x,O=p.y-D.y,H=-v*j/g.getWidth(),R=-v*O/g.getHeight();if("roaming"===x)m.rotate(Y,H/2,R/2);else if(x===Qb||x===jo||x===Ij)g._86O||_.beginTransaction(),g.fi({kind:g._86O?"betweenEditRotation":"beginEditRotation",event:Y}),g._86O=1,g.sm().each(function(n){if(Cl(n)&&g.isRotationEditable(n)){var q=A(H)>A(R)?H:R;x===Qb?n.setRotationX(n.getRotationX()+q):x===jo?n.setRotationY(n.getRotationY()+q):x===Ij&&n.setRotationZ(n.getRotationZ()+q)}});else if("move"===x||gr[x]){x===pj||x===Hf||x===ko?(g._87O||_.beginTransaction(),g.fi({kind:g._87O?"betweenEditSize":"beginEditSize",event:Y}),g._87O=1):(g._moving||_.beginTransaction(),g.fi({kind:g._moving?"betweenMove":"beginMove",event:Y}),g._moving=1);var r,I=m.p3,F=g.getPositionInfo(I),G=xb(g);r=x===Qj?"x":x===Kq?"y":x===vn?"z":x===pj?"sx":x===Hf?"sy":x===ko?"sz":g.getMoveMode(Y,m.movedata),j=j/g.getWidth()*F.width,O=-1*O/g.getHeight()*F.height;var E,q,C=[G[0]*j,G[4]*j,G[8]*j],Z=[G[1]*O,G[5]*O,G[9]*O],t=C[0]+Z[0],P=C[1]+Z[1],e=C[2]+Z[2],l=[I[0]+t,I[1]+P,I[2]+e],Q=Wj(g.getEye(),l,!0);if("xyz"===r?(E=l,g.moveSelection(t,P,e)):"xz"===r?(E=nh(g,I,[0,1,0],l),E&&g.moveSelection(E[0]-I[0],0,E[2]-I[2])):"xy"===r?(E=nh(g,I,[0,0,1],l),E&&g.moveSelection(E[0]-I[0],E[1]-I[1],0)):"yz"===r?(E=nh(g,I,[1,0,0],l),E&&g.moveSelection(0,E[1]-I[1],E[2]-I[2])):"x"===r||"sx"===r?(Q[0]=0,E=nh(g,I,Q,l),E&&(q=E[0]-I[0],"x"===r?g.moveSelection(q,0,0):g.sm().each(function(E){Cl(E)&&g.isSizeEditable(E)&&(S=M(sg,E.getWidth()+q),u=S/E.getWidth(),E.setWidth(S),sb(Y)&&(E.setHeight(E.getHeight()*u),E.setTall(E.getTall()*u)))}))):"y"===r||"sy"===r?(Q[1]=0,E=nh(g,I,Q,l),E&&(q=E[1]-I[1],"y"===r?g.moveSelection(0,q,0):g.sm().each(function(e){Cl(e)&&g.isSizeEditable(e)&&(S=M(sg,e.getTall()+q),u=S/e.getTall(),e.setTall(S),sb(Y)&&(e.setHeight(e.getHeight()*u),e.setWidth(e.getWidth()*u)))}))):("z"===r||"sz"===r)&&(Q[2]=0,E=nh(g,I,Q,l),E&&(q=E[2]-I[2],"z"===r?g.moveSelection(0,0,q):g.sm().each(function(B){Cl(B)&&g.isSizeEditable(B)&&(S=M(sg,B.getHeight()+q),u=S/B.getHeight(),B.setHeight(S),sb(Y)&&(B.setTall(B.getTall()*u),B.setWidth(B.getWidth()*u)))
}))),!E)return;m.p3=E}else if(x===Gh){var o=m.div;o||(o=m.div=mc(),zd(m.getView(),o),o.op=D,o.style.background=g.getRectSelectBackground()),g.fi({kind:g._rectSelecting?"betweenRectSelect":"beginRectSelect",event:Y}),g._rectSelecting=1,o.rect=Ge(o.op,p),_p(o,o.rect)}else if("pinch"===x&&2===qe(Y)){g.fi({kind:g._pinching?"betweenPinch":"beginPinch",event:Y}),g._pinching=1;var q=Kf(Y);g.handlePinch(q,m.dist),m.dist=q}else"pan"===x||sb(Y)?m.pan(Y,j,O):"none"===x||g.isFirstPersonMode()||(db(Y)?m.rotate(Y,H,R):(m.pan(Y,j,0),g.isWalkable()&&(g.fi({kind:g._walking?"betweenWalk":"beginWalk",event:Y}),g._walking=1,g.walk(O/g.getHeight()*g.getCenterInfo().height))));m.point=p},pan:function(u,V,X){var O=this.gv;if(O.isPannable()){var d=O.getCenterInfo(),E=V/O.getWidth()*d.width,H=-1*X/O.getHeight()*d.height;O.fi({kind:O._panning?"betweenPan":"beginPan",event:u}),O._panning=1,O.pan(-E,-H)}},rotate:function(z,H,k){var c=this.gv;c.isRotatable()&&(c.fi({kind:c._rotating?"betweenRotate":"beginRotate",event:z}),c._rotating=1,c.rotate(H,k))},handleWindowMouseUp:function(E){this.handleWindowTouchEnd(E)},handleWindowTouchEnd:function(C){var y=this,R=y.gv,T=R.dm(),G=y.div;if(G){var W=R.getDatasInRect(G.rect);if(!W.isEmpty()){var a=R.sm(),B=a.toSelection();W.each(function(v){a.co(v)?B.remove(v):B.add(v)}),a.ss(B)}bj(G)}R._moving&&(delete R._moving,R.fi({kind:"endMove",event:C}),R.onMoveEnded(),T.endTransaction()),R._panning&&(delete R._panning,R.fi({kind:"endPan",event:C}),R.onPanEnded()),R._rotating&&(delete R._rotating,R.fi({kind:"endRotate",event:C}),R.onRotateEnded()),R._86O&&(delete R._86O,R.fi({kind:"endEditRotation",event:C}),T.endTransaction()),R._87O&&(delete R._87O,R.fi({kind:"endEditSize",event:C}),T.endTransaction()),R._pinching&&(delete R._pinching,R.fi({kind:"endPinch",event:C}),R.onPinchEnded()),R._rectSelecting&&(delete R._rectSelecting,R.fi({kind:"endRectSelect",event:C}),R.onRectSelectEnded()),R._walking&&(delete R._walking,R.fi({kind:"endWalk",event:C}),R.onWalkEnded()),y.dist=y.point=y._62O=y.p3=y.movedata=y.div=y._57I=y._32Q=y._31Q=y.foward=s}});var Dj=Hg.MapInteractor=function(P){fm(Dj,this,[P]),this._minPhi=0,this._maxPhi=5*_/12,this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01};Fg("MapInteractor",lg,{handle_contextmenu:function(J){Jr(J)},handle_mousewheel:function($){this.gv.handleScroll($,$.wheelDelta/40)},handle_DOMMouseScroll:function(I){2===I.axis&&this.gv.handleScroll(I,-I.detail)},handle_keydown:function(i){this.gv.handleKeyDown(i)},handle_mousedown:function(I){this.handle_touchstart(I)},handle_touchstart:function(b){Jr(b);var R=this,W=R.gv;if(W.setFocus(b)){W.lp(b);var C=W.getDataInfoAt(b),c=C?C.data:s,K=C?C.part:s;if(!c||!W.isInteractive(c)){var p=R.editing={point:W.lp(b)};nb?p.touch=!0:(p.touch=!1,p.pan=db(b)),ym(R,b)}yk(b)?W.handleDoubleClick(b,c,K):W.handleClick(b,c,K)}},handle_mouseup:function(Y){this.handle_touchend(Y)},handle_touchend:function(){},handleWindowMouseMove:function(k){this.handleWindowTouchMove(k)},handleWindowTouchMove:function(o){var H=this,Z=H.gv,b=H.editing;if(b){var A=Z.lp(o),F=b.point,u=A.x-F.x,g=A.y-F.y;if(!b.moved){if(Math.abs(u)<H.threshold&&Math.abs(g)<H.threshold&&!(o.touches&&o.touches.length>1))return;b.moved=!0}if(b.point=A,b.touch){var D=o.touches.length;if(2!==D)H.pan(o,u,g);else{if(1>=D)return;var w=o.touches,x={x:w[0].clientX,y:w[0].clientY},p={x:w[1].clientX,y:w[1].clientY},T={x:p.x-x.x,y:p.y-x.y},E=b.lastCenter,W=Math.atan2(T.y,T.x),P=b.theta,N=0;P==s?P=b.theta=W:(N=W-P,b.thetaStarted||Math.abs(N)>H.touchRotateThreshold?(b.thetaStarted=!0,b.theta=W):N=0);var d=_*(x.y+p.y)/2/Z.getHeight(),I=b.phi,a=0;I==s?I=b.phi=d:(a=d-I,b.phiStarted||Math.abs(a)>H.touchRotateThreshold?(b.phiStarted=!0,b.phi=d):a=0);var f,n=Math.sqrt(T.x*T.x+T.y*T.y),j=b.vlen;if(j){var M=x.x-E.x,h=x.y-E.y,R=p.x-E.x,i=p.y-E.y,V=Math.sqrt(M*M+h*h),c=Math.sqrt(R*R+i*i),S=j/2,C=H._sign2(V-S),O=H._sign2(c-S);0>C*O||0===C&&0===O?(f=1,b.vlen=n):(f||(f=n/j),b.scaleStarted||Math.abs(f-1)>H.touchScaleThreshold?(b.vlen=n,b.scaleStarted=!0):f=1)}else j=b.vlen=n,f=1;1!==f&&Z.setZoom(f),(a||N)&&H.rotate(o,N,-a),b.lastCenter={x:(p.x+x.x)/2,y:(p.y+x.y)/2}}}else if(b.pan)H.pan(o,u,g);else{var r=-v*u/Z.getWidth(),U=-v*g/Z.getHeight();H.rotate(o,r,U)}}},_sign2:function(F){return Math.abs(F)<this._touchScaleCheckAccuracy?0:F>0?1:-1},handleWindowMouseUp:function(I){this.handleWindowTouchEnd(I)},handleWindowTouchEnd:function(q){var z=this,i=z.editing;if(z.editing=null,i){var R=z.gv;if(!i.moved&&i.pan){var k=R.getDataAt(q);k?R.sm().setSelection([k]):R.sm().clearSelection()}else R._panning=null,R._rotating=null,R.fi({kind:i.pan?"endPan":"endRotate",event:q})}},pan:function(g,A,p){var F=this,_=F.gv;if(_.isPannable()){var R=_.getCenterInfo(),D=-A/_.getWidth()*R.width,P=1*p/_.getHeight()*R.height;_.fi({kind:_._panning?"betweenPan":"beginPan",event:g}),_._panning=1;var u=F.keepHorizon,i=F.editing.touch;if((i&&g.touches&&g.touches.length>1||!i&&sb(g))&&(u=!u),!u)return _.pan(D,P);if(D||P){var l=xb(_),N=[l[0]*D,l[4]*D,l[8]*D],H=[l[1],0,l[9]],W=Math.sqrt(H[0]*H[0]+H[2]*H[2]);W&&(H=[H[0]/W*P,0,H[2]/W*P]);var M=N[0]+H[0],t=N[1]+H[1],$=N[2]+H[2],V=_._center,J=_._eye;V[0]+=M,V[1]+=t,V[2]+=$,J[0]+=M,J[1]+=t,J[2]+=$,_.fp(is,s,J),_.fp(Vp,s,V)}}},rotate:function(B,L,r){var X=this,R=X.gv;if(R.isRotatable()){var v=R._center,e=R._eye,G=Wj(e,v),S=o(O(G[0]*G[0]+G[2]*G[2]),G[1]),d=S+r;d=Math.max(X.minPhi,Math.min(X.maxPhi,d)),r=d-S,R.fi({kind:R._rotating?"betweenRotate":"beginRotate",event:B}),R._rotating=1,R.rotate(L,r)}}}),D.defineProperties(Dj.prototype,{minPhi:{get:function(){return this._minPhi},set:function(h){this._minPhi=h}},maxPhi:{get:function(){return this._maxPhi},set:function(s){this._maxPhi=s}},keepHorizon:{get:function(){return this._keepHorizon},set:function(Y){this._keepHorizon=Y}},threshold:{get:function(){return this._threshold},set:function(X){this._threshold=X}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function($){this._touchScaleThreshold=$}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(P){this._touchRotateThreshold=P}}});var Lp=function(Q){this.gv=Q};xl(Lp,D,{_iv:!0,iv:function(){this._iv=!0},face:function(M,E){var N=this,y=N.gv.getGL();if(!y||!Cl(M))return s;var D=E.x,F=E.width,w=E.height,Z=N.height-E.y-w,t=p(F/2),f=new Uint8Array(4*F*w),A=0;for(N.iv(),N.validate(M),ve(y,N.frame),y.readPixels(D,Z,F,w,y.RGBA,y.UNSIGNED_BYTE,f),ve(y,s),N.iv();t>=A;A++)for(var G=t-A,O=t+A,K=G;O>=K;K++)for(var V=G;O>=V;V++)if(K===G||K===O||V===G||V===O){var k=Io.m[f[4*(K*F+V)]];if(k)return k}},get:function(i,D){this.validate();var h=this,b=h.gv.getGL();if(!b)return s;var W,z,N=i.x,o=i.width,m=i.height,A=h.height-i.y-m,k=p(o/2),j=new Uint8Array(4*o*m),r=0,Z=j.length,S=D?s:new Yd,X=D?s:{};if(ve(b,h.frame),b.readPixels(N,A,o,m,b.RGBA,b.UNSIGNED_BYTE,j),ve(b,s),D){for(;k>=r;r++)for(var F=k-r,n=k+r,w=F;n>=w;w++)for(var T=F;n>=T;T++)if((w===F||w===n||T===F||T===n)&&(W=h.info(j,4*(w*o+T))))return W}else for(;Z>r;r+=4)W=h.info(j,r),W&&(z=W.data,X[z._id]||(S.add(z),X[z._id]=z));return S},info:function(I,z){return this.colorMap[(I[z]<<16)+(I[z+1]<<8)+I[z+2]+((127&I[z+3])<<24)]},validate:function($){var E=this,J=E.gv,e=J.getGL();if(e){var g=J.getWidth(),w=J.getHeight(),m=e.RGBA,X=e.TEXTURE_2D,K=e.RENDERBUFFER,b=e.FRAMEBUFFER;E.texture||(E.texture=Am(e),E.render=e.createRenderbuffer(),E.frame=e.createFramebuffer()),(E.width!==g||E.height!==w)&&(bb(e,E.texture),e.texImage2D(X,0,m,g,w,0,m,e.UNSIGNED_BYTE,s),Xm(e,e.TEXTURE_MIN_FILTER,e.LINEAR),e.bindRenderbuffer(K,E.render),e.renderbufferStorage(K,e.DEPTH_COMPONENT16,g,w),ve(e,E.frame),e.framebufferTexture2D(b,e.COLOR_ATTACHMENT0,X,E.texture,0),e.framebufferRenderbuffer(b,e.DEPTH_ATTACHMENT,K,E.render),bb(e,s),e.bindRenderbuffer(K,s),ve(e,s),E.width=g,E.height=w),E._iv&&(E._iv=!1,ve(e,E.frame),J._42($||(E.colorMap={}),1),ve(e,s))}}});var Oo=function(I){this.gv=I};xl(Oo,D,{gap:0,size:0,_42:function(p,b){var V=this,u=V.gv,B=u._gridGap,H=u._gridSize;if(u._gridVisible){if(V.gap!==B||V.size!==H){for(var G=[],X=u._gridSize/2,$=B*X,N=0;2*X+1>N;N++){var L=6*N,Q=6*(2*X+1)+L;G[L]=-$,G[L+1]=0,G[L+2]=-$+N*B,G[L+3]=$,G[L+4]=0,G[L+5]=-$+N*B,G[Q]=-$+N*B,G[Q+1]=0,G[Q+2]=-$,G[Q+3]=-$+N*B,G[Q+4]=0,G[Q+5]=$}V.vs=new Jm(G),V.gap=B,V.size=H}gk(u),yo(p,b),go(p),Bo(p,b,1,u._gridColor,u._buffer.vs,V.vs),Xc(p,0,V.vs.length/3,p.LINES),Pc(p),pn(p,b)}else V.vs=V.gap=V.size=s}});var eq=function(X){this.gv=X};xl(eq,D,{_42:function(V,o){var A=this.gv,B=A._buffer.vs,z=A._axisXColor,u=A._axisYColor,Q=A._axisZColor,M=A._originAxisVisible,j=A._centerAxisVisible;if(M||j){var q=a?V.TRIANGLES:V.TRIANGLE_FAN,l=V.LINES;if(gk(A),yo(V,o),go(V),M){var b=A.getCenterInfo(),I=d(b.width,b.height)/5,$=.8*I,Z=.05*I;Bo(V,o,1.5,z,B,new Jm([0,0,0,I,0,0,$,Z,0,$,0,Z,$,-Z,0,$,0,-Z,$,Z,0,0,0,0,0,I,0,Z,$,0,0,$,Z,-Z,$,0,0,$,-Z,Z,$,0,0,0,0,0,0,I,Z,0,$,0,Z,$,-Z,0,$,0,-Z,$,Z,0,$])),Xc(V,0,2,l),Xc(V,1,6,q),Bo(V,o,s,u),Xc(V,7,2,l),Xc(V,8,6,q),Bo(V,o,s,Q),Xc(V,14,2,l),Xc(V,15,6,q)}if(j){var n=A._center,k=n[0],R=n[1],f=n[2],b=A.getPositionInfo(n);I=d(b.width,b.height)/20,Bo(V,o,1.5,z,B,new Jm([k,R,f,k+I,R,f,k,R,f,k,R+I,f,k,R,f,k,R,f+I])),Xc(V,0,2,l),Bo(V,o,s,u),Xc(V,2,2,l),Bo(V,o,s,Q),Xc(V,4,2,l)}Pc(V),pn(V,o)}}});var op=function(v){this.gv=v},Qj="edit_tx",Kq="edit_ty",vn="edit_tz",Qb="edit_rx",jo="edit_ry",Ij="edit_rz",pj="edit_sx",Hf="edit_sy",ko="edit_sz",gr={};gr[Qj]=1,gr[Kq]=1,gr[vn]=1,gr[Qb]=1,gr[jo]=1,gr[Ij]=1,gr[pj]=1,gr[Hf]=1,gr[ko]=1,xl(op,D,{_42:function(f,j,h){var $=this,s=$.gv,V=s.sm().ld();if(s.isEditable(V)&&!s.isEditHelperDisabled()&&Cl(V)&&(!s.isFirstPersonMode()||!s.isMouseRoamable()&&!nb)){gk(s);var l,a,g=s.isMovable(V),X=s.isRotationEditable(V),W=s.isSizeEditable(V),t=s._axisXColor,N=s._axisYColor,i=s._axisZColor,D=s._editSizeColor,y=s.getCenterInfo(),v=d(y.width,y.height)/10,r=v/(h?5:10),c=.7*v,o=.4*c,e=V.p3(),T=e[0],C=e[1],S=e[2];l=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],g&&$._17O(f,j,V,h,Qj,t,l,[T,C-r,S,T+c,C-r,S,T+c,C,S,T+c,C,S,T,C,S,T,C-r,S,T,C-r,S+r,T+c,C-r,S+r,T+c,C-r,S,T+c,C-r,S,T,C-r,S,T,C-r,S+r]),a=T+c,W&&$._17O(f,j,V,h,pj,D,l,[a,C-r,S,a+o,C-r,S,a+o,C,S,a+o,C,S,a,C,S,a,C-r,S,a,C-r,S+r,a+o,C-r,S+r,a+o,C-r,S,a+o,C-r,S,a,C-r,S,a,C-r,S+r]),a+=o,X&&$._17O(f,j,V,h,Qb,t,l,[a,C-r,S,a+o,C-r,S,a+o,C,S,a+o,C,S,a,C,S,a,C-r,S,a,C-r,S+r,a+o,C-r,S+r,a+o,C-r,S,a+o,C-r,S,a,C-r,S,a,C-r,S+r]),l=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],g&&$._17O(f,j,V,h,Kq,N,l,[T,C,S,T,C+c,S,T-r,C+c,S,T-r,C+c,S,T-r,C,S,T,C,S,T,C,S,T,C,S-r,T,C+c,S-r,T,C+c,S-r,T,C+c,S,T,C,S]),a=C+c,W&&$._17O(f,j,V,h,Hf,D,l,[T,a,S,T,a+o,S,T-r,a+o,S,T-r,a+o,S,T-r,a,S,T,a,S,T,a,S,T,a,S-r,T,a+o,S-r,T,a+o,S-r,T,a+o,S,T,a,S]),a+=o,X&&$._17O(f,j,V,h,jo,N,l,[T,a,S,T,a+o,S,T-r,a+o,S,T-r,a+o,S,T-r,a,S,T,a,S,T,a,S,T,a,S-r,T,a+o,S-r,T,a+o,S-r,T,a+o,S,T,a,S]),l=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],g&&$._17O(f,j,V,h,vn,i,l,[T,C,S,T,C,S+c,T,C-r,S+c,T,C-r,S+c,T,C-r,S,T,C,S,T,C-r,S,T-r,C-r,S,T-r,C-r,S+c,T-r,C-r,S+c,T,C-r,S+c,T,C-r,S]),a=S+c,W&&$._17O(f,j,V,h,ko,D,l,[T,C,a,T,C,a+o,T,C-r,a+o,T,C-r,a+o,T,C-r,a,T,C,a,T,C-r,a,T-r,C-r,a,T-r,C-r,a+o,T-r,C-r,a+o,T,C-r,a+o,T,C-r,a]),a+=o,X&&$._17O(f,j,V,h,Ij,i,l,[T,C,a,T,C,a+o,T,C-r,a+o,T,C-r,a+o,T,C-r,a,T,C,a,T,C-r,a,T-r,C-r,a,T-r,C-r,a+o,T-r,C-r,a+o,T,C-r,a+o,T,C-r,a])}},_17O:function(o,q,l,d,X,P,U,c){var h=this.gv._buffer;Tn(o,q,d,!0,l,X),xk(o,q,s,!0,s,!0,s,!1),so(o,q.uDiffuse,P),Ec(o,h.vs,new Jm(c),q.aPosition),Ec(o,h.ns,new Jm(U),q.aNormal),go(o),Xc(o,0,12),Pc(o),fe(o,q)}});var Ac=c.Raycaster=function(r){this.gv=r};If("Raycaster",D,{intersect:function(K){var M=this,l=M.gv,G=l.getDataAt(K);return G?M.intersectObject(K,G):null},intersectObject:function(D,R){if(D instanceof In)return this._intersectObjectImpl(D,R);var E,B,f=this,G=f.gv;B=G.unproject(D);var y=G.getEye();G.isOrtho()?(E=Wj(G.getCenter(),y),E[0]+=E[0],E[1]+=E[1],E[2]+=E[2]):E=y,E=new tg(E);var O=new tg(B).sub(E).normalize(),o=new c.Math.Ray(E,O);return f._intersectObjectImpl(o,R)},_intersectObjectImpl:function(){function g(){var A=new tg;return A.subVectors(Y,j),a.subVectors(G,j),A.cross(a).normalize(),A}function K(G,d,L,i,y,s,X){return Ff.barycoordFromPoint(G,d,L,i,Z),y.multiplyScalar(Z.x),s.multiplyScalar(Z.y),X.multiplyScalar(Z.z),y.add(s).add(X),y.clone()}var s=new rg,m=new rg,f=new In,x=new tg,i=new tg,T=new tg,o=new tg,q=new tg,G=new tg,j=new tg,Y=new tg,u=new Gg,A=new Gg,N=new Gg,a=new tg,Q={vs:ll,is:$r,uv:ih},Z=new tg;return function(O,p){var F=this.gv.getData3dUI(p),I=p.mat||F.mat;if(I){s.fromArray(I),m.getInverse(s),f.copy(O).applyMatrix4(m);var J,n,M="body",a=F.shapeModel;if(a||(a=Me(F)),a||(p instanceof c.Node&&!(p instanceof c.Shape)?(J=!0,a=Q):(n=!0,a=[F.left,F.front,F.right,F.back,F.top,F.bottom])),!a)return console.log("Can not find shape model."),null;Dc(a)||(a=[a]);var _,l,L,w,H,y,X,C,R,S,v,Z,t,h=1/0,B=["","top_","bottom_"],z=!1;for(_=0,l=a.length;l>_;_++)if(Z=a[_])for(L=0,w=B.length;w>L;L++)if(t=B[L],X=Z[t+"vs"],C=Z[t+"is"],R=Z[t+"uv"]||Z[t+"tuv"],X)for(H=0,y=C?C.length:X.length/3;y>H;H+=3)C?(i.fromArray(X,3*C[H]),T.fromArray(X,3*C[H+1]),o.fromArray(X,3*C[H+2])):(i.fromArray(X,3*H),T.fromArray(X,3*(H+1)),o.fromArray(X,3*(H+2))),S=f.intersectTriangle(i,T,o,!1,x),S&&(v=f.origin.distanceTo(S),h>v&&(h=v,q.copy(S),G.copy(i),j.copy(T),Y.copy(o),""!==t?M=t.slice(0,-1):J?M=Md[Math.floor(H/6)]:n&&(M=Md[_]),R&&(z=!0,C?(u.fromArray(R,2*C[H]),A.fromArray(R,2*C[H+1]),N.fromArray(R,2*C[H+2])):(u.fromArray(R,2*H),A.fromArray(R,2*(H+1)),N.fromArray(R,2*(H+2))))));if(!isFinite(h))return null;var P,$=q.clone().applyMatrix4(s);z&&(P=K(q,G,j,Y,u,A,N));var b=g(G,j,Y),k=g(G.applyMatrix4(s),j.applyMatrix4(s),Y.applyMatrix4(s)),E=f.direction.dot(b);return E>0&&(b.multiplyScalar(-1),k.multiplyScalar(-1)),{world:$,local:q.clone(),worldNormal:k,normal:b,uv:P,part:M}}}}()});var un=function(c,y){this.gv=c,this.s=function(g,B,w){return B==s&&(B=w),B==s?y.getStyle(g):Rp(B,y,c)},this.data=y};xl(un,D,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(C,Z,d,e){var B=this,y=B.data;if(!(y instanceof xc)){var T,q,a,X,o,M,F,p=B.gv,G=y._id,L=B.s("shape3d.alwaysOnTop")?null:B.s("batch"),t=p._batchIndexMap,m=p._batchModelMap,u=p.isSelectable(y),i=p.getBrightness(y),_=i!=s&&1!==i;if(B.needValidate(C)){if(a=Lk(t,m,y,L),B.validate(a,L?jh[L]||Cc:s),a&&(X=t[G],o=X.size=a.vs.length/3-X.begin,F=a.rs))for(i=_?i:1,M=0;o>M;M++)F.push(i);if(Cl(y)){var $=p.getWireframeGeometry(y);if($)Kb(p,y,$);else{var k=p.getWireframe(y);k&&Kb(p,y,k)}}B.labelInfo=B.label2Info=B.noteInfo=B.note2Info=B._38o=s,B._24O(Xo,"getLabel"),B._24O(um,"getLabel2"),B._26O(ip,"getNote"),B._26O(mp,"getNote2"),B._15O(),B.interactiveInfo=p.isInteractive(y)?{}:s,B._iv=!1}_&&so(C,Z.uBrightness,i),so(C,Z.uAlphaTest,B.s("alphaTest")),q=Tn(C,Z,d,u,y,Hr),q&&(yq(q,t[G],m),yq(q,p._polylineIndexMap[G],p._polylineModelMap),yq(q,p._wireframeIndexMap[G],p._wireframeModelMap)),t[G]||B._80o(C,Z,e),p.isLabelVisible(y)&&((T=B.labelInfo)&&(Tn(C,Z,d,u,y,Xo),B._28O(T,Xo,e)),(T=B.label2Info)&&(Tn(C,Z,d,u,y,um),B._28O(T,um,e))),p.isNoteVisible(y)&&((T=B.noteInfo)&&(Tn(C,Z,d,u,y,ip),B._29O(T,ip,e)),(T=B.note2Info)&&(Tn(C,Z,d,u,y,mp),B._29O(T,mp,e))),(T=B._38o)&&B._99O(C,Z,T,d,u,e),_&&so(C,Z.uBrightness,1)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return rl},_80o:function(){},dispose:function(){},_calcAnchorMat:function(H){if(H.hasOwnProperty("_anchor")||H.hasOwnProperty("_anchorElevation")){var M=H.getAnchor3d(),z={x:M.x-.5,y:M.y-.5,z:M.z-.5},m=kr();return Ih(m,[-z.x,-z.y,-z.z]),m}},getBodyColor:function(G){var r=this.data,o=this.gv.getBodyColor(r);return o?o:G?r.getStyle(G):s},_24O:function(w,J){var j=this,v=j.data,X=j.gv,r=j.s,C=X[J](v);if(C!=s){var c=r(w+".scale"),z=r(w+".max"),D=j[w+"Info"]={label:C,textureScale:r(w+".texture.scale"),color:X[J+"Color"](v),font:r(w+".font"),align:r(w+".align"),background:X[J+"Background"](v)},K=D.rect=nq(D,C);z>0&&z<K.width&&(D.labelWidth=K.width,K.width=z),K.x=K.y=0,K.width*=c,K.height*=c,D.mat=j._16O(r(w+".autorotate"),r(w+".position"),K,r(w+".face"),r(w+".t3"),r(w+".r3"),r(w+".rotationMode"));var n=K.width/2,H=K.height/2;D.vs=new Jm([-n,H,0,-n,-H,0,n,-H,0,n,H,0]),K.width/=c,K.height/=c}},_26O:function(X,Y){var T=this,x=T.data,v=T.gv,e=T.s,H=v[Y](x);if(H!=s){var _=e(X+".scale"),w=this[X+"Info"]={note:H,textureScale:e(X+".texture.scale"),expanded:e(X+".expanded"),font:e(X+".font"),color:e(X+".color"),align:e(X+".align"),borderWidth:e(X+".border.width"),borderColor:e(X+".border.color"),background:v[Y+"Background"](x)};if(w.expanded){var N=e(X+".max"),A=nq(w,H);A.width+=6,A.height+=2,N>0&&N<A.width&&(w.labelWidth=A.width,A.width=N);var u={x:-A.width/2,y:-8-A.height,width:A.width,height:A.height+8}}else u={x:-6,y:-18,width:12,height:18};w.mat=T._16O(e(X+".autorotate"),e(X+".position"),s,e(X+".face"),e(X+".t3"),e(X+".r3"),e(X+".rotationMode")),w.rect=u,1!==_&&(u=cq(u),u.x*=_,u.height*=_,u.y=-u.height,u.width*=_);var O=u.x,Z=u.y,W=u.width,D=u.height;w.vs=new Jm([O,-Z,0,O,-Z-D,0,O+W,-Z-D,0,O+W,-Z,0])}},_28O:function(V,H,s){if(s(this.s(H+".transparent"))){var M=V.rect,T=V.textureScale,q=M.width*T,L=M.height*T;if(q>=1&&L>=1){var v=zm(q,L);1!==T&&(v.translate(v,M.x,M.y),v.scale(T,T),v.translate(v,-M.x,-M.y)),tr(v,V),v.restore(),Hq(this,H,V.mat,V.vs,!0)}}},_29O:function(N,U,k){if(k(this.s(U+".transparent"))){var u=N.rect,x=N.textureScale,T=u.x,f=u.y,V=u.width*x,A=u.height*x;if(V>=1&&A>=1){u.x=u.y=0;var F=zm(V,A);1!==x&&F.scale(x,x),Si(F,N),F.restore(),u.x=T,u.y=f,Hq(this,U,N.mat,N.vs,!1)}}},_99O:function($,i,h,M,O,v){if(h){var j=this,P=j.gv,n=j.data,t=P._buffer,B=P._1O,m=h.icons;for(var X in m){var y=m[X],I=h.rects[X];if(I&&v(Rp(y.transparent,n,P))){Tn($,i,M,O,n,X);var V=Rp(y.shape3d,n,P),w=V?[V]:Rp(y.names,n,P),W=w?w.length:0,a=Rp(y.textureScale,n,P)||1,R=Rp(y.light,n,P);R==s&&(R=V?!0:!1),xk($,i,Rp(y.blend,n,P),R,Rp(y.opacity,n,P),Rp(y.reverseFlip,n,P),Rp(y.reverseColor,n,P),Rp(y.reverseCull,n,P));for(var E=0;W>E;E++){var z=w[E],Z=I[E];if(dk(j,Z.mat),V)Or(P,n,Me(j,V),j);else{var _=sr(z);if(_){var C=Z.width*a,x=Z.height*a;if(C>=1&&x>=1){var b=zm(C,x);pc(b,_,Rp(y.stretch,n,P),0,0,C,x,n,P),b.restore(),Am($,Co,B),go($,i,B,Rp(y.discardSelectable,n,P),t.uv,ls),Ec($,t.vs,Z.vs,i.aPosition),Td($,t.ns,il,i.aNormal),up($,t.is,Gq),fn($,0,Gq.length),Pc($,i,B)}}}jd(P)}fe($,i)}}}}});var Ik=function(P,m){fm(Ik,this,[P,m])};xl(Ik,un,{_16O:function(S,l,z,n,p,s,w,J,Y){var P=this.data,H=P.getFinalScale3d(),C=Jg(l,H,z,n,J,Y);if(P.hasOwnProperty("_anchor")||P.hasOwnProperty("_anchorElevation")){var r=P.getAnchor3d();C[0]-=(r.x-.5)*H[0],C[1]-=(r.y-.5)*H[1],C[2]-=(r.z-.5)*H[2]}return pe(kr(),C,P.p3(),n,p,s,w,S,P.getFinalRotation3d(),P.getRotationMode())},clear:function(){var C=this;C.faceMat=C.mat=C.shapeModel=C.left=C.right=C.front=C.back=C.top=C.bottom=C.csg=s},needValidate:function(T){if(this._iv)return this._validateFrameId=T._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var D=T._renderInfo.frame;if(this._validateFrameId!==D)return this._validateFrameId=D,!0}return!1},validate:function(g,P){var E=this,Y=E.gv,j=E.data,s=Me(E);E._updateAutoRotation(),E._updateFixSize2d(),E._updateOverlapping(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(Ao(Y,j,"_wireframeModelMap","_wireframeIndexMap"),Ao(Y,j,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var k=vj(j,Y.getMat(j),s?E.s("shape3d.scaleable"):!0),S=E._calcAnchorMat(j);if(S&&nc(k,k,S),j.mat=k,E.clear(),g){var c=[];s?Sm(Y,j,s,E,E.getBodyColor(),[k],g,c):(_n(Y,j,g,P,k,Zq,c,Iq),_n(Y,j,g,P,k,Oi,c,fg),_n(Y,j,g,P,k,Tp,c,hg),_n(Y,j,g,P,k,Rk,c,vh),_n(Y,j,g,P,k,ad,c,Pm),_n(Y,j,g,P,k,Ed,c,hi)),c.length&&(wm(g.vs,c),wm(g.ns,gs(c)))}else E.mat=k,(E.shapeModel=s)||(E._cubeUvs=null,E.vf(Zq,0),E.vf(Oi,16),E.vf(ad,8),E.vf(Ed,24),E.vf(Tp,32),E.vf(Rk,40))},_updateAutoRotation:function(){var K=this,M=K.data,m=K.s("shape3d.autorotate");if(!m)return M._dynamicRotation&&delete M._dynamicRotation,void 0;var U,C=K.gv;U="string"==typeof m?[m.indexOf("x")<0?C._eye[0]:C._center[0],m.indexOf("y")<0?C._eye[1]:C._center[1],m.indexOf("z")<0?C._eye[2]:C._center[2]]:C._eye;var h=C._center,y=[U[0]-h[0],U[1]-h[1],U[2]-h[2]],o=M.p3(),a=rk([o[0]+y[0],o[1]+y[1],o[2]+y[2]],o,C._up),i=M.r3(),z=Hc(a,M.getRotationMode());Math.abs(i[0]-z[0])<1e-5&&Math.abs(i[1]-z[1])<1e-5&&Math.abs(i[2]-z[2])<1e-5||(M._dynamicRotation=z)},_updateFixSize2d:function(){var Q=this,A=Q.data,X=Q.s("shape3d.fixSizeOnScreen");if(!X)return A._dynamicScale3d&&delete A._dynamicScale3d,void 0;var q=Q.gv;A.getFinalScale3d();var i=vj(A,q.getMat(A)),K=kh([0,0,0],i),b=q.toViewPosition(K);if(!isNaN(b.x)&&!isNaN(b.y)){var r=kh([1,0,0],i),_=q.toViewPosition(r),p=kh([0,1,0],i),j=q.toViewPosition(p),w=_.x-b.x,S=j.y-b.y,Z=A._dynamicScale3d||[1,1,1],c=sr(A.s("shape3d.image")),n=X[0]>0?X[0]:c?Db(c,Q):20,v=X[1]>0?X[1]:c?Vc(c,Q):20,U=Math.abs(w/n),W=Math.abs(S/v);Math.abs(U-1)<.001&&Math.abs(W-1)<.001||(A._dynamicScale3d=[Z[0]/U,Z[1]/W,Z[2]])}},_updateOverlapping:function(){var H=this,s=H.s("hide.overlapping.group");if(!s)return H._rectOverlapping&&(H._rectOverlapping=w),void 0;var E,t,r,B=H.gv,S=H.data,X=vj(S,B.getMat(S)),Q=1/0,O=1/0,n=-1/0,Y=-1/0,G=S.getAnchor3d(),M=G.x,b=G.y,P=G.z;for(E=0;8>E;E++){if(t=kh([(E>>2)-M,(1&E>>1)-b,(1&E)-P],X),r=B.toViewPosition(t),isNaN(r.x)||isNaN(r.y))return;Q=Math.min(Q,r.x),n=Math.max(n,r.x),O=Math.min(O,r.y),Y=Math.max(Y,r.y)}var T={x:Q,y:O,w:n-Q,h:Y-O};H._rectOverlapping=B.overlappingBox.isOverlapping(s,T)},getVectorDynamicSize:function(){var U,a=this,y=a.s("shape3d"),T=a.data;if("billboard"===y||"plane"===y||(U=T._currentCubeElementId)!=s){var r,w,N=a.gv,S=vj(T,N.getMat(T)),n=function(F,A){var b=N.toViewPosition(kh(F,S)),l=N.toViewPosition(kh(A,S)),j=b.x-l.x,f=b.y-l.y;return Math.min(2048,Math.sqrt(j*j+f*f))};if("billboard"===y)r=n([-.5,0,0],[.5,0,0]),w=n([0,-.5,0],[0,.5,0]);else if("plane"===y)r=n([-.5,0,0],[.5,0,0]),w=n([0,0,-.5],[0,0,.5]);else if(T._currentCubeElementId!=s){var C=3*$r[U+1],d=3*$r[U],z=3*$r[U+2];r=n([ll[C],ll[C+1],ll[C+2]],[ll[z],ll[z+1],ll[z+2]]),w=n([ll[C],ll[C+1],ll[C+2]],[ll[d],ll[d+1],ll[d+2]])}return[r,w]}},getCachedTexture:function(){var t=this,C=t.data,I=C._currentCubeElementId;return I!=s?t._cubeCachedImage?t._cubeCachedImage[I]:null:t._shape3dCachedImage},setCachedTexture:function(K){var r=this,g=r.data,o=g._currentCubeElementId;if(o!=s){if(!r._cubeCachedImage)return r._cubeCachedImage={};r._cubeCachedImage[o]=K}else r._shape3dCachedImage=K},invalidateCachedTexture:function(m){var Z,x,J,q=this;if((J=q._shape3dCachedImage)&&(m.deleteTexture(J),q._shape3dCachedImage=null),x=q._cubeCachedImage){for(Z in x)m.deleteTexture(x[Z]);q._cubeCachedImage=null}},vf:function(I,y){var m=this;if(m.gv.getFaceVisible(m.data,I)){var Q=Tf(m,I);Q.mat&&(m.faceMat=!0);var G=Q.uv;if(G){var V=m._cubeUvs;V||(V=m._cubeUvs=new Jm([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var x=0;8>x;x++)V[y+x]=G[x]}return Q}},_80o:function(h,k,P){var X=this;if(X._rectOverlapping)return!0;var B=X.gv,S=X.data,t=B._cube,O=X.shapeModel;gk(B,X.mat),O?Or(B,S,O,X,X.getBodyColor(),P):(Ec(h,t.vs,s,k.aPosition),Ec(h,t.ns,s,k.aNormal),ae(h,t.is),X._18O(h,k,X.left,0,P),X._18O(h,k,X.front,6,P),X._18O(h,k,X.right,12,P),X._18O(h,k,X.back,18,P),X._18O(h,k,X.top,24,P),X._18O(h,k,X.bottom,30,P)),jd(B),X.faceMat&&(X._18O(h,k,X.left,0,P,!0),X._18O(h,k,X.front,6,P,!0),X._18O(h,k,X.right,12,P,!0),X._18O(h,k,X.back,18,P,!0),X._18O(h,k,X.top,24,P,!0),X._18O(h,k,X.bottom,30,P,!0))},_18O:function(r,T,t,d,C,P){if(t){if(!C(t.transparent))return;if(P&&!t.mat||!P&&t.mat)return;P&&gk(this.gv,t.mat);var E=this,z=E.data;z._currentCubeElementId=d;var h=E.gv,U=h.getTexture(t.texture,z),O=t.uv,V=t.uvScale,w=t.uvOffset,i=t.discardSelectable;U?O?go(r,T,U,i,h._buffer.uv,E._cubeUvs,w,V):go(r,T,U,i,h._cube.uv,s,w,V):go(r),xk(r,T,t.blend,t.light,t.opacity,t.reverseFlip,t.reverseColor,t.reverseCull),so(r,T.uDiffuse,t.color),fn(r,d,6),fe(r,T),Pc(r,T,U),P&&jd(h),z._currentCubeElementId=null}}});var Ym=function(R,Q){fm(Ym,this,[R,Q])};xl(Ym,un,{_25Q:1,validate:function(i){var A=this,f=A.gv,n=A.data,N=A.s,e=N("edge.width"),y=n._40I,Q=n._41I;if(A.shapeModel=A.info=s,y&&Q){var o,V,P,v,F,u,X,T,j,t,m=n.isLooped(),I=N(Rj),r=Z.getEdgeType(I);if(r){var O=r(n,sp(A,f,n,m,I),f,A._19Q);if(!O.points||O.points.isEmpty())return;u=A.info={},X=O.segments,F=O.points,T=F.size();for(var H=y.getElevation(),E=Q.getElevation(),C=0;T>C;C++){var x=F.get(C);x.e==s&&(x.e=H+(E-H)*C/(T-1))}j=cf(F.get(0)),t=cf(F.get(T-1));var M=T%2;0===M?(u.c1=cf(F.get(T/2-1)),u.c2=cf(F.get(T/2))):u.p3=cf(F.get((T-M)/2)),u.s1=j,u.s2=cf(F.get(1)),u.t1=cf(F.get(T-2)),u.t2=t}else{F=new Yd,u=A.info={};var U=N("edge.offset"),q=N("edge.center"),a=N("edge.source.t3"),c=N("edge.target.t3"),l=y.p3(),h=Q.p3();if(a&&(l[0]+=a[0],l[1]+=a[1],l[2]+=a[2]),c&&(h[0]+=c[0],h[1]+=c[1],h[2]+=c[2]),I===qg){X=N("edge.segments");var D=u.points=N(Ce)||$l;if(T=D.size()){j=cf(D.get(0)),t=cf(D.get(T-1)),!q&&U&&(P=Wj(j,l,!0),U=d(U,dq(l,j)),l=[l[0]+P[0]*U,l[1]+P[1]*U,l[2]+P[2]*U],P=Wj(h,t,!0),U=d(U,dq(t,h)),h=[h[0]-P[0]*U,h[1]-P[1]*U,h[2]-P[2]*U]);var M=T%2;0===M?(o=cf(D.get(T/2-1)),V=cf(D.get(T/2))):u.p3=cf(D.get((T-M)/2)),u.s1=l,u.s2=j,u.t1=t,u.t2=h}else!q&&U&&(P=Wj(h,l,!0),v=dq(l,h),U=Mb(U,v),l=[l[0]+P[0]*U,l[1]+P[1]*U,l[2]+P[2]*U],h=[h[0]-P[0]*U,h[1]-P[1]*U,h[2]-P[2]*U]),o=l,V=h;F.add({x:l[0],y:l[2],e:l[1]}),F.addAll(D),F.add({x:h[0],y:h[2],e:h[1]})}else{var b=sp(A,f,n,m,I);if(A._19Q||(b=-b),m){var R=l[0],B=l[1],_=l[2],W=y.getTall()/2+b;o=[R-b,B+W,_],V=[R+b,B+W,_],F.add({x:R-b,y:_,e:B}),F.add({x:R-b,y:_,e:B+W}),F.add({x:R+b,y:_,e:B+W}),F.add({x:R+b,y:_,e:B})}else{P=Wj(h,l,!0),v=dq(l,h);var J={x:l[0],y:l[2]},S={x:h[0],y:h[2]},k=ak(s,J,S,b),G=k.x-J.x,p=k.y-J.y;U=Mb(U,v),P[0]*=U,P[1]*=U,P[2]*=U,o=[l[0]+P[0]+G,l[1]+P[1],l[2]+P[2]+p],V=[h[0]-P[0]+G,h[1]-P[1],h[2]-P[2]+p],q?(F.add({x:l[0],y:l[2],e:l[1]}),F.add({x:o[0],y:o[2],e:o[1]}),F.add({x:V[0],y:V[2],e:V[1]}),F.add({x:h[0],y:h[2],e:h[1]})):(F.add({x:o[0],y:o[2],e:o[1]}),F.add({x:V[0],y:V[2],e:V[1]}))}}u.c1=o,u.c2=V}u.list=N(mn)===es?A.createTubeModel(F,X,e/2,i):A.createLineModel(F,X,e,"edge","edge.dash")}}});var dm=function(w,a){fm(dm,this,[w,a])};xl(dm,Ik,{_80o:function(N,b,Q){var j=this,W=j.gv,D=j.shapeModel;gk(W,j.mat),D?Or(W,j.data,D,j,j.getBodyColor(),Q):(cd(j,N,b,j.left,Q),cd(j,N,b,j.front,Q),cd(j,N,b,j.right,Q),cd(j,N,b,j.back,Q),cd(j,N,b,j.top,Q),cd(j,N,b,j.bottom,Q)),jd(W)},validate:function(t,j){var N,J,I=this,S=I.s,f=I.data,R=f.p3(),g=f._thickness/2,O=f.isClosePath(),y=f.getPoints(),E=f.getSegments(),r=S(re),L=t&&t.uv;if(I.clear(),0>g)J=I.shapeModel=_j(y,E,S(Cq),S(Yb),r,S($q),f.getTall(),f.getShapeElevation(),O),S(Yp)?S("shape3d.image")||delete J.uv:(delete J.vs,delete J.ns,delete J.uv),S("shape3d.top.image")||delete J.top_uv,S("shape3d.bottom.image")||delete J.bottom_uv;else if(S(mn)===es)N=kb(y,E,r,O),J=I.shapeModel={vs:[]},S("shape3d.image")&&(J.uv=[],J.sum=S($q)||je(N)||1,J.len=0),S(Cq)&&!O&&(J.top_vs=[],S("shape3d.top.image")&&(J.top_uv=[])),S(Yb)&&!O&&(J.bottom_vs=[],S("shape3d.bottom.image")&&(J.bottom_uv=[])),I._12O(N,g);else{var b,H,p,c,Z,B,Q,l,T,Y;if(N=kb(y,E,r,O),Z=I.vf(ad,L,!1,j),g&&(B=I.vf(Ed,L,!1,j),Q=O?s:I.vf(Zq,L,!1,j),l=O?s:I.vf(Oi,L,!1,j),T=I.vf(Tp,L,!1,j),Y=I.vf(Rk,L,!1,j)),g){for(var _=0,v=N.length;v>_;_++)N[_]=I._tryRemoveBezierPoints(N[_],g);I._12O(N,g)}else Z&&N.forEach(function(n){if(c=n.length,c>0)for(b=n[0],p=1;c>p;p++)H=n[p],I.addV(Z.vs,b,H),b=H});I._20Q(N),t||(Z&&(Z.ns=gs(Z.vs),vm(Z,"vs"),vm(Z,gg)),g&&(B&&(B.ns=gs(B.vs),vm(B,"vs"),vm(B,gg)),Q&&(Q.ns=gs(Q.vs),vm(Q,"vs"),vm(Q,gg)),l&&(l.ns=gs(l.vs),vm(l,"vs"),vm(l,gg)),T&&(T.ns=gs(T.vs),vm(T,"vs"),vm(T,gg)),Y&&(Y.ns=gs(Y.vs),vm(Y,"vs"),vm(Y,gg))))}var d=I.mat=kr();Ih(d,R),Mn(d,f.getFinalRotation3d(),f.getRotationMode());var q=f.getScale3d(),P=f._dynamicScale3d;P&&(q[0]*=P[0],q[1]*=P[1],q[2]*=P[2]),Ld(d,q),Ih(d,rp(R)),t&&(bs(I,d,t,J),I.clear())},_20Q:function(T){var f,e,x,d,Y,G,p,Z=this,v=Z.front,J=Z.back,_=Z.top,H=Z.bottom,L=v?v.tuv:s,o=J?J.tuv:s,q=_?_.tuv:s,N=H?H.tuv:s,k=0;(L||o||q||N)&&(f=Z.s($q)||je(T)||1,T.forEach(function(w){if(e=w.length,e>0)for(G=w[0],x=1;e>x;x++)p=w[x],d=k/f,k+=dq(G,p),Y=k/f,Z._14O(v,d,Y),Z._14O(J,1-Y,1-d),Z._14O(_,d,Y),Z._14O(H,d,Y),G=p}))},_14O:function(H,R,K){if(H){var U=H.uv,N=H.tuv;if(N){if(U)var Y=U[0]+(U[6]-U[0])*R,Q=U[1]+(U[7]-U[1])*R,$=U[2]+(U[4]-U[2])*R,G=U[3]+(U[5]-U[3])*R,j=U[2]+(U[4]-U[2])*K,c=U[3]+(U[5]-U[3])*K,f=U[0]+(U[6]-U[0])*K,e=U[1]+(U[7]-U[1])*K;else Y=R,Q=0,$=R,G=1,j=K,c=1,f=K,e=0;N.push($,G,j,c,f,e,f,e,Y,Q,$,G)}}},_13O:function(l){var F=l.uv,x=l.tuv;x&&(F?x.push(F[2],F[3],F[4],F[5],F[6],F[7],F[6],F[7],F[0],F[1],F[2],F[3]):x.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(s,k){var h=s.length;if(4>h)return s;var T,C,W,d,f,P,x=!1,M=function(U){return s[U]},p=function(S){return s[h-1-S]};for(f=0;1>=f;f++)for(P=f?p:M,C=P(0),W=P(1),T=2;h-1>T;T++)if(d=P(T),!d.remove)if(d.b){var r=ak(C,W,d,k);r.adjust?(d.remove=!0,x=!0):(C=W,W=d)}else C=W,W=d;if(!x)return s;var n=[];for(T=0;h>T;T++)s[T].remove||n.push(s[T]);return n},_12O:function(j,q){var n,D,U,C,l,O=this;j.forEach(function(Z){if(l=Z.length,l>0)for(n={p:Z[0],n:!0},C=1;l>C;C++)D=Z[C],U=l-1>C?Z[C+1]:s,O.addPoint(n,D,U,q,Z)})},addPoint:function(K,A,o,B,T){var Q,U,x,g,a,Z,W,I,p,e=this,J=K.p,V=K.f,r=K.b,u=e.s("shape3d.side")||Cm,F=e.s("shape3d.start.angle"),l=e.s("shape3d.sweep.angle"),X=e.shapeModel,M=e.data.isClosePath();if(K.n&&(K.n=!1,V=M&&T.length>2?ak(T[T.length-2],J,A,B):ak(s,J,A,B),r=pk(J,V),X?X.top_vs&&e._10O(r,V,u,F,l,X.top_vs,X.top_uv):(Q=e.left)&&(e.addV(Q.vs,r,V),e._13O(Q))),U=o?ak(J,A,o,B):M&&T.length>2?ak(J,A,T[1],B):ak(J,A,s,B),x=pk(A,U),X){var D,i,N=X.vs,h=X.uv,$=X.sum;for(h&&(D=X.len/$,X.len+=dq(J,A),i=X.len/$),Z=e._9O(r,V,u,F,l),W=e._9O(x,U,u,F,l),I=0;u>I;I++)p=I+1,wm(N,Z[p]),wm(N,W[I]),wm(N,Z[I]),wm(N,W[I]),wm(N,Z[p]),wm(N,W[p]),h&&(g=I/u,a=p/u,h.push(D,a,i,g,D,g,i,g,D,a,i,a));!o&&X.bottom_vs&&e._10O(x,U,u,F,l,X.bottom_vs,X.bottom_uv,!0)}else!o&&(Q=e.right)&&(e.addV(Q.vs,U,x),e._13O(Q)),(Q=e.front)&&e.addV(Q.vs,V,U),(Q=e.back)&&e.addV(Q.vs,x,r),(Q=e.top)&&e.addH(Q.vs,V,U,x,r,!0),(Q=e.bottom)&&e.addH(Q.vs,r,x,U,V);K.p=A,K.f=U,K.b=x},_10O:function(G,Q,F,E,I,N,b,j){var C,D,x=this,r=x.data,B=x._9O(G,Q,F,E,I),y=(G.x+Q.x)/2,k=(G.y+Q.y)/2,$=r.getShapeElevation(),n=0;for(n=0;F>n;n++)j?(wm(N,B[n]),wm(N,B[n+1])):(wm(N,B[n+1]),wm(N,B[n])),wm(N,[y,$,k]),b&&(j?(C=v*(n+1)/F+E,D=v*n/F+E):(C=v*n/F+E,D=v*(n+1)/F+E),b.push(.5-.5*P(D),.5-.5*t(D),.5-.5*P(C),.5-.5*t(C),.5,.5))},_9O:function(g,L,T,p,r){var s,b,m=this,k=m.data,B=[],q=(g.x+L.x)/2,Z=(g.y+L.y)/2,S=k.getTall()/2,W=k.getShapeElevation(),M=0;for(r=r||v;T>=M;M++)s=r*M/T+p,b=P(s),B.push([q+(g.x-q)*b,W+S*t(s),Z+(g.y-Z)*b]);return B},addV:function(M,g,c){var e=g.x,V=g.y,p=c.x,Y=c.y,j=this.data,r=j.getShapeElevation(),W=j.getTall()/2;M.push(e,r-W,V,p,r-W,Y,p,r+W,Y,p,r+W,Y,e,r+W,V,e,r-W,V)},addH:function(p,v,e,G,j,z){var q=this.data,g=q.getTall()/2,B=q.getShapeElevation()+(z?g:-g);p.push(v.x,B,v.y,e.x,B,e.y,G.x,B,G.y,G.x,B,G.y,j.x,B,j.y,v.x,B,v.y)},vf:function(Y,Q,c,k){var W,T=this,B=T.gv.getFaceVisible(T.data,Y);return(c||B)&&(W=Tf(T,Y,k),W.vs=[],W.tuv=B&&(W.texture||Q)?[]:s,W.visible=B),W}});var _q=function(I,D){fm(_q,this,[I,D])};xl(_q,un,{_25Q:1,validate:function(y){var E=this,r=E.data,Y=E.s,I=r.getPoints(),p=I.size();if(E.shapeModel=E.info=s,p>1){var N=E.info={},Z=r.getSegments(),B=r.getThickness(),a=cf(I.get(0)),e=cf(I.get(p-1)),L=p%2;0===L?(N.c1=cf(I.get(p/2-1)),N.c2=cf(I.get(p/2))):N.p3=cf(I.get((p-L)/2)),N.s1=a,N.s2=cf(I.get(1)),N.t1=cf(I.get(p-2)),N.t2=e,N.list=Y(mn)===es?E.createTubeModel(I,Z,B/2,y):E.createLineModel(I,Z,B,"shape.border","shape.dash")}var U=r.p3(),m=E.mat=kr();Ih(m,U),Mn(m,r.getFinalRotation3d(),r.getRotationMode());var T=r.getScale3d(),A=r._dynamicScale3d;A&&(T[0]*=A[0],T[1]*=A[1],T[2]*=A[2]),Ld(m,T),Ih(m,rp(U))},_80o:function(Q,Y,v){var J=this,m=J.shapeModel;if(m){var W=J.gv;gk(W,J.mat),Or(W,J.data,m,J,J.getBodyColor(),v),jd(W)
}}});var ui=c.graph3d.VR=function(Z){var k=this;k.gv=Z,k._controllers=[],k.switch=new zn(k),k._enable=!1,k._defaultCallLater=c.Default.callLater,"undefined"!=typeof K&&"VRFrameData"in K&&(k._frameData=new K.VRFrameData),k.measureOflength=1,k.eyesOffset=[0,0,0]};xl(ui,D,{ms_fire:!0,_42:function(n,v,y,s){var $=this,H=$.gv,b=$._device;if(b){var N=$._measureOflength;if(b.depthNear=H.getNear()*N,b.depthFar=H.getFar()*N,$._controllers.forEach(function($){$&&$.update()}),b.isPresenting===!1)return H.iv(),!1;var T=$._frameData;b.getFrameData(T);var k=T.pose.position;return k&&H.setEye($.toViewPosition(k)),n.viewport(0,0,v/2,y),$._viewMatrix=$._copyViewMatrix(T.leftViewMatrix),$._projectMatrix=$._copyProjectMatrix(T.leftProjectionMatrix),s(),n.viewport(v/2,0,v/2,y),$._viewMatrix=$._copyViewMatrix(T.rightViewMatrix),$._projectMatrix=$._copyProjectMatrix(T.rightProjectionMatrix),s(),$._lastViewMatrix=$._viewMatrix,$._lastProjectMatrix=$._projectMatrix,$._viewMatrix=null,$._projectMatrix=null,$.submitFrame(),!0}},addController:function(f){f=f||0;var B=this,T=B.getController(f);return T?T:(T=new gq(B,f),B._controllers.push(T),T)},getController:function(E){E=E||0;for(var m=this._controllers,K=0,w=m.length;w>K;K++)if(m[K]&&m[K].id===E)return m[K];return null},removeController:function(E){E=E||0;for(var N=this._controllers,R=0,c=N.length;c>R;R++)if(N[R]&&N[R].id===E)return N.splice(R,1),!0;return!1},toViewPosition:function(h,S){var O=this,G=O._scaleFactor,i=O._eyesOffset;return S?(S[0]=h[0]*G+i[0],S[1]=h[1]*G+i[1],S[2]=h[2]*G+i[2],S):[h[0]*G+i[0],h[1]*G+i[1],h[2]*G+i[2]]},_copyViewMatrix:function(x){var p=this.dup(x),U=this._scaleFactor;p[12]*=U,p[13]*=U,p[14]*=U;var t=this._eyesOffset;if(t&&(t[0]||t[1]||t[2])){var H=t[0],c=t[1],Z=t[2];p[12]-=p[0]*H+p[4]*c+p[8]*Z,p[13]-=p[1]*H+p[5]*c+p[9]*Z,p[14]-=p[2]*H+p[6]*c+p[10]*Z}return p},shutdown:function(){var R=this._device;R&&R.isPresenting&&R.exitPresent()},isPresenting:function(){var s=this._device;return s&&s.isPresenting},_copyProjectMatrix:function(A){var w=this.dup(A),S=this._scaleFactor;return w[14]*=S,w},dup:function(M,k){for(var n=M.length,p=k||new Array(n);n--;)p[n]=M[n];return p},getViewMatrix:function(N){var j=this._viewMatrix;return j?this.dup(j,N):void 0},getProjectMatrix:function(){var V=this._projectMatrix;return V?this.dup(V):void 0},submitFrame:function(){var S=this;if(S._enable&&S._deviceInAction){var q=S._device;q&&q.isPresenting&&(q.submitFrame(),S.gv.iv())}},setDevice:function(O){var j=this;j._device=O},_injectCallLaterFunc:function(x){var u=this;if(!x)return No=c.Default.callLater=u._defaultCallLater,void 0;var u=this;No=c.Default.callLater=function(i,d,n,W){var Y=u._device;return Y&&Y.isPresenting?W?F(function(){No(i,d,n)},W):Y.requestAnimationFrame(function(){u._deviceInAction=!0,i.apply(d,n),u._deviceInAction=!1}):(u._defaultCallLater(i,d,n,n),void 0)}}}),D.defineProperties(ui.prototype,{enable:{get:function(){return this._enable},set:function(p){var X=this;X._enable!==p&&(X._enable=p,p?(X.switch.showButton(),X._injectCallLaterFunc(!0)):(X.shutdown(),X.switch.hideButton(),X._injectCallLaterFunc(!1)))}},measureOflength:{get:function(){return this._measureOflength},set:function(O){this._measureOflength=O;var Z=this._scaleFactor=1/O;this._controllers.forEach(function(T){T&&T._setScaleFactor(Z)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(d){this._eyesOffset=d}}});var gq=function(s,y){function i(v){var O=navigator.getGamepads&&navigator.getGamepads();if(O)for(var N=0,u=0,Y=O.length;Y>N;N++){var X=O[N];if(X){var P=X.id;if("OpenVR Gamepad"===P||"OpenVR Controller"===P||0===P.indexOf("Oculus Touch")||0===P.indexOf("Spatial Controller")){if(u===v)return X;u++}}}}function b(B,j,a){return Math.abs(B[0]-j[0])<a&&Math.abs(B[1]-j[1])<a&&Math.abs(B[2]-j[2])<a?!0:!1}var f=this;f.vr=s,f.id=y;var A,I,n=[0,0],R=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],X=new Zm;f.getGamepad=function(){return I},f.getButtonState=function(H){R.forEach(function(y){return y.id===H?y.pressed:void 0})},f.getNode=function(){return X};var Y=.003;f.setRotationEpsilon=function(P){Y=P};var $=5e-4,T=$;f.setPositionEpsilon=function(u){$=u,T=u*f.vr._scaleFactor},f._setScaleFactor=function(D){X.s3(D,D,D),T=$*D};var F,g=new ub,C=new rg,H=[0,0,0],q=[0,0,0],L=new tg,N=new In;f.getRay=function(){return F?(N.origin.fromArray(H),N.direction.copy(L),F=!1,N):N},f.update=function(){if(A=I,I=i(y),A!==I&&console.log("gamepad changed",I),!I||I.pose===w)return I=null,X.s("shape3d.visible",!1),void 0;X.dm()||s.gv.dm().add(X),X.s("shape3d.visible",!0);var V=I.pose;if(null!==V){V.position&&(f.vr.toViewPosition(V.position,H),b(X.p3(),H,T)||(F=!0,X.p3(H))),V.orientation&&(g.fromArray(V.orientation),L.set(0,0,-1).applyQuaternion(g).normalize(),C.makeRotationFromQuaternion(g),Hc(C.el,X.getRotationMode(),q),b(X.r3(),q,Y)||(F=!0,X.r3(q))),F&&s.fp("gamepad.pose",null,{position:H,rotation:q,id:y});var d=I.axes;(n[0]!==d[0]||n[1]!==d[1])&&(n=[d[0],d[1]],s.fp("gamepad.axes",null,{id:y,axes:n}));var K,G,$,B,a=I.buttons;for(K=0,G=a.length;G>K;K++)$=a[K],B=$.pressed,B!==R[K].pressed&&(R[K].pressed=B,s.fp("gamepad.button."+R[K].id,null,{id:y,_62O:B?"down":"up"}))}}},zn=function(Z){this.vr=Z,this._button=null};xl(zn,D,{showButton:function(){var Q=this.assureButton();if(!Q.parentNode){var Y=this.vr.gv,x=Y.getView();Y._79O?x.insertBefore(Q,Y._79O):x.appendChild(Q)}},hideButton:function(){var Y=this._button;Y&&Y.parentNode&&Y.parentNode.removeChild(Y)},assureButton:function(){var d=this._button;return d?d:this._button=this.createButton(this.vr.gv)},createButton:function(m){function M(m,r){m.textContent=r&&r.isPresenting?"关闭 VR 显示":"开启 VR 显示"}function J(L){A.style.display="",A.style.cursor="pointer",A.style.left="calc(50% - 50px)",A.style.width="100px",M(A,L),A.onmouseenter=function(){A.style.opacity="1.0"},A.onmouseleave=function(){A.style.opacity="0.5"},A.onclick=function(){L.isPresenting?L.exitPresent():L.requestPresent([{source:m.getCanvas()}])},m.vr.setDevice(L)}function P(){A.style.display="",A.style.cursor="auto",A.style.left="calc(50% - 75px)",A.style.width="150px",M(A,null),A.onmouseenter=null,A.onmouseleave=null,A.onclick=null,m.vr.setDevice(null)}function F(P){P.style.position="absolute",P.style.bottom="20px",P.style.padding="12px 6px",P.style.border="1px solid #fff",P.style.borderRadius="4px",P.style.color="#000",P.style.font="normal 13px sans-serif",P.style.textAlign="center",P.style.opacity="0.5",P.style.outline="none",P.style.zIndex="999"}if("getVRDisplays"in navigator){var A=this._button=G.createElement("button");return A.style.display="none",F(A),K.addEventListener("vrdisplayconnect",function(t){J(t.display)},!1),K.addEventListener("vrdisplaydisconnect",function(){P()},!1),K.addEventListener("vrdisplaypresentchange",function(Y){M(A,Y.display)},!1),navigator.getVRDisplays().then(function(f){f.length>0?J(f[0]):P()}),A}var N=G.createElement("a");return N.href="https://webvr.info",N.innerHTML="当前不支持 webvr",N.style.left="calc(50% - 90px)",N.style.width="180px",N.style.textDecoration="none",F(N),N}}),D.defineProperties(zn.prototype,{}),se(Z,{accordionViewExpandIcon:jm(ef),accordionViewCollapseIcon:jm(ef,!0),accordionViewLabelColor:Jl,accordionViewLabelFont:dr,accordionViewTitleBackground:Ap,accordionViewSelectBackground:Wp,accordionViewSelectWidth:3,accordionViewSeparatorColor:w,splitViewDividerSize:1,splitViewDividerBackground:Ap,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:ys,rect:[2,2,12,12],background:ef}]},propertyViewLabelColor:yc,propertyViewLabelSelectColor:Jl,propertyViewLabelFont:dr,propertyViewExpandIcon:jm(Lq),propertyViewCollapseIcon:jm(Lq,!0),propertyViewBackground:gf,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Rr,propertyViewColumnLineColor:Rr,propertyViewSelectBackground:Wp,listViewLabelColor:yc,listViewLabelSelectColor:Jl,listViewLabelFont:dr,listViewRowLineVisible:!1,listViewRowLineColor:Rr,listViewSelectBackground:Wp,treeViewLabelColor:yc,treeViewLabelSelectColor:Jl,treeViewLabelFont:dr,treeViewExpandIcon:jm(fo),treeViewCollapseIcon:jm(fo,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Rr,treeViewSelectBackground:Wp,treeViewDoubleClickToToggle:!0,tableViewLabelColor:yc,tableViewLabelSelectColor:Jl,tableViewLabelFont:dr,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Rr,tableViewColumnLineColor:Rr,tableViewSelectBackground:Wp,treeTableViewLabelColor:yc,treeTableViewLabelSelectColor:Jl,treeTableViewLabelFont:dr,treeTableViewExpandIcon:jm(fo),treeTableViewCollapseIcon:jm(fo,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Rr,treeTableViewColumnLineColor:Rr,treeTableViewSelectBackground:Wp,tableHeaderLabelColor:yc,tableHeaderLabelFont:dr,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:an,tableHeaderBackground:gf,tableHeaderMoveBackground:Mc,tableHeaderInsertColor:Wp,tableHeaderSortDescIcon:ge(Lq,!0),tableHeaderSortAscIcon:ge(Lq),tabViewTabGap:1,tabViewLabelColor:Jl,tabViewLabelFont:dr,tabViewTabBackground:Ap,tabViewSelectWidth:3,tabViewSelectBackground:Wp,tabViewMoveBackground:Mc,tabViewInsertColor:Wp,toolbarLabelColor:yc,toolbarLabelSelectColor:Jl,toolbarLabelFont:dr,toolbarBackground:gf,toolbarSelectBackground:Wp,toolbarItemGap:8,toolbarSeparatorColor:fs},!0);var Zi={translateX:1,sortColumn:1},_c={sortable:1,sortOrder:1,sortFunc:1},vf={focusData:1},_b={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},os={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},jq=function(i,O){O.add(i),i.hasChildren()&&i.eachChild(function(y){jq(y,O)})},im=function(w,f,V,E,q,e,$,k,v,I,i){var B,M=V.getValueType(I),W=V.getAlign(I);if(V.getEnumValues(I)){var L=V.toEnumLabel(f,I),J=Fd||0,G=0,g=e,h=Z.getTextSize(E,L).width;return B=sr(V.toEnumIcon(f,I)),B&&(G=e+Fd/2,"center"===W?G+=(k-(J+h))/2:"right"===W&&(G=G+k-(J+h)),ds(w,B,G,$+v/2,I,i),g=G+Fd/2),L!=s&&(B?Kn(w,L,E,q,g,$,k-(g-e),v):Kn(w,L,E,q,e,$,k,v,W)),void 0}return f=V.formatValue(f),f!=s?M===Cd?(Yg(w,e,$,k,v,f),void 0):M===Af||!M&&vs(f)?(B=sr(f?Bq:Rl),ds(w,B,e+k/2,$+v/2,I,i),void 0):(Kn(w,f,E,q,e,$,k,v,W),void 0):void 0},ao=function(c,N){var r=N.view,E=kk(c),M=N.column||N.property;r.getDataModel().beginTransaction(),N.editor=c,c.info=N,r.setCurrentEditor(c),r.getView().insertBefore(E,r._79O),_p(c,N.editorRect),c.setFocus?c.setFocus():Zp(c),c.commitValue=function(G,f){c._17Q&&(c=c._17Q),f||r.setValue(N.data,M,c.getValue?c.getValue():c.value),c.close&&c.close(),bj(E)},M.onEditorCreated&&M.onEditorCreated(N)},Bb=function(w,D,U,v,E){var m=_f(w,U),P=D.value,x=D.view,V=E.getValueType(D.data);return m.onblur=m.onchange=function(){x.endEditing()},"input"===w?(P=E.formatValue(P),P!=s&&(m.value=P),m.onkeydown=function(q){Rg(q)?x.endEditing():af(q)&&x.endEditing(!0)},(V===$p||V===Te)&&m.addEventListener(Gi,Z.numberListener,!1)):w===Gh&&v.forEach(function(A){var r=G.createElement("option");r.innerHTML=E.toEnumLabel(A),r.value=A,E.isEnumEqual(P,A)&&(r.selected=!0),zd(m,r)}),ao(m,D),m},Cn=c.widget={},Pf=function(v,R,r){xl(H+".widget."+v,R,r)};se(Zf,{ms_value:function(I){I.getValue=function(P){var W=this.getItemById(P),n=W.element;return Fm(n)?n:n?n.getValue?n.getValue():n.value:W.selected},I.setValue=function(z,j){var v=this.getItemById(z);if(v){var P=v.element;P&&!Fm(P)?P.setValue?P.setValue(j):P.value=j:vs(j)?(v.selected=j,this.iv()):(v.element=j,this.iv())}},I.v=function(L,i){var S=this;if(2===arguments.length)S.setValue(L,i);else{if(!Sg(L))return S.getValue(L);for(var o in L)S.setValue(o,L[o])}return S}},_46o:function(i){i._icon=s,i._accessType=s,i._valueType=s,i._editable=!1,i._batchEditable=!0,i._align=Zq,i._nullable=!0,i._emptiable=!1,i.setParent=xn,i.formatValue=function(z){var Q=this,i=Q._valueType;return Q.getEnumValues()?Q.toEnumLabel(z):i===Af?!!z:z!=s&&i===$p?T(z):z},i.setEnum=function(a,k,Z,n,M,I,E){var u=this;a&&!Dc(a)&&a.values&&(n=a.editable,Z=a.icons,k=a.labels,M=a.strict,I=a.maxHeight,E=a.dropDownWidth,a=a.values),Qr(a)&&(a=a._as),Qr(k)&&(k=k._as),Qr(Z)&&(Z=Z._as),u._enumValues=a,u._enumLabels=k,u._enumIcons=Z,u._enumEditable=n,u._enumStrict=M==s?!0:M,u._enumMaxHeight=I,u._enumDropDownWidth=E,a&&a.length&&Rb(a[0])&&(u._valueType=Te),u.fp("enum",!1,!0)},i.getEnumDropDownWidth=function(){return this._enumDropDownWidth},i.getEnumMaxHeight=function(){return this._enumMaxHeight},i.isEnumEditable=function(){return this._enumEditable},i.getEnumValues=function(){return this._enumValues},i.getEnumLabels=function(){return this._enumLabels},i.getEnumIcons=function(){return this._enumIcons},i.isEnumStrict=function(){return this._enumStrict},i.isEnumEqual=function(i,f){return this._enumStrict?i===f:i==f},i.toEnumLabel=function(P,X){var K=this,A=K.getEnumValues(X),S=K.getEnumLabels(X);if(A&&S)for(var T=0;T<A.length;T++)if(K.isEnumEqual(P,A[T]))return S[T];return P},i.toEnumIcon=function(D,p){var Q=this,C=Q.getEnumValues(p),y=Q.getEnumIcons(p);if(C&&y)for(var t=0;t<C.length;t++)if(Q.isEnumEqual(D,C[t]))return y[t];return w}},_45o:function(Y){Y._87o=function(e,I,i,T,N,G){if(e){var H=this,L=H._90I,K=mc(1);H._columnLineVisible&&(N-=1),H._rowLineVisible&&(G-=1),0>=N||0>=G||(H._90I||(L=H._90I={}),L[I]||(L[I]=new Yd),_p(K,H.tx()+i,H.ty()+T,N,G),zd(K,e),H._view.insertBefore(K,H._79O),e.onParentAdded&&e.onParentAdded(K),L[I].add(K))}},Y._76o=function(){var f=this,C=f._90I;if(C){for(var n in C)C[n].each(function(N){bj(N)});delete f._90I}},Y._77o=function(d){var V=this;if(V._90I){var O=V._90I[d];O&&(O.each(function(s){bj(s)}),delete V._90I[d])}}},_47o:function(h){h.getValue=function(Q,p){return p.getValue?p.getValue(Q,p,this):Pe(Q,p.getAccessType(),p.getName())},h.setValue=function(N,T,y){if(T.isEmptiable(N)||""!==y||(y=w),T.isNullable(N)||y!=s){var B=this,D=T.getName(N),k=T.getAccessType(N),W=T.getValueType(N);W===$p&&Fm(y)?y=g(y):W===Te&&Fm(y)?y=parseFloat(y):W===Af&&Fm(y)&&(y="true"===y),B._batchEditable&&T._batchEditable&&B.isSelected(N)?B.sm().each(function(p){T.setValue?T.setValue(p,T,y,B):We(p,k,D,y)}):T.setValue?T.setValue(N,T,y,B):We(N,k,D,y)}},h.setCurrentEditor=function(k){this.endEditing(),this._currentEditor=k,this.redraw()},h.isEditing=function(D,U){var _=this,H=_._currentEditor;if(!H)return!1;if(U){var N=H.info;return N?(N.column||N.property)===U&&N.data===D:!1}return!0},h.endEditing=function(B){var c=this,o=c._currentEditor;o&&(delete c._currentEditor,o.commitValue&&o.commitValue(o.info,B),c.redraw(),c.getDataModel().endTransaction())},h.beginEditing=function(A){this.endEditing();var e=this,I=A.column||A.property;if(I.beginEditing)I.beginEditing(A);else{var M=A.data,d=A.value,z=e.getSelectBackground(M),C=I.getEnumValues(M),P=I.getSlider(M),B=I.getColorPicker(M);if(P){var a=vq(Cn.Slider,P);return a.setValue(d),a.getView().onblur=function(){e.endEditing()},a.isInstant()&&(a.onValueChanged=function(){e.setValue(M,I,a.getValue())}),ao(a,A),void 0}if(B||I.getValueType(M)===Cd){var r=vq(Cn.ColorPicker,B);return r.setValue(d),r.onClosed=function(){e.endEditing()},r.isInstant()&&(r.onValueChanged=function(z,s){e.setValue(M,I,s)}),ao(r,A),r.open(),void 0}if(C){if(Cn.ComboBox){var k=new Cn.ComboBox;k.setValue(d),k.setValues(C),k.setLabels(I.getEnumLabels(M)),k.setIcons(I.getEnumIcons(M)),k.setEditable(I.isEnumEditable(M)),k.setStrict(I.isEnumStrict(M)),k.setMaxHeight(I.getEnumMaxHeight(M)),k.setDropDownWidth(I.getEnumDropDownWidth(M)),k.onClosed=function(){e.endEditing()},ao(k,A),k.open()}else Bb(Gh,A,z,C,I);return}var n=I.getValueType(M);if(n===Af||vs(d))return e.setValue(M,I,!d),void 0;if(I.getItemEditor(M)){var H=ai(I.getItemEditor(M)),O=new H(M,I,e,A),$=O.getView();return $._17Q=O,O.setValue(d),Tr($),ao($,A),O.editBeginning&&O.editBeginning(),void 0}Bb("input",A,z,s,I)}}},_44o:function(i){i.init=function(X){var K=this,C=K.th=new ic(X),p=K._view=Op(1,K);K.tv=K._tableView=X,zd(p,C.getView()),zd(p,X.getView()),C.mp(function(j){j.property===me&&K.iv()}),K.iv()},i.getTableView=function(){return this.tv},i.getTableHeader=function(){return this.th},i.getDataModel=function(){return this.tv.dm()},i.getColumnModel=function(){return this.tv.getColumnModel()},i.setColumns=function(B){this.tv.setColumns(B)},i.addColumns=function(Q){this.tv.addColumns(Q)},i.endEditing=function(){this.tv.endEditing()},i.validateImpl=function(){var T=this,l=T.th,p=Mi(l),j={x:0,y:0,width:T.getWidth(),height:p};_p(l,j),j.y=p,j.height=M(0,T.getHeight()-p),_p(T.tv,j)}},ms_vs:function(A){A._41o=function(){return this._29I.height<this._59I},A._43o=function(){var H=this;H._41o()&&(H._58I||(F(function(){H._94O()},Je),H.iv()),H._58I=new Date)},A._94O=function(){var y=this;if(y._58I){var o=new Date;o.getTime()-y._58I.getTime()>=Je?(delete y._58I,y.iv()):F(function(){y._94O()},Je)}},A._93I=function(){var y=this,g=y._27I;if(y._58I||!y._autoHideScrollBar){g||zd(y._79O,g=y._27I=mc());var Z=y._29I,W=Z.height,e=y._59I,O=y.getScrollBarSize(),_=Z.width-O-2,X=W*(-y.ty()/e),n=W*(W/e),k=g.style;e>W?($e>n&&(X=X+n/2-$e/2,0>X&&(X=0),X+$e>W&&(X=W-$e),n=$e),k.visibility=Lj,k.background=y.getScrollBarColor(),k.borderRadius=O/2+Wo,_p(g,_,X,O,n)):k.visibility=Fc}else g&&(g.style.visibility=Fc)}},ms_hs:function(M){M._40o=function(){return this._29I.width<this._91I},M._42o=function(){var _=this;_._40o()&&(_._95O||(F(function(){_._94I()},Je),_.iv()),_._95O=new Date)},M._94I=function(){var U=this;if(U._95O){var C=new Date;C.getTime()-U._95O.getTime()>=Je?(delete U._95O,U.iv()):F(function(){U._94I()},Je)}},M._92I=function(){var j=this,z=j._28I;if(j._95O||!j._autoHideScrollBar){z||zd(j._79O,z=j._28I=mc());var A=j._29I,V=A.width,J=j._91I,c=j.getScrollBarSize(),R=A.height-c-2,u=V*(-j.tx()/J),Y=V*(V/J),h=z.style;J>V?($e>Y&&(u=u+Y/2-$e/2,0>u&&(u=0),u+$e>V&&(u=V-$e),Y=$e),h.visibility=Lj,h.background=j.getScrollBarColor(),h.borderRadius=c/2+Wo,_p(z,u,R,Y,c)):h.visibility=Fc}else z&&(z.style.visibility=Fc)}}}),jb(Bq,Qf(16,16,[{type:Sh,rect:[1,1,14,14],background:Wp},{type:lf,rect:[1,1,14,14],width:1,color:br},{type:Ri,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),jb(Rl,Qf(16,16,{type:lf,rect:[1,1,14,14],width:1,color:br})),jb(Gl,Qf(16,16,[{type:Xq,rect:[2,2,12,12],borderWidth:1,borderColor:br,background:"#FFF"},{type:Xq,rect:[4,4,8,8],background:Wp}])),jb(Sd,Qf(16,16,{type:Xq,rect:[2,2,12,12],borderWidth:1,borderColor:br})),Zf._15Q=function(k){k._29I=Kd,k._59I=0,k._91I=0,k._5o=function(h){var J=this;J._30I=new Yd,J._rows=new Yd,J._rowMap={},J._31I=0,J._14I=0,J._view=Op(1,J),J._canvas=qb(J._view),zd(J._view,J._79O=mc()),J.dm(h?h:new Wr)},k.getCheckIcon=function(B){var l=this.sm(),T=l.co(B);return l.sg()?sr(T?Gl:Sd):sr(T?Bq:Rl)},k.checkData=function(Q){var g=this.sm(),A=g.co(Q);g.sg()&&A||(this._32o=1,A?g.rs(Q):g.as(Q),delete this._32o)},k.getDataAt=function(L){L.target&&(L=this.lp(L));var K=p(L.y/this._rowHeight),y=this._rows;return 0>K||K>=y.size()?s:y.get(K)},k.onDataDoubleClicked=function(){},k.onDataClicked=function(){},k.adjustTranslateX=function(){return 0},k.adjustTranslateY=function(N){var G=this.getHeight()-this._59I;return G>N&&(N=G),N>0?0:T(N)},k.onPropertyChanged=function($){var a=this,S=$.property;_b[S]?a.ivm():vf[S]||a.redraw(),S===qj?a._42o():S===xi&&a._43o()},k.getLabel=function(X){return X.toLabel()},k.getLabelFont=function(){return this._labelFont},k.getLabelColor=function(F){var X=this;if(X.isCheckMode()){if(X._focusData===F)return X._labelSelectColor}else if(X.isSelected(F))return X._labelSelectColor;return X._labelColor},k.getStartRowIndex=function(){return this._31I},k.getEndRowIndex=function(){return this._14I},k.getRowDatas=function(){return this._rows},k.getRowIndex=function(e){return this._rowMap[e._id]},k.getRowSize=function(){return this._rows.size()},k.getViewRect=function(){return cq(this._29I)},k.isVisible=function(a){return this._visibleFunc?this._visibleFunc(a):!0},k.getCurrentSortFunc=function(){return this._sortFunc},k.setDataModel=function(v){var m=this,p=m._dataModel,M=m._selectionModel;p!==v&&(p&&(p.umm(m.handleDataModelChange,m),p.umd(m.handleDataPropertyChange,m),p.umh(m.handleHierarchyChange,m),M||p.sm().ums(m.handleSelectionChange,m)),m._dataModel=v,v.mm(m.handleDataModelChange,m),v.md(m.handleDataPropertyChange,m),v.mh(m.handleHierarchyChange,m),M?M._21I(v):v.sm().ms(m.handleSelectionChange,m),m.fp("dataModel",p,v))},k.validateModel=function(){var W=this;W._rows.clear(),W._rowMap={},W.buildChildren(W._dataModel._roots);var J=W._rows=W._rows.toList(W.isVisible,W),w=0,H=W.getCurrentSortFunc(),s=J.size();for(H&&J.sort(H);s>w;w++)W._rowMap[J.get(w)._id]=w},k.buildChildren=function(B){var M=this;B.each(function(o){M._rows.add(o),M.buildChildren(o._children)})},k.handleDataModelChange=function(){this.ivm()},k.handleDataPropertyChange=function(g){"parent"===g.property?this.ivm():this.invalidateData(g.data)},k.handleHierarchyChange=function(){this.ivm()},k.handleSelectionChange=function(_){_.datas.each(this.invalidateData,this),this.onSelectionChanged(_)},k.onSelectionChanged=function(Q){var V=this,H=V.sm();!V.isAutoMakeVisible()||1!==H.size()||"set"!==Q.kind&&"append"!==Q.kind||V._32o||V.makeVisible(H.ld())},k.handleBackgroundClick=function(x){db(x)&&!this.isCheckMode()&&this.sm().cs()},k.makeVisible=function(q){q&&(this._23I=q,this.iv())},k.scrollToIndex=function(W){var O=this,G=O._29I,s=G.height,f=O._rowHeight,p=f*W;W>=0&&W<O._rows.size()&&s>0&&(p+f>G.y+s?O.ty(-p+s-f):p<G.y&&O.ty(-p))},k.autoScroll=function(s,A){var G=this,r=G._rowHeight,o=r,U=r/4,f=G._29I,K=G.lp(s),T={x:G.tx(),y:G.ty()};return r>0&&f&&(K.x-f.x<o?G.translate(U,0):f.x+f.width-K.x<o&&G.translate(-U,0),K.y-f.y<o?G.translate(0,U):f.y+f.height-K.y<o&&G.translate(0,-U)),T.x=G.tx()-T.x,T.y=G.ty()-T.y,A&&(A.x+=T.x,A.y+=T.y),T},k.getTopRowOrderSelection=function(){var N=this.sm().getTopSelection(),W={},U=new Yd;return N.each(function(Q){W[Q._id]=Q}),this._rows.each(function(B){W[B._id]&&U.add(B)}),U},k.getRowOrderSelection=function(){var h=new Yd;return this._rows.each(function(y){this.isSelected(y)&&h.add(y)},this),h},k.ivm=function(){this.invalidateModel()},k.invalidateModel=function(){var A=this;A._96I||(A._96I=1,A._32I=1,delete A._24I),A.iv()},k.redraw=function(){var T=this;T._32I||(T._32I=1,delete T._24I,T.iv())},k.invalidateData=function(E){var p=this;B?p.redraw():p._32I||(p._24I||(p._24I={}),p._24I[E._id]=E,p.iv())},k.getFocusData=function(){return this._focusData},k.setFocusDataById=function(q){this.setFocusData(this.dm().getDataById(q))},k.setFocusData=function(s){var $=this,_=$._focusData;_!==s&&($._focusData=s,$.fp("focusData",_,s),_&&$.invalidateData(_),s&&($.invalidateData(s),$.isAutoMakeVisible()&&$.makeVisible(s)))},k.drawRowBackground=function(j,P,K,p,G,A,m){var x=this,U=x.isCheckMode();(P===x._focusData&&U||K&&!U)&&Yg(j,p,G,A,m,x.getSelectBackground(P))},k.drawData=function(e,h,w){var F=this,R=F._rowHeight,a=R*w,t=F._29I,V=t.x,T=t.width;e.save(),e.beginPath(),e.rect(V,a,T,R),e.clip(),F._87o(F.drawRow(e,h,F.isSelected(h),V,a,T,R),w,V,a,T,R),e.restore(),F._rowLineVisible&&Yg(e,V,a+R-1,T,1,F._rowLineColor)},k._12I=function(T){var E=this,z=E._31I,M=E._29I,Y=M.x,o=M.y,C=M.width,R=M.height;for(T.beginPath(),T.rect(Y,o,C,R),T.clip(),T.clearRect(Y,o,C,R),E._76o(),E._93db(T);z<E._14I;z++)E.drawData(T,E._rows.get(z),z);E._92db(T)},k._13I=function(v){for(var c,p=this,S=p._rowHeight,w=p._29I,k=w.x,T=w.width,E=p._31I,L=p._30I;E<p._14I;E++)c=p._rows.get(E),p._24I[c._id]&&L.add({data:c,index:E});L.isEmpty()||(v.beginPath(),L.each(function(R){v.rect(k,R.index*S,T,S)}),v.clip(),L.each(function(H){v.clearRect(k,H.index*S,T,S)}),L.each(function(S){p._77o(S.index)}),p._93db(v),L.each(function(A){p.drawData(v,A.data,A.index)}),p._92db(v),L.clear())},k.validateImpl=function(){var P=this,n=P._canvas,U=P.getWidth(),V=P.getHeight(),g=P._rowHeight,G=P._32I;(U!==n.clientWidth||V!==n.clientHeight)&&(Dg(n,U,V),G=1);var H=i&&!x;P._96I&&!H&&P.validateModel();var L=P._29I,J={x:-P.tx(),y:-P.ty(),width:U,height:V},F=P._rows.size(),Y=Ml(n),$=P._23I;G||vk(J,L)||(G=1),P._29I=J,P._59I=F*g,P._31I=p(J.y/g),P._14I=Q((J.y+J.height)/g),P._31I<0&&(P._31I=0),P._14I>F&&(P._14I=F),P._99I&&G&&P._99I(),ol(Y,P.tx(),P.ty(),1),G?P._12I(Y):P._24I&&P._13I(Y),P._93I(),P._92I(),Y.restore(),P._32I=P._24I=P._96I=s,$&&(P.scrollToIndex(P.getRowIndex($)),delete P._23I),P.tx(P.tx()),P.ty(P.ty())}},Zf._48o=function(U){U._rootVisible=!0,U._rootData=s,U._35o=function(){this._expandMap={},this._levelMap={}},U.validateModel=function(){var H=this,y=H._rootData;H._rows.clear(),H._levelMap={},H._rowMap={},H._currentLevel=0,y?H._rootVisible?H.isVisible(y)&&H.buildData(y):H.buildChildren(y):H.buildChildren(),delete H._currentLevel},U.buildData=function(y){var J=this,r=y._id,Y=J._rows;J._rowMap[r]=Y.size(),Y.add(y),J._levelMap[r]=J._currentLevel,J.isExpanded(y)&&(J._currentLevel++,J.buildChildren(y),J._currentLevel--)},U.buildChildren=function(x){var z=this,$=x?x._children:z._dataModel._roots,E=z.getCurrentSortFunc();E&&z.isChildrenSortable(x)?$.toList(z.isVisible,z).sort(E).each(z.buildData,z):$.each(function(P){z.isVisible(P)&&z.buildData(P)})},U.getLevel=function(i){return this._levelMap[i._id]},U.getToggleIcon=function(y){var K=this,E=K._loader,S=K._collapseIcon;return E&&!E.isLoaded(y)?S:y.hasChildren()?K.isExpanded(y)?K._expandIcon:S:s},U.isCheckMode=function(){return this._checkMode!=s},U.isChildrenSortable=function(){return!0},U.handleDataModelChange=function(S){var I=this;S.kind===Dq?delete I._expandMap[S.data._id]:S.kind===zo&&(I._expandMap={}),I.ivm()},U.toggle=function(e){var p=this;p.isExpanded(e)?p.collapse(e):p.expand(e)},U.isExpanded=function(G){return 1===this._expandMap[G._id]},U.expand=function(c){var F=this,Y=F._loader;F.isExpanded(c)||(Y&&!Y.isLoaded(c)&&Y.load(c),F._expandMap[c._id]=1,F.ivm(),F.onExpanded(c))},U.onExpanded=function(){},U.collapse=function(A){var X=this;X.isExpanded(A)&&(delete X._expandMap[A._id],X.ivm(),X.onCollapsed(A))},U.onCollapsed=function(){},U.expandAll=function(P){if(P)this.expand(P),P.eachChild(function(v){this.expandAll(v)},this);else{var h=this;h._dataModel.each(function(w){w.hasChildren()&&(h._expandMap[w._id]=1)}),h.ivm()}},U.collapseAll=function(){this._expandMap={},this.ivm()},U.makeVisible=function(U){if(U){var j=this;if(!j._rootData||U.isDescendantOf(j._rootData)){for(var H=U._parent;H;)j.expand(H),H=H._parent;j._23I=U,j.iv()}}},U.checkData=function(N){var d,p=this,U=p._checkMode,u=p.sm(),K=u.co(N);if(!u.sg()||!K){if(p._32o=1,U===Ph)K?u.rs(N):u.as(N);else if(U===oj)d=new Yd(N),d.addAll(N._children);else if("descendant"===U)d=new Yd,jq(N,d);else if("all"===U&&(d=new Yd,jq(N,d),!K))for(var Y=N._parent;Y;)d.add(Y),Y=Y._parent;d&&(K?u.rs(d):u.as(d)),delete p._32o}},U._97I=function(U,T,a,X,Y,Z,w){var F=this,K=F._indent,S=F._levelMap[T._id],o=F.getIconWidth(T),N=sr(F.getToggleIcon(T));N?(X+=K*S,ds(U,N,X+K/2,Y+w/2,T,F),X+=K):X+=K*(S+1),F._checkMode&&(ds(U,F.getCheckIcon(T),X+K/2,Y+w/2,T,F),X+=K),F.drawIcon(U,T,X,Y,o,w),F.drawLabel(U,T,X+o,Y,w)}},Zf._14Q=function(Q){Q.getIcon=function(d){return d.getIcon()},Q.getIconWidth=function(V){return this.getIcon(V)?this._indent:0},Q.drawIcon=function(l,A,n,U,H,M){if(H){var t=this,u=t.getBodyColor(A),T=sr(t.getIcon(A),u);T&&(M-=t.isRowLineVisible()?1:0,pc(l,T,hm,n,U,H,M,A,t,u),Hb(l,t.getBorderColor(A),n,U,H,M))}},Q.drawLabel=function(B,f,k,q,D){var u=this;Kn(B,u.getLabel(f),u.getLabelFont(f),u.getLabelColor(f),k,q,0,D)}},Zf._50o=function(X){X._98I=function(){var _=this,j=_._39o=new Wr;_._60I=new Yd,j.mm(_._17o,_),j.md(_._18o,_),j.mh(_._19o,_)},X.setColumns=function(q){this._39o.clear(),this.addColumns(q)},X.addColumns=function(X){var r=this._39o;X.forEach(function(R){if(!(R instanceof Hi)){var i=ai(R.className);R=vq(i?i:Hi,R)}r.add(R)})},X.onColumnClicked=function(){},X.onCheckColumnClicked=function(){},X._3Q=function(u){for(var G,l=0,a=this._60I,K=a.size();K>l;l++)if(G=a.get(l),G.column===u)return G;return s},X.getColumnAt=function(T){var O=this._4Q(T);return O?O.column:s},X._4Q=function(w){for(var Z=this,R=w.target?Z.lp(w).x:w.x,F=Z._60I,x=0;x<F.size();x++){var i=F.get(x),B=i.startX;if(R>=B&&R<B+i.column.getWidth())return i}return s},X.getToolTip=function(Y){var t=this,C=t.getDataAt(Y),M=t.getColumnAt(Y);return C&&M?M.getToolTip(C,t):s},X.adjustTranslateX=function(X){var x=this.getWidth()-this._91I;return x>X&&(X=x),X>0?0:T(X)},X._99I=function(){var B=this,n=B._29I,m=B._60I;m.clear(),B._91I=0,B._39o._roots.each(function(L){if(L.isVisible()){var S=B._91I+L.getWidth();B._91I<=n.x+n.width&&S>=n.x&&m.add({column:L,startX:B._91I}),B._91I=S}})},X.drawData=function(T,t,u){var X=this,N=X._rowHeight,k=N*u,B=X.isSelected(t),z=X._29I,O=z.x,h=z.width;X.drawRowBackground(T,t,B,O,k,h,N),X._60I.each(function(O){var c=O.column,i=O.startX,F=c.getWidth();F>0&&!X.isEditing(t,c)&&(T.save(),T.beginPath(),T.rect(i,k,F,N),T.clip(),X._87o(X.drawCell(T,t,B,c,i,k,F,N),u,i,k,F,N),X._columnLineVisible&&Yg(T,i+F-1,k,1,N,X._columnLineColor),T.restore())}),X._rowLineVisible&&Yg(T,O,k+N-1,h,1,X._rowLineColor)},X.drawCell=function(e,V,F,q,T,w,N,S){var $=this;if(q.drawCell)return q.drawCell(e,V,F,q,T,w,N,S,$);var g=$.getValue(V,q);im(e,g,q,$.getLabelFont(V,q,g),$.getLabelColor(V,q,g),T,w,N,S,V,$)},X.getColumnModel=function(){return this._39o},X._17o=function(){this.redraw()},X._18o=function(B){var e=this;B.data===e._sortColumn&&_c[B.property]?e.ivm():(e._42o(),e.redraw())},X._19o=function(){this.redraw()},X.getCurrentSortFunc=function(){var D=this,o=D._sortColumn;if(o&&o.isSortable()){var w=o.getSortFunc(),q=Gk===o.getSortOrder()?1:-1;return w||(w=Od),function(M,s){return w.call(D,D.getValue(M,o),D.getValue(s,o),M,s)*q}}return D._sortFunc},X.isCellEditable=function(i,t,y){return(!this.isCheckMode()&&this.isSelected(i)||this.isCheckMode()&&i===this._focusData)&&t.isEditable()&&this.isEditable()?t.isCellEditable?t.isCellEditable(i,t,y,this):!0:!1},X._37O=function(Y,T){if(db(T))for(var y=this,S=y.lp(T),W=y._60I,M=y._rowHeight,n=y._29I,L=n.x,a=n.y,N=n.width,J=n.height,E=0;E<W.size();E++){var q=W.get(E),C=q.startX,d=q.column,A=d.getWidth();if(d!==y._31o&&d!==y._4o&&S.x>=C&&S.x<C+A&&y.isCellEditable(Y,d,T)){var Q={x:C,y:y.getRowIndex(Y)*M,width:A,height:M},g={x:Q.x+y.tx(),y:Q.y+y.ty(),width:Q.width,height:Q.height},K=0,c=0;return Q.x<L?K=Q.x-L:Q.x+Q.width>L+N&&(K=Q.x+Q.width-L-N),K&&(y.tx(y.tx()-K),g.x-=K),Q.y<a?c=Q.y-a:Q.y+M>a+J&&(c=Q.y+M-a-J),c&&(y.ty(y.ty()-c),g.y-=c),y.beginEditing({data:Y,column:d,value:y.getValue(Y,d),event:T,rect:Q,editorRect:g,view:y}),void 0}}}},Cn.BaseItemEditor=function(d,J,o,t){this._data=d,this._column=J,this._master=o,this._editInfo=t},Pf("BaseItemEditor",D,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var wo=c.Tab=function(){fm(wo,this)};If("Tab",yb,{ms_ac:["view","closable","disabled"],_icon:s,_closable:!1,_disabled:!1,setParent:xn});var Hi=c.Column=function(){fm(Hi,this)};If("Column",yb,{_46o:1,ms_ac:["accessType","valueType",Lj,Wk,Ue,Lm,"align",Cd,"sortOrder",Ar,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:Gk,_sortFunc:s,_sortable:!0,_clickable:!0,setWidth:function(Y){16>Y&&(Y=16);var B=this._width;this._width=Y,this.fp(Lm,B,Y)},getToolTip:function(J,w){return this.formatValue(w.getValue(J,this))}});var ck=c.Property=function(){fm(ck,this)};If("Property",yb,{_46o:1,ms_ac:["accessType","valueType",Wk,Ue,"categoryName",Cd,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:s,getToolTip:function(e,I,Z){var d=this;return I?d.formatValue(Z.getValue(e,d)):Z.getPropertyName(d)}}),Cn.AccordionView=function(){var $=this;$._20o={},$._21o=new Yd,$._10o=s,$._9o=s,$._11o=s,$._view=Op(0,$),$.iv()},Pf("AccordionView",D,{ms_v:1,ms_fire:1,ms_ac:[Mq,vg,"titleHeight",hl,po,"titleBackground","selectWidth",bf,"orientation","separatorColor"],_expandIcon:Z.accordionViewExpandIcon,_collapseIcon:Z.accordionViewCollapseIcon,_titleHeight:si,_labelColor:Z.accordionViewLabelColor,_labelFont:Z.accordionViewLabelFont,_titleBackground:Z.accordionViewTitleBackground,_selectBackground:Z.accordionViewSelectBackground,_selectWidth:Z.accordionViewSelectWidth,_orientation:"v",_separatorColor:Z.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()
},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(x,z,q,i){var t=this,d=mc();if(t._20o[x])throw x+" already exists";d.onmousedown=Jr,d.style.cursor=wg,d.addEventListener(nb?xq:Wb,function(U){Jr(U)},!1),d.addEventListener(nb?dh:Yc,function(Q){Jr(Q),db(Q)&&(t._10o===x?t.collapse():t.expand(x))},!1),zd(t._view,d),t._20o[x]={content:z,div:d,canvas:qb(d),icon:i},t._21o.add(x),q&&t.expand(x),t.iv()},remove:function(V){var u=this,$=u._20o[V];$&&(bj($.div),delete u._20o[V],u._21o.remove(V),u.iv())},clear:function(){var b=this;b._21o.toArray().forEach(b.remove,b),b._20o={},b._21o.clear(),b.iv()},isExpanded:function(y){return this._10o===y},expand:function(x){var E=this;E._20o[x]&&E._10o!==x&&(E._10o=x,E.onExpanded(x),E.iv())},onExpanded:function(){},collapse:function(){var t=this;t._10o&&(t.onCollapsed(t._10o),delete t._10o,t.iv())},onCollapsed:function(){},initCanvas:function(Y,O,M){Dg(Y,O,M);var b=Ml(Y);return ol(b,0,0,1),b.clearRect(0,0,O,M),b},drawTitle:function(D,e,t,y,R){var S=this,E=sr(R.icon),f=S.isExpanded(e),n=S._titleHeight,M=S._titleBackground,j=S._selectWidth,C=S._separatorColor,u=sr(f?S._expandIcon:S._collapseIcon),Q=j+4;Yg(D,0,0,t,y,M),f&&j&&Yg(D,0,0,j,y,S._selectBackground),(f||S._21o.get(S._21o.size()-1)!==e)&&Yg(D,0,y-1,t,1,C?C:Ln(M)),E&&(ds(D,E,Q+Db(E)/2,n/2),Q+=Db(E)+2),Kn(D,e,S.getLabelFont(e),S.getLabelColor(e),Q,0,0,n),u&&ds(D,u,t-Db(u)/2-4,n/2)},validateImpl:function(){var Z=this,B=Z._view,V=0,f=0,h=Z.getWidth(),p=Z.getHeight(),k=Z._titleHeight,g=Z._21o.size()*k,_=Z._11o,S=Z._9o;delete Z._11o,delete Z._9o,Z._21o.each(function(K){var v,U,X=Z._20o[K],H=X.content,j=Z._10o===K;nn(Z)?(_p(X.div,V,0,k,p),v=Z.initCanvas(X.canvas,k,p),Xr(v,0,p),Wf(v,-q),Z.drawTitle(v,K,p,k,X),v.restore(),j?(U=M(0,h-g),H&&(Z._11o=H,Z._9o=kk(H),_p(H,V+k,0,U,p)),V+=k+U):V+=k):(_p(X.div,0,f,h,k),v=Z.initCanvas(X.canvas,h,k),Z.drawTitle(v,K,h,k,X),v.restore(),j?(U=M(0,p-g),H&&(Z._11o=H,Z._9o=kk(H),_p(H,0,f+k,h,U)),f+=k+U):f+=k)});var Q=Z._9o;_&&_!==Z._11o&&_.endEditing&&_.endEditing(),Q&&Q!==S&&zd(B,Q),S&&S!==Q&&bj(S)}}),Cn.SplitView=function(D,o,U,L){var n=this,N=n._dividerDiv=mc(),I=n._60O=qb(),O=n._61O=qb(),W=I.style,H=O.style;n._view=Op(1,n),zd(n._view,N),W.msTouchAction=Pp,W.pointerEvents=Pp,W.cursor=wg,H.msTouchAction=Pp,H.pointerEvents=Pp,H.cursor=wg,D&&n.setLeftView(D),o&&n.setRightView(o),U&&n.setOrientation(U),L!=s&&n.setPosition(L),n.setStatus($g),new wc(n)},Pf("SplitView",D,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:Z.splitViewDividerSize,_dividerBackground:Z.splitViewDividerBackground,_dragOpacity:Z.splitViewDragOpacity,_toggleIcon:Z.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(F,n){var x=this,k=x._position;isNaN(F)||(n||(x._82O=0>F?-1:F>1?1:0),x._position=F,x.fp(dj,k,F))},getLeftView:function(){return this._leftView},setLeftView:function(m){var Z=this,g=Z._leftView,M=Z._view;if(Z._leftView!==m){if(g&&g!==Z._rightView){var E=kk(g);E.parentNode===M&&bj(E)}if(Z._leftView=m,m){var B=kk(m);B.parentNode!==M&&M.insertBefore(B,Z._dividerDiv)}Z.fp("leftView",g,m)}},getRightView:function(){return this._rightView},setRightView:function(A){var w=this,W=w._rightView,a=w._view;if(w._rightView!==A){if(W&&W!==w._leftView){var S=kk(W);S.parentNode===a&&bj(S)}if(w._rightView=A,A){var H=kk(A);H.parentNode!==a&&a.insertBefore(H,w._dividerDiv)}w.fp("rightView",W,A)}},validateImpl:function(){var o=this,m=o._draggable,k=o._position,r=o.getWidth(),p=o.getHeight(),E=o._dividerSize,l=o._dividerBackground,t=nb?18:8,Y=o._dividerDiv,I=o._82O,i=o._60O,f=o._61O,$=o._toggleIcon,G=o._status,Q=Y.style,b=null,R=nb?20:4,Z=$.comps[0];E>=t||0===E?o._coverDiv&&(bj(o._coverDiv),delete o._coverDiv):o._coverDiv||(o._coverDiv=mc(),a&&(o._coverDiv.style.background=jn),zd(Y,o._coverDiv)),o._togglable?i.parentNode||(zd(Y,i),zd(Y,f)):(bj(i),bj(f));var X=o._coverDiv,j=o._leftView,L=o._rightView;if(nn(o)){if(E>r&&(E=r),G===$g)if(1===I)var w=d(k,r),P=M(0,r-E-w);else-1===I?(P=d(-k,r),w=M(0,r-E-P)):(w=T((r-E)*k),P=M(0,r-E-w));else"cl"===G?(w=0,P=M(0,r-E)):"cr"===G&&(P=0,w=M(0,r-E));j&&_p(j,0,0,w,p),L&&_p(L,w+E,0,P,p),_p(Y,w,0,E,p),o._22o=w,X&&(_p(X,E/2-t/2,0,t,p),X.style.cursor=m?Se:""),Y.style.cursor=m?Se:"";var v=Y.clientHeight/2,A=Y.clientWidth;Dg(i,A,A),_p(i,0,v-A-R,A,A),b=Ml(i),ol(b,0,0,1),Z.rotation=-q,ff(b,$,0,0,A,A),b.restore(),Dg(f,A,A),_p(f,0,v+R,A,A),b=Ml(f),ol(b,0,0,1),Z.rotation=q,ff(b,$,0,0,A,A),b.restore()}else{if(E>p&&(E=p),G===$g)if(1===I)var O=d(k,p),J=M(0,p-E-O);else-1===I?(J=d(-k,p),O=M(0,p-E-J)):(O=T((p-E)*k),J=M(0,p-E-O));else"cl"===G?(O=0,J=M(0,p-E)):"cr"===G&&(J=0,O=M(0,p-E));j&&_p(j,0,0,r,O),L&&_p(L,0,O+E,r,J),_p(Y,0,O,r,E),o._22o=O,X&&(_p(X,0,E/2-t/2,r,t),X.style.cursor=m?Xp:""),Q.cursor=m?Xp:"";var F=Y.clientWidth/2,A=Y.clientHeight;Dg(i,A,A),_p(i,F-A-R,0,A,A),b=Ml(i),ol(b,0,0,1),Z.rotation=0,ff(b,$,0,0,A,A),b.restore(),Dg(f,A,A),_p(f,F+R,0,A,A),b=Ml(f),ol(b,0,0,1),Z.rotation=_,ff(b,$,0,0,A,A),b.restore()}Q.background=l}});var wc=function(Y){this.sv=Y,this.addListeners()};xl(wc,D,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(A){var Q=this,y=Q.sv,D=y._dividerDiv,c=y._60O,k=y._61O,R=y._status,f=A.target;if(f===c)R===$g?y.setStatus("cl"):"cr"===R&&y.setStatus($g);else if(f===k)R===$g?y.setStatus("cr"):"cl"===R&&y.setStatus($g);else if(Uo(A)&&(f===D||f===y._coverDiv)&&(Jr(A),y.isDraggable())){y.getLeftView(),y.getRightView();var V=Q.maskDiv=mc();if(V.style.left=0,V.style.top=0,V.style.width=y.getWidth()+"px",V.style.height=y.getHeight()+"px",y.getView().appendChild(V),!y.isContinuousLayout()){var N=Q.resizeDiv=mc();N.style.left=D.style.left,N.style.top=D.style.top,N.style.width=D.style.width,N.style.height=D.style.height,N.style.opacity=y.getDragOpacity(),N.style.background=y.getDividerBackground(),zd(Q.getView(),N)}Q._lastAbsPosition=y._22o,Q._86o=nn(y)?gh(A).x:gh(A).y,ym(Q,A)}},handleWindowTouchMove:function(k){Uo(k)&&this.update(k,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(A){var N=this;N.update(A,!0),N.sv.setStatus($g),N.maskDiv&&bj(N.maskDiv),N.resizeDiv&&bj(N.resizeDiv),N.maskDiv=N.resizeDiv=s},handle_mousedown:function(B){db(B)&&this.handle_touchstart(B)},handleWindowMouseMove:function(G){this.handleWindowTouchMove(G)},handleWindowMouseUp:function(l){this.handleWindowTouchEnd(l)},update:function(i,s){var O=this,n=O.sv,D=nn(n)?n.getWidth():n.getHeight(),Q=n._dividerSize,P=O._lastAbsPosition-O._86o;nn(n)?(P+=gh(i).x,P>D-Q&&(P=D-Q),0>P&&(P=0),O.resizeDiv&&(O.resizeDiv.style.left=P+Wo)):(P+=gh(i).y,P>D-Q&&(P=D-Q),0>P&&(P=0),O.resizeDiv&&(O.resizeDiv.style.top=P+Wo)),s&&D!==Q&&(1===n._82O?n.setPosition(P,1):-1===n._82O?n.setPosition(P-D+Q,1):n.setPosition(P/(D-Q),1))}}),Cn.TabView=function(){var l=this,I=l._view=Op(1,l),G=l._91O=mc(1),$=l._tabModel=new Wr,g=$.sm(),u=l.invalidate;l._7o=new Yd,l._canvas=qb(G),zd(I,G),zd(I,l._92O=mc(1)),g.setSelectionMode(Yl),g.ms(l.handleSelectionChange,l),$.mm(u,l),$.md(u,l),$.mh(u,l),new Oq(l),l.iv()},Pf("TabView",D,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",hl,po,"tabBackground","selectWidth",bf,"moveBackground","insertColor"],_tabPosition:Tp,_tabHeight:si,_tabGap:Z.tabViewTabGap,_labelColor:Z.tabViewLabelColor,_labelFont:Z.tabViewLabelFont,_tabBackground:Z.tabViewTabBackground,_selectWidth:Z.tabViewSelectWidth,_selectBackground:Z.tabViewSelectBackground,_moveBackground:Z.tabViewMoveBackground,_insertColor:Z.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(s,T,z){var j=new wo,y=this._tabModel;return j.setName(s),j.setView(T),y.add(j),z&&y.sm().ss(j),j},getLabel:function(g){return g.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(A){this._23o=A,this.iv()},get:function(y){var k=this,f=k._tabModel;if(Rb(y))return f._roots.get(y);if(Fm(y)){var i;return f.each(function($){y===k.getLabel($)&&(i=$)}),i}return y instanceof wo?y:s},select:function(B){this._tabModel.sm().ss(this.get(B))},remove:function(b){var e=this;if(b=e.get(b)){var h=e._tabModel,u=h._roots.indexOf(b);e._tabModel.remove(b),e._12Q(--u)}},getCurrentTab:function(){return this._8o},hideTabView:function(P,B){B.parentNode===this._92O&&(Zd(B)?(B.style.display=Um,B._tab_=P):bj(B),Oc())},showTabView:function(x,z){Zd(z)&&(z.style.display="block",z._tab_=x),z.parentNode!==this._92O&&(zd(this._92O,z),Oc())},_24o:function(){var b,f=this,F=f._8o,O=f._9o,g=f._tabModel.sm().ld();g&&(b=kk(g.getView())),b!==O&&(O&&(F.getView()&&F.getView().endEditing&&F.getView().endEditing(),f.hideTabView(F,O)),b&&f.showTabView(g,b)),f._8o=g,f._9o=b,F!==g&&f.onTabChanged(F,g)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(i,I){this._12Q(--I)},_12Q:function(t){var $=this,_=$._tabModel,E=_.size();if(E&&!_.sm().ld()){t==s&&(t=0),t>=E&&(t=E-1),0>t&&(t=0);for(var V=t;V>=0;V--){var q=$.get(V);if(!q.isDisabled())return $.select(q),q}for(V=t+1;E>V;V++)if(q=$.get(V),!q.isDisabled())return $.select(q),q}},getTabWidth:function(C){var $=4,O=sr(C.getIcon());O&&($+=Db(O,C)+4);var E=this.getLabel(C);return E&&($+=Bm(this.getLabelFont(C),E).width+4),C.isClosable()&&($+=10),$},drawTab:function(Q,U,x,n,i,D,b){var A,u=this,O=u._tabPosition,k=x+4,l=u._selectWidth,r=sr(U.getIcon()),w=U.isDisabled(),v=u.getLabelColor(U),M=u.getLabelFont(U),G=u.getLabel(U),t=u._selectBackground,y=O===Zq+"-vertical",S=O===Oi+"-vertical";(y||S)&&(k=n+4),w&&(Q.globalAlpha=de),Yg(Q,x,n,i,D,b),U===u._8o&&l&&(O===Tp?Yg(Q,x,n+D-l,i,l,t):O===Zq?Yg(Q,x+i-l,n,l,D,t):O===Oi?Yg(Q,x,n,l,D,t):y?Yg(Q,x+i-l,n,l,D,t):S?Yg(Q,x,n,l,D,t):Yg(Q,x,n,i,l,t));var L=i/2;if(y&&(Xr(Q,L,n+D/2),Wf(Q,_),Xr(Q,-L,-n-D/2)),r){var H=Vc(r,U),j=Db(r,U);if(y||S){var c=x+i/2,P=k+H/2;Xr(Q,c,P),Wf(Q,q),Xr(Q,-c,-P),ds(Q,r,x+i/2,k+H/2,U,u),Xr(Q,c,P),Wf(Q,-q),Xr(Q,-c,-P),k+=H+4}else ds(Q,r,k+j/2,n+D/2,U,u),k+=j+4}return y||S?(Xr(Q,i/2,k+i/2),Wf(Q,q),Xr(Q,-i/2,-k-i/2),Kn(Q,G,M,v,x,k,D,i),Xr(Q,i/2,k+i/2),Wf(Q,-q),Xr(Q,-i/2,-k-i/2)):Kn(Q,G,M,v,k,n,i,D),y&&(Xr(Q,L,n+D/2),Wf(Q,-_),Xr(Q,-L,-n-D/2)),U.isClosable()&&(A=S?{x:x+i-12,y:n+D-12,width:12,height:12}:{x:x+i-12,y:n+2,width:12,height:12},this.drawCloseIcon(U,Q,v,A)),w&&(Q.globalAlpha=1),A},drawCloseIcon:function(x,k,p,z){var B=z.x,e=z.y;k.strokeStyle=p,k.lineWidth=1,k.beginPath(),k.moveTo(B+2,e+8),k.lineTo(B+8,e+2),k.moveTo(B+8,e+8),k.lineTo(B+2,e+2),k.stroke()},validateImpl:function(){var X=this;X._24o();var A,q=X._canvas,z=X._tabPosition,j=X._91O,c=X._92O,P=X._tabModel,O=X.getWidth(),W=X.getHeight(),t=X._tabHeight,K=X._7o,s=X._tabGap,e=z===Tp,L=z===Zq,v=z===Oi,D=z===Zq+"-vertical",E=z===Oi+"-vertical",u=X._23o,U=0;if((L||v)&&P._roots.each(function(x){U=M(X.getTabWidth(x),U)}),e?(_p(j,0,0,O,t),A={x:0,y:t,width:O,height:M(0,W-t)}):L?(_p(j,0,0,U,W),A={x:U,y:0,width:M(0,O-U),height:W}):v?(_p(j,O-U,0,U,W),A={x:0,y:0,width:M(0,O-U),height:W}):D?(_p(j,0,0,t,W),A={x:t,y:0,width:M(0,O-t),height:W}):E?(_p(j,O-t,0,t,W),A={x:0,y:0,width:M(0,O-t),height:W}):(_p(j,0,W-t,O,t),A={x:0,y:0,width:O,height:M(0,W-t)}),_p(c,A),D||E){X._9o&&(A.x=0,_p(X._8o.getView(),A)),Dg(q,t,W);var I=Ml(q),x=0;if(ol(I,0,X.ty(),1),I.clearRect(0,0,t,W),K.clear(),P._roots.each(function(f){var M,S=X.getTabWidth(f);u&&u.tab===f||(M=X.drawTab(I,f,0,x,t,S,X._tabBackground)),K.add({_75o:M,tab:f,startY:x,endY:x+S,height:S}),x+=S+s}),X._23Q=M(0,x-s),u){var k=u.position;X.drawTab(I,u.tab,0,u.startY,t,u.height,X._moveBackground),Yg(I,0,k,t,1,X._insertColor)}if(I.restore(),X._selectionChanged){X._selectionChanged=!1;for(var R=X.ty(),N=0;N<K.size();N++){var o=K.get(N);if(o.tab===X._8o){if(o.endY+R<0){X.ty(-o.startY);break}if(o.startY+R>W){X.ty(W-o.endY);break}}}}X.ty(X.ty())}else if(L||v){X._9o&&(A.x=0,_p(X._8o.getView(),A)),Dg(q,U,W);var I=Ml(q),x=0;if(ol(I,0,X.ty(),1),I.clearRect(0,0,U,W),K.clear(),P._roots.each(function(S){var V;u&&u.tab===S||(V=X.drawTab(I,S,0,x,U,t,X._tabBackground)),K.add({_75o:V,tab:S,startY:x,endY:x+t,height:t}),x+=t+s}),X._23Q=M(0,x-s),u){var k=u.position;X.drawTab(I,u.tab,0,u.startY,U,u.height,X._moveBackground),Yg(I,0,k,U,1,X._insertColor)}if(I.restore(),X._selectionChanged){X._selectionChanged=!1;for(var R=X.ty(),N=0;N<K.size();N++){var o=K.get(N);if(o.tab===X._8o){if(o.endY+R<0){X.ty(-o.startY);break}if(o.startY+R>W){X.ty(W-o.endY);break}}}}X.ty(X.ty())}else{X._9o&&(A.y=0,_p(X._8o.getView(),A)),Dg(q,O,t);var I=Ml(q),h=0;if(ol(I,X.tx(),0,1),I.clearRect(0,0,O,t),K.clear(),P._roots.each(function(c){var J,l=X.getTabWidth(c);u&&u.tab===c||(J=X.drawTab(I,c,h,0,l,t,X._tabBackground)),K.add({_75o:J,tab:c,startX:h,endX:h+l,width:l}),h+=l+s}),X._64I=M(0,h-s),u){var k=u.position;X.drawTab(I,u.tab,u.startX,0,u.width,t,X._moveBackground),np(I,X._insertColor,k,0,t)}if(I.restore(),X._selectionChanged){X._selectionChanged=!1;for(var C=X.tx(),N=0;N<K.size();N++){var o=K.get(N);if(o.tab===X._8o){if(o.endX+C<0){X.tx(-o.startX);break}if(o.startX+C>O){X.tx(O-o.endX);break}}}}X.tx(X.tx())}for(var y=[],_=c.children,N=0;N<_.length;N++){var g=_[N],f=g._tab_;f&&!P.contains(f)&&y.push(g)}y.forEach(function(W){c.removeChild(W)})}});var Oq=function(B){this.tv=B,this.addListeners()};xl(Oq,D,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(P){this.handleScroll(P,10*(P.wheelDelta/40))},handle_DOMMouseScroll:function(B){this.handleScroll(B,10*-B.detail)},handleScroll:function(t,u){Jr(t);var s=this.tv,p=s._tabPosition;!s._40o()||p!==Tp&&p!==Rk||s.tx(this.tv.tx()+u),!s._41o()||p!==Zq&&p!==Oi&&p!==Zq+"-vertical"&&p!==Oi+"-vertical"||s.ty(this.tv.ty()+u)},_8Q:function(y){var x,W,n=this.tv,V=n._tabPosition,j=n._7o;if(V===Tp||V===Rk){var X=n.lp(y).x;for(x=0;x<j.size();x++)if(W=j.get(x),W.startX<=X&&X<=W.endX)return W}else if(V===Zq||V===Oi||V===Zq+"-vertical"||V===Oi+"-vertical"){var $=n.lp(y).y;for(x=0;x<j.size();x++)if(W=j.get(x),W.startY<=$&&$<=W.endY)return W}return s},isClickable:function($){var M=this.tv,O=M._tabPosition,k=this._73o=this._8Q($);return!M._40o()||O!==Tp&&O!==Rk?!M._41o()||O!==Zq&&O!==Oi&&O!==Zq+"-vertical"&&O!==Oi+"-vertical"?k&&(!k.tab.isDisabled()||M.isMovable()):!0:!0},handle_mousemove:function(W){var t=this;wk?t._74o=t._8Q(W):t.getView().style.cursor=t.isClickable(W)?wg:""},handle_mousedown:function(k){this.handle_mousemove(k),this.handle_touchstart(k)},handle_touchstart:function(U){var x=this,X=x.tv,a=X._tabPosition;Jr(U),db(U)&&x.isClickable(U)&&(a===Tp||a===Rk?(x.x=gh(U).x,x.lp=X.lp(U),x.tx=X.tx()):(x.y=gh(U).y,x.lp=X.lp(U),x.ty=X.ty()),ym(x,U))},handleWindowMouseMove:function(U){this.handleWindowTouchMove(U)},handleWindowTouchMove:function(h){var C,Z=this,S=Z.tv,P=S._tabPosition,n=Z._73o;if(P===Tp||P===Rk){if(C=gh(h).x-Z.x,!Z._25o&&!Z.moving&&A(C)>2&&(S._40o()&&!sf(h)?Z._25o=1:n&&S.isMovable()&&(Z.moving=1)),Z._25o)S.tx(Z.tx+C);else if(Z.moving){var Q=Z.lp.x+C,W=S._tabGap/2;S._7o.each(function(p){var R=p.endX,$=Q-p.startX<R-Q;Q>=p.startX&&R>=Q&&S._7Q({tab:n.tab,startX:n.startX+C,width:n.width,front:$,insertTab:p.tab,position:$?M(0,p.startX-W):d(S._64I,R+W)})})}}else if(C=gh(h).y-Z.y,!Z._25o&&!Z.moving&&A(C)>2&&(S._41o()&&!sf(h)?Z._25o=1:n&&S.isMovable()&&(Z.moving=1)),Z._25o)S.ty(Z.ty+C);else if(Z.moving){var K=Z.lp.y+C,W=S._tabGap/2;S._7o.each(function(T){var _=T.endY,j=K-T.startY<_-K;K>=T.startY&&_>=K&&S._7Q({tab:n.tab,startY:n.startY+C,height:n.height,front:j,insertTab:T.tab,position:j?M(0,T.startY-W):d(S._23Q,_+W)})})}},handleWindowMouseUp:function(A){this.handleWindowTouchEnd(A)},handleWindowTouchEnd:function(){var B=this,d=B.tv,_=d._tabPosition,o=d.getTabModel(),D=o._roots,A=B._73o;if(B.moving){var N=d._23o;if(N&&N.insertTab!==N.tab){var p=N.tab,J=D.remove(p),E=D.indexOf(N.insertTab);E>=0&&(N.front||E++,E<=D.size()&&(D.add(p,E),o._38I(p,J,E)))}d._7Q(s),delete B.moving}else if(!B._25o&&A){p=A.tab;var j=B._74o;if(!j||j.tab===p)if(!p.isDisabled()&&Mr(A._75o,B.lp)){var x=function(){var W=D.indexOf(p);o.remove(p),d.onTabClosed(p,W)};d.onTabClosing(p,x)&&x()}else p.isDisabled()||d._8o===p||o.sm().ss(p)}B._25o=B._73o=B._74o=_===Tp||_===Rk?B.x=B.lp=B.tx=s:B.y=B.lp=B.ty=s}}),Cn.PropertyView=function(Y){var n=this;n._view=Op(1,n),n._canvas=qb(n._view),zd(n._view,n._79O=mc()),n._rows=new Yd,n._28o=new Yd,n._26o={},n._26Q={};var $=n._propertyModel=new Wr,X=n.ivm;$.mm(X,n),$.md(X,n),$.mh(X,n),n.dm(Y?Y:new Wr),new Uq(n)},Pf("PropertyView",D,{ms_ac:[hl,Vr,po,Wk,Ue,"categorizable",De,Ar,dn,Mq,vg,cp,hk,Ol,"selectRowIndex",bf,"background",ap,gj,Ke,Ir,Xb],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:Kd,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:Fd,_background:Z.propertyViewBackground,_expandIcon:Z.propertyViewExpandIcon,_collapseIcon:Z.propertyViewCollapseIcon,_scrollBarColor:zr,_scrollBarSize:oq,_autoHideScrollBar:io,_selectBackground:Z.propertyViewSelectBackground,_rowHeight:Pi,_rowLineVisible:Z.propertyViewRowLineVisible,_rowLineColor:Z.propertyViewRowLineColor,_10I:.5,_columnLineVisible:Z.propertyViewColumnLineVisible,_columnLineColor:Z.propertyViewColumnLineColor,_labelColor:Z.propertyViewLabelColor,_labelSelectColor:Z.propertyViewLabelSelectColor,_labelFont:Z.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(H){0>H&&(H=0),H>1&&(H=1);var Y=this,u=Y._10I;Y._10I=H,Y.fp("columnPosition",u,H)},getPropertyName:function(U){return U.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(E,J,H){return H===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(R,x){return x===this._selectRowIndex?this._labelSelectColor:R.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(x){var B=this.getHeight()-this._59I;return B>x&&(x=B),x>0?0:T(x)},isExpanded:function(z){if(!z)return!0;var i=this._26o[z];return i?i.isExpanded:!(this._26Q[z]===!1)},toggle:function(t){var K=this;K.isExpanded(t)?K.collapse(t):K.expand(t)},expandAll:function(){this.validate();for(var x in this._26o)this.expand(x)},expand:function(_){if(_&&_!==Um){var J=this,d=J._26o[_];d&&!d.isExpanded&&(d.isExpanded=!0,J.onExpanded(_),J.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var e in this._26o)this.collapse(e)},collapse:function(S){if(S&&S!==Um){var c=this,h=c._26o[S];h&&h.isExpanded&&(h.isExpanded=!1,c.onCollapsed(S),c.ivm())}},onCollapsed:function(){},getCategoryName:function(f){if(!this.isCategorizable())return Um;var g=f.getCategoryName();return g?g:Um},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(z){var q=this,Z=q._dataModel;Z!==z&&(Z&&(Z.umd(q.handlePropertyChange,q),q._selectionModel||Z.sm().ums(q.handleSelectionChange,q)),q._dataModel=z,z.md(q.handlePropertyChange,q),q._selectionModel?q._selectionModel._21I(z):z.sm().ms(q.handleSelectionChange,q),q.fp(Qm,Z,z))},isVisible:function(H){return this._visibleFunc?this._visibleFunc(H):!0},onPropertyChanged:function(s){var r=this,c=s.property;os[c]?r.ivm():r.iv(),c===xi&&r._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:$l},handlePropertyChange:function(d){this._27o===d.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var D=this;D._96I||(D.setSelectRowIndex(-1),D._96I=1,D.iv())},redraw:function(){this.iv()},validateModel:function(){var Z=this,n=Z._rows,h=Z._28o,o={},G=new Yd,b=Z._27o;Z.updateCurrentData(),b!==Z._27o&&Z.endEditing(),n.clear(),h.clear(),Z.getRawProperties().each(function(v){if(Z.isVisible(v)){G.add(v);var B=Z.getCategoryName(v);o[B]||(h.add(B,B===Um?0:w),o[B]={isExpanded:Z.isExpanded(B),properties:new Yd})}}),Z._sortFunc&&G.sort(Z._sortFunc);for(var N in Z._26o)Z._26Q[N]=Z.isExpanded(N);Z._26o=o,h.each(function(g){g!==Um&&n.add(g);var M=o[g];M.isExpanded&&G.each(function(q){Z.getCategoryName(q)===g&&(M.properties.add(q),n.add({property:q,data:Z._27o}))},Z)})},validateImpl:function(){var w=this;w._76o(),w._96I&&(w.validateModel(),delete w._96I);var U=w._canvas,r=w.getWidth(),$=w.getHeight(),_=-w.ty(),b=w._rowHeight,T=w._indent,n=r-T,g=w._rows,I=g.size(),l=w._9I=T+n*w._10I,H=w._59I=I*b;Dg(U,r,$),w._29I={x:0,y:_,width:r,height:$},w._31I=p(_/b),w._14I=Q((_+$)/b),w._31I<0&&(w._31I=0),w._14I>I&&(w._14I=I);var G,h=Ml(U),V=w._background;ol(h,0,-_,1),h.beginPath(),h.rect(0,_,r,$),h.clip(),h.clearRect(0,_,r,$),w._93db(h),V&&Yg(h,0,0,T,H,V);for(var y=w._31I;y<w._14I;y++){var Y=g.get(y),_=b*y;if(Fm(Y))V&&Yg(h,T,_,n,b,V),G=sr(w.isExpanded(Y)?w._expandIcon:w._collapseIcon),G&&pc(h,G,hm,0,_,T,b),h.save(),h.beginPath(),h.rect(T,_,n,b),h.clip(),w.drawCategoryName(h,Y,y,T,_,n,b),h.restore();else{var W=Y.property,i=Y.data,G=sr(W.getIcon()),A=w._selectRowIndex===y?w.getSelectBackground():s;if(G&&pc(h,G,hm,0,_,T,b),A&&Yg(h,T,_,n,b,A),h.save(),h.beginPath(),h.rect(T,_,l-T,b),h.clip(),w.drawPropertyName(h,W,y,T,_,l-T,b),h.restore(),!w.isEditing(i,W)){var R=l+1,u=r-l-1;h.save(),h.beginPath(),h.rect(R,_,u,b),h.clip(),w._87o(w.drawPropertyValue(h,W,w.getValue(i,W),y,R,_,u,b,i),y,R,_,u,b),h.restore()}}w._rowLineVisible&&Yg(h,T,_+b-1,n,1,w._rowLineColor)}w._columnLineVisible&&(Yg(h,l,0,1,H,w._columnLineColor),Yg(h,r-1,0,1,H)),w._92db(h),w._93I(),h.restore(),w.ty(w.ty())},drawCategoryName:function(Y,e,T,m,s,g,C){Kn(Y,e,this.getCategoryFont(e),this.getCategoryColor(e),m,s,g,C)},drawPropertyName:function(p,H,z,K,k,l,$){return H.drawPropertyName?(H.drawPropertyName(p,H,z,K,k,l,$,this),void 0):(Kn(p,this.getPropertyName(H),this.getPropertyFont(H,z),this.getPropertyColor(H,z),K,k,l,$),void 0)},drawPropertyValue:function(t,g,B,P,q,j,s,G,Y){return g.drawPropertyValue?g.drawPropertyValue(t,g,B,P,q,j,s,G,Y,this):(im(t,B,g,this.getLabelFont(g,B,P),this.getLabelColor(g,B,P),q,j,s,G,Y,this),void 0)},isPropertyEditable:function(N){return N.isEditable()&&this.isEditable()},setProperties:function(m){this._propertyModel.clear(),this.addProperties(m)},addProperties:function(W){if(W){var y=this._propertyModel;W.forEach(function(U){if(!(U instanceof ck)){var e=ai(U.className);U=vq(e?e:ck,U)}y.add(U)})}},getRowIndexAt:function(u){var C=this,i=p(C.lp(u).y/C._rowHeight);return i>=0&&i<C._rows.size()?i:-1},getPropertyAt:function(K){var f=this,H=f.getRowIndexAt(K);return H>=0?f._rows.get(H).property:s},getToolTip:function(t){var a=this,P=a.getPropertyAt(t),p=a._27o;return P&&p?P.getToolTip(p,a._9I<a.lp(t).x,a):s}});var Uq=function(d){this.pv=d,this.addListeners()};xl(Uq,D,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(W){this.getView().style.cursor=W},clear:function(){var W=this;W._62O=W.cp=W.ty=W.p=s,W.setCursor(Ph)},handle_mousedown:function(T){this.handle_touchstart(T)},handle_touchstart:function(r){var e=this,x=e.pv;Jr(r),x.setFocus(r)&&(db(r)?(e.cp=gh(r),e.ty=x.ty(),e.p=x.getColumnPosition(),e.handle_touchmove(r)):x.setSelectRowIndex(x.getRowIndexAt(r)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(j){this.handle_touchend(j)},handle_touchend:function(e){var M=this;if(M.cp&&!M._62O){var J=M.pv,g=J.lp(e),G=g.x,l=g.y,Y=J._indent,n=J.getRowIndexAt(e),c=J._9I;if(n>=0){var i=J._rowHeight,V=i*n,S=J._rows.get(n),H=S.property;if(Fm(S))sr(J.isExpanded(S)?J._expandIcon:J._collapseIcon)&&G>=0&&Y>=G&&l>=V&&V+i>=l?J.toggle(S):yk(e)&&J.toggle(S);else if(G>c&&J.isPropertyEditable(H,e)){var f={x:c+1,y:V,width:J.getWidth()-c-1,height:i},u={x:f.x+J.tx(),y:f.y+J.ty(),width:f.width,height:f.height},U=0,w=J._29I;f.y<w.y?U=f.y-w.y:f.y+i>w.y+w.height&&(U=f.y+i-w.y-w.height),U&&(J.ty(J.ty()-U),u.y-=U),J.beginEditing({data:S.data,property:H,value:J.getValue(S.data,H),event:e,rect:f,editorRect:u,view:J})}}J.setSelectRowIndex(n)}M.clear()},handleWindowMouseMove:function(g){this.handleWindowTouchMove(g)},handleWindowTouchMove:function(H){var T=this,V=T.pv,h=T.ty,C=T.cp,t=gh(H),P=T._62O;if("p"===P)V.setTranslateY(h+t.y-C.y);else if("c"===P){var q=V.getWidth()-V._indent;if(q>16){var j=T.p-(C.x-t.x)/q,c=16/q;c>j&&(j=c),j>1-c&&(j=1-c),V.setColumnPosition(j)}}else"s"===P&&V.setTranslateY(h+(C.y-t.y)*V._59I/V._29I.height)},handle_mousemove:function(G){this.handle_touchmove(G)},handle_touchmove:function(F){if(!wk&&db(F)){var U=this,z=U.pv,S=A(z.lp(F).x-z._9I)<=(nb?8:3);U.cp?U._62O||(S?(U._62O="c",ym(U)):A(gh(F).y-U.cp.y)>=2&&(U._62O=U.isV(F)?"s":"p",ym(U))):(S?U.setCursor(Se):U.setCursor(Ph),U.isV(F)&&z._43o())}},isV:function(v){var H=this.pv,b=H._29I;return H._41o()&&b.x+b.width-H.lp(v).x<pi},handle_mousewheel:function(E){this.handleScroll(E,E.wheelDelta/40)},handle_DOMMouseScroll:function(o){2===o.axis&&this.handleScroll(o,-o.detail)},handleScroll:function(F,k){var D=this.pv;Jr(F),D.endEditing(),D.translate(0,k*D.getRowHeight())},handle_keydown:function(z){var C=this.pv,x=C._rows.size(),o=C._selectRowIndex+(oo(z)?-1:1);(oo(z)||Ni(z))&&(0>o&&(o=0),o>=x&&(o=x-1),C.setSelectRowIndex(o))}}),Cn.ListView=function(v){this._5o(v),new _k(this)},Pf("ListView",D,{ms_ac:[hl,Vr,po,ap,De,gj,Ke,Ar,dn,cp,hk,Ol,$j,bf],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:Fd,_rowHeight:Pi,_rowLineVisible:Z.listViewRowLineVisible,_rowLineColor:Z.listViewRowLineColor,_scrollBarColor:zr,_scrollBarSize:oq,_autoMakeVisible:Ud,_autoHideScrollBar:io,_selectBackground:Z.listViewSelectBackground,_labelColor:Z.listViewLabelColor,_labelSelectColor:Z.listViewLabelSelectColor,_labelFont:Z.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(T){var W=this,g=W._checkMode;W._checkMode=T,W.fp(ql,g,T)},drawRow:function(M,Z,o,W,k,s,O){var y=this,D=0,m=y._indent,t=y.getIconWidth(Z);y.drawRowBackground(M,Z,o,W,k,s,O),y._checkMode&&(ds(M,sr(y.getCheckIcon(Z)),D+m/2,k+O/2,Z,y),D+=m),y.drawIcon(M,Z,D,k,t,O),y.drawLabel(M,Z,D+t,k,O)}});var _k=function(a){this.list=a,this._lastSelectDataTime=qo(),this.addListeners()};xl(_k,D,{ms_listener:1,getView:function(){return this.list._view},clear:function(l){var d=this,B=d.list;l&&"d"===d._62O&&!d.dragCancel&&B.handleDragAndDrop(l,"end"),B.draggingData&&(B.draggingData=null,B.redraw()),d.dragCancel=d._62O=d._isV=d._isH=d.cp=d.tx=d.ty=s},handle_mousedown:function(J){this.handle_touchstart(J)},handle_touchstart:function(_){var D=this,V=D.list;if(Jr(_),V.setFocus(_)){var G=V.getDataAt(_);D.cp=gh(_),D.tx=V.tx(),D.ty=V.ty(),db(_)?G&&V.handleDragAndDrop&&!D.isV(_)&&!D.isH(_)&&(V.draggingData=G,V.redraw(),V.handleDragAndDrop(_,"prepare")):(G&&D._33o(_,G),D.clear(_))}},handleWindowMouseUp:function(A){this.clear(A)},handleWindowTouchEnd:function(D){this.clear(D)},handle_mouseup:function(I){this.handle_touchend(I)},handle_touchend:function(W){var q=this,V=q.list;if(!q._isV&&!q._isH&&q.cp&&!q._62O){var F=V.getDataAt(W);F?(V.isCheckMode()?q._34o(W,F):q._33o(W,F),yk(W)?V.onDataDoubleClicked(F,W):V.onDataClicked(F,W)):V.handleBackgroundClick(W)}q.clear(W)},handleWindowMouseMove:function(C){this.handleWindowTouchMove(C)},handleWindowTouchMove:function(H){var Q=this,R=Q.list,D=Q._62O,p=Q.tx,y=Q.ty,C=Q.cp,G=gh(H),K=R._29I;"p"===D?R.setTranslate(p+G.x-C.x,y+G.y-C.y):"v"===D?R.ty(y+(C.y-G.y)*R._59I/K.height):"h"===D?R.tx(p+(C.x-G.x)*R._91I/K.width):"d"===D&&(Q.dragCancel||R.handleDragAndDrop(H,"between"))},handle_mousemove:function(y){this.handle_touchmove(y)},handle_touchmove:function(E){if(!wk&&db(E)){var p=this,l=p.list;if(p._isV=p.isV(E),p._isH=p.isH(E),p.cp){if(!p._62O){if(dq(gh(E),p.cp)<2)return;p._isV?p._62O="v":p._isH?p._62O="h":l.draggingData&&!this.dragCancel?(p._62O="d",l.handleDragAndDrop(E,"begin")):p._62O="p",p._62O&&"d"!==p._62O&&l.draggingData&&(l.draggingData=null,l.redraw()),ym(p)}}else p._isV&&l._43o(),p._isH&&l._42o()}},isV:function(s){var r=this.list,g=r._29I;return r._41o()&&g.x+g.width-r.lp(s).x<pi},isH:function(K){var O=this.list,H=O._29I;return O._40o()&&H.y+H.height-O.lp(K).y<pi},handle_mousewheel:function(K){this.handleScroll(K,K.wheelDelta/40,K.wheelDelta!==K.wheelDeltaX)},handle_DOMMouseScroll:function(j){this.handleScroll(j,-j.detail,1)},handleScroll:function(y,B,O){var W=this.list;Jr(y),W.endEditing&&W.endEditing(),O&&W._41o()?W.translate(0,B*W.getRowHeight()):W._40o()&&W.translate(10*B,0)},handle_keydown:function(v){if(!Z.isInput(v.target)){var o,T=this.list,M=T.sm(),n=T._rows,R=n.size();if(Un(v))T.selectAll();else if(sl(v))T.handleDelete&&T.handleDelete(v);else if(af(v))"d"!==this._62O||this.dragCancel||(T.handleDragAndDrop(v,"cancel"),this.dragCancel=!0);else if(mm(v))T.isCheckMode()&&(o=T.getFocusData(),o&&T.checkData(o));else if(oo(v)||Ni(v)){var p=T.isCheckMode();if(o=p?T.getFocusData():M.ld()){var L=T.getRowIndex(o);L>=0&&(oo(v)?0!==L&&(o=n.get(L-1),p?T.setFocusData(o):M.ss(o)):L!==R-1&&(o=n.get(L+1),p?T.setFocusData(o):M.ss(o)))}else R>0&&(o=n.get(0),p?T.setFocusData(o):M.ss(o))}}},_34o:function(Y,H){var f=this.list,S=f.lp(Y).x;return S>=0&&S<=f._indent?(f.checkData(H),void 0):(f.setFocusData(H),void 0)},_33o:function(T,$){var N=this.list,s=N.sm(),V=s.ld();if(sf(T))N.isSelected($)?s.rs($):s.as($);else if(sb(T))if(V)for(var j=N.getRowIndex(V),J=N.getRowIndex($);j!==J;)j+=J>j?1:-1,s.as(N._rows.get(j));else s.ss($);else if(db(T)){var q=qo();if(s.contains($)){var y=q-this._lastSelectDataTime;N.handleDataDoubleSelect&&y>500&&1500>y&&N.handleDataDoubleSelect(T,$)}s.ss($),this._lastSelectDataTime=q}else s.contains($)||s.ss($)}}),Cn.TreeView=function(Q){var F=this;F._35o(),F._5o(Q),new Vf(F)},Pf("TreeView",D,{ms_ac:[hl,Vr,po,"rootVisible",ql,"rootData",Ar,dn,cp,hk,Ol,De,ap,gj,Ke,Mq,vg,$j,bf,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:s,_indent:Fd,_rowHeight:Pi,_rowLineVisible:Z.treeViewRowLineVisible,_rowLineColor:Z.treeViewRowLineColor,_scrollBarColor:zr,_scrollBarSize:oq,_autoHideScrollBar:io,_expandIcon:Z.treeViewExpandIcon,_collapseIcon:Z.treeViewCollapseIcon,_autoMakeVisible:Ud,_selectBackground:Z.treeViewSelectBackground,_labelColor:Z.treeViewLabelColor,_labelSelectColor:Z.treeViewLabelSelectColor,_labelFont:Z.treeViewLabelFont,_doubleClickToToggle:Z.treeViewDoubleClickToToggle,drawRow:function(H,T,V,b,R,X,n){var O=this;O.drawRowBackground(H,T,V,b,R,X,n),O._97I(H,T,V,0,R,X,n)},isOnToggleIcon:function(G){var n=this.getDataAt(G);if(n){var j=this.getIndent(),z=this.lp(G).x;if(sr(this.getToggleIcon(n))){var T=j*this.getLevel(n);if(z>=T&&T+j>=z)return!0}}return!1}});var Vf=function(q){fm(Vf,this,[q])};xl(Vf,_k,{toggle:function($,x,F,T){var S=this.list,N=S.lp($).x;if(sr(S.getToggleIcon(x))){var K=F*T;if(N>=K&&K+F>=N)return S.toggle(x),!0}return S.isDoubleClickToToggle()&&yk($)?(S.toggle(x),!0):!1},_34o:function(Q,z){var j=this.list,m=j.lp(Q).x,e=j._levelMap[z._id],c=j._indent,_=c*(e+1);return m>=_&&_+c>=m?(j.checkData(z),void 0):(this.toggle(Q,z,c,e)||j.setFocusData(z),void 0)},_33o:function(m,r){var t=this,X=t.list;t.toggle(m,r,X._indent,X.getLevel(r))||Vf.superClass._33o.call(t,m,r)},handle_keydown:function(e){if(Ee(e)||Ck(e)){var Q=this.list,g=Q._rows,w=Q.isCheckMode(),b=Q.sm(),v=w?Q.getFocusData():b.ld();v?v.hasChildren()&&(Ee(e)?Q.collapse(v):Q.expand(v)):g.size()>0&&(v=g.get(0),w?Q.setFocusData(v):b.ss(v))}else Vf.superClass.handle_keydown.call(this,e)}});var ud=Cn.TableView=function(m){this._98I(),this._5o(m),new Df(this)};Pf("TableView",D,{ms_ac:[hl,Vr,po,"sortMode",Wk,Ue,ap,gj,Ke,Ir,Xb,"sortColumn",Ar,dn,cp,hk,Ol,$j,bf],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:Uk,_editable:!0,_batchEditable:!1,_rowHeight:Pi,_rowLineVisible:Z.tableViewRowLineVisible,_rowLineColor:Z.tableViewRowLineColor,_columnLineVisible:Z.tableViewColumnLineVisible,_columnLineColor:Z.tableViewColumnLineColor,_scrollBarColor:zr,_scrollBarSize:oq,_autoHideScrollBar:io,_autoMakeVisible:Ud,_selectBackground:Z.tableViewSelectBackground,_labelColor:Z.tableViewLabelColor,_labelSelectColor:Z.tableViewLabelSelectColor,_labelFont:Z.tableViewLabelFont,getCheckColumn:function(){var a=this;
if(!a._31o){var n=a._31o=new Hi;n.setEditable(!0),n.setWidth(40),n.getValue=a.getCheckColumValue,n.drawCell=a.drawCheckColumnCell}return a._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(Q){var H=this,P=H._39o,M=H.getCheckColumn();Q!==H.isCheckMode()&&(Q?P.add(M,0):P.remove(M),H.fp(ql,!Q,Q))},getCheckColumValue:function(G,O,h){return h.isSelected(G)},drawCheckColumnCell:function(r,A,P,l,c,h,u,V,y){ds(r,y.getCheckIcon(A),c+u/2,h+V/2,A,y)}});var Df=function(Z){fm(Df,this,[Z])};xl(Df,_k,{_34o:function(d,S){var N=this.list,s=N._31o;if(N.isCellEditable(S,s,d)){var $=N._3Q(s),I=N.lp(d).x;if($&&I>=$.startX&&I<$.startX+s.getWidth())return N.checkData(S),void 0}N._37O(S,d),N.setFocusData(S)},_33o:function(f,J){this.list._37O(J,f),Df.superClass._33o.apply(this,arguments)}});var fh=Cn.TreeTableView=function(V){var t=this,W=t._4o=new Hi;t._35o(),t._98I(),t._5o(V),W.setDisplayName("Name"),W.setEditable(!0),W.setWidth(180),W.drawCell=ej,W.getValue=Lf,t._39o.add(W),new qr(t)},ej=function(U,z,r,b,L,R,K,C,u){u._97I(U,z,r,L,R,K,C)},Lf=function(K,z,F){return F.getLabel(K)};Pf("TreeTableView",D,{ms_ac:[hl,Vr,po,"sortMode",Wk,Ue,De,ql,"rootData","rootVisible",Ar,dn,"sortColumn",Mq,vg,cp,hk,Ol,$j,Ke,ap,gj,Ir,Xb,bf,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:Uk,_checkMode:s,_editable:!0,_batchEditable:!1,_indent:Fd,_rowHeight:Pi,_rowLineVisible:Z.treeTableViewRowLineVisible,_rowLineColor:Z.treeTableViewRowLineColor,_columnLineVisible:Z.treeTableViewColumnLineVisible,_columnLineColor:Z.treeTableViewColumnLineColor,_expandIcon:Z.treeTableViewExpandIcon,_collapseIcon:Z.treeTableViewCollapseIcon,_scrollBarColor:zr,_scrollBarSize:oq,_autoHideScrollBar:io,_autoMakeVisible:Ud,_selectBackground:Z.treeTableViewSelectBackground,_labelColor:Z.treeTableViewLabelColor,_labelSelectColor:Z.treeTableViewLabelSelectColor,_labelFont:Z.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var qr=function(B){fm(qr,this,[B])};xl(qr,_k,{_34o:function(p,I){var A=this.list,R=A._4o,P=A._3Q(R),S=A.lp(p).x;if(P){var O=A._indent,e=P.startX+O*A.getLevel(I);if(sr(A.getToggleIcon(I))&&S>=e&&e+O>=S)return A.toggle(I),void 0;if(A.isCellEditable(I,R)&&(e+=O,S>=e&&e+O>=S))return A.checkData(I),void 0}A._37O(I,p),A.setFocusData(I)},_33o:function(d,C){var i=this.list,z=i.lp(d).x;if(sr(i.getToggleIcon(C))){var K=i._3Q(i._4o);if(K){var u=i._indent,T=K.startX+u*i.getLevel(C);if(z>=T&&T+u>=z)return i.toggle(C),void 0}}i._37O(C,d),qr.superClass._33o.apply(this,arguments)}});var ic=Cn.TableHeader=function(o){var h=this,x=h._view=Op(1,h),U=h._39o=o.getColumnModel(),O=h.iv;h.tv=h._tableView=o,h._60I=new Yd,h._canvas=qb(x),x.style.background=Z.tableHeaderBackground||"",x.style.height=Zr+Wo,U.mm(O,h),U.md(O,h),U.mh(O,h),o.mp(function(_){Zi[_.property]&&h.iv()},h),new lp(h),h.iv()};Pf("TableHeader",D,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",hl,po,De,"moveBackground","insertColor",Ir,Xb,"resizable","movable"],_checkIcon:Rl,_movable:!0,_resizable:!0,_labelColor:Z.tableHeaderLabelColor,_labelFont:Z.tableHeaderLabelFont,_columnLineColor:Z.tableHeaderColumnLineColor,_columnLineVisible:Z.tableHeaderColumnLineVisible,_sortDescIcon:Z.tableHeaderSortDescIcon,_sortAscIcon:Z.tableHeaderSortAscIcon,_moveBackground:Z.tableHeaderMoveBackground,_insertColor:Z.tableHeaderInsertColor,_indent:Fd,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(l){return l.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(p){return p.getColor()||this._labelColor},getLabelAlign:function(D){return D._align},onPropertyChanged:function(){this.iv()},_5Q:function(x){this._61I=x,this.iv()},getLogicalPoint:function(W){return Tg(W,this._canvas,this.tv.tx())},validateImpl:function(){var s=this,S=s._canvas,C=s.getWidth(),x=s.getHeight(),D=s.tv,E=s._60I,F=s._61I,e=-D.tx(),T=0;(C!==S.clientWidth||x!==S.clientHeight)&&Dg(S,C,x),E.clear(),s._39o._roots.each(function(R){if(R.isVisible()){var z=T+R.getWidth();e+C>=T&&z>=e&&E.add({column:R,startX:T}),T=z}});var b=Ml(S);if(ol(b,-e,0,1),b.beginPath(),b.rect(e,0,C,x),b.clip(),b.clearRect(e,0,C,x),E.each(function(G){var D=G.column,w=G.startX,V=D.getWidth();V>0&&(b.save(),b.beginPath(),b.rect(w,0,V,x),b.clip(),F&&F.column===D||s.drawColumn(b,D,w,0,V,x),s._columnLineVisible&&Yg(b,w+V-1,0,1,x,s._columnLineColor),b.restore())}),F){var w=F.column,T=F.startX,M=F.position,H=w.getWidth();b.save(),b.beginPath(),b.rect(T,0,H,x),b.clip(),b.fillStyle=s._moveBackground,b.fill(),s.drawColumn(b,w,T,0,H,x),b.restore(),np(b,s._insertColor,M,0,x)}b.restore()},_6Q:function(z){var E=this.tv;return E._31o===z&&E.sm().getSelectionMode()===wb},drawColumn:function(G,h,R,S,l,p){var o=this,W=o.tv,y=sr(h.getIcon()),J=o.getLabelAlign(h);if(o._6Q(h)){var d=sr(o._checkIcon);ds(G,d,R+l/2,S+p/2,h,o)}else{var X=o.getLabel(h),j=o.getLabelFont(h),k=o.getLabelColor(h),z=Bm(j,X).width,g=y?o._indent:0;J===Zq?(y&&pc(G,y,hm,R,S,g,p),Kn(G,X,j,k,R+g,S,l,p,Zq)):J===Oi?(y&&pc(G,y,hm,R+l-z-g,S,g,p),Kn(G,X,j,k,R,S,l,p,Oi)):(y&&pc(G,y,hm,R+(l-z-g)/2,S,g,p),Kn(G,X,j,k,R+(l-z+g)/2,S,0,p,Zq))}if(h.isSortable()&&W.getSortColumn()===h&&(y=sr(h.getSortOrder()===Gk?o._sortAscIcon:o._sortDescIcon))){var _=Db(y,h)/2+2;ds(G,y,J===Oi?R+_:R+l-_,S+p/2,h,W)}}});var lp=function(o){var d=this;d.th=o,d.tv=o._tableView,d.addListeners()};xl(lp,D,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(S){this.getView().style.cursor=S},handle_mousemove:function(L){if(!wk){var u=this;delete u._29o,u.setCursor(Ph);for(var F=u.th,K=F._60I,Q=F.lp(L).x,j=K.size()-1;j>=0;j--){var o=K.get(j),t=o.column,V=o.startX+t.getWidth();if(F.isResizable()&&A(V-Q)<=(nb?10:3))return u._29o=o,u.setCursor(Se),void 0;Q>o.startX&&V>Q&&(u._29o=o),(t.isClickable()||t.isSortable()||F.isMovable()||u.tv.getCheckColumn&&t===u.tv.getCheckColumn())&&Q>o.startX&&V>Q&&u.setCursor(wg)}}},handle_mousedown:function(m){this.handle_touchstart(m)},handle_touchstart:function(v){var L=this;Jr(v),L.tv.endEditing(),L.handle_mousemove(v),L._29o&&(L.x=gh(v).x,L.lx=L.th.lp(v).x,L.w=L._29o.column.getWidth(),ym(L,v))},handleWindowMouseMove:function(o){this.handleWindowTouchMove(o)},handleWindowTouchMove:function(m){var W=this,b=W.th,q=W.getView().style.cursor,_=W._29o,G=gh(m).x-W.x;if(W.resizing||W.moving||(q===Se?W.resizing=1:b.isMovable()&&q===wg&&A(G)>2&&(W.moving=1)),W.resizing)_.column.setWidth(W.w+G);else if(W.moving){var C=W.lx+G;b._60I.each(function(W){var F=W.startX,$=F+W.column.getWidth();if(C>=F&&$>=C){var z={column:_.column,startX:_.startX+G,front:$-C>C-F,insertColumn:W.column};z.position=z.front?F:$,b._5Q(z)}})}},_16Q:function(M,j){var i=this,D=i.tv,T=i.th,K=T._checkIcon;if(T._6Q(M)){var f=sr(K),W=i.lx,A=M.getWidth(),C=Db(f,M);if(W>=j+A/2-C&&j+A/2+C>=W){T.setCheckIcon(K===Bq?Rl:Bq);var k=D.sm(),N=D._rows;return K===Bq?k.rs(N):k.ss(N),D.onCheckColumnClicked(M),!0}}return!1},handleWindowMouseUp:function(b){this.handleWindowTouchEnd(b)},handleWindowTouchEnd:function(v){var O=this,B=O.tv,a=O.th,N=O._29o;if(O.moving){var z=a._61I;if(z&&z.insertColumn!==z.column){var E=z.column,u=B.getColumnModel()._roots,e=u.remove(E),f=u.indexOf(z.insertColumn);f>=0&&(z.front||f++,f<=u.size()&&(u.add(E,f),B.getColumnModel()._38I(E,e,f)))}a._5Q(s),delete O.moving}else if(!O.resizing&&N){E=N.column;var x=a.lp(v).x,h=N.startX,o=!0;if(a.onColumnClicked){var C=a.onColumnClicked(E,v,h);C===!1&&(o=!1)}if(o&&x>=h&&x<=h+E.getWidth()&&!O._16Q(E,h)){if(E.isSortable()){var I=B.getSortMode(),t=E.getSortOrder();I===Uk?B.getSortColumn()===E?(t===Ki&&B.setSortColumn(s),E.setSortOrder(t===Gk?Ki:Gk)):B.setSortColumn(E):"bistate"===I&&(B.getSortColumn()===E?E.setSortOrder(t===Gk?Ki:Gk):B.setSortColumn(E))}B.onColumnClicked(E,v,h)}}O._29o=O.resizing=O.x=O.lx=O.w=s}}),Cn.TablePane=function(h){this.init(new ud(h))},Pf("TablePane",D,{ms_v:1,_44o:1}),Cn.TreeTablePane=function(T){this.init(new fh(T))},Pf("TreeTablePane",D,{ms_v:1,_44o:1}),Cn.Toolbar=function(u){var Y=this,y=Y._view=Op(1,Y),H=y.style;H.background=Z.toolbarBackground||"",H.height=si+Wo,Y._canvas=qb(y),Y._30o=new Yd,Y._90I=new Yd,Y.setItems(u||[]),y.handleGroupSelectedChanged=function(i){if(i.isSelected()){var A=i.getGroupId();null!=A&&Y._items.forEach(function(b){var n=b.element;n&&n!==i&&n.setSelected&&n.getGroupId&&n.getGroupId()===A&&n.setSelected(!1)})}},new lq(Y)},Pf("Toolbar",D,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[En,hl,po,Vr,bf,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:Z.toolbarLabelColor,_labelSelectColor:Z.toolbarLabelSelectColor,_labelFont:Z.toolbarLabelFont,_selectBackground:Z.toolbarSelectBackground,_itemGap:Z.toolbarItemGap,_separatorColor:Z.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(D){var p=this.getItemInfoAt(D);return p?p.item.toolTip:s},getLabelColor:function(O){return O&&O.selected&&O.type!==Bq&&O.type!==Nb?this._labelSelectColor:this._labelColor},onPropertyChanged:function(G){this.iv(),G.property===En&&this._items.forEach(function(c){Ll(c)})},redraw:function(){this.iv()},addItem:function(E,f){var e=this._items;f==s?e.push(E):e.splice(f,0,E),this.fp(En,s,e)},removeItem:function(_){if(_)for(var F=this._items,h=0;h<F.length;h++)_===F[h]&&(F.splice(h,1),this.fp(En,s,F))},removeItemById:function(m){if(m!=s)for(var F=this._items,V=0;V<F.length;V++)if(m===F[V].id){var i=F.splice(V,1)[0];return this.fp(En,s,F),i}},getItemById:function(T){if(T!=s)for(var L=this._items,C=0;C<L.length;C++){var O=L[C];if(T===O.id)return O}},setItemVisible:function(W,p){var B=this.getItemById(W);B&&(B.visible=p)},getItemInfos:function(){return this._30o},getItemInfoAt:function(V){var e=this,D=0,l=e._30o,Z=e.lp(V),f=Z.x,S=Z.y;if(S>=0&&S<=e.getHeight())for(;D<l.size();D++){var b=l.get(D);if(b.startX<=f&&f<=b.endX)return b}return s},drawItem:function(T,l,e,j,K){if(l.visible===!1)return 0;if(dc(l.visible)&&!l.visible())return 0;var Y=this,I=l.disabled;I&&(T.globalAlpha=de);var k=Y.drawItemImpl(T,l,e,j,K),O=Y._itemGap;return I&&(T.globalAlpha=1),this._currentItem!==l||"separator"===l||l.separator===!0||l.unfocusable||Hb(T,Y._separatorColor,e-O/2,0,k+O,j),k},drawItemImpl:function(L,A,S,v,j){var G=this,X=G._view,k=G._itemGap,n=v/2,N=A.type,Y=A.element,d=A.label;Fm(Y)&&(d=Y,Y=s);var K,C=G.getLabelFont(A),O=G.getLabelColor(A),F=A.selected,b=sr(A.icon),H=Db(b,A),T=0,V=H+(d?Bm(C,d).width:0);if("separator"===A||A.separator===!0)return np(L,G._separatorColor,S,v/4,n),1;if(Y){b&&ds(L,b,S+H/2,n,A,G),Kn(L,d,C,O,S+H,0,0,v);var c=kk(Y);j||G._90I.add(c),c.parentNode!==X&&zd(X,c),Y.iv&&Y.iv(),Y.validate&&Y.validate();var x=c.getBoundingClientRect(),_=x.width,q=c.style;return Tr(c),q.left=G.tx()+S+V+Wo,q.top=(v-x.height)/2+Wo,V+_}return N===Nb?K=sr(F?Gl:Sd):N===Bq&&(K=sr(F?Bq:Rl)),K?(T=Db(K,A),ds(L,K,S+T/2,n,A,G),S+=T,V+=T):F&&Yg(L,S-k/2,0,V+k,v,G.getSelectBackground(A)),b&&ds(L,b,S+H/2,n,A,G),Kn(L,d,C,O,S+H,0,0,v),V},validateImpl:function(){var z=this,G=z._canvas,c=z.getWidth(),N=z.getHeight(),Q=z._30o,A=z._items;Dg(G,c,N);var p=Ml(G),e=z._itemGap,Y=e/2;ol(p,z.tx(),0,1),p.clearRect(0,0,c,N);var E=z._90I;z._90I=new Yd,Q.clear(),A.forEach(function(M){var B=z.drawItem(p,M,Y,N);Q.add({item:M,startX:Y,endX:Y+B,width:B}),B&&(Y+=B+e)}),E.each(function(N){z._90I.contains(N)||bj(N)});var l=z._64I;z._64I=M(0,Y),p.restore(),z._stickToRight?(z._65O=0,p=Ml(G),Y=c-z._64I+e,ol(p,0,0,1),p.clearRect(0,0,c,N),Q.clear(),A.forEach(function(M){var n=z.drawItem(p,M,Y,N,!0);Q.add({item:M,startX:Y,endX:Y+n,width:n}),n&&(Y+=n+e)}),p.restore()):z.tx(z.tx()),l!==z._64I&&z.onSumWidthChanged(l,z._64I)},onSumWidthChanged:function(){},handleClick:function(v,N){var T=this,i=v.type,z=v.action,K=v.groupId,C=v.selected;v.disabled||(K!=s?C||(v.selected=!0,this._items.forEach(function(q){q.groupId===K&&v!==q&&(q.selected=!1)}),z&&v.action(v,T,N)):i===Bq||"toggle"===i?(v.selected=!C,z&&v.action(v,T,N)):z&&v.action(v,T,N)),Oc(),T.iv()}});var lq=function(X){this.tb=X,this.addListeners()};xl(lq,D,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(Z){this.handleScroll(Z,10*(Z.wheelDelta/40))},handle_DOMMouseScroll:function(B){this.handleScroll(B,10*-B.detail)},handleScroll:function(X,F){Jr(X);var q=this.tb;q.isScrollable()&&!q._stickToRight&&(q.tx(q.tx()+F),ur())},handle_mousemove:function(t){var h=this;wk||h.setItem(t)},handle_mouseout:function(e){var E=this;e.target===E.getView()?E.tb.setCurrentItem(s):E.handle_mousemove(e)},handle_mousedown:function(q){this.handle_mousemove(q),this.handle_touchstart(q)},handle_touchstart:function(G){var A=this,M=A.tb,k=G.target;db(G)&&(k===A.getView()||k===M._canvas)&&(Jr(G),M.setFocus(G)&&(this.setItem(G,!0),(M.isScrollable()||A.info&&!A.info.item.disabled)&&(A.x=gh(G).x,A.tx=M.tx(),ym(A,G))))},handleWindowMouseMove:function(f){this.handleWindowTouchMove(f)},handleWindowTouchMove:function(n){var m=this,B=m.tb;if(!B._stickToRight){var T=gh(n).x-m.x;!m._25o&&A(T)>2&&B.isScrollable()&&(m._25o=1),m._25o&&B.tx(m.tx+T)}},handleWindowMouseUp:function(a){this.handleWindowTouchEnd(a)},handleWindowTouchEnd:function(q){var U=this,g=U.tb,w=U.info,E=U.tb.getItemInfoAt(q);if(!U._25o&&w){var t=w.item;E&&E.item===t&&g.handleClick(t,q)}U._25o=U.x=U.tx=s,U.setItem()},setItem:function(F,w){var R=this,O=R.tb,r=R.info=F?O.getItemInfoAt(F):s,B=r?r.item:s;O.setCurrentItem(B),w&&B&&dc(B.onDown)&&B.onDown(F)}}),Cn.BorderPane=function(){this._view=Op(1,this),this.iv()},Pf("BorderPane",D,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(m,o){this._12o("leftView",m),o!=s&&this.setLeftWidth(o)},getRightView:function(){return this._rightView},setRightView:function(b,Q){this._12o("rightView",b),Q!=s&&this.setRightWidth(Q)},getTopView:function(){return this._topView},setTopView:function(J,n){this._12o("topView",J),n!=s&&this.setTopHeight(n)},getBottomView:function(){return this._bottomView},setBottomView:function(i,E){this._12o("bottomView",i),E!=s&&this.setBottomHeight(E)},getCenterView:function(){return this._centerView},setCenterView:function(E){this._12o("centerView",E)},_12o:function(I,V){var g=this,c="_"+I,D=g._view,o=g[c];o!==V&&(o&&(o.getView?bj(o.getView()):bj(o)),g[c]=V,V&&(V.getView?zd(D,V.getView(),1):zd(D,V,1)),g.fp(I,o,V))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var T=this,N=T._topView,Z=T._bottomView,n=T._leftView,d=T._rightView,G=T._centerView,j=T.getWidth(),W=T.getHeight(),H=0,r=0,w=j,k=W,O=0,b=0,S=0,$=0;N&&(O=T._topHeight==s?Mi(N):T._topHeight,r=O),Z&&(b=T._bottomHeight==s?Mi(Z):T._bottomHeight,k=W-b),n&&(S=T._leftWidth==s?Ag(n):T._leftWidth,H=S),d&&($=T._rightWidth==s?Ag(d):T._rightWidth,w=j-$);var X=M(0,w-H),V=M(0,k-r);N&&_p(N,0,0,j,O),Z&&_p(Z,0,k,j,b),n&&_p(n,0,r,S,V),d&&_p(d,w,r,$,V),G&&_p(G,H,r,X,V)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);