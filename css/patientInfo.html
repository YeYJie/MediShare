<div id="patientInfo">
	<div class="row">
		<div class="col-md-2" id="patientInfoHeader"></div>
		<div class="col-md-10" id="patientInfoDetail"></div>
	</div>
</div>

<script type="text/javascript">

	function doShowPatientInfo(patient) {
		var patientInfoHeader = '<img src="/header/' + patient.id + '" class="img-responsive"/>';
		document.getElementById("patientInfoHeader").innerHTML = patientInfoHeader;
		var patientInfoTable = ''
			+'<table class="table table-bordered">'
			+'	<tbody>'
			+'		<tr>'
			+'			<td>姓名:</td><td colspan="2">' + patient.name + '</td>'
			+'			<td>性别:</td><td colspan="2">' + patient.gender + '</td>'
			+'			<td>出生日期:</td><td colspan="2">' + patient.birth + '</td>'
			+'		</tr>'
			+'		<tr>'
			+'			<td>民族:</td><td colspan="2">' + patient.minzu + '</td>'
			+'			<td>婚姻状况:</td><td colspan="2">' + patient.maritalStatus + '</td>'
			+'			<td>教育情况:</td><td colspan="2">' + patient.educationalLevel + '</td>'
			+'		</tr>'
			+'		<tr>'
			+'			<td>职业:</td><td colspan="2">' + patient.occupation + '</td>'
			+'			<td>工作单位:</td><td colspan="5">' + patient.company + '</td>'
			+'		</tr>'
			+'		<tr>'
			+'			<td>居住地址:</td><td colspan="8">' + patient.addr + '</td>'
			+'		</tr>'
			+'		<tr>'
			+'			<td>过敏史:</td><td colspan="8">' + patient.allergy + '</td>'
			+'		</tr>'
			+'	</tbody>'
			+'</table>';
		document.getElementById("patientInfoDetail").innerHTML = patientInfoTable;
	}

	var patientInfoCache = {};

	function showPatientInfo(pid) {
		var pInfo = patientInfoCache[pid];

		if(!pInfo) {
			$.ajax({
				type: "GET",
				url: "/getPatientInfo/" + pid,
				success: function(patientInfo) {
					console.log("[patientInfo.html showPatientInfo]: ", patientInfo);
					// processPatients(doctorPatients.patients);
					patientInfoCache[patientInfo.id.toString()] = patientInfo;
					doShowPatientInfo(patientInfo);
					return false;
				},
				error: function(xhr) {
				}
			});
		}
		else {
			doShowPatientInfo(pInfo);
		}
	}

	function clearPatientInfo() {
		document.getElementById("patientInfoHeader").innerHTML = "";
		document.getElementById("patientInfoDetail").innerHTML = "";
	}

	$(function() {

		socket.on('patientInfo', function(data) {
			console.log('socket.on patientInfo', data);
		});

	});
</script>
